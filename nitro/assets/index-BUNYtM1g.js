import{A as a0,a as o0,C as $r,T as l0,i as c0,b as MN,c as Es,S as Ve,R as u0,M as _r,F as nR,G as aR,B as h0,d as bO,e as zo,f as d0,P as Qt,g as bN,h as Fu,j as _0,k as XE,l as g0,m as f0,n as kd,W as m0,o as E0,p as rc,H as p0,q as I0,D as T0,r as R0,s as _,t as i,u as DN,v as gs,w as oR,x as lR,y as S0,z as Dr,E as cR,I as hu,J as du,K as vN,L as O0,N as A0,O as uR,Q as N0,U as PN,V as Xs,X as C0,Y as x0,Z as lr,_ as cr,$ as hR,a0 as Cd,a1 as dR,a2 as _R,a3 as LN,a4 as y0,a5 as UN,a6 as M0,a7 as b0,a8 as jN,a9 as _u,aa as wN,ab as D0,ac as v0,ad as P0,ae as wm,af as qE,ag as L0,ah as U0,ai as j0,aj as w0,ak as F0,al as gR,am as fR,an as G0,ao as k0,ap as B0,aq as V0,ar as DO,as as H0,at as W0,au as Y0,av as z0,aw as K0,ax as uE,ay as hE,az as dE,aA as X0}from"./vendor-VkprU1_0.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();const Ug=class Ug{};Ug.UNKNOWN=0,Ug.BROWSER=1;let QE=Ug;const qu=class qu{};qu.UNKNOWN=0,qu.FLASH=1,qu.HTML5=2;let JE=qu;const Rc=class Rc{};Rc.CONNECTION_OPENED="open",Rc.CONNECTION_CLOSED="close",Rc.CONNECTION_ERROR="error",Rc.CONNECTION_MESSAGE="message";let hc=Rc;const Et=class Et{static getExpressionTimeout(t){switch(t=parseInt(t),t){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(t){return Et.EXPRESSION_MAP.indexOf(t)}static getExpression(t){return t>Et.EXPRESSION_MAP.length?null:Et.EXPRESSION_MAP[t]}static getGestureId(t){return Et.GESTURE_MAP.indexOf(t)}static getGesture(t){return t>Et.GESTURE_MAP.length?null:Et.GESTURE_MAP[t]}static idToAvatarActionState(t){return t==="Lay"?"lay":t==="Float"?"float":t==="Swim"?"swim":t==="Sit"?"sit":t==="Respect"?"respect":t==="Wave"?"wave":t==="Idle"?"idle":t==="Dance"?"dance":t==="UseItem"?"usei":t==="CarryItem"?"cri":t==="Talk"?"talk":t==="Sleep"?"Sleep":t==="Move"?"mv":"std"}};Et.CARRY_OBJECT="cri",Et.DANCE="dance",Et.EFFECT="fx",Et.EXPRESSION="expression",Et.EXPRESSION_BLOW_A_KISS="blow",Et.EXPRESSION_CRY="cry",Et.EXPRESSION_IDLE="idle",Et.EXPRESSION_LAUGH="laugh",Et.EXPRESSION_RESPECT="respect",Et.EXPRESSION_RIDE_JUMP="ridejump",Et.EXPRESSION_SNOWBOARD_OLLIE="sbollie",Et.EXPRESSION_SNOWBORD_360="sb360",Et.EXPRESSION_WAVE="wave",Et.GESTURE="gest",Et.GESTURE_AGGRAVATED="agr",Et.GESTURE_SAD="sad",Et.GESTURE_SMILE="sml",Et.GESTURE_SURPRISED="srp",Et.GUIDE_STATUS="guide",Et.MUTED="muted",Et.PET_GESTURE_BLINK="eyb",Et.PET_GESTURE_CRAZY="crz",Et.PET_GESTURE_JOY="joy",Et.PET_GESTURE_MISERABLE="mis",Et.PET_GESTURE_PUZZLED="puz",Et.PET_GESTURE_TONGUE="tng",Et.PLAYING_GAME="playing_game",Et.POSTURE="posture",Et.POSTURE_FLOAT="float",Et.POSTURE_LAY="lay",Et.POSTURE_SIT="sit",Et.POSTURE_STAND="std",Et.POSTURE_SWIM="swim",Et.POSTURE_WALK="mv",Et.SIGN="sign",Et.SLEEP="sleep",Et.SNOWWAR_DIE_BACK="swdieback",Et.SNOWWAR_DIE_FRONT="swdiefront",Et.SNOWWAR_PICK="swpick",Et.SNOWWAR_RUN="swrun",Et.SNOWWAR_THROW="swthrow",Et.TALK="talk",Et.BLINK="blink",Et.TYPING="typing",Et.USE_OBJECT="usei",Et.VOTE="vote",Et.GESTURE_MAP=["",Et.GESTURE_SMILE,Et.GESTURE_AGGRAVATED,Et.GESTURE_SURPRISED,Et.GESTURE_SAD,Et.PET_GESTURE_JOY,Et.PET_GESTURE_CRAZY,Et.PET_GESTURE_TONGUE,Et.PET_GESTURE_BLINK,Et.PET_GESTURE_MISERABLE,Et.PET_GESTURE_PUZZLED],Et.EXPRESSION_MAP=["",Et.EXPRESSION_WAVE,Et.EXPRESSION_BLOW_A_KISS,Et.EXPRESSION_LAUGH,Et.EXPRESSION_CRY,Et.EXPRESSION_IDLE,Et.DANCE,Et.EXPRESSION_RESPECT,Et.EXPRESSION_SNOWBOARD_OLLIE,Et.EXPRESSION_SNOWBORD_360,Et.EXPRESSION_RIDE_JUMP];let St=Et;const Sc=class Sc{};Sc.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0],Sc.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1],Sc.MIN_DIRECTION=0,Sc.MAX_DIRECTION=7;let Jr=Sc;const Ca=class Ca{};Ca.GENERIC="hd",Ca.HEAD="head",Ca.TORSO="torso",Ca.LEGS="legs",Ca.HOTLOOKS="hotlooks",Ca.WARDROBE="wardrobe",Ca.EFFECTS="effects";let qr=Ca;const Xt=class Xt{};Xt.MALE="M",Xt.FEMALE="F",Xt.UNISEX="U",Xt.SCALE="h",Xt.STD="std",Xt.DEFAULT_FRAME=0,Xt.BODY="bd",Xt.SHOES="sh",Xt.LEGS="lg",Xt.CHEST="ch",Xt.WAIST_ACCESSORY="wa",Xt.CHEST_ACCESSORY="ca",Xt.HEAD="hd",Xt.HAIR="hr",Xt.FACE_ACCESSORY="fa",Xt.EYE_ACCESSORY="ea",Xt.HEAD_ACCESSORY="ha",Xt.HEAD_ACCESSORY_EXTRA="he",Xt.COAT_CHEST="cc",Xt.CHEST_PRINT="cp",Xt.LEFT_HAND_ITEM="li",Xt.LEFT_HAND="lh",Xt.LEFT_SLEEVE="ls",Xt.RIGHT_HAND="rh",Xt.RIGHT_SLEEVE="rs",Xt.FACE="fc",Xt.EYES="ey",Xt.HAIR_BIG="hrb",Xt.RIGHT_HAND_ITEM="ri",Xt.LEFT_COAT_SLEEVE="lc",Xt.RIGHT_COAT_SLEEVE="rc",Xt.FIGURE_SETS=[Xt.SHOES,Xt.LEGS,Xt.CHEST,Xt.WAIST_ACCESSORY,Xt.CHEST_ACCESSORY,Xt.HEAD,Xt.HAIR,Xt.FACE_ACCESSORY,Xt.EYE_ACCESSORY,Xt.HEAD_ACCESSORY,Xt.HEAD_ACCESSORY_EXTRA,Xt.COAT_CHEST,Xt.CHEST_PRINT];let At=Xt;const Qu=class Qu{};Qu.NONE=0,Qu.GUIDE=1,Qu.REQUESTER=2;let Zn=Qu;const jg=class jg{};jg.LARGE="h",jg.SMALL="sh";let hr=jg;const Ju=class Ju{};Ju.FULL="full",Ju.HEAD="head",Ju.BODY="body";let ai=Ju;const nl=class nl{};nl.VERTICAL="vertical",nl.SITTING="sitting",nl.HORIZONTAL="horizontal",nl.SWIM="swim",nl.SNOWWARS_HORIZONTAL="swhorizontal";let no=nl;const lo=class lo{};lo.NONE=0,lo.HEART=1,lo.SMILE=2,lo.BOBBA=3,lo.RELATIONSHIP_TYPES=[0,1,2,3],lo.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];let ur=lo;const xa=class xa{};xa.HOTEL_VIEW="hotel_view",xa.HOME_ROOM="home_room",xa.NAVIGATOR="navigator",xa.CATALOG="catalog",xa.INVENTORY="inventory",xa.ME_MENU="me_menu",xa.FRIEND_LIST="friendlist";let f_=xa;const al=class al{};al.LOVE_LOCK=0,al.CARVE_A_TREE=1,al.FRIENDS_PORTRAIT=2,al.WILD_WEST_WANTED=3,al.HABBOWEEN=4;let m_=al;const wg=class wg{};wg.CATALOG="catalog",wg.INVENTORY="inventory";let Vo=wg;const $=class ${};$.OBJECT_ROOM_ID="object_room_id",$.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value",$.TILE_CURSOR_HEIGHT="tile_cursor_height",$.FIGURE="figure",$.GENDER="gender",$.OWN_USER="own_user",$.FIGURE_CAN_STAND_UP="figure_can_stand_up",$.FIGURE_VERTICAL_OFFSET="figure_vertical_offset",$.FIGURE_TALK="figure_talk",$.FIGURE_DANCE="figure_dance",$.FIGURE_SLEEP="figure_sleep",$.FIGURE_BLINK="figure_blink",$.FIGURE_EFFECT="figure_effect",$.FIGURE_CARRY_OBJECT="figure_carry_object",$.FIGURE_USE_OBJECT="figure_use_object",$.FIGURE_GESTURE="figure_gesture",$.FIGURE_POSTURE="figure_posture",$.FIGURE_POSTURE_PARAMETER="figure_posture_parameter",$.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable",$.FIGURE_HIGHLIGHT="figure_highlight",$.FURNITURE_PURCHASER_NAME="furniture_purchaser_name",$.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure",$.STD="std",$.FIGURE_SIGN="figure_sign",$.FIGURE_FLAT_CONTROL="figure_flat_control",$.FIGURE_IS_TYPING="figure_is_typing",$.FIGURE_IS_MUTED="figure_is_muted",$.FIGURE_GAINED_EXPERIENCE="figure_gained_experience",$.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp",$.FIGURE_NUMBER_VALUE="figure_number_value",$.FIGURE_IS_PLAYING_GAME="figure_is_playing_game",$.FIGURE_GUIDE_STATUS="figure_guide_status",$.FIGURE_EXPRESSION="figure_expression",$.HEAD_DIRECTION="head_direction",$.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables",$.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index",$.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable",$.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation",$.FURNITURE_DATA_FORMAT="furniture_data_format",$.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number",$.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size",$.FURNITURE_CRACKABLE_STATE="furniture_crackable_state",$.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits",$.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target",$.FURNITURE_CREDIT_VALUE="furniture_credit_value",$.FURNITURE_DATA="furniture_data",$.FURNITURE_ITEMDATA="furniture_itemdata",$.FURNITURE_COLOR="furniture_color",$.FURNITURE_LIFT_AMOUNT="furniure_lift_amount",$.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id",$.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name",$.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1",$.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2",$.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time",$.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled",$.FURNITURE_SIZE_X="furniture_size_x",$.FURNITURE_SIZE_Y="furniture_size_y",$.FURNITURE_SIZE_Z="furniture_size_z",$.FURNITURE_CENTER_X="furniture_center_x",$.FURNITURE_CENTER_Y="furniture_center_y",$.FURNITURE_CENTER_Z="furniture_center_z",$.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions",$.FURNITURE_AD_URL="furniture_ad_url",$.FURNITURE_TYPE_ID="furniture_type_id",$.FURNITURE_EXTRAS="furniture_extras",$.FURNITURE_EXPIRY_TIME="furniture_expiry_time",$.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp",$.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object",$.FURNITURE_IS_STICKIE="furniture_is_stickie",$.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status",$.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url",$.FURNITURE_BRANDING_URL="furniture_branding_url",$.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x",$.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y",$.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z",$.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status",$.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name",$.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state",$.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier",$.FURNITURE_USAGE_POLICY="furniture_usage_policy",$.FURNITURE_OWNER_ID="furniture_owner_id",$.FURNITURE_OWNER_NAME="furniture_owner_name",$.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue",$.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation",$.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness",$.FURNITURE_AREA_HIDE_ROOT_X="furniture_area_hide_root_x",$.FURNITURE_AREA_HIDE_ROOT_Y="furniture_area_hide_root_y",$.FURNITURE_AREA_HIDE_WIDTH="furniture_area_hide_width",$.FURNITURE_AREA_HIDE_LENGTH="furniture_area_hide_length",$.FURNITURE_AREA_HIDE_INVISIBILITY="furniture_area_hide_invisibility",$.FURNITURE_AREA_HIDE_WALL_ITEMS="furniture_area_hide_wall_items",$.FURNITURE_AREA_HIDE_INVERT="furniture_area_hide_invert",$.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask",$.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type",$.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height",$.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result",$.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count",$.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed",$.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name",$.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender",$.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure",$.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type",$.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type",$.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count",$.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_",$.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_",$.FURNITURE_INTERNAL_LINK="furniture_internal_link",$.FURNITURE_CLOTHING_BOY="furniture_clothing_boy",$.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl",$.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data",$.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data",$.PET_PALETTE_INDEX="pet_palette_index",$.PET_COLOR="pet_color",$.PET_HEAD_ONLY="pet_head_only",$.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids",$.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids",$.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids",$.PET_IS_RIDING="pet_is_riding",$.PET_TYPE="pet_type",$.PET_ALLOWED_DIRECTIONS="pet_allowed_directions",$.RACE="race",$.ROOM_MAP_DATA="room_map_data",$.ROOM_PLANE_MASK_XML="room_plane_mask_xml",$.ROOM_FLOOR_TYPE="room_floor_type",$.ROOM_WALL_TYPE="room_wall_type",$.ROOM_LANDSCAPE_TYPE="room_landscape_type",$.ROOM_WALL_THICKNESS="room_wall_thickness",$.ROOM_FLOOR_THICKNESS="room_floor_thickness",$.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time",$.ROOM_FLOOR_VISIBILITY="room_floor_visibility",$.ROOM_WALL_VISIBILITY="room_wall_visibility",$.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility",$.ROOM_DOOR_X="room_door_x",$.ROOM_DOOR_Y="room_door_y",$.ROOM_DOOR_Z="room_door_z",$.ROOM_DOOR_DIR="room_door_dir",$.ROOM_BACKGROUND_COLOR="room_background_color",$.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only",$.ROOM_RANDOM_SEED="room_random_seed",$.ROOM_WORLD_TYPE="room_world_type",$.ROOM_SELECTED_X="room_selected_x",$.ROOM_SELECTED_Y="room_selected_y",$.ROOM_SELECTED_Z="room_selected_z",$.ROOM_SELECTED_PLANE="room_selected_plane",$.IMAGE_QUERY_SCALE="image_query_scale",$.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type",$.SESSION_URL_PREFIX="session_url_prefix",$.SESSION_CURRENT_USER_ID="session_current_user_id";let A=$;const JS=class JS{};JS.UNIQUE_SET=256;let ZE=JS;class Ko{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(t){(this._flags&ZE.UNIQUE_SET)>0&&(this._uniqueNumber=t.readInt(),this._uniqueSeries=t.readInt())}initializeFromRoomObjectModel(t){this._uniqueNumber=t.getValue(A.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=t.getValue(A.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(t){t&&(t.setValue(A.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),t.setValue(A.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(t){return!1}get state(){const t=parseInt(this.getLegacyString());return isNaN(t)?0:t}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(t){this._uniqueNumber=t}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(t){this._uniqueSeries=t}get rarityLevel(){return-1}get flags(){return this._flags}set flags(t){this._flags=t}}const Ln=class Ln{};Ln.LEGACY_KEY=0,Ln.MAP_KEY=1,Ln.STRING_KEY=2,Ln.VOTE_KEY=3,Ln.EMPTY_KEY=4,Ln.NUMBER_KEY=5,Ln.HIGHSCORE_KEY=6,Ln.CRACKABLE_KEY=7;let ha=Ln;const Fg=class Fg extends Ko{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(t){t&&(this._state=t.readString(),this._hits=t.readInt(),this._target=t.readInt(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._state=t.getValue(A.FURNITURE_CRACKABLE_STATE),this._hits=t.getValue(A.FURNITURE_CRACKABLE_HITS),this._target=t.getValue(A.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,Fg.FORMAT_KEY),t.setValue(A.FURNITURE_CRACKABLE_STATE,this._state),t.setValue(A.FURNITURE_CRACKABLE_HITS,this._hits),t.setValue(A.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(t){return!0}get hits(){return this._hits}get target(){return this._target}};Fg.FORMAT_KEY=ha.CRACKABLE_KEY;let E_=Fg;const Gg=class Gg extends Ko{parseWrapper(t){t&&(this._state="",super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,Gg.FORMAT_KEY)}getLegacyString(){return this._state}compare(t){return super.compare(t)}};Gg.FORMAT_KEY=ha.EMPTY_KEY;let p_=Gg;class vO{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(t){this._score=t}get users(){return this._users}set users(t){this._users=t}addUsername(t){this._users.push(t)}}const kg=class kg extends Ko{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(t){if(!t)return;this._state=t.readString(),this._scoreType=t.readInt(),this._clearType=t.readInt();let e=t.readInt();for(;e>0;){const s=new vO;s.score=t.readInt();let r=t.readInt();for(;r>0;)s.addUsername(t.readString()),r--;this._entries.push(s),e--}super.parseWrapper(t)}initializeFromRoomObjectModel(t){this._scoreType=t.getValue(A.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=t.getValue(A.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const e=t.getValue(A.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<e;){const r=new vO;r.score=t.getValue(A.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),r.users=t.getValue(A.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(r),s++}super.initializeFromRoomObjectModel(t)}writeRoomObjectModel(t){if(super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,kg.FORMAT_KEY),t.setValue(A.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),t.setValue(A.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){t.setValue(A.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let e=0;for(;e<this._entries.length;){const s=this._entries[e];t.setValue(A.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+e,s.score),t.setValue(A.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+e,s.users),e++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}};kg.FORMAT_KEY=ha.HIGHSCORE_KEY;let I_=kg;const Bg=class Bg extends Ko{constructor(){super(),this._data=""}parseWrapper(t){t&&(this._data=t.readString(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(A.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,Bg.FORMAT_KEY),t.setValue(A.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(t){return this._data===t.getLegacyString()}setString(t){this._data=t}};Bg.FORMAT_KEY=ha.LEGACY_KEY;let Di=Bg;const co=class co extends Ko{constructor(){super(),this._data={}}parseWrapper(t){if(!t)return;this._data={};const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data[t.readString()]=t.readString();super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(A.FURNITURE_DATA)||{}}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,co.FORMAT_KEY),t.setValue(A.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const t=this._data[co.STATE];return t??""}compare(t){return!1}getValue(t){return this._data[t]}get rarityLevel(){if(!this._data)return-1;const t=this._data[co.RARITY];return t==null?-1:parseInt(t)}get data(){return this._data}};co.FORMAT_KEY=ha.MAP_KEY,co.STATE="state",co.RARITY="rarity";let Gl=co;const ol=class ol extends Ko{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readInt());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(A.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,ol.FORMAT_KEY),t.setValue(A.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[ol.STATE].toString()}compare(t){if(!(t instanceof ol))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){if(!this._data||!this._data.length)return-1;const e=this._data[t];return e??-1}};ol.FORMAT_KEY=ha.NUMBER_KEY,ol.STATE=0;let gu=ol;const ll=class ll extends Ko{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readString());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(A.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,ll.FORMAT_KEY),t.setValue(A.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[ll.STATE]}compare(t){if(!(t instanceof ll))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){return this._data[t]||""}setValue(t){this._data=t}};ll.FORMAT_KEY=ha.STRING_KEY,ll.STATE=0;let An=ll;const Vg=class Vg extends Ko{constructor(){super(),this._state="",this._result=0}parseWrapper(t){t&&(this._state=t.readString(),this._result=t.readInt(),super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(A.FURNITURE_DATA_FORMAT,Vg.FORMAT_KEY);const e={};e.S=this._state,e.R=this._result.toString(),t.setValue(A.FURNITURE_DATA,e)}getLegacyString(){return this._state}compare(t){return!0}setString(t){this._state=t}get result(){return this._result}};Vg.FORMAT_KEY=ha.VOTE_KEY;let Hh=Vg;class ra{static getData(t){let e=null;switch(t&255){case E_.FORMAT_KEY:e=new E_;break;case p_.FORMAT_KEY:e=new p_;break;case I_.FORMAT_KEY:e=new I_;break;case Di.FORMAT_KEY:e=new Di;break;case Gl.FORMAT_KEY:e=new Gl;break;case gu.FORMAT_KEY:e=new gu;break;case An.FORMAT_KEY:e=new An;break;case Hh.FORMAT_KEY:e=new Hh;break}return e?(e.flags=t&65280,e):null}}const uo=class uo{};uo.MINIMUM=-2,uo.ROOM=0,uo.FLOOR=10,uo.WALL=20,uo.UNIT=100,uo.CURSOR=200;let Y=uo;const Rt=class Rt{};Rt.FURNITURE_BASIC="furniture_basic",Rt.FURNITURE_MULTISTATE="furniture_multistate",Rt.FURNITURE_MULTIHEIGHT="furniture_multiheight",Rt.FURNITURE_RANDOMSTATE="furniture_randomstate",Rt.FURNITURE_PLACEHOLDER="furniture_placeholder",Rt.FURNITURE_CREDIT="furniture_credit",Rt.FURNITURE_STICKIE="furniture_stickie",Rt.FURNITURE_PRESENT="furniture_present",Rt.FURNITURE_TROPHY="furniture_trophy",Rt.FURNITURE_ECOTRON_BOX="furniture_ecotron_box",Rt.FURNITURE_DICE="furniture_dice",Rt.FURNITURE_HOCKEY_SCORE="furniture_hockey_score",Rt.FURNITURE_HABBOWHEEL="furniture_habbowheel",Rt.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door",Rt.FURNITURE_PLANET_SYSTEM="furniture_planet_system",Rt.FURNITURE_WINDOW="furniture_window",Rt.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem",Rt.FURNITURE_ROOMDIMMER="furniture_roomdimmer",Rt.FURNITURE_SOUND_MACHINE="furniture_sound_machine",Rt.FURNITURE_JUKEBOX="furniture_jukebox",Rt.FURNITURE_CRACKABLE="furniture_crackable",Rt.FURNITURE_PUSHABLE="furniture_pushable",Rt.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change",Rt.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",Rt.FURNITURE_SCORE="furniture_score",Rt.FURNITURE_ES="furniture_es",Rt.FURNITURE_FIREWORKS="furniture_fireworks",Rt.FURNITURE_SONG_DISK="furniture_song_disk",Rt.FURNITURE_BB="furniture_bb",Rt.FURNITURE_BG="furniture_bg",Rt.FURNITURE_WELCOME_GIFT="furniture_welcome_gift",Rt.FURNITURE_FLOOR_HOLE="furniture_floor_hole",Rt.FURNITURE_MANNEQUIN="furniture_mannequin",Rt.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",Rt.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal",Rt.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization",Rt.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock",Rt.FURNITURE_VOTE_COUNTER="furniture_vote_counter",Rt.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",Rt.FURNITURE_SOUNDBLOCK="furniture_soundblock",Rt.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport",Rt.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed",Rt.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing",Rt.FURNITURE_BACKGROUND_COLOR="furniture_background_color",Rt.FURNITURE_MYSTERYBOX="furniture_mysterybox",Rt.FURNITURE_EFFECTBOX="furniture_effectbox",Rt.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy",Rt.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution",Rt.FURNITURE_LOVELOCK="furniture_lovelock",Rt.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted",Rt.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock",Rt.FURNITURE_BADGE_DISPLAY="furniture_badge_display",Rt.FURNITURE_HIGH_SCORE="furniture_high_score",Rt.FURNITURE_INTERNAL_LINK="furniture_internal_link",Rt.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height",Rt.FURNITURE_YOUTUBE="furniture_youtube",Rt.FURNITURE_RENTABLE_SPACE="furniture_rentable_space",Rt.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on",Rt.FURNITURE_VIMEO="furniture_vimeo",Rt.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link",Rt.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link",Rt.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo",Rt.FURNITURE_AREA_HIDE="furniture_area_hide",Rt.ROOM="room",Rt.USER="user",Rt.BOT="bot",Rt.RENTABLE_BOT="rentable_bot",Rt.PET="pet",Rt.TILE_CURSOR="tile_cursor",Rt.SELECTION_ARROW="selection_arrow",Rt.GAME_SNOWBALL="game_snowball",Rt.GAME_SNOWSPLASH="game_snowsplash";let xt=Rt;const Ji=class Ji{};Ji.OBJECT_UNDEFINED="OBJECT_UNDEFINED",Ji.OBJECT_MOVE="OBJECT_MOVE",Ji.OBJECT_PLACE="OBJECT_PLACE",Ji.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE",Ji.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE",Ji.OBJECT_MOVE_TO="OBJECT_MOVE_TO",Ji.OBJECT_PLACE_TO="OBJECT_PLACE_TO",Ji.OBJECT_PICKUP="OBJECT_PICKUP",Ji.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT",Ji.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET",Ji.OBJECT_EJECT="OBJECT_EJECT",Ji.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";let Gt=Ji;const Oc=class Oc{};Oc.USER=1,Oc.PET=2,Oc.BOT=3,Oc.RENTABLE_BOT=4;let Pe=Oc;const Zi=class Zi{static getTypeNumber(t){return Zi.AVATAR_TYPES[t]}static getTypeString(t){for(const e in Zi.AVATAR_TYPES)if(e&&Zi.AVATAR_TYPES[e]===t)return e;return null}static getRealType(t){switch(t){case Zi.BOT:case Zi.RENTABLE_BOT:return Zi.USER;default:return t}}};Zi.USER="user",Zi.PET="pet",Zi.BOT="bot",Zi.RENTABLE_BOT="rentable_bot",Zi.MONSTER_PLANT="monsterplant",Zi.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};let Ue=Zi;const Ee=class Ee{};Ee.FURNITURE_STATIC="furniture_static",Ee.FURNITURE_ANIMATED="furniture_animated",Ee.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated",Ee.FURNITURE_POSTER="furniture_poster",Ee.FURNITURE_EXTERNAL_IMAGE="furniture_external_image",Ee.FURNITURE_HABBOWHEEL="furniture_habbowheel",Ee.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer",Ee.FURNITURE_BOTTLE="furniture_bottle",Ee.FURNITURE_PLANET_SYSTEM="furniture_planet_system",Ee.FURNITURE_QUEUE_TILE="furniture_queue_tile",Ee.FURNITURE_PARTY_BEAMER="furniture_party_beamer",Ee.FURNITURE_CUBOID="furniture_cuboid",Ee.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped",Ee.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks",Ee.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",Ee.FURNITURE_WATER_AREA="furniture_water_area",Ee.FURNITURE_SCORE_BOARD="furniture_score_board",Ee.FURNITURE_FIREWORKS="furniture_fireworks",Ee.FURNITURE_BB="furniture_bb",Ee.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb",Ee.FURNITURE_BG="furniture_bg",Ee.FURNITURE_STICKIE="furniture_stickie",Ee.FURNITURE_MANNEQUIN="furniture_mannequin",Ee.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",Ee.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge",Ee.FURNITURE_VOTE_COUNTER="furniture_vote_counter",Ee.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",Ee.FURNITURE_SOUNDBLOCK="furniture_soundblock",Ee.FURNITURE_BADGE_DISPLAY="furniture_badge_display",Ee.FURNITURE_YOUTUBE="furniture_youtube",Ee.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder",Ee.ROOM="room",Ee.USER="user",Ee.PET_ANIMATED="pet_animated",Ee.BOT="bot",Ee.RENTABLE_BOT="rentable_bot",Ee.TILE_CURSOR="tile_cursor";let mt=Ee;const Hg=class Hg{constructor(t,e,s,r=null){this._id=t,this._location=e,this._targetLocation=s,this._movementType=r}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}};Hg.MOVE="mv",Hg.SLIDE="sld";let Va=Hg;class PO{constructor(t){if(!t)throw new Error("invalid_wrapper");this._webId=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._figure=t.readString(),this._owner=t.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}var Mo=(a=>(a.FLOOR="S",a.WALL="I",a.EFFECT="E",a.BADGE="B",a.ROBOT="R",a.HABBO_CLUB="H",a.PET="P",a))(Mo||{});class LO{constructor(t){this._stuffId=t.readInt(),this._classId=t.readInt(),this._productCode=t.readString(),this._userId=t.readInt(),this._userName=t.readString(),this._rarityLevel=t.readInt(),this._hasMutation=t.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class Gu{constructor(t,e,s){this._layerId=t,this._partId=e,this._paletteId=s}get layerId(){return this._layerId}set layerId(t){this._layerId=t}get partId(){return this._partId}set partId(t){this._partId=t}get paletteId(){return this._paletteId}set paletteId(t){this._paletteId=t}}class da{constructor(t){this._typeId=this.getTypeId(t),this._paletteId=this.getPaletteId(t),this._color=this.getColor(t),this._headOnly=this.getHeadOnly(t);const e=this.getCustomData(t);this._customLayerIds=this.getCustomLayerIds(e),this._customPartIds=this.getCustomPartIds(e),this._customPaletteIds=this.getCustomPaletteIds(e),this._customParts=[];let s=0;for(;s<this._customLayerIds.length;)this._customParts.push(new Gu(this._customLayerIds[s],this._customPartIds[s],this._customPaletteIds[s])),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(t){if(this._customParts){for(const e of this._customParts)if(e.layerId===t)return e}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let t=this.typeId+" "+this.paletteId+" "+this.color.toString(16);t=t+(" "+this.customParts.length);for(const e of this.customParts)t=t+(" "+e.layerId+" "+e.partId+" "+e.paletteId);return t}getCustomData(t){let e=[];if(t){const s=t.split(" "),r=this._headOnly?1:0,n=4+r;if(s.length>n){const o=3+r,l=parseInt(s[o]);e=s.slice(n,n+l*3)}}return e}getCustomLayerIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+0])),s=s+3;return e}getCustomPartIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+1])),s=s+3;return e}getCustomPaletteIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+2])),s=s+3;return e}getTypeId(t){if(t){const e=t.split(" ");if(e.length>=1)return parseInt(e[0])}return 0}getPaletteId(t){if(t){const e=t.split(" ");if(e.length>=2)return parseInt(e[1])}return 0}getColor(t){if(t){const e=t.split(" ");if(e.length>=3)return parseInt(e[2],16)}return 16777215}getHeadOnly(t){if(t){const e=t.split(" ");if(e.length>=4)return e[3]==="head"}return!1}}class q0{constructor(t){if(!t)throw new Error("invalid_wrapper");this._chance=t.readInt(),this._breeds=[];let e=t.readInt();for(;e>0;)this._breeds.push(t.readInt()),e--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}const Wg=class Wg{};Wg.KICKED_OUT_OF_ROOM=4008,Wg.STRIP_LOCKED_FOR_TRADING=-13001;let $E=Wg;const Zu=class Zu{};Zu.OLD_IDENTITY=0,Zu.NEW_IDENTITY=1,Zu.REAL_NOOB=2;let ku=Zu;const Te=class Te{};Te.DOG=0,Te.CAT=1,Te.CROCODILE=2,Te.TERRIER=3,Te.BEAR=4,Te.PIG=5,Te.LION=6,Te.RHINO=7,Te.SPIDER=8,Te.TURTLE=9,Te.CHICKEN=10,Te.FROG=11,Te.DRAGON=12,Te.MONSTER=13,Te.MONKEY=14,Te.HORSE=15,Te.MONSTERPLANT=16,Te.BUNNY=17,Te.BUNNYEVIL=18,Te.BUNNYDEPRESSED=19,Te.BUNNYLOVE=20,Te.PIGEONGOOD=21,Te.PIGEONEVIL=22,Te.DEMONMONKEY=23,Te.BABYBEAR=24,Te.BABYTERRIER=25,Te.GNOME=26,Te.LEPRECHAUN=27,Te.KITTENBABY=28,Te.PUPPYBABY=29,Te.PIGLETNBABY=30,Te.HALOOMPA=31,Te.FOOLS=32,Te.PTEROSAUR=33,Te.VELOCIRAPTOR=34;let Ds=Te;const ho=class ho{};ho.NONE=0,ho.GUEST=1,ho.GUILD_MEMBER=2,ho.GUILD_ADMIN=3,ho.ROOM_OWNER=4,ho.MODERATOR=5;let Ce=ho;const _o=class _o{static getLocalizationKey(t){switch(t){case _o.FREE_TRADING:return"${trading.mode.free}";case _o.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case _o.NO_TRADING:return"${trading.mode.not.allowed}"}return""}};_o.NO_TRADING=0,_o.ROOM_CONTROLLER_REQUIRED=1,_o.FREE_TRADING=2;let nu=_o;const jr=class jr{};jr.SUPER_USER=9,jr.ADMINISTRATOR=8,jr.COMMUNITY=7,jr.PLAYER_SUPPORT=6,jr.MODERATOR=5,jr.EMPLOYEE=4,jr.BUS_PARTNER=3,jr.PARTNER=2,jr.CELEBRITY=1,jr.NONE=0;let kl=jr;class Q0{}const $u=class $u{};$u.MATCH_ALL_PIXELS=-1,$u.MATCH_OPAQUE_PIXELS=128,$u.MATCH_NOTHING=256;let Rn=$u;const Ac=class Ac{};Ac.DEFAULT=1,Ac.ROOM_PLANE=2,Ac.AVATAR=3,Ac.AVATAR_OWN=4;let Nr=Ac;const rn=class rn{};rn.MOUSE_CLICK="click",rn.DOUBLE_CLICK="double_click",rn.MOUSE_MOVE="mousemove",rn.MOUSE_DOWN="mousedown",rn.MOUSE_DOWN_LONG="mousedown_long",rn.MOUSE_UP="mouseup",rn.ROLL_OVER="mouseover",rn.ROLL_OUT="mouseout",rn.RIGHT_CLICK="contextmenu";let lt=rn;const cl=class cl{};cl.TOUCH_START="touchstart",cl.TOUCH_MOVE="touchmove",cl.TOUCH_CANCEL="touchcancel",cl.TOUCH_END="touchend",cl.TOUCH_LONG="touchlong";let Vi=cl;const $s=class $s{constructor(t){this._ordinal=t}get ordinal(){return this._ordinal}equals(t){return t&&t._ordinal==this._ordinal}};$s.NONE=new $s(0),$s.WAVE=new $s(1),$s.BLOW=new $s(2),$s.LAUGH=new $s(3),$s.CRY=new $s(4),$s.IDLE=new $s(5),$s.JUMP=new $s(6),$s.RESPECT=new $s(7);let Qr=$s;const nn=class nn{};nn.DUMMY="DUMMY",nn.FRIEND_FURNITURE="FRIEND_FURNITURE",nn.MONSTERPLANT_SEED="MONSTERPLANT_SEED",nn.MYSTERY_BOX="MYSTERY_BOX",nn.EFFECT_BOX="EFFECT_BOX",nn.MYSTERY_TROPHY="MYSTERY_TROPHY",nn.RANDOM_TELEPORT="RANDOM_TELEPORT",nn.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING",nn.GENERIC_USABLE="GENERIC_USABLE";let es=nn;const Pt=class Pt{};Pt.CHAT_WIDGET="RWE_CHAT_WIDGET",Pt.INFOSTAND="RWE_INFOSTAND",Pt.ME_MENU="RWE_ME_MENU",Pt.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET",Pt.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER",Pt.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET",Pt.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET",Pt.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET",Pt.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET",Pt.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET",Pt.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET",Pt.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET",Pt.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET",Pt.DOORBELL="RWE_DOORBELL",Pt.LOADINGBAR="RWE_LOADINGBAR",Pt.ROOM_QUEUE="RWE_ROOM_QUEUE",Pt.ROOM_POLL="RWE_ROOM_POLL",Pt.ROOM_VOTE="RWE_ROOM_VOTE",Pt.USER_CHOOSER="RWE_USER_CHOOSER",Pt.FURNI_CHOOSER="RWE_FURNI_CHOOSER",Pt.ROOM_DIMMER="RWE_ROOM_DIMMER",Pt.FRIEND_REQUEST="RWE_FRIEND_REQUEST",Pt.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE",Pt.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING",Pt.USER_NOTIFICATION="RWE_USER_NOTIFICATION",Pt.FRIENDS_BAR="RWE_FRIENDS_BAR",Pt.PURSE_WIDGET="RWE_PURSE_WIDGET",Pt.AVATAR_INFO="RWE_AVATAR_INFO",Pt.WELCOME_GIFT="RWE_WELCOME_GIFT",Pt.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET",Pt.EFFECTS="RWE_EFFECTS",Pt.MANNEQUIN="RWE_MANNEQUIN",Pt.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU",Pt.LOCATION_WIDGET="RWE_LOCATION_WIDGET",Pt.CAMERA="RWE_CAMERA",Pt.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA",Pt.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR",Pt.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION",Pt.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING",Pt.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM",Pt.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING",Pt.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY",Pt.INTERNAL_LINK="RWE_INTERNAL_LINK",Pt.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT",Pt.YOUTUBE="RWE_YOUTUBE",Pt.RENTABLESPACE="RWE_RENTABLESPACE",Pt.VIMEO="RWE_VIMEO",Pt.ROOM_TOOLS="RWE_ROOM_TOOLS",Pt.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE",Pt.WORD_QUIZZ="RWE_WORD_QUIZZ",Pt.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE",Pt.ROOM_LINK="RWE_ROOM_LINK",Pt.CRAFTING="RWE_CRAFTING",Pt.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";let Wh=Pt;const ya=class ya{};ya.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM",ya.JUKEBOX="RWEIEP_JUKEBOX",ya.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT",ya.SONGDISK="RWEIEP_SONGDISK",ya.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI",ya.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS",ya.USABLE="RWEIEP_USABLE";let vs=ya;const th=class th{};th.NOBODY=0,th.CONTROLLER=1,th.EVERYBODY=2;let T_=th;const eh=class eh{};eh.NORMAL=0,eh.GENERIC=1,eh.BOT=2;let yo=eh;class Is{constructor(t=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],t)for(const[e,s]of t.entries())this.add(e,s)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._length=0,this._array=[],this._keys=[]}unshift(t,e){return this._dictionary.get(t)!==null?!1:(this._dictionary.set(t,e),this._array.unshift(e),this._keys.unshift(t),this._length++,!0)}add(t,e){return this._dictionary.get(t)!==void 0?!1:(this._dictionary.set(t,e),this._array[this._length]=e,this._keys[this._length]=t,this._length++,!0)}remove(t){const e=this._dictionary.get(t);if(!e)return null;const s=this._array.indexOf(e);return s>=0&&(this._array.splice(s,1),this._keys.splice(s,1),this._length--),this._dictionary.delete(t),e}getWithIndex(t){return t<0||t>=this._length?null:this._array[t]}getKey(t){return t<0||t>=this._length?null:this._keys[t]}getKeys(){return this._keys.slice()}hasKey(t){return this._keys.indexOf(t)>-1}getValue(t){return this._dictionary.get(t)}getValues(){return this._array.slice()}hasValue(t){return this._array.indexOf(t)>-1}indexOf(t){return this._array.indexOf(t)}concatenate(t){for(const e of t._keys)this.add(e,t.getValue(e))}clone(){const t=new Is;return t.concatenate(this),t}}const J0=a=>{let t="";const e=new Uint8Array(a),s=e.byteLength;for(let r=0;r<s;r++)t+=String.fromCharCode(e[r]);return window.btoa(t)};class Fm{constructor(t){this._position=0,this._dataView=new DataView(t)}readBytes(t){const e=new Fm(this._dataView.buffer.slice(this._position,this._position+t));return this._position+=t,e}readByte(){const t=this._dataView.getInt8(this._position);return this._position++,t}readShort(){const t=this._dataView.getInt16(this._position);return this._position+=2,t}readInt(){const t=this._dataView.getInt32(this._position);return this._position+=4,t}readFloat(){const t=this._dataView.getFloat32(this._position);return this._position+=4,t}readDouble(){const t=this._dataView.getFloat64(this._position);return this._position+=8,t}remaining(){return this._dataView.byteLength-this._position}toString(t){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class UO{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(t){const e=new Uint8Array(1);return e[0]=t,this.appendArray(e),this}writeBytes(t){const e=new Uint8Array(t);return this.appendArray(e),this}writeShort(t){const e=new Uint8Array(2);return e[0]=t>>8,e[1]=t&255,this.appendArray(e),this}writeInt(t){const e=new Uint8Array(4);return e[0]=t>>24,e[1]=t>>16,e[2]=t>>8,e[3]=t&255,this.appendArray(e),this}writeString(t,e=!0){const s=new TextEncoder().encode(t);return e?(this.writeShort(s.length),this.appendArray(s)):this.appendArray(s),this}appendArray(t){if(!t)return;const e=new Uint8Array(this.position+t.length>this._buffer.length?this.position+t.length:this._buffer.length);e.set(this._buffer),e.set(t,this.position),this._buffer=e,this.position+=t.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(t){this._position=t}toString(t){return new TextDecoder(t).decode(this._buffer)}}class w{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s,this._length=NaN}static sum(t,e){return!t||!e?null:new w(t.x+e.x,t.y+e.y,t.z+e.z)}static dif(t,e){return!t||!e?null:new w(t.x-e.x,t.y-e.y,t.z-e.z)}static product(t,e){return t?new w(t.x*e,t.y*e,t.z*e):null}static dotProduct(t,e){return!t||!e?0:t.x*e.x+t.y*e.y+t.z*e.z}static crossProduct(t,e){if(!t||!e)return null;const s=new w;return s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x,s}static scalarProjection(t,e){if(!t||!e)return-1;const s=e.length;return s>0?(t.x*e.x+t.y*e.y+t.z*e.z)/s:-1}static cosAngle(t,e){if(!t||!e)return 0;const s=t.length*e.length;return s?w.dotProduct(t,e)/s:0}static isEqual(t,e){return!(!t||!e||t.x!==e.x||t.y!==e.y||t.z!==e.z)}assign(t){t&&(this._x=t.x,this._y=t.y,this._z=t.z,this._length=NaN)}add(t){t&&(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._length=NaN)}subtract(t){t&&(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._length=NaN)}multiply(t){this._x*=t,this._y*=t,this._z*=t,this._length=NaN}divide(t){t&&(this._x/=t,this._y/=t,this._z/=t,this._length=NaN)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}dotProduct(t){return this._x*t.x+this._y*t.y+this._z*t.z}crossProduct(t){const e=new w;return e.x=this._y*t.z-this._z*t.y,e.y=this._z*t.x-this._x*t.z,e.z=this._x*t.y-this._y*t.x,e}normalize(){const t=1/this.length;this._x=this._x*t,this._y=this._y*t,this._z=this._z*t}get x(){return this._x}set x(t){this._x=t,this._length=NaN}get y(){return this._y}set y(t){this._y=t,this._length=NaN}get z(){return this._z}set z(t){this._z=t,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}const Un=class Un{static hex2rgb(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e}static hex2rgba(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e[3]=t&255,e}static rgb2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)}static rgba2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)+(t[3]|0)}static rgbStringToHex(t){const e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+Un.getHex(e[1])+Un.getHex(e[2])+Un.getHex(e[3])}static getHex(t){return isNaN(t)?"00":Un.HEX_DIGITS[(t-t%16)/16]+Un.HEX_DIGITS[t%16]}static int2rgb(t){t>>>=0;const e=t&255,s=(t&65280)>>>8;return"rgba("+[(t&16711680)>>>16,s,e,1].join(",")+")"}static rgbToHSL(t){const e=(t>>16&255)/255,s=(t>>8&255)/255,r=(t&255)/255,n=Math.max(e,s,r),o=Math.min(e,s,r),l=n-o;let c=0,u=0;const h=(n+o)/2;if(l!==0){switch(u=h>.5?l/(2-n-o):l/(n+o),n){case e:c=(s-r)/l+(s<r?6:0);break;case s:c=(r-e)/l+2;break;case r:c=(e-s)/l+4;break}c*=60}const d=Math.round(c/360*255),f=Math.round(u*255),E=Math.round(h*255);return(d<<16)+(f<<8)+E}static hslToRGB(t){const e=(t>>16&255)/255,s=(t>>8&255)/255,r=(t&255)/255;let n=0,o=0,l=0;if(s>0){const d=r<.5?r*(1+s):r+s-r*s,f=2*r-d;[n,o,l]=[e+1/3,e,e-1/3].map(m=>(m<0&&(m+=1),m>1&&(m-=1),m*6<1?f+(d-f)*6*m:m*2<1?d:m*3<2?f+(d-f)*(2/3-m)*6:f))}else n=o=l=r;const c=Math.round(n*255),u=Math.round(o*255),h=Math.round(l*255);return(c<<16)+(u<<8)+h}static rgb2xyz(t){let e=(t>>16&255)/255,s=(t>>8&255)/255,r=(t>>0&255)/255;return e>.04045?e=Math.pow((e+.055)/1.055,2.4):e=e/12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s=s/12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r=r/12.92,e=e*100,s=s*100,r=r*100,new w(e*.4124+s*.3576+r*.1805,e*.2126+s*.7152+r*.0722,e*.0193+s*.1192+r*.9505)}static xyz2CieLab(t){let e=t.x/95.047,s=t.y/100,r=t.z/108.883;return e>.008856?e=Math.pow(e,1/3):e=7.787*e+16/116,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,r>.008856?r=Math.pow(r,1/3):r=7.787*r+16/116,new w(116*s-16,500*(e-s),200*(s-r))}static rgb2CieLab(t){return Un.xyz2CieLab(Un.rgb2xyz(t))}static colorize(t,e){if(e===4294967295)return t;let s=e>>16&255,r=e>>8&255,n=e&255;return s=(t>>16&255)*s/255,r=(t>>8&255)*r/255,n=(t&255)*n/255,(t&&4278190080)|s<<16|r<<8|n}};Un.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];let yr=Un;const Yg=class Yg{static isBuilderClubId(t){return t>=Yg.BUILDER_CLUB_FURNI_ID_BASE}};Yg.BUILDER_CLUB_FURNI_ID_BASE=2147418112;let R_=Yg;new a0;let h_=null;const Z0=async a=>{var t;return h_=await o0(a),(t=h_.events)==null||t.destroy(),h_},Mr=()=>h_,Gm=new $r;Gm.interactive=!1;Gm.interactiveChildren=!1;Gm.eventMode="none";const Yh=()=>Gm,zg=class zg{constructor(){this._textures={},this._totalTextures=0,this._runCount=0}getTotalTextures(){let t=0;for(const e in this._textures)for(const s in this._textures[e])t+=this._textures[e][s].length;return this._totalTextures=t,this._totalTextures}getTexture(t,e){if(this._textures[t]||(this._textures[t]={}),this._textures[t][e]||(this._textures[t][e]=[]),this._textures[t][e].length){const s=this._textures[t][e].shift();if(s)return this._totalTextures--,s}return me.createRenderTexture(t,e)}putTexture(t){t&&(this._textures[t.width]||(this._textures[t.width]={}),this._textures[t.width][t.height]||(this._textures[t.width][t.height]=[]),delete t.source.hitMap,this._textures[t.width][t.height].push(t),this._totalTextures++)}run(){if(this._runCount++,!!this._totalTextures)for(const t in this._textures)for(const e in this._textures[t]){const s=this._textures[t][e];for(let r=s.length-1;r>=0;r--){const n=s[r],o=n.source;o._touched>-1&&this._runCount-o._touched>zg.MAX_IDLE&&(delete n.source.hitMap,o.destroyed||n.destroy(!0),this._textures[n.width][n.height].splice(r,1),this._totalTextures--,Lt.log(`[TexturePool] Texture disposed: ${n.width}x${n.height}`))}}}get textures(){return this._textures}};zg.MAX_IDLE=3600;let tp=zg;const $0=new tp,la=()=>$0,Ti=()=>l0.shared,tj=()=>Ti().FPS,zt=()=>Ti().lastTime,ul=class ul{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",t=>{if(typeof t.data=="string"&&t.data.startsWith(ul.MESSAGE_KEY)){const{method:e,params:s}=JSON.parse(t.data.substr(ul.MESSAGE_KEY.length)),r=window[e];if(!r)return;r(...s);return}})),!0}static call(t,...e){if(window.top!==window&&window.top.postMessage(ul.MESSAGE_KEY+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalInterface"in window))return;const s=window.FlashExternalInterface[t];return typeof s<"u"?s(...e):void 0}static callGame(t,...e){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalGameInterface"in window))return;const s=window.FlashExternalGameInterface[t];return typeof s<"u"?s(...e):void 0}static addCallback(t,e){window[t]=e}};ul.MESSAGE_KEY="Nitro_LegacyExternalInterface",ul._isListeningForPostMessages=!1;let re=ul;const hl=class hl{static log(...t){this.LOG_DEBUG&&console.log(this.logPrefix(),...t)}static warn(...t){this.LOG_WARN&&console.warn(this.logPrefix(),...t)}static error(...t){this.LOG_ERROR&&console.error(this.logPrefix(),...t)}static events(...t){this.LOG_EVENTS&&console.log(this.logPrefix(),...t)}static packets(...t){this.LOG_PACKETS&&console.log(this.logPrefix(),...t)}static logPrefix(){return"[Nitro]"}};hl.LOG_DEBUG=!1,hl.LOG_WARN=!1,hl.LOG_ERROR=!1,hl.LOG_EVENTS=!1,hl.LOG_PACKETS=!1;let Lt=hl;const Nc=class Nc{static logEventLog(t){try{re.available&&re.call("logEventLog",t)}catch{Lt.log("External interface not working, failed to log event log.")}}static openPage(t){try{re.available&&re.call("openPage",t)}catch{Lt.log("Failed to open web page",t)}}static openWebPage(t){window.open(t)}static sendHeartBeat(){try{re.available&&re.call("heartBeat")}catch{Lt.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(t){try{re.available&&Nc.openPage(t)}catch{Lt.log("Failed to open web page",t)}}static closeWebPageAndRestoreClient(){try{re.available&&re.call("closeWebPageAndRestoreClient")}catch{Lt.log("Failed to close web page and restore client!")}}static openHabblet(t,e=null){try{re.available&&re.call("openHabblet",t,e)}catch{Lt.log("Failed to open Habblet",t)}}static closeHabblet(t,e=null){try{re.available&&re.call("closeHabblet",t,e)}catch{Lt.log("Failed to close Habblet",t)}}static send(t,e){try{re.available&&re.call("disconnect",t,e)}catch{Lt.log("Failed to close send ")}}static showGame(t){try{re.available&&re.callGame("showGame",t)}catch(e){Lt.log("Failed to open game",e)}}static hideGame(){try{re.available&&re.callGame("hideGame")}catch{Lt.log("Failed to hide game")}}static open(t){try{re.available&&re.call("openExternalLink",escape(t))}catch{Lt.log("External interface not working. Could not request to open: "+t)}}static roomVisited(t){try{re.available&&re.call("roomVisited",t)}catch{Lt.log("External interface not working. Could not store last room visit.")}}static openMinimail(t){try{re.available&&re.call("openMinimail",t)}catch{Lt.log("External interface not working. Could not open minimail.")}}static openNews(){try{re.available&&re.call("openNews")}catch{Lt.log("External interface not working. Could not open news.")}}static closeNews(){try{re.available&&re.call("closeNews")}catch{Lt.log("External interface not working. Could not close news.")}}static openAvatars(){try{re.available&&re.call("openAvatars")}catch{Lt.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{re.available&&re.call("openRoomEnterAd")}catch{Lt.log("External interface not working. Could not open roomenterad.")}}static updateFigure(t){try{re.available&&re.call("updateFigure",t)}catch{Lt.log("External interface not working. Could not update figure.")}}};Nc.ADVERTISEMENT="advertisement",Nc.OPENLINK="openlink",Nc.OPENROOM="openroom";let Nn=Nc;const ej=a=>a>>>0,FN=a=>{const t=ej(a);return t>=Math.pow(2,31)?t-Math.pow(2,32):t},zh=[],As=a=>{zh.indexOf(a)>=0||zh.push(a)},Ns=a=>{const t=zh.indexOf(a);t!==-1&&zh.splice(t,1)},ht=a=>{if(!(!a||a===""))for(const t of zh){if(!t)continue;const e=t.eventUrlPrefix;e.length>0?a.substr(0,e.length)===e&&t.linkReceived(a):t.linkReceived(a)}},mr=class mr{constructor(t=0,e=0,s=0,r=0,n=0,o=0,l=0,c=0,u=0){this._data=[t,e,s,r,n,o,l,c,u]}static getXRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),r=Math.sin(e);return new mr(1,0,0,0,s,-r,0,r,s)}static getYRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),r=Math.sin(e);return new mr(s,0,r,0,1,0,-r,0,s)}static getZRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),r=Math.sin(e);return new mr(s,-r,0,r,s,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(t){const e=t.x*this._data[0]+t.y*this._data[3]+t.z*this._data[6],s=t.x*this._data[1]+t.y*this._data[4]+t.z*this._data[7],r=t.x*this._data[2]+t.y*this._data[5]+t.z*this._data[8];return new w(e,s,r)}multiply(t){const e=this._data[0]*t.data[0]+this._data[1]*t.data[3]+this._data[2]*t.data[6],s=this._data[0]*t.data[1]+this._data[1]*t.data[4]+this._data[2]*t.data[7],r=this._data[0]*t.data[2]+this._data[1]*t.data[5]+this._data[2]*t.data[8],n=this._data[3]*t.data[0]+this._data[4]*t.data[3]+this._data[5]*t.data[6],o=this._data[3]*t.data[1]+this._data[4]*t.data[4]+this._data[5]*t.data[7],l=this._data[3]*t.data[2]+this._data[4]*t.data[5]+this._data[5]*t.data[8],c=this._data[6]*t.data[0]+this._data[7]*t.data[3]+this._data[8]*t.data[6],u=this._data[6]*t.data[1]+this._data[7]*t.data[4]+this._data[8]*t.data[7],h=this._data[6]*t.data[2]+this._data[7]*t.data[5]+this._data[8]*t.data[8];return new mr(e,s,r,n,o,l,c,u,h)}scalarMultiply(t){let e=0;for(;e<this._data.length;)this._data[e]=this._data[e]*t,e++}rotateX(t){const e=t*Math.PI/180,s=Math.cos(e),r=Math.sin(e);return new mr(1,0,0,0,s,-r,0,r,s).multiply(this)}rotateY(t){const e=t*Math.PI/180,s=Math.cos(e),r=Math.sin(e);return new mr(s,0,r,0,1,0,-r,0,s).multiply(this)}rotateZ(t){const e=t*Math.PI/180,s=Math.cos(e),r=Math.sin(e);return new mr(s,-r,0,r,s,0,0,0,1).multiply(this)}skew(){}transpose(){return new mr(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(t){return!1}get data(){return this._data}};mr.IDENTITY=new mr(1,0,0,0,1,0,0,0,1),mr.TOLERANS=1e-18;let Bu=mr;const sh=class sh{constructor(){this._jsonFile=null,this._texture=null}static async from(t){const e=new sh;return await e.parse(t),e}async parse(t){const e=new Fm(t);let s=e.readShort();for(;s>0;){const r=e.readShort(),n=e.readBytes(r).toString(),o=e.readInt(),l=e.readBytes(o),c=c0(l.toArrayBuffer());n.endsWith(".json")?this._jsonFile=JSON.parse(sh.TEXT_DECODER.decode(c)):this._texture=await MN.load(`data:image/png;base64,${J0(c)}`),s--}}get jsonFile(){return this._jsonFile}get texture(){return this._texture}};sh.TEXT_DECODER=new TextDecoder("utf-8");let ep=sh;const go=class go{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const t=[`
 %c %c %c Nitro ${go.UI_VERSION} - Renderer ${go.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...t)}else self.console&&self.console.log(`Nitro ${go.UI_VERSION} - Renderer ${go.RENDERER_VERSION} `)}};go.RENDERER_VERSION="2.0.0",go.UI_VERSION="";let fu=go;class GN{constructor(t,e,s){this._location=null,this._transformedLocation=new w,this._needsTransformation=!1,this._location=new w(t,e,s),(t!==0||e!==0||s!==0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(t){this._needsTransformation&&(this._transformedLocation=t.vectorMultiplication(this._location))}}class jO{constructor(t){t<0&&(t=0),this._reservedNumbers=[],this._freeNumbers=[];let e=0;for(;e<t;)this._freeNumbers.push(e),e++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const t=this._freeNumbers.pop();return this._reservedNumbers.push(t),t}return-1}freeNumber(t){const e=this._reservedNumbers.indexOf(t);e>=0&&(this._reservedNumbers.splice(e,1),this._freeNumbers.push(t))}}const ih=class ih{static makeRoomPreviewerId(t){return(t&65535)+ih.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(t){return t>=ih.PREVIEW_ROOM_ID_BASE}};ih.PREVIEW_ROOM_ID_BASE=2147418112;let pn=ih;class me{static generateTexture(t){return this.getRenderer().textureGenerator.generateTexture(t)}static generateTextureFromImage(t){return Es.from(t)}static async generateImage(t){return this.getExtractor().image(t)}static async generateImageUrl(t){return this.getExtractor().base64(t)}static generateCanvas(t){return this.getExtractor().canvas(t)}static clearRenderTexture(t){return this.writeToTexture(new Ve(Es.EMPTY),t)}static createRenderTexture(t,e){return t<0||e<0?null:u0.create({width:t,height:e})}static createAndFillRenderTexture(t,e,s=16777215){return t<0||e<0?null:this.clearAndFillRenderTexture(this.createRenderTexture(t,e),s)}static createAndWriteRenderTexture(t,e,s,r=null){return t<0||e<0?null:this.writeToTexture(s,this.createRenderTexture(t,e),!0,r)}static clearAndFillRenderTexture(t,e=16777215){if(!t)return null;const s=new Ve(Es.WHITE);return s.tint=e,s.width=t.width,s.height=t.height,this.writeToTexture(s,t)}static writeToTexture(t,e,s=!0,r=null){return!t||!e?null:(this.getRenderer().render({container:t,target:e,clear:s,transform:r}),e)}static flipTextureHorizontal(t){if(!t)return null;const e=new _r;return e.scale(-1,1),e.translate(t.width,0),this.createAndWriteRenderTexture(t.width,t.height,new Ve(t),e)}static flipTextureVertical(t){if(!t)return null;const e=new _r;return e.scale(1,-1),e.translate(0,t.height),this.createAndWriteRenderTexture(t.width,t.height,new Ve(t),e)}static flipTextureHorizontalAndVertical(t){if(!t)return null;const e=new _r;return e.scale(-1,-1),e.translate(t.width,t.height),this.createAndWriteRenderTexture(t.width,t.height,new Ve(t),e)}static getPixels(t){return this.getExtractor().pixels(t)}static getRenderer(){return Mr()}static getExtractor(){return this.getRenderer().extract}}const $i=class $i extends nR{constructor(t){t={...$i.DEFAULT_OPTIONS,...t};const e=aR.from({vertex:`in vec2 aPosition;
            out vec2 vTextureCoord;
            
            uniform vec4 uInputSize;
            uniform vec4 uOutputFrame;
            uniform vec4 uOutputTexture;
            
            vec4 filterVertexPosition( void )
            {
                vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
                
                position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
                position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;
            
                return vec4(position, 0.0, 1.0);
            }
            
            vec2 filterTextureCoord( void )
            {
                return aPosition * (uOutputFrame.zw * uInputSize.zw);
            }
            
            void main(void)
            {
                gl_Position = filterVertexPosition();
                vTextureCoord = filterTextureCoord();
            }`,fragment:`
            in vec2 vTextureCoord;
            out vec4 finalColor;

            uniform sampler2D uTexture;
            uniform sampler2D uLutTexture;
            uniform int channel;

            void main(void) {
                vec4 currentColor = texture(uTexture, vTextureCoord);
                vec4 adjusted = currentColor;

                if(currentColor.a > 0.0)
                {
                    if(channel == 0)
                    {
                        adjusted = texture2D(uLutTexture, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
                    } else if(channel == 1) {
                        adjusted = texture2D(uLutTexture, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
                    } else if(channel == 2) {
                        adjusted = texture2D(uLutTexture, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
                    } else if(channel == 3) {
                        adjusted = texture2D(uLutTexture, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
                    }
                }

                finalColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
            }
            `,name:"palette-map-filter"}),s=$i.getLookUpTable(t.palette),r=new Es({source:new h0({resource:Uint8Array.from(s),width:s.length/4,height:1})});(async()=>console.log(await me.generateImageUrl(r)))(),super({gpuProgram:null,glProgram:e,resources:{paletteMapUniforms:{uChannel:{value:t.channel,type:"int"}},uLutTexture:r.source}}),this.uniforms=this.resources.paletteMapUniforms.uniforms,Object.assign(this,t)}apply(t,e,s,r){t.applyFilter(this,e,s,r)}static getLookUpTable(t){const e=[];for(let s=0;s<t.length;s++)e[s*4+$i.CHANNEL_RED]=t[s]>>16&255,e[s*4+$i.CHANNEL_GREEN]=t[s]>>8&255,e[s*4+$i.CHANNEL_BLUE]=t[s]&255,e[s*4+$i.CHANNEL_ALPHA]=t[s]>>24&255;return e}};$i.CHANNEL_RED=0,$i.CHANNEL_GREEN=1,$i.CHANNEL_BLUE=2,$i.CHANNEL_ALPHA=3,$i.DEFAULT_OPTIONS={palette:[],channel:$i.CHANNEL_RED};let S_=$i;const Kg=class Kg extends nR{constructor(t){t={...Kg.DEFAULT_OPTIONS,...t};const e=aR.from({vertex:`in vec2 aPosition;
            out vec2 vTextureCoord;
            
            uniform vec4 uInputSize;
            uniform vec4 uOutputFrame;
            uniform vec4 uOutputTexture;
            
            vec4 filterVertexPosition( void )
            {
                vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
                
                position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
                position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;
            
                return vec4(position, 0.0, 1.0);
            }
            
            vec2 filterTextureCoord( void )
            {
                return aPosition * (uOutputFrame.zw * uInputSize.zw);
            }
            
            void main(void)
            {
                gl_Position = filterVertexPosition();
                vTextureCoord = filterTextureCoord();
            }`,fragment:`
            in vec2 vTextureCoord;
            out vec4 finalColor;

            uniform sampler2D uTexture;

            void main(void) {
                vec4 c = texture(uTexture, vTextureCoord);

                if(c.r == 0.0 && c.g == 0.0 && c.b == 0.0) {
                    finalColor = vec4(0.0, 0.0, 0.0, 0.0);
                } else {
                    finalColor = c;
                }
            }
            `,name:"plane-mask-filter"});super({gpuProgram:null,glProgram:e,resources:{planeMaskUniforms:{}}}),this.uniforms=this.resources.planeMaskUniforms.uniforms,Object.assign(this,t)}apply(t,e,s,r){t.applyFilter(this,e,s,r)}};Kg.DEFAULT_OPTIONS={};let sp=Kg;const Xg=class Xg extends nR{constructor(t){t={...Xg.DEFAULT_OPTIONS,...t};const e=aR.from({vertex:`in vec2 aPosition;
            out vec2 vTextureCoord;
            
            uniform vec4 uInputSize;
            uniform vec4 uOutputFrame;
            uniform vec4 uOutputTexture;
            
            vec4 filterVertexPosition( void )
            {
                vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
                
                position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
                position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;
            
                return vec4(position, 0.0, 1.0);
            }
            
            vec2 filterTextureCoord( void )
            {
                return aPosition * (uOutputFrame.zw * uInputSize.zw);
            }
            
            void main(void)
            {
                gl_Position = filterVertexPosition();
                vTextureCoord = filterTextureCoord();
            }`,fragment:`
            in vec2 vTextureCoord;
            out vec4 finalColor;

            uniform sampler2D uTexture;
            uniform vec3 uLineColor;
            uniform vec3 uColor;

            void main(void) {
                vec4 currentColor = texture(uTexture, vTextureCoord);
                vec3 colorLine = uLineColor * currentColor.a;
                vec3 colorOverlay = uColor * currentColor.a;

                if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {
                    finalColor = vec4(colorLine.r, colorLine.g, colorLine.b, currentColor.a);
                } else if(currentColor.a > 0.0) {
                    finalColor = vec4(colorOverlay.r, colorOverlay.g, colorOverlay.b, currentColor.a);
                }
            }
            `,name:"wired-filter"});super({gpuProgram:null,glProgram:e,resources:{planeMaskUniforms:{uLineColor:{value:new Float32Array(3),type:"vec3<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"}}}}),this.uniforms=this.resources.planeMaskUniforms.uniforms,this._lineColor=new bO,this.lineColor=t.lineColor??0,this._color=new bO,this.color=t.color??0,Object.assign(this,t)}apply(t,e,s,r){t.applyFilter(this,e,s,r)}get lineColor(){return this._lineColor.value}set lineColor(t){this._lineColor.setValue(t);const[e,s,r]=this._lineColor.toArray();this.uniforms.uLineColor[0]=e,this.uniforms.uLineColor[1]=s,this.uniforms.uLineColor[2]=r}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,s,r]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=s,this.uniforms.uColor[2]=r}};Xg.DEFAULT_OPTIONS={lineColor:0,color:0};let ip=Xg;class km{constructor(t){this._complete=!0,this._target=t}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(t){this._target=t}get target(){return this._target}set tag(t){this._tag=t}get tag(){return this._tag}start(){this._running=!0}update(t){}stop(){this._target=null,this._running=!1}tick(t){}}class sj extends km{constructor(t){super(t)}tick(t){super.tick(t),this.target&&(this.target.remove(),this.target=null)}}class mR extends km{constructor(t,e){super(t),this._complete=!1,this._duration=e}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=zt()}tick(t){super.tick(t);const e=(t-this._startTimeMs)/this._duration;e<1?this.update(e):(this.update(1),this._complete=!0)}}class ij extends mR{constructor(t,e,s){super(t,e),this._height=s}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(t){super.update(t),this.target.style.top=this._offset-this._height+this.getBounceOffset(t)*this._height+"px"}getBounceOffset(t){return t<.364?7.5625*t*t:t<.727?(t=t-.545,7.5625*t*t+.75):t<.909?(t=t-.9091,7.5625*t*t+.9375):(t=t-.955,7.5625*t*t+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class rj extends mR{constructor(t){super(t.target,t.duration),this._interval=t}start(){super.start(),this._interval.start()}update(t){super.update(t),this._interval.update(t)}stop(){super.stop(),this._interval.stop()}}class nj extends rj{constructor(t,e){super(t),this._rate=e}}class aj extends nj{constructor(t,e){super(t,e)}update(t){this._interval.update(Math.pow(t,1/this._rate))}}class oj extends mR{constructor(t,e,s,r,n,o){super(t,e),this._deltaX=s,this._deltaY=r,this._height=-n,this._numJumps=o}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(t){super.update(t),this.target.style.left=this._startX+this._deltaX*t+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(t*Math.PI*this._numJumps))+this._deltaY*t+"px"}}const Ht=class Ht{static get TIMER_TIME(){return 1e3/tj()}static runMotion(t){return Ht._RUNNING_MOTIONS.indexOf(t)===-1&&Ht._QUEUED_MOTIONS.indexOf(t)===-1&&(Ht._IS_UPDATING?Ht._QUEUED_MOTIONS.push(t):(Ht._RUNNING_MOTIONS.push(t),t.start()),Ht.startTimer()),t}static removeMotion(t){let e=Ht._RUNNING_MOTIONS.indexOf(t);e>-1?Ht._IS_UPDATING?(e=Ht._REMOVED_MOTIONS.indexOf(t),e==-1&&Ht._REMOVED_MOTIONS.push(t)):(Ht._RUNNING_MOTIONS.splice(e,1),t.running&&t.stop(),Ht._RUNNING_MOTIONS.length||Ht.stopTimer()):(e=Ht._QUEUED_MOTIONS.indexOf(t),e>-1&&Ht._QUEUED_MOTIONS.splice(e,1))}static getMotionByTag(t){for(const e of Ht._RUNNING_MOTIONS)if(e.tag==t)return e;for(const e of Ht._QUEUED_MOTIONS)if(e.tag==t)return e;return null}static getMotionByTarget(t){for(const e of Ht._RUNNING_MOTIONS)if(e.target==t)return e;for(const e of Ht._QUEUED_MOTIONS)if(e.target==t)return e;return null}static getMotionByTagAndTarget(t,e){for(const s of Ht._RUNNING_MOTIONS)if(s.tag==t&&s.target==e)return s;for(const s of Ht._QUEUED_MOTIONS)if(s.tag==t&&s.target==e)return s;return null}static get isRunning(){return!!Ht._TIMER}static get isUpdating(){return Ht._IS_UPDATING}static onTick(){Ht._IS_UPDATING=!0;const t=zt();let e=null;for(;e=Ht._QUEUED_MOTIONS.pop();)Ht._RUNNING_MOTIONS.push(e);for(;e=Ht._REMOVED_MOTIONS.pop();)Ht._RUNNING_MOTIONS.splice(Ht._RUNNING_MOTIONS.indexOf(e),1),e.running&&e.stop();for(e of Ht._RUNNING_MOTIONS)e.running?(e.tick(t),e.complete&&Ht.removeMotion(e)):Ht.removeMotion(e);Ht._RUNNING_MOTIONS.length||Ht.stopTimer(),Ht._IS_UPDATING=!1}static startTimer(){Ht._TIMER||(Ht._TIMER=setInterval(()=>Ht.onTick(),Ht.TIMER_TIME))}static stopTimer(){Ht._TIMER&&(clearInterval(Ht._TIMER),Ht._TIMER=null)}getNumRunningMotions(t){let e=0;for(const s of Ht._RUNNING_MOTIONS)s.target===t&&e++;return e}};Ht._QUEUED_MOTIONS=[],Ht._RUNNING_MOTIONS=[],Ht._REMOVED_MOTIONS=[],Ht._TIMER=null,Ht._IS_UPDATING=!1;let Vu=Ht;class wO extends km{constructor(...t){super(t?t[0].target:null),this._queue=[];for(const e of t)this._queue.push(e);this._motion=t[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(t){super.update(t),this._motion.running&&this._motion.update(t)}stop(){super.stop(),this._motion.stop()}tick(t){if(super.tick(t),this._motion.tick(t),this._motion.complete){this._motion.stop();const e=this._queue.indexOf(this._motion);e<this._queue.length-1?(this._motion=this._queue[e+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class lj extends km{constructor(t){super(null),this._waitTimeMs=t}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=zt()}tick(t){super.tick(t),this._complete=t-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}const dl=class dl{static createAsset(t,e,s,r,n,o=!1,l=!1,c=!1){const u=dl.GRAPHIC_POOL.length?dl.GRAPHIC_POOL.pop():new dl;return u._name=t,u._source=e||null,s?(u._texture=s,u._initialized=!1):(u._texture=null,u._initialized=!0),u._usesPalette=c,u._x=r,u._y=n,u._flipH=o,u._flipV=l,u._rectangle=null,u}recycle(){this._texture=null,dl.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new zo(0,0,this.width,this.height)),this._rectangle}};dl.GRAPHIC_POOL=[];let rp=dl;class cj{constructor(t,e,s){for(this._palette=t;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=e,this._secondaryColor=s}applyPalette(t){const e=Mr().texture.generateCanvas(t),s=e.getContext("2d"),r=s.getImageData(0,0,e.width,e.height);for(let o=0;o<r.data.length;o+=4){let l=this._palette[r.data[o+1]];l===void 0&&(l=[0,0,0]),r.data[o]=l[0],r.data[o+1]=l[1],r.data[o+2]=l[2]}s.putImageData(r,0,0);const n=Es.from(e);return n.source.hitMap=r.data,n}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}const rh=class rh{constructor(t,e){if(!t)throw new Error("invalid_collection");this._name=t.name,this._textureSource=e&&e.textureSource||null,this._data=t,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],e&&this.addLibraryAsset(e.textures),this.define(t)}static removeFileExtension(t){return t.substring(0,t.lastIndexOf("."))||t}dispose(){if(this._palettes&&this._palettes.clear(),this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const t of this._assets.values())t.recycle();this._assets.clear()}}addReference(){this._referenceCount++}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this.disposePaletteAssets(!1))}define(t){const e=t.assets,s=t.palettes;e&&this.defineAssets(e),s&&this.definePalettes(s)}defineAssets(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const r=-s.x||0,n=-s.y||0;let o=!1;const l=!1,c=s.usesPalette||!1;let u=s.source||"";s.flipH&&u.length&&(o=!0),u.length||(u=e);const h=this.getLibraryAsset(u);if(!h)continue;let d=this.createAsset(e,u,h,o,l,r,n,c);if(!d){const f=this.getAsset(e);f&&f.name!==f.source&&(d=this.replaceAsset(e,u,h,o,l,r,n,c))}}}definePalettes(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const r=s.id.toString();if(this._palettes.get(r))continue;let n=16777215,o=16777215,l=s.color1;l&&l.length>0&&(n=parseInt(l,16)),l=s.color2,l&&l.length>0&&(o=parseInt(l,16)),this._palettes.set(r,new cj(s.rgb,n,o))}}createAsset(t,e,s,r,n,o,l,c){if(this._assets.get(t))return!1;const u=rp.createAsset(t,e,s,o,l,r,n,c);return this._assets.set(t,u),!0}replaceAsset(t,e,s,r,n,o,l,c){const u=this._assets.get(t);return u&&(this._assets.delete(t),u.recycle()),this.createAsset(t,e,s,r,n,o,l,c)}getAsset(t){if(!t)return null;const e=this._assets.get(t);return e||null}getAssetWithPalette(t,e){const s=t+"@"+e;let r=this.getAsset(s);if(!r){if(r=this.getAsset(t),!r||!r.usesPalette)return r;const n=this.getPalette(e);if(n){const o=n.applyPalette(r.texture);o&&(this._paletteAssetNames.push(s),this.createAsset(s,r.source+"@"+e,o,r.flipH,r.flipV,r.x,r.y,!1),r=this.getAsset(s))}}return r}getTexture(t){return this._textures.get(t)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(t){const e=this.getPalette(t);return e?[e.primaryColor,e.secondaryColor]:null}getPalette(t){return t?this._palettes.get(t):null}addAsset(t,e,s,r=0,n=0,o=!1,l=!1){if(!t||!e)return!1;const c=this.getLibraryAsset(t);return c?s?(c.source=e.source,c.frame=e.frame,c.trim=e.trim,c.updateUvs(),!0):!1:(this._textures.set(t,e),this.createAsset(t,t,e,o,l,r,n,!1))}disposeAsset(t){const e=this._assets.get(t);if(!e)return;this._assets.delete(t);const s=this.getLibraryAsset(e.source);s&&(this._textures.delete(e.source),s.destroy(!0)),e.recycle()}getLibraryAsset(t){if(!t)return null;t=this._name+"_"+t;const e=this._textures.get(t);return e||null}addLibraryAsset(t){if(t)for(const e in t){const s=t[e];s&&this._textures.set(rh.removeFileExtension(e),s)}}disposePaletteAssets(t=!0){if(this._paletteAssetNames&&(t||this._paletteAssetNames.length>rh.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const e of this._paletteAssetNames)this.disposeAsset(e);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get name(){return this._name}get textureSource(){return this._textureSource}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}};rh.PALETTE_ASSET_DISPOSE_THRESHOLD=10;let np=rh;class uj{constructor(){this._textures=new Map,this._collections=new Map}getTexture(t){return t?this._textures.get(t):null}setTexture(t,e){!t||!e||(e.label=t,this._textures.set(t,e))}getAsset(t){if(!t)return null;for(const e of this._collections.values()){if(!e)continue;const s=e.getAsset(t);if(s)return s}return Lt.warn(`AssetManager: Asset not found: ${t}`),null}addAssetToCollection(t,e,s,r=!0){const n=this.getCollection(t);return n?n.addAsset(e,s,r,0,0,!1,!1):!1}getCollection(t){return t?this._collections.get(t):null}createCollection(t,e){if(!t)return null;const s=new np(t,e);for(const[r,n]of s.textures.entries())this.setTexture(r,n);return this._collections.set(s.name,s),s}async downloadAssets(t){if(!t||!t.length)return Promise.resolve(!0);try{return await Promise.all(t.map(e=>this.downloadAsset(e))),!0}catch(e){Lt.error(e)}return!1}async downloadAsset(t){try{if(!t||!t.length)return!1;if(t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")||t.endsWith(".gif")){const n=await MN.load(t);return this.setTexture(t,n),!0}const e=await fetch(t);if(e.status!==200||!e.headers.has("Content-Type")||e.headers.get("Content-Type")!=="application/octet-stream")return!1;const s=await e.arrayBuffer(),r=await ep.from(s);return await this.processAsset(r.texture,r.jsonFile),!0}catch(e){return Lt.error(e),!1}}async processAsset(t,e){let s=null;t&&(e!=null&&e.spritesheet)&&Object.keys(e.spritesheet).length&&(s=new d0(t,e.spritesheet),await s.parse(),s.textureSource.label=e.name??null),this.createCollection(e,s)}get collections(){return this._collections}}const hj=new uj,ae=()=>hj;class kN{constructor(){this._listeners=new Map}dispose(){this.removeAllListeners()}addEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!s){this._listeners.set(t,[e]);return}Lt.events("Added Event Listener",t),s.push(e)}removeEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!(!s||!s.length)){for(const[r,n]of s.entries())if(!(!n||n!==e)){s.splice(r,1),s.length||this._listeners.delete(t);return}}}dispatchEvent(t){return t?(Lt.events("Dispatched Event",t.type),this.processEvent(t),!0):!1}processEvent(t){const e=this._listeners.get(t.type);if(!e||!e.length)return;const s=[];for(const r of e)r&&s.push(r);for(;s.length;){const r=s.shift();try{r(t)}catch(n){Lt.error(n.stack);return}}}removeAllListeners(){this._listeners.clear()}}const dj=new kN,X=()=>dj,Ui=class Ui{};Ui.CONFIG_LOADED="CONFIG_LOADED",Ui.CONFIG_FAILED="CONFIG_FAILED",Ui.LOCALIZATION_LOADED="LOCALIZATION_LOADED",Ui.LOCALIZATION_FAILED="LOCALIZATION_FAILED",Ui.SOCKET_OPENED="SOCKET_OPENED",Ui.SOCKET_CLOSED="SOCKET_CLOSED",Ui.SOCKET_ERROR="SOCKET_ERROR",Ui.SOCKET_CONNECTED="SOCKET_CONNECTED",Ui.AVATAR_ASSET_DOWNLOADED="AVATAR_ASSET_DOWNLOADED",Ui.AVATAR_ASSET_LOADED="AVATAR_ASSET_LOADED",Ui.AVATAR_EFFECT_DOWNLOADED="AVATAR_EFFECT_DOWNLOADED",Ui.AVATAR_EFFECT_LOADED="AVATAR_EFFECT_LOADED",Ui.FURNITURE_DATA_LOADED="FURNITURE_DATA_LOADED";let vi=Ui;class se{constructor(t){this._type=t}get type(){return this._type}}const qg=class qg extends se{constructor(t){super(t)}};qg.LOADED="NCE_LOADED",qg.FAILED="NCE_FAILED";let FO=qg;class D{constructor(t,e){this._callBack=t,this._parserClass=e,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(t){this._parser=t}get connection(){return this._connection}set connection(t){this._connection=t}}const Cc=class Cc extends se{constructor(t,e,s){super(t),this._connection=e,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}};Cc.CONNECTION_OPENED="SCE_OPEN",Cc.CONNECTION_CLOSED="SCE_CLOSED",Cc.CONNECTION_ERROR="SCE_ERROR",Cc.CONNECTION_MESSAGE="SCE_MESSAGE";let GO=Cc;const nh=class nh extends se{constructor(){super(nh.SETTINGS_UPDATED)}clone(){const t=new nh;return t._volumeSystem=this._volumeSystem,t._volumeFurni=this._volumeFurni,t._volumeTrax=this._volumeTrax,t._oldChat=this._oldChat,t._roomInvites=this._roomInvites,t._cameraFollow=this._cameraFollow,t._flags=this._flags,t._chatType=this._chatType,t}get volumeSystem(){return this._volumeSystem}set volumeSystem(t){this._volumeSystem=t}get volumeFurni(){return this._volumeFurni}set volumeFurni(t){this._volumeFurni=t}get volumeTrax(){return this._volumeTrax}set volumeTrax(t){this._volumeTrax=t}get oldChat(){return this._oldChat}set oldChat(t){this._oldChat=t}get roomInvites(){return this._roomInvites}set roomInvites(t){this._roomInvites=t}get cameraFollow(){return this._cameraFollow}set cameraFollow(t){this._cameraFollow=t}get flags(){return this._flags}set flags(t){this._flags=t}get chatType(){return this._chatType}set chatType(t){this._chatType=t}};nh.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";let mu=nh;const ZS=class ZS extends se{constructor(t,e){super(t),this._sampleCode=e}get sampleCode(){return this._sampleCode}};ZS.PLAY_SOUND="NSOE_PLAY_SOUND";let Eu=ZS;const Qg=class Qg extends se{constructor(t){super(t)}get iconId(){return this._iconId}set iconId(t){this._iconId=t}get iconName(){return this._iconName}set iconName(t){this._iconName=t}};Qg.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK",Qg.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";let ap=Qg;const Jg=class Jg extends ap{constructor(t,e,s){super(Jg.ANIMATE_ICON),this._image=t,this._x=e,this._y=s}get image(){return this._image}get x(){return this._x}get y(){return this._y}};Jg.ANIMATE_ICON="NTAIE_ANIMATE_ICON";let Kh=Jg;const $S=class $S extends se{constructor(t,e){super(t),this._library=e}get library(){return this._library}};$S.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";let op=$S;const tO=class tO extends se{constructor(t,e){super(t),this._library=e}get library(){return this._library}};tO.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";let lp=tO;const eO=class eO extends se{constructor(t){super(t)}};eO.INITIALIZED="RCWM_INITIALIZED";let Xh=eO;const Ma=class Ma extends se{constructor(t,e){super(t),this._connection=e}get connection(){return this._connection}};Ma.CONNECTION_ESTABLISHED="NCE_ESTABLISHED",Ma.CONNECTION_CLOSED="NCE_CLOSED",Ma.CONNECTION_ERROR="NCE_ERROR",Ma.CONNECTION_HANDSHAKING="NCE_HANDSHAKING",Ma.CONNECTION_HANDSHAKED="NCE_HANDSHAKED",Ma.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED",Ma.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";let kO=Ma;const ba=class ba extends se{constructor(t,e){super(t),this._roomId=e}get roomId(){return this._roomId}};ba.INITIALIZED="REE_INITIALIZED",ba.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED",ba.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED",ba.NORMAL_MODE="REE_NORMAL_MODE",ba.GAME_MODE="REE_GAME_MODE",ba.ROOM_ZOOMED="REE_ROOM_ZOOMED",ba.DISPOSED="REE_DISPOSED";let Ne=ba;const Zg=class Zg extends Ne{constructor(t,e,s,r){super(Zg.ROOM_COLOR,t),this._color=e,this._brightness=s,this._bgOnly=r}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}};Zg.ROOM_COLOR="REE_ROOM_COLOR";let O_=Zg;const ah=class ah extends se{constructor(t,e){super(t),this._contentType=e}get contentType(){return this._contentType}};ah.RCLE_SUCCESS="RCLE_SUCCESS",ah.RCLE_FAILURE="RCLE_FAILURE",ah.RCLE_CANCEL="RCLE_CANCEL";let Ya=ah;const $g=class $g extends Ne{constructor(t,e,s){super($g.ROOM_DRAG,t),this._offsetX=e,this._offsetY=s}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}};$g.ROOM_DRAG="RDE_ROOM_DRAG";let A_=$g;const ji=class ji extends Ne{constructor(t,e,s,r){super(t,e),this._objectId=s,this._category=r}get objectId(){return this._objectId}get category(){return this._category}};ji.SELECTED="REOE_SELECTED",ji.DESELECTED="REOE_DESELECTED",ji.ADDED="REOE_ADDED",ji.REMOVED="REOE_REMOVED",ji.PLACED="REOE_PLACED",ji.PLACED_ON_USER="REOE_PLACED_ON_USER",ji.CONTENT_UPDATED="REOE_CONTENT_UPDATED",ji.REQUEST_MOVE="REOE_REQUEST_MOVE",ji.REQUEST_ROTATE="REOE_REQUEST_ROTATE",ji.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION",ji.MOUSE_ENTER="REOE_MOUSE_ENTER",ji.MOUSE_LEAVE="REOE_MOUSE_LEAVE",ji.DOUBLE_CLICK="REOE_DOUBLE_CLICK";let Ot=ji;const Re=class Re extends Ot{constructor(t,e,s,r,n=null){super(t,e,s,r),this._widget=n}get widget(){return this._widget}get contextMenu(){return this._widget}};Re.OPEN_WIDGET="RETWE_OPEN_WIDGET",Re.CLOSE_WIDGET="RETWE_CLOSE_WIDGET",Re.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU",Re.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU",Re.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER",Re.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI",Re.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT",Re.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE",Re.REQUEST_STICKIE="RETWE_REQUEST_STICKIE",Re.REQUEST_PRESENT="RETWE_REQUEST_PRESENT",Re.REQUEST_TROPHY="RETWE_REQUEST_TROPHY",Re.REQUEST_TEASER="RETWE_REQUEST_TEASER",Re.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX",Re.REQUEST_DIMMER="RETWE_REQUEST_DIMMER",Re.REMOVE_DIMMER="RETWE_REMOVE_DIMMER",Re.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE",Re.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR",Re.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN",Re.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",Re.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",Re.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR",Re.REQUEST_AREA_HIDE="RETWE_REQUEST_AREA_HIDE",Re.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG",Re.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG",Re.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG",Re.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING",Re.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED",Re.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM",Re.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING",Re.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING",Re.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY",Re.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY",Re.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK",Re.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK",Re.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";let ot=Re;const tf=class tf extends ot{constructor(t,e,s,r){super(tf.UPDATE_STATE_AREA_HIDE,t,e,s),this._isOn=r}get isOn(){return this._isOn}};tf.UPDATE_STATE_AREA_HIDE="REAHSE_UPDATE_STATE_AREA_HIDE";let cp=tf;const ef=class ef extends Ne{constructor(t,e,s,r,n,o){super(ef.ROOM_COLOR,t),this._state=e,this._presetId=s,this._effectId=r,this._color=n,this._brightness=o}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};ef.ROOM_COLOR="REDSE_ROOM_COLOR";let N_=ef;class up extends Ot{constructor(t,e,s,r,n,o,l,c,u,h,d,f,E){super(t,e,s,r),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=n,this._x=o,this._y=l,this._z=c,this._direction=u,this._placedInRoom=h,this._placedOnFloor=d,this._placedOnWall=f,this._instanceData=E}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class _j extends Ot{constructor(t,e,s,r,n,o){super(t,e,s,r),this._droppedObjectId=n,this._droppedObjectCategory=o}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}const sf=class sf extends Ot{constructor(t,e,s,r,n,o=1){super(t,e,s,r),this._soundId=n,this._pitch=o}get soundId(){return this._soundId}get pitch(){return this._pitch}};sf.PLAY_SOUND="REOPSE_PLAY_SOUND",sf.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";let dc=sf;const xc=class xc extends Ot{};xc.FURNI_CLICK="RERAE_FURNI_CLICK",xc.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK",xc.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW",xc.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";let na=xc;const yc=class yc extends Ot{constructor(t,e,s,r,n,o=1){super(t,e,s,r),this._sampleId=n,this._pitch=o}get sampleId(){return this._sampleId}get pitch(){return this._pitch}};yc.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",yc.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",yc.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",yc.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";let zr=yc;const rf=class rf extends Ot{constructor(t,e,s,r,n=-1,o=-1){super(t,e,s,r),this._inventoryStripId=n,this._furnitureTypeId=o}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}};rf.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM",rf.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";let pu=rf;class tn extends se{constructor(t,e){super(t),this._object=e}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}const sO=class sO extends tn{constructor(t,e,s,r=!0){super(t,e),this._badgeId=s,this._groupBadge=r}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}};sO.LOAD_BADGE="ROBAE_LOAD_BADGE";let Sn=sO;const nf=class nf extends tn{constructor(t,e){super(t,e)}};nf.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID",nf.RODRE_URL_PREFIX="RODRE_URL_PREFIX";let Zr=nf;const af=class af extends tn{constructor(t,e,s,r,n,o){super(af.DIMMER_STATE,t),this._state=e,this._presetId=s,this._effectId=r,this._color=n,this._brightness=o}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};af.DIMMER_STATE="RODSUE_DIMMER_STATE";let Ll=af;const of=class of extends tn{constructor(t,e){super(t,e)}};of.ADD_HOLE="ROFHO_ADD_HOLE",of.REMOVE_HOLE="ROFHO_REMOVE_HOLE";let Oi=of;const ui=class ui extends tn{};ui.DICE_OFF="ROFCAE_DICE_OFF",ui.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE",ui.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL",ui.STICKIE="ROFCAE_STICKIE",ui.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR",ui.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT",ui.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START",ui.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP",ui.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE",ui.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT",ui.JUKEBOX_START="ROFCAE_JUKEBOX_START",ui.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP",ui.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE",ui.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON",ui.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";let _t=ui;const iO=class iO extends tn{constructor(t,e,s,r,n,o){super(t,e),this._enable=s,this._hue=r,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};iO.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";let Ha=iO;const rO=class rO extends Ne{constructor(t,e,s,r,n,o){super(t,e),this._enable=s,this._hue=r,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};rO.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";let qh=rO;const jn=class jn extends tn{constructor(t,e,s,r=!1,n=!1,o=!1,l=!1){super(t,e),this._eventId="",this._eventId=s,this._altKey=r,this._ctrlKey=n,this._shiftKey=o,this._buttonDown=l}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(t){this._localX=t}get localY(){return this._localY}set localY(t){this._localY=t}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}};jn.CLICK="ROE_MOUSE_CLICK",jn.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK",jn.MOUSE_MOVE="ROE_MOUSE_MOVE",jn.MOUSE_DOWN="ROE_MOUSE_DOWN",jn.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG",jn.MOUSE_UP="ROE_MOUSE_UP",jn.MOUSE_ENTER="ROE_MOUSE_ENTER",jn.MOUSE_LEAVE="ROE_MOUSE_LEAVE";let Ut=jn;const lf=class lf extends tn{constructor(t,e){super(t,e)}};lf.POSITION_CHANGED="ROME_POSITION_CHANGED",lf.OBJECT_REMOVED="ROME_OBJECT_REMOVED";let Mi=lf;const cf=class cf extends _t{constructor(t,e,s,r=1){super(t,e),this._soundId=s,this._pitch=r}get soundId(){return this._soundId}get pitch(){return this._pitch}};cf.PLAY_SOUND="ROPSIE_PLAY_SOUND",cf.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";let za=cf;const _l=class _l extends tn{constructor(t,e,s="",r=""){super(t,e),this._imageUrl="",this._clickUrl="",this._imageUrl=s,this._clickUrl=r}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}};_l.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE",_l.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK",_l.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK",_l.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW",_l.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";let ts=_l;const Mc=class Mc extends tn{constructor(t,e,s,r=1){super(t,e),this._sampleId=s,this._pitch=r}get sampleId(){return this._sampleId}get pitch(){return this._pitch}};Mc.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",Mc.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",Mc.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",Mc.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";let js=Mc;const wn=class wn extends Ot{};wn.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT",wn.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON",wn.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF",wn.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE",wn.JUKEBOX_INIT="ROSM_JUKEBOX_INIT",wn.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON",wn.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF",wn.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";let ds=wn;const uf=class uf extends tn{constructor(t,e,s=0){super(t,e),this._state=s}get state(){return this._state}};uf.STATE_CHANGE="ROSCE_STATE_CHANGE",uf.STATE_RANDOM="ROSCE_STATE_RANDOM";let he=uf;class bn extends Ut{constructor(t,e,s,r,n,o,l=!1,c=!1,u=!1,h=!1){super(t,e,s,l,c,u,h),this._tileX=r,this._tileY=n,this._tileZ=o}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class cc extends Ut{constructor(t,e,s,r,n,o,l,c,u,h=!1,d=!1,f=!1,E=!1){super(t,e,s,h,d,f,E),this._wallLocation=new w,this._wallWd=new w,this._wallHt=new w,this._wallLocation.assign(r),this._wallWd.assign(n),this._wallHt.assign(o),this._x=l,this._y=c,this._direction=u}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}const _e=class _e extends tn{constructor(t,e){super(t,e)}};_e.OPEN_WIDGET="ROWRE_OPEN_WIDGET",_e.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET",_e.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU",_e.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU",_e.PLACEHOLDER="ROWRE_PLACEHOLDER",_e.CREDITFURNI="ROWRE_CREDITFURNI",_e.STACK_HEIGHT="ROWRE_STACK_HEIGHT",_e.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE",_e.STICKIE="ROWRE_STICKIE",_e.PRESENT="ROWRE_PRESENT",_e.TROPHY="ROWRE_TROPHY",_e.TEASER="ROWRE_TEASER",_e.ECOTRONBOX="ROWRE_ECOTRONBOX",_e.DIMMER="ROWRE_DIMMER",_e.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER",_e.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE",_e.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR",_e.MANNEQUIN="ROWRE_MANNEQUIN",_e.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU",_e.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU",_e.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",_e.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",_e.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR",_e.AREA_HIDE="ROWRE_AREA_HIDE",_e.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG",_e.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG",_e.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG",_e.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN",_e.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING",_e.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED",_e.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM",_e.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING",_e.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING",_e.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY",_e.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY",_e.INERNAL_LINK="ROWRE_INTERNAL_LINK",_e.ROOM_LINK="ROWRE_ROOM_LINK",_e.YOUTUBE="ROWRE_YOUTUBE";let q=_e;class gj{constructor(t,e,s,r,n,o,l=0,c=0,u=!1,h=!1,d=!1,f=!1){this._type=t,this._eventId=e,this._canvasId=s,this._spriteTag=r,this._screenX=n,this._screenY=o,this._localX=l,this._localY=c,this._ctrlKey=u,this._altKey=h,this._shiftKey=d,this._buttonDown=f,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}class fj extends se{constructor(t){super(t)}}const nO=class nO extends fj{constructor(t,e){super(t),this._targetLocation=e}get targetLocation(){return this._targetLocation}};nO.ROAME_MOVE_TO="ROAME_MOVE_TO";let Iu=nO;const hf=class hf extends Ne{constructor(t,e,s=!1,r=!1){super(hf.ROOM_ZOOM,t),this._level=e,this._forceFlip=s,this._asDelta=r}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}};hf.ROOM_ZOOM="REE_ROOM_ZOOM";let xl=hf;const df=class df extends se{constructor(t,e){super(df.IMAGE_READY),this._badgeId=t,this._image=e}get badgeId(){return this._badgeId}get image(){return this._image}};df.IMAGE_READY="BIME_BADGE_IMAGE_READY";let Za=df;const _f=class _f extends se{constructor(t,e){super(_f.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=t,this._keyColor=e}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}};_f.MYSTERY_BOX_KEYS_UPDATE="mbke_update";let C_=_f;const gf=class gf extends se{constructor(){super(gf.PERKS_UPDATED)}};gf.PERKS_UPDATED="PUE_perks_updated";let BO=gf;const bc=class bc extends se{constructor(t,e,s=!0){super(t),this._session=e,this._openLandingView=s}get session(){return this._session}get openLandingView(){return this._openLandingView}};bc.CREATED="RSE_CREATED",bc.STARTED="RSE_STARTED",bc.ENDED="RSE_ENDED",bc.ROOM_DATA="RSE_ROOM_DATA";let yt=bc;const wi=class wi extends yt{constructor(t,e,s,r,n,o=0,l,c=null,u=-1){super(t,e),this._objectId=s,this._message=r,this._chatType=n,this._chatColours=l,this._links=c,this._extraParam=u,this._style=o}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}get chatColours(){return this._chatColours}};wi.CHAT_EVENT="RSCE_CHAT_EVENT",wi.FLOOD_EVENT="RSCE_FLOOD_EVENT",wi.CHAT_TYPE_SPEAK=0,wi.CHAT_TYPE_WHISPER=1,wi.CHAT_TYPE_SHOUT=2,wi.CHAT_TYPE_RESPECT=3,wi.CHAT_TYPE_PETRESPECT=4,wi.CHAT_TYPE_HAND_ITEM_RECEIVED=5,wi.CHAT_TYPE_PETTREAT=6,wi.CHAT_TYPE_PETREVIVE=7,wi.CHAT_TYPE_PET_REBREED_FERTILIZE=8,wi.CHAT_TYPE_PET_SPEED_FERTILIZE=9,wi.CHAT_TYPE_MUTE_REMAINING=10;let fe=wi;const ff=class ff extends yt{constructor(t,e,s,r,n,o){super(ff.CONFIRM_PET_BREEDING,t),this._nestId=e,this._pet1=s,this._pet2=r,this._rarityCategories=n,this._resultPetTypeId=o}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}};ff.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";let hp=ff;const mf=class mf extends yt{constructor(t,e,s){super(mf.RSPFUE_CONFIRM_PET_BREEDING_RESULT,t),this._breedingNestStuffId=e,this._result=s}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}};mf.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";let dp=mf;const Ef=class Ef extends yt{constructor(t,e,s){super(Ef.RSDE_DANCE,t),this._roomIndex=e,this._danceId=s}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}};Ef.RSDE_DANCE="RSDE_DANCE";let x_=Ef;class mj{constructor(t,e,s,r){this._id=t,this._type=e,this._color=s,this._brightness=r}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}const aO=class aO extends yt{constructor(t,e){super(t,e),this._selectedPresetId=0,this._presets=[]}storePreset(t,e,s,r){this._presets[t-1]=new mj(t,e,s,r)}getPreset(t){return t<0||t>=this._presets.length?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(t){this._selectedPresetId=t}};aO.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";let Qh=aO;const oh=class oh extends yt{constructor(t,e,s){super(t,e),this._userName="",this._userName=s}get userName(){return this._userName}};oh.DOORBELL="RSDE_DOORBELL",oh.RSDE_REJECTED="RSDE_REJECTED",oh.RSDE_ACCEPTED="RSDE_ACCEPTED";let In=oh;const tr=class tr extends yt{constructor(t,e,s=null){super(t,e),this._message=s}get message(){return this._message}};tr.RSEME_KICKED="RSEME_KICKED",tr.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL",tr.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT",tr.RSEME_MAX_PETS="RSEME_MAX_PETS",tr.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS",tr.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET",tr.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET",tr.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL",tr.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT",tr.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED",tr.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT",tr.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";let ue=tr;const pf=class pf extends yt{constructor(t,e,s,r,n){super(pf.FAVOURITE_GROUP_UPDATE,t),this._roomIndex=e,this._habboGroupId=s,this._habboGroupName=n,this._status=r}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}};pf.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";let y_=pf;const If=class If extends yt{constructor(t,e,s,r){super(If.RSFRE_FRIEND_REQUEST,t),this._requestId=0,this._userId=0,this._requestId=e,this._userId=s,this._userName=r}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}};If.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";let _p=If;const Tf=class Tf extends yt{constructor(t,e,s){super(Tf.NEST_BREEDING_SUCCESS,t),this._petId=e,this._rarityCategory=s}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}};Tf.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";let gp=Tf;const Rf=class Rf extends yt{constructor(t,e,s,r){super(Rf.PET_BREEDING,t),this._state=e,this._ownPetId=s,this._otherPetId=r}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};Rf.PET_BREEDING="RSPFUE_PET_BREEDING";let fp=Rf;const Sf=class Sf extends yt{constructor(t,e,s){super(Sf.PET_BREEDING_RESULT,t),this._resultData=e,this._otherResultData=s}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}};Sf.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";let mp=Sf;const Of=class Of extends yt{constructor(t,e,s,r){super(Of.PET_COMMANDS,t),this._petId=e,this._allCommandIds=s,this._enabledCommandIds=r}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}};Of.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";let VO=Of;const Af=class Af extends yt{constructor(t,e,s){super(Af.PET_FIGURE_UPDATE,t),this._petId=e,this._figure=s}get id(){return this._petId}get figure(){return this._figure}};Af.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";let Ep=Af;const Nf=class Nf extends yt{constructor(t,e){super(Nf.PET_INFO,t),this._petInfo=e}get petInfo(){return this._petInfo}};Nf.PET_INFO="RSPIUE_PET_INFO";let M_=Nf;const Cf=class Cf extends yt{constructor(t,e,s){super(Cf.PET_LEVEL_UPDATE,t),this._petId=e,this._level=s}get petId(){return this._petId}get level(){return this._level}};Cf.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";let pp=Cf;const xf=class xf extends yt{constructor(t,e,s,r,n,o){super(t,e),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=s,this._figureData=r,this._nameValidationStatus=n,this._nameValidationInfo=o}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}};xf.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED",xf.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";let bo=xf;const yf=class yf extends yt{constructor(t,e,s,r,n,o){super(yf.PET_STATUS_UPDATE,t),this._petId=e,this._canBreed=s,this._canHarvest=r,this._canRevive=n,this._hasBreedingPermission=o}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}};yf.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";let b_=yf;const lh=class lh extends yt{constructor(t,e,s){super(t,e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=s}get id(){return this._id}get headline(){return this._headline}set headline(t){this._headline=t}get summary(){return this._summary}set summary(t){this._summary=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}};lh.OFFER="RSPE_POLL_OFFER",lh.ERROR="RSPE_POLL_ERROR",lh.CONTENT="RSPE_POLL_CONTENT";let mn=lh;const oO=class oO extends yt{constructor(t,e,s,r,n,o,l,c,u){super(t,e),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=s,this._itemType=r,this._productCode=n,this._placedItemId=o,this._placedItemType=l,this._placedInRoom=c,this._petFigureString=u}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}};oO.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";let Jh=oO;const lO=class lO extends yt{constructor(t,e){super(t,e)}};lO.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";let D_=lO;const fo=class fo extends yt{constructor(t,e,s,r=!1){super(fo.QUEUE_STATUS,t),this._name=e,this._target=s,this._queues=new Map,this._isActive=r}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(t){return this._queues.get(t)}addQueue(t,e){this._queues.set(t,e)}};fo.QUEUE_STATUS="RSQE_QUEUE_STATUS",fo.QUEUE_TYPE_CLUB="c",fo.QUEUE_TYPE_NORMAL="d",fo.QUEUE_TARGET_VISITOR=2,fo.QUEUE_TARGET_SPECTATOR=1;let HO=fo;const cO=class cO extends yt{constructor(t,e){super(t,e)}};cO.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";let v_=cO;const Mf=class Mf extends yt{constructor(t,e,s){super(Mf.RSUBE_BADGES,t),this._userId=0,this._badges=[],this._userId=e,this._badges=s}get userId(){return this._userId}get badges(){return this._badges}};Mf.RSUBE_BADGES="RSUBE_BADGES";let P_=Mf;const bf=class bf extends yt{constructor(t,e){super(bf.USER_DATA_UPDATED,t),this._addedUsers=e}get addedUsers(){return this._addedUsers}};bf.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";let L_=bf;const Df=class Df extends yt{constructor(t,e,s,r,n,o){super(Df.USER_FIGURE,t),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=e,this._figure=s,this._gender=r,this._customInfo=n,this._achievementScore=o}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}};Df.USER_FIGURE="RSUBE_FIGURE";let U_=Df;const vf=class vf extends se{constructor(t,e){super(vf.UTRE_USER_TAGS_RECEIVED),this._userId=t,this._tags=e}get userId(){return this._userId}get tags(){return this._tags}};vf.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";let WO=vf;const Pf=class Pf extends yt{constructor(t,e,s,r,n=null,o=0){super(t,e),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=s,this._choices=r,this._SafeStr_7651=n,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=o}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}};Pf.VOTE_QUESTION="RSPE_VOTE_QUESTION",Pf.VOTE_RESULT="RSPE_VOTE_RESULT";let _c=Pf;const ch=class ch extends yt{constructor(t,e,s=-1){super(t,e),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=s}get id(){return this._id}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get pollId(){return this._pollId}set pollId(t){this._pollId=t}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get duration(){return this._duration}set duration(t){this._duration=t}get question(){return this._question}set question(t){this._question=t}get userId(){return this._userId}set userId(t){this._userId=t}get value(){return this._value}set value(t){this._value=t}get answerCounts(){return this._answerCounts}set answerCounts(t){this._answerCounts=t}};ch.QUESTION="RWPUW_NEW_QUESTION",ch.FINISHED="RWPUW_QUESION_FINSIHED",ch.ANSWERED="RWPUW_QUESTION_ANSWERED";let En=ch;const Lf=class Lf extends se{constructor(t){super(Lf.UPDATED),this._uiFlags=t}get uiFlags(){return this._uiFlags}};Lf.UPDATED="APUE_UPDATED";let Ip=Lf;const Uf=class Uf extends se{constructor(t){super(Uf.UNUE_NAME_UPDATED),this._name=t}get name(){return this._name}};Uf.UNUE_NAME_UPDATED="unue_name_updated";let j_=Uf;const jf=class jf extends se{constructor(t,e){super(jf.NOTIFY_PLAYED_SONG),this._name=t,this._creator=e}get name(){return this._name}get creator(){return this._creator}};jf.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";let w_=jf;const uh=class uh extends se{constructor(t,e,s,r){super(t),this._id=s,this._position=r,this._priority=e}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}};uh.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG",uh.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG",uh.NPE_SONG_CHANGED="NPE_SONG_CHANGED";let aa=uh;const wf=class wf extends se{constructor(t){super(t)}};wf.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED",wf.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";let $n=wf;const uO=class uO extends se{constructor(t){super(t)}};uO.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";let yl=uO;const hO=class hO extends se{constructor(t,e){super(t),this._id=e}get id(){return this._id}};hO.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";let Bl=hO;const dO=class dO extends se{constructor(t,e){super(t),this._id=e}get id(){return this._id}};dO.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";let Tu=dO;const an=class an{constructor(t,e,s,r){this._state=an.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=s,this._assetManager=r,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this.checkIsLoaded()}async downloadAsset(){if(!(!this._assetManager||this._state===an.LOADING||this._state===an.LOADED)){if(!this.checkIsLoaded()&&(this._state=an.LOADING,!await this._assetManager.downloadAsset(this._downloadUrl)))throw new Error("Could not download asset");this.checkIsLoaded()&&X().dispatchEvent(new lp(vi.AVATAR_ASSET_DOWNLOADED,this))}}checkIsLoaded(){return this._assetManager.getCollection(this._libraryName)?(this._state=an.LOADED,!0):!1}get libraryName(){return this._libraryName}get isLoaded(){return this._state===an.LOADED}};an.NOT_LOADED=0,an.LOADING=1,an.LOADED=2;let Tp=an;class Ej{constructor(){this._definitions=new Map,this._config={},this._missingKeys=[],fu.sayHello()}async init(){await this.reloadConfiguration()}async reloadConfiguration(){try{this.resetConfiguration(),this.parseConfiguration(this.getDefaultConfig(),!0);const t=this.getValue("config.urls").slice();if(!t||!t.length)throw new Error("Invalid configuration urls");for(const e of t){if(!e||!e.length)return;const s=await fetch(e);if(s.status!==200)throw new Error("Invalid configuration file");this.parseConfiguration(await s.json())}}catch(t){throw new Error(t)}}resetConfiguration(){this._definitions.clear(),this._config={},this._missingKeys=[]}parseConfiguration(t,e=!1){if(!t)return!1;try{const s=new RegExp(/\${(.*?)}/g);for(const r in t){let n=t[r];typeof n=="string"&&(n=this.interpolate(n,s)),this._definitions.has(r)?e&&this.setValue(r,n):this.setValue(r,n)}return!0}catch(s){return Lt.error(s.stack),!1}}interpolate(t,e=null){e||(e=new RegExp(/\${(.*?)}/g));const s=t.match(e);if(s&&s.length)for(const r of s){const n=this._definitions.get(this.removeInterpolateKey(r));n&&(t=t.replace(r,n))}return t}removeInterpolateKey(t){return t.replace("${","").replace("}","")}getValue(t,e=null){let s=this._definitions.get(t);if(s===void 0){if(this._missingKeys.indexOf(t)>=0)return e;this._missingKeys.push(t),Lt.warn(`Missing configuration key: ${t}`),s=e}return s}setValue(t,e){const s=t.split(".");let r=this._config;for(let n=0;n<s.length;n++){const o=s[n].toString();if(n!==s.length-1){r[o]||(r[o]={}),r=r[o];continue}r[o]=e}this._definitions.set(t,e)}getDefaultConfig(){return window.NitroConfig}get definitions(){return this._definitions}}const pj=new Ej,jt=()=>pj;class Ij{constructor(t,e){this._missingMandatoryLibs=[],this._figureMap=new Map,this._figureListeners=new Map,this._incompleteFigures=new Map,this._currentDownloads=[],this._libraryNames=[],this._assets=t,this._structure=e}async init(){this._missingMandatoryLibs=jt().getValue("avatar.mandatory.libraries");const t=jt().getValue("avatar.figuremap.url");if(!t||!t.length)throw new Error("Invalid figure map url");const e=await fetch(t);if(e.status!==200)throw new Error("Invalid figure map file");const s=await e.json();this.processFigureMap(s.libraries),X().addEventListener(vi.AVATAR_ASSET_DOWNLOADED,r=>this.onLibraryLoaded(r)),await this.processMissingLibraries()}processFigureMap(t){if(!t)return;const e=jt().getValue("avatar.asset.url");for(const s of t){if(!s)continue;const r=s.id,n=s.revision||"";if(this._libraryNames.indexOf(r)>=0)continue;this._libraryNames.push(r);const o=new Tp(r,n,e,this._assets);for(const l of s.parts){const c=l.id,h=l.type+":"+c;let d=this._figureMap.get(h);d||(d=[]),d.push(o),this._figureMap.set(h,d)}}}async processMissingLibraries(){const t=[];this._missingMandatoryLibs.forEach(e=>{const s=this._figureMap.get(e);if(s)for(const r of s)t.push(r.downloadAsset())}),this._missingMandatoryLibs=[],await Promise.all(t)}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];for(const[r,n]of this._incompleteFigures.entries()){let o=!0;for(const l of n)if(!(!l||l.isLoaded)){o=!1;break}if(o){e.push(r);const l=this._figureListeners.get(r);if(l)for(const c of l)!c||c.disposed||c.resetFigure(r);this._figureListeners.delete(r),X().dispatchEvent(new se(vi.AVATAR_ASSET_LOADED))}}for(const r of e)r&&this._incompleteFigures.delete(r);let s=0;for(;s<this._currentDownloads.length;){const r=this._currentDownloads[s];r&&r.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}isAvatarFigureContainerReady(t){return!this.getAvatarFigurePendingLibraries(t).length}getAvatarFigurePendingLibraries(t){const e=[];if(!t||!this._structure)return e;const s=this._structure.figureData;if(!s)return e;const r=t.getPartTypeIds();for(const n of r){const o=s.getSetType(n);if(!o)continue;const l=o.getPartSet(t.getPartSetId(n));if(l)for(const c of l.parts){if(!c)continue;const u=c.type+":"+c.id,h=this._figureMap.get(u);if(h!==void 0)for(const d of h)!d||d.isLoaded||e.indexOf(d)>=0||e.push(d)}}return e}downloadAvatarFigure(t,e){const s=t.getFigureString(),r=this.getAvatarFigurePendingLibraries(t);if(r&&r.length){if(e&&!e.disposed){let n=this._figureListeners.get(s);n||(n=[],this._figureListeners.set(s,n)),n.push(e)}this._incompleteFigures.set(s,r);for(const n of r)n&&n.downloadAsset()}else e&&!e.disposed&&e.resetFigure(s)}}class Hu{constructor(t){this._parts=new Map,this.parseFigure(t)}getPartTypeIds(){return this.partSets().keys()}hasPartType(t){return!!this.partSets().get(t)}getPartSetId(t){const e=this.partSets().get(t);return e?e.get("setid"):0}getPartColorIds(t){const e=this.partSets().get(t);return e?e.get("colorids"):null}updatePart(t,e,s){const r=new Map;r.set("type",t),r.set("setid",e),r.set("colorids",s);const n=this.partSets();n.delete(t),n.set(t,r)}removePart(t){this.partSets().delete(t)}getFigureString(){const t=[];for(const e of this.partSets().keys()){if(!e)continue;let s=[];s.push(e),s.push(this.getPartSetId(e)),s=s.concat(this.getPartColorIds(e)),t.push(s.join("-"))}return t.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(t){t||(t="");for(const e of t.split(".")){const s=e.split("-");if(s.length>=2){const r=s[0],n=parseInt(s[1]),o=[];let l=2;for(;l<s.length;)o.push(parseInt(s[l])),l++;this.updatePart(r,n,o)}}}}class Tj{constructor(t){this._id=parseInt(t.id),this._value=parseInt(t.id),this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._isAnimated=!0,t.animated!==void 0&&t.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class Rj{constructor(t){if(this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=new Map,this._id=t.id,this._state=t.state,this._precedence=t.precedence,this._activePartSet=t.activePartSet,this._assetPartDefinition=t.assetPartDefinition,this._lay=t.lay,this._geometryType=t.geometryType,this._isMain=t.main||!1,this._isDefault=t.isDefault||!1,this._isAnimation=t.animation||!1,this._startFromFrameZero=t.startFromFrameZero||!1,this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,t.params&&t.params.length>0)for(const e of t.params)e&&(e.id==="default"?this._defaultParameterValue=e.value:this._params.set(e.id,e.value));if(t.types&&t.types.length>0)for(const e of t.types){if(!e)continue;const s=new Tj(e);this._types.set(s.id,s)}}setOffsets(t,e,s){this._canvasOffsets||(this._canvasOffsets=new Map);let r=this._canvasOffsets.get(t);r||(r=new Map,this._canvasOffsets.set(t,r)),r.set(e,s)}getOffsets(t,e){if(!this._canvasOffsets)return null;const s=this._canvasOffsets.get(t);return s?s.get(e):null}getType(t){if(!t)return null;const e=this._types.get(parseInt(t));return e||null}getParameterValue(t){if(!t)return"";const e=this._params.get(t);return e||this._defaultParameterValue}getPrevents(t){return this._prevents.concat(this.getTypePrevents(t))}getTypePrevents(t){if(!t)return[];const e=this._types.get(parseInt(t));return e?e.prevents:[]}getPreventHeadTurn(t){if(!t)return this._preventHeadTurn;const e=this.getType(t);return e?e.preventHeadTurn:this._preventHeadTurn}isAnimated(t){if(!t)return!0;const e=this.getType(t);return e?e.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class Rp{constructor(t,e="",s=0){this._actionType=t||"",this._actionParameter=e||"",this._definition=null,this._startFrame=s||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(t){this._actionParameter=t}get definition(){return this._definition}set definition(t){this._definition=t}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(t){this._overridingAction=t}}class Sj{constructor(t,e){this._assets=t,this._actions=new Map,this._defaultAction=null,this.updateActions(e)}updateActions(t){if(t){for(const e of t.actions){if(!e||!e.state)continue;const s=new Rj(e);this._actions.set(s.state,s)}t.actionOffsets&&this.parseActionOffsets(t.actionOffsets)}}parseActionOffsets(t){if(!(!t||!t.length))for(const e of t){const s=this._actions.get(e.action);if(s)for(const r of e.offsets){const n=r.size||"",o=r.direction;if(n===""||o===void 0)continue;const l=r.x||0,c=r.y||0,u=r.z||0;s.setOffsets(n,o,[l,c,u])}}}getActionDefinition(t){if(!t)return null;for(const e of this._actions.values())if(!(!e||e.id!==t))return e;return null}getActionDefinitionWithState(t){const e=this._actions.get(t);return e||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const t of this._actions.values())if(!(!t||!t.isDefault))return this._defaultAction=t,t;return null}getCanvasOffsets(t,e,s){let r=[];for(const n of t){if(!n)continue;const o=this._actions.get(n.actionType),l=o&&o.getOffsets(e,s);l&&(r=l)}return r}sortActions(t){if(!t)return null;t=this.filterActions(t);const e=[];for(const s of t){if(!s)continue;const r=this._actions.get(s.actionType);r&&(s.definition=r,e.push(s))}return e.sort((s,r)=>{if(!s||!r)return 0;const n=s.definition.precedence,o=r.definition.precedence;return n<o?1:n>o?-1:0}),e}filterActions(t){let e=[];const s=[];for(const r of t){if(!r)continue;const n=this._actions.get(r.actionType);n&&(e=e.concat(n.getPrevents(r.actionParameter)))}for(const r of t){if(!r)continue;let n=r.actionType;r.actionType==="fx"&&(n=n+("."+r.actionParameter)),!(e.indexOf(n)>=0)&&s.push(r)}return s}}class Oj{constructor(){this._cache=new Map,this.setLastAccessTime(zt())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache.clear()}}getDirectionCache(t){const e=this._cache.get(t.toString());return e||null}updateDirectionCache(t,e){this._cache.set(t.toString(),e)}setLastAccessTime(t){this._lastAccessTime=t}getLastAccessTime(){return this._lastAccessTime}debugInfo(t){}}class YO{constructor(){this._cache=new Map}setAction(t,e){this._currentAction||(this._currentAction=t);const s=this.getActionCache(this._currentAction);s&&s.setLastAccessTime(e),this._currentAction=t}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(t,e){if(!(!this._cache||this._disposed))for(const[s,r]of this._cache.entries()){if(!r)continue;const n=r.getLastAccessTime();e-n>=t&&(r.dispose(),this._cache.delete(s))}}getAction(){return this._currentAction}setDirection(t){this._currentDirection=t}getDirection(){return this._currentDirection}getActionCache(t=null){return this._currentAction?(t||(t=this._currentAction),t.overridingAction?this._cache.get(t.overridingAction):this._cache.get(t.id)):null}updateActionCache(t,e){t.overridingAction?this._cache.set(t.overridingAction,e):this._cache.set(t.id,e)}debugInfo(t){}}class Aj{constructor(t,e,s){this._image=t,this._regPoint=e,this._offset=new Qt(0,0),this._regPoint=e,this._isCacheable=s,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(t){this._regPoint=t,this.cleanPoints()}get image(){return this._image}set image(t){this._image&&this._image!==t&&this._image.destroy({children:!0}),this._image=t}get regPoint(){const t=this._regPoint.clone();return t.x+=this._offset.x,t.y+=this._offset.y,t}set offset(t){this._offset=t,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class Nj{constructor(t){this._id=t.id||"",this._align=t.align||"",this._base=t.base||"",this._ink=t.ink||0,this._blend=0;const e=t.blend;e&&e.length>0&&(this._blend=parseInt(e),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}const Ff=class Ff{constructor(t,e,s){if(this._id=t.id,this._animationFrame=t.frame||0,this._dx=t.dx||0,this._dy=t.dy||0,this._dz=t.dz||0,this._directionOffset=t.dd||0,this._type=e,this._base=t.base||"",this._items=new Map,t.items)for(const r of t.items)this._items.set(r.id,r.base);this._base!==""&&this.baseAsInt().toString(),s&&(this._action=new Rp(s.state,this.base),this._action.definition=s)}get items(){return this._items}baseAsInt(){let t=0,e=0;for(;e<this._base.length;)t=t+this._base.charCodeAt(e),e++;return t}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}};Ff.BODYPART="bodypart",Ff.FX="fx";let fn=Ff;class Cj{constructor(t){this._ink=t.ink;let e=t.foreground,s=t.background;e=e.replace("#",""),s=s.replace("#",""),this._foreGround=parseInt(e,16),this._backGround=parseInt(s,16),this._colorTransform=null,this._rgb=parseInt(e,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new bN({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(t,e){const s=t>>24&255,r=t>>16&255,n=t>>8&255,o=t&255,l=e>>24&255,c=e>>16&255,u=e>>8&255,h=e&255,d=(l-s)/255,f=(c-r)/255,E=(u-n)/255,m=(h-o)/255,I=new Map,p=[];let T=s,R=r,S=n,L=o;for(let M=0;M<256;M++){T+=d,R+=f,S+=E,L+=m;const P=Math.max(0,Math.min(255,Math.round(T))),k=Math.max(0,Math.min(255,Math.round(R))),G=Math.max(0,Math.min(255,Math.round(S))),j=Math.max(0,Math.min(255,Math.round(L))),F=P<<24|k<<16|G<<8|j;p.push(F)}return I.set("alphas",p),I.set("reds",p),I.set("greens",p),I.set("blues",p),I}}class xj{constructor(t){this._offset=t.offset}get offset(){return this._offset}}class yj{constructor(t,e){this._animation=t,this._id=e.id,this._ink=e.ink,this._member=e.member,this._hasStaticY=!!e.staticY,this._hasDirections=!!e.directions,this._dx=[],this._dy=[],this._dz=[];const s=e.directionList;if(s&&s.length)for(const r of s){const n=r.id;n!==void 0&&(this._dx[n]=r.dx||0,this._dy[n]=r.dy||0,this._dz[n]=r.dz||0)}}getDirectionOffsetX(t){return t<this._dx.length?this._dx[t]:0}getDirectionOffsetY(t){return t<this._dy.length?this._dy[t]:0}getDirectionOffsetZ(t){return t<this._dz.length?this._dz[t]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}const Dc=class Dc{constructor(t,e){if(this._id=e.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=e.resetOnToggle||!1,e.sprites&&e.sprites.length){this._spriteData=[];for(const s of e.sprites)this._spriteData.push(new yj(this,s))}if(e.avatars&&e.avatars.length&&(this._avatarData=new Cj(e.avatars[0])),e.directions&&e.directions.length&&(this._directionData=new xj(e.directions[0])),e.removes&&e.removes.length){this._removeData=[];for(const s of e.removes)this._removeData.push(s.id)}if(e.adds&&e.adds.length){this._addData=[];for(const s of e.adds)this._addData.push(new Nj(s))}if(e.overrides&&e.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of e.overrides){const r=s.name,n=s.override;this._overriddenActions.set(n,r);const o=[];this.parseFrames(o,s.frames,t),this._overrideFrames.set(r,o)}}this.parseFrames(this._frames,e.frames,t)}parseFrames(t,e,s){if(!(!e||!e.length))for(const r of e){let n=1;r.repeats&&r.repeats>1&&(n=r.repeats);let o=0;for(;o<n;){const l=[];if(r.bodyparts&&r.bodyparts.length)for(const c of r.bodyparts){const u=s.getActionDefinition(c.action),h=new fn(c,fn.BODYPART,u);l.push(h)}if(r.fxs&&r.fxs.length)for(const c of r.fxs){const u=s.getActionDefinition(c.action),h=new fn(c,fn.FX,u);l.push(h)}t.push(l),o++}}}frameCount(t=null){if(!t)return this._frames.length;if(this._overrideFrames){const e=this._overrideFrames.get(t);if(e)return e.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const t=[];for(const e of this._overriddenActions.keys())t.push(e);return t}overridingAction(t){return this._overriddenActions?this._overriddenActions.get(t):null}getFrame(t,e=null){t<0&&(t=0);let s=[];if(!e)this._frames.length>0&&(s=this._frames[t%this._frames.length]);else{const r=this._overrideFrames.get(e);r&&r.length>0&&(s=r[t%r.length])}return s}getAnimatedBodyPartIds(t,e=null){const s=[];for(const r of this.getFrame(t,e))if(r.type===fn.BODYPART)s.push(r.id);else if(r.type===fn.FX&&this._addData&&this._addData.length)for(const n of this._addData)n.id===r.id&&s.push(n.align);return s}getLayerData(t,e,s=null){for(const r of this.getFrame(t,s)){if(r.id===e)return r;if(r.type===fn.FX&&this._addData&&this._addData.length){for(const n of this._addData)if(n.align===e&&n.id===r.id)return r}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(t){if(this._addData){for(const e of this._addData)if(e.id===t)return e}return null}get id(){return this._id}get spriteData(){return this._spriteData||Dc.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||Dc.EMPTY_ARRAY}get addData(){return this._addData||Dc.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}};Dc.EMPTY_ARRAY=[];let Sp=Dc;class Mj{constructor(){this._animations=new Map}registerAnimation(t,e){if(!e)return!1;const s=e[Object.keys(e)[0]],r=new Sp(t,s);return this._animations.set(s.name,r),!0}getAnimation(t){const e=this._animations.get(t);return e||null}getLayerData(t,e,s){const r=this.getAnimation(t);return r?r.getLayerData(e,s):null}get animations(){return this._animations}}class bj{constructor(t){this._partList=t,this._images=new Map}dispose(){for(const t of this._images.values())t&&t.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(t){const e=this._images.get(this.getCacheKey(t));return e||null}updateImageContainer(t,e){const s=this.getCacheKey(e),r=this._images.get(s);r&&r.dispose(),this._images.set(s,t)}getCacheKey(t){let e="";for(const s of this._partList)e+=s.getCacheableKey(t)+"/";return e}debugInfo(t){}}class zO{constructor(t,e,s,r,n,o=null){this._texture=t,this._container=o,this._rect=e,this._regPoint=s,this._flipH=r,this._colorTransform=n,r&&(this._regPoint.x=-this._regPoint.x+e.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new zo(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}const _O=class _O{constructor(t,e,s,r){this._structure=t,this._avatar=e,this._assets=s,this._scale=r,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new _r}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache=null}if(this._unionImages){for(const t of this._unionImages)t&&t.dispose();this._unionImages=[]}}}disposeInactiveActions(t=6e4){const e=zt();if(this._cache)for(const s of this._cache.values())s&&s.disposeActions(t,e)}resetBodyPartCache(t){if(this._cache)for(const e of this._cache.values())e&&e.setAction(t,0)}setDirection(t,e){const s=this._structure.getBodyPartsUnordered(t);if(s)for(const r of s){const n=this.getBodyPartCache(r);n&&n.setDirection(e)}}setAction(t,e){const s=this._structure.getActiveBodyPartIds(t,this._avatar);for(const r of s){const n=this.getBodyPartCache(r);n&&n.setAction(t,e)}}setGeometryType(t){if(this._geometryType!==t){if(this._geometryType===no.SITTING&&t===no.VERTICAL||this._geometryType===no.VERTICAL&&t===no.SITTING||this._geometryType===no.SNOWWARS_HORIZONTAL&&(t=no.SNOWWARS_HORIZONTAL)){this._geometryType=t,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=t,this._canvas=null}}getImageContainer(t,e,s=!1){const r=this.getBodyPartCache(t)||new YO;this._cache.set(t,r);let n=r.getDirection(),o=r.getAction(),l=e;o.definition.startFromFrameZero&&(l-=o.startFrame);let c=o,u=[],h=new Map;const d=new Qt;if(o.definition.isAnimation){let p=n;const T=this._structure.getAnimation(o.definition.state+"."+o.actionParameter),R=e-o.startFrame;if(T){const S=T.getLayerData(R,t,o.overridingAction);S&&(p=(n+S.dd+8)%8,d.x=this._scale===hr.LARGE?S.dx:S.dx/2,d.y=this._scale===hr.LARGE?S.dy:S.dy/2,l=S.animationFrame,S.action&&(o=S.action),S.type===fn.BODYPART?(S.action&&(c=S.action),n=p):S.type===fn.FX&&(n=p),h=S.items),u=T.removeData}}let f=r.getActionCache(c);(!f||s)&&(f=new Oj,r.updateActionCache(c,f));let E=f.getDirectionCache(n);if(!E||s){const p=this._structure.getParts(t,this._avatar.getFigure(),c,this._geometryType,n,u,this._avatar,h);E=new bj(p),f.updateDirectionCache(n,E)}let m=E.getImageContainer(l);if(!m||s){const p=E.getPartList();if(m=this.renderBodyPart(n,p,l,o),m&&!s)m.isCacheable&&E.updateImageContainer(m,l);else return null}const I=this._structure.getFrameBodyPartOffset(c,n,l,t);return d.x+=I.x,d.y+=I.y,m.offset=d,m}getBodyPartCache(t){let e=this._cache.get(t);return e||(e=new YO,this._cache.set(t,e)),e}renderBodyPart(t,e,s,r){if(!e||!e.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const n=Jr.DIRECTION_IS_FLIPPED[t]||!1;let o=r.definition.assetPartDefinition,l=!0,c=e.length-1;for(;c>=0;){const E=e[c];let m=16777215;if(!(t==7&&(E.partType==="fc"||E.partType==="ey"))&&!(E.partType==="ri"&&!E.partId)){const I=E.partId,p=E.getFrameDefinition(s);let T=E.partType,R=0;p?(R=p.number,p.assetPartDefinition&&p.assetPartDefinition!==""&&(o=p.assetPartDefinition)):R=E.getFrameIndex(s);let S=t,L=!1;n&&(o==="wav"&&(T===At.LEFT_HAND||T===At.LEFT_SLEEVE||T===At.LEFT_COAT_SLEEVE)||o==="drk"&&(T===At.RIGHT_HAND||T===At.RIGHT_SLEEVE||T===At.RIGHT_COAT_SLEEVE)||o==="blw"&&T===At.RIGHT_HAND||o==="sig"&&T===At.LEFT_HAND||o==="respect"&&T===At.LEFT_HAND||T===At.RIGHT_HAND_ITEM||T===At.LEFT_HAND_ITEM||T===At.CHEST_PRINT?L=!0:(t===4?S=2:t===5?S=1:t===6&&(S=0),E.flippedPartType!==T&&(T=E.flippedPartType)));let M=this._scale+"_"+o+"_"+T+"_"+I+"_"+S+"_"+R,P=this._assets.getAsset(M);if(P||(M=this._scale+"_std_"+T+"_"+I+"_"+S+"_0",P=this._assets.getAsset(M)),P){const k=P.texture;if(!k||!k.source)l=!1;else{E.isColorable&&E.color&&(m=E.color.rgb);const G=new Qt(-P.x,-P.y);L&&(G.x=G.x+(this._scale===hr.LARGE?65:31)),this._unionImages.push(new zO(k,P.rectangle,G,L,m))}}}c--}if(!this._unionImages.length)return null;const u=this.createUnionImage(this._unionImages,n),h=this._scale===hr.LARGE?this._canvas.height-16:this._canvas.height-8,d=new Qt(-u.regPoint.x,h-u.regPoint.y);n&&o!=="lay"&&(d.x=d.x+(this._scale===hr.LARGE?67:31));let f=this._unionImages.length-1;for(;f>=0;){const E=this._unionImages.pop();E&&E.dispose(),f--}return new Aj(u.container,d,l)}convertColorToHex(t){let e=(t*255).toString(16);return e.length<2&&(e="0"+e),e}createUnionImage(t,e){const s=new zo;for(const l of t)l&&s.enlarge(l.offsetRect);const r=new Qt(-s.x,-s.y),n=new $r,o=new Ve(Es.EMPTY);o.width=s.width,o.height=s.height,n.addChild(o);for(const l of t){if(!l)continue;const c=r.clone();c.x-=l.regPoint.x,c.y-=l.regPoint.y,e&&(c.x=n.width-(c.x+l.rect.width)),e!=l.flipH?(this._matrix.a=-1,this._matrix.tx=l.rect.x+l.rect.width+c.x,this._matrix.ty=c.y-l.rect.y):(this._matrix.a=1,this._matrix.tx=c.x-l.rect.x,this._matrix.ty=c.y-l.rect.y);const u=new Ve(l.texture);u.tint=l.colorTransform,u.setFromMatrix(this._matrix),n.addChild(u)}return new zO(null,n.getLocalBounds().rectangle,r,e,null,n)}};_O.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;let Op=_O;const qs=class qs{constructor(t,e,s,r,n,o=null){this._structure=t,this._assets=e,this._figure=s,this._scale=r,this._effectManager=n,this._effectListener=o,this._disposed=!1,this._canvasOffsets=[],this._actions=[],this._activeTexture=null,this._defaultAction=null,this._frameCounter=0,this._directionOffset=0,this._changes=!0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._lastActionsString=null,this._currentActionsString=null,this._effectIdInUse=-1,this._animationFrameCount=-1,this._cachedBodyParts=[],this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._figure||(this._figure=new Hu("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._scale||(this._scale=hr.LARGE),this._cache=new Op(this._structure,this,this._assets,this._scale),this.setDirection(qs.DEFAULT_AVATAR_SET,qs.DEFAULT_DIRECTION),this._defaultAction=new Rp(St.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(qs.DEFAULT_ACTION),this.resetActions(),this._animationFrameCount=0}dispose(){this._disposed||(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._activeTexture&&(la().putTexture(this._activeTexture),this._activeTexture=null),this._cache&&(this._cache.dispose(),this._cache=null),this._canvasOffsets=null,this._disposed=!0)}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(t){return this._structure.getPartColor(this._figure,t)}setDirection(t,e){e+=this._directionOffset,e<Jr.MIN_DIRECTION?e=Jr.MAX_DIRECTION+(e+1):e>Jr.MAX_DIRECTION&&(e-=Jr.MAX_DIRECTION+1),this._structure.isMainAvatarSet(t)&&(this._mainDirection=e),(t===ai.HEAD||t===ai.FULL)&&(t===ai.HEAD&&this.isHeadTurnPreventedByAction()&&(e=this._mainDirection),this._headDirection=e),this._cache.setDirection(t,e),this._changes=!0}setDirectionAngle(t,e){this.setDirection(t,Math.floor(e/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(t){return this._structure.getBodyPartData(t.animation.id,this._frameCounter,t.id)}updateAnimationByFrames(t=1){this._frameCounter+=t,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getBodyParts(t,e,s){return(s!==this._cachedBodyPartsDirection||e!==this._cachedBodyPartsGeometryType||t!==this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=e,this._cachedBodyPartsAvatarSet=t,this._cachedBodyParts=this._structure.getBodyParts(t,e,s)),this._cachedBodyParts}buildAvatarContainer(t,e){const s=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection),r=new $r;let n=s.length-1;for(;n>=0;){const o=s[n],l=this._cache.getImageContainer(o,this._frameCounter);if(l){const c=l.image;if(c){const u=new $r;u.addChild(c);const h=l.regPoint.clone();h.x+=t.offset.x,h.y+=t.offset.y,h.x+=t.regPoint.x,h.y+=t.regPoint.y,u.position.set(h.x,h.y),r.addChild(u)}}n--}if(r.filters=[],this._avatarSpriteData&&(this._avatarSpriteData.colorTransform&&(r.filters===void 0||r.filters===null?r.filters=[this._avatarSpriteData.colorTransform]:Array.isArray(r.filters)?r.filters=[...r.filters,this._avatarSpriteData.colorTransform]:r.filters=[r.filters,this._avatarSpriteData.colorTransform]),this._avatarSpriteData.paletteIsGrayscale)){this.convertToGrayscale(r);const o=new S_({palette:this._avatarSpriteData.reds,channel:S_.CHANNEL_RED});r.filters===void 0||r.filters===null?r.filters=[o]:Array.isArray(r.filters)?r.filters=[...r.filters,o]:r.filters=[r.filters,o]}return r}processAsTexture(t,e){if(!this._changes)return this._activeTexture;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const r=this.buildAvatarContainer(s,t);return this._activeTexture&&(this._activeTexture.width!==s.width||this._activeTexture.height!==s.height)&&(la().putTexture(this._activeTexture),this._activeTexture=null),this._activeTexture||(this._activeTexture=la().getTexture(s.width,s.height)),this._activeTexture?(Mr().render({target:this._activeTexture,container:r,clear:!0}),r.destroy(),this._activeTexture.source.hitMap=null,this._changes=!1,this._activeTexture):null}processAsImageUrl(t,e=1){const s=this.processAsTexture(t,!1);return Mr().texture.generateCanvas(s).toDataURL("image/png")}processAsContainer(t){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const e=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);return e?this.buildAvatarContainer(e,t):null}applyPalette(t,e=[],s=[],r=[]){const n=me.generateCanvas(t),o=n.getContext("2d"),l=o.getImageData(0,0,n.width,n.height),c=l.data;for(let h=0;h<c.length;h+=4){if(e.length==256){let d=e[c[h]];d===void 0&&(d=0),c[h]=d>>16&255,c[h+1]=d>>8&255,c[h+2]=d&255}if(s.length==256){let d=s[c[h+1]];d===void 0&&(d=0),c[h]=d>>16&255,c[h+1]=d>>8&255,c[h+2]=d&255}if(r.length==256){let d=s[c[h+2]];d===void 0&&(d=0),c[h]=d>>16&255,c[h+1]=d>>8&255,c[h+2]=d&255}}o.putImageData(l,0,0);const u=new Ve(Es.from(n));return me.writeToTexture(u,t,!0),t}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString=""}endActionAppends(){if(this.sortActions()){for(const t of this._sortedActions)t.actionType===St.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(t.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(t.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(t,...e){let s="";switch(this._actionsSorted=!1,e&&e.length>0&&(s=e[0]),s!=null&&(s=s.toString()),t){case St.POSTURE:switch(s){case St.POSTURE_LAY:case St.POSTURE_WALK:case St.POSTURE_STAND:case St.POSTURE_SWIM:case St.POSTURE_FLOAT:case St.POSTURE_SIT:case St.SNOWWAR_RUN:case St.SNOWWAR_DIE_FRONT:case St.SNOWWAR_DIE_BACK:case St.SNOWWAR_PICK:case St.SNOWWAR_THROW:(s===St.POSTURE_LAY||s===St.POSTURE_LAY||s===St.POSTURE_LAY)&&s===St.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(ai.FULL,4):this.setDirection(ai.FULL,2)),this.addActionData(s);break}break;case St.GESTURE:switch(s){case St.GESTURE_AGGRAVATED:case St.GESTURE_SAD:case St.GESTURE_SMILE:case St.GESTURE_SURPRISED:this.addActionData(s);break}break;case St.EFFECT:case St.DANCE:case St.TALK:case St.EXPRESSION_WAVE:case St.SLEEP:case St.SIGN:case St.EXPRESSION_RESPECT:case St.EXPRESSION_BLOW_A_KISS:case St.EXPRESSION_LAUGH:case St.EXPRESSION_CRY:case St.EXPRESSION_IDLE:case St.EXPRESSION_SNOWBOARD_OLLIE:case St.EXPRESSION_SNOWBORD_360:case St.EXPRESSION_RIDE_JUMP:this.addActionData(t,s);break;case St.CARRY_OBJECT:case St.USE_OBJECT:{const r=this._structure.getActionDefinitionWithState(t);r&&(s=r.getParameterValue(s)),this.addActionData(t,s);break}}return!0}addActionData(t,e=""){this._actions||(this._actions=[]),this._actions.some(r=>r.actionType===t&&r.actionParameter===e)||this._actions.push(new Rp(t,e,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){if(!this._sortedActions)return!1;for(const t of this._sortedActions){const e=this._structure.getActionDefinitionWithState(t.actionType);if(e!=null&&e.getPreventHeadTurn(t.actionParameter))return!0}return!1}sortActions(){let t=!1,e=!1,s=!1;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(t=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const r of this._sortedActions)if(this._currentActionsString+=r.actionType+r.actionParameter,r.actionType===St.EFFECT){const n=parseInt(r.actionParameter);this._effectIdInUse!==n&&(s=!0),this._effectIdInUse=n,e=!0}e||(this._effectIdInUse>-1&&(s=!0),this._effectIdInUse=-1),s&&this._cache.disposeInactiveActions(),this._lastActionsString!=this._currentActionsString&&(t=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,t}setActionsToParts(){if(!this._sortedActions)return;const t=zt(),e=[];for(const s of this._sortedActions)e.push(s.actionType);for(const s of this._sortedActions)if(s&&s.definition&&s.definition.isAnimation){const r=this._structure.getAnimation(`${s.definition.state}.${s.actionParameter}`);if(r&&r.hasOverriddenActions()){const n=r.overriddenActionNames();if(n)for(const o of n)e.includes(o)&&(s.overridingAction=r.overridingAction(o))}r&&r.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(s&&s.definition&&(s.definition.isAnimation&&s.actionParameter===""&&(s.actionParameter="1"),this.setActionToParts(s,t),s.definition.isAnimation)){this._isAnimating=s.definition.isAnimated(s.actionParameter);const r=this._structure.getAnimation(`${s.definition.state}.${s.actionParameter}`);r&&(this._sprites=[...this._sprites,...r.spriteData],r.hasDirectionData()&&(this._directionOffset=r.directionData.offset),r.hasAvatarData()&&(this._avatarSpriteData=r.avatarData))}}setActionToParts(t,e){!t||!t.definition||t.definition.assetPartDefinition===""||(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.setAction(t,e),this._changes=!0)}resetBodyPartCache(t){!t||t.definition.assetPartDefinition===""||(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.resetBodyPartCache(t),this._changes=!0)}convertToGrayscale(t,e="CHANNELS_EQUAL"){let s=.33,r=.33,n=.33;switch(e){case qs.CHANNELS_UNIQUE:s=.3,r=.59,n=.11;break;case qs.CHANNELS_RED:s=1,r=0,n=0;break;case qs.CHANNELS_GREEN:s=0,r=1,n=0;break;case qs.CHANNELS_BLUE:s=0,r=0,n=1;break;case qs.CHANNELS_DESATURATED:s=.3086,r=.6094,n=.082;break}const o=new Fu;return o.matrix=[s,r,n,0,0,s,r,n,0,0,s,r,n,0,0,0,0,0,1,0],t.filters===void 0||t.filters===null?t.filters=[o]:Array.isArray(t.filters)?t.filters=[...t.filters,o]:t.filters=[t.filters,o],t}isPlaceholder(){return!1}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}resetEffect(t){t===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(t))}};qs.CHANNELS_EQUAL="CHANNELS_EQUAL",qs.CHANNELS_UNIQUE="CHANNELS_UNIQUE",qs.CHANNELS_RED="CHANNELS_RED",qs.CHANNELS_GREEN="CHANNELS_GREEN",qs.CHANNELS_BLUE="CHANNELS_BLUE",qs.CHANNELS_DESATURATED="CHANNELS_DESATURATED",qs.DEFAULT_ACTION="Default",qs.DEFAULT_DIRECTION=2,qs.DEFAULT_AVATAR_SET=ai.FULL;let F_=qs;class d_{constructor(t){this._number=t.number,this._assetPartDefinition=t.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class Dj{constructor(t){if(this._frames=[],t.frames&&t.frames.length>0)for(const e of t.frames){if(!e)continue;this._frames.push(new d_(e));let s=e.repeats||0;if(s>1)for(;--s>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}const vc=class vc{constructor(t){if(this._id=t.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],t.parts&&t.parts.length>0)for(const e of t.parts){if(!e)continue;const s=new Dj(e);this._actionParts.set(e.setType,s),this._frameCount=Math.max(this._frameCount,s.frames.length)}if(t.offsets&&t.offsets.frames&&t.offsets.frames.length>0)for(const e of t.offsets.frames){if(!e)continue;const s=e.id;this._frameCount=Math.max(this._frameCount,s);const r=new Map;if(this._bodyPartOffsets.set(s,r),e.directions&&e.directions.length>0)for(const n of e.directions){if(!n)continue;const o=n.id,l=new Map;if(r.set(o,l),n.bodyParts&&n.bodyParts.length>0)for(const c of n.bodyParts){if(!c)continue;const u=c.id;let h=0,d=0;c.dx!==void 0&&(h=c.dx),c.dy!==void 0&&(d=c.dy),l.set(u,new Qt(h,d))}}if(this._frameIndexes.push(s),e.repeats!==void 0){let n=e.repeats||0;if(n>1)for(;--n>0;)this._frameIndexes.push(s)}}}getPart(t){if(!t)return null;const e=this._actionParts.get(t);return e||null}getFrameBodyPartOffset(t,e,s){const r=e%this._frameIndexes.length,n=this._frameIndexes[r],o=this._bodyPartOffsets.get(n);if(!o)return vc.DEFAULT_OFFSET;const l=o.get(t);if(!l)return vc.DEFAULT_OFFSET;const c=l.get(s);return c||vc.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}};vc.DEFAULT_OFFSET=new Qt(0,0);let Zh=vc;class vj{constructor(){this._actions=new Map}parse(t){if(t&&t.length>0)for(const e of t){if(!e)continue;const s=new Zh(e);this._actions.set(s.id,s)}return!0}appendJSON(t){for(const e of t.action)this._actions.set(e.id,new Zh(e));return!0}getAction(t){const e=this._actions.get(t.id);return e||null}getFrameCount(t){const e=this.getAction(t);return e?e.frameCount:0}}class Pj{constructor(t,e){this._id=t.id,this._width=t.width,this._height=t.height,this._offset=new Qt(t.dx,t.dy),e==hr.LARGE?this._regPoint=new Qt((this._width-64)/2,0):this._regPoint=new Qt((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}class Lj{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._type=t.type,this._index=t.index,this._colorLayerIndex=t.colorindex,this._paletteMapId=-1,this._breed=-1}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class Uj{constructor(t,e){if(!t||!e)throw new Error("invalid_data");this._id=e.id,this._type=t,this._gender=e.gender,this._clubLevel=e.club,this._isColorable=e.colorable,this._isSelectable=e.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=e.preselectable,this._isSellable=e.sellable;for(const s of e.parts){const r=new Lj(s),n=this.getPartIndex(r);n!==-1?this._parts.splice(n,0,r):this._parts.push(r)}if(e.hiddenLayers)for(const s of e.hiddenLayers)this._hiddenLayers.push(s.partType)}dispose(){this._parts=null,this._hiddenLayers=null}getPartIndex(t){const e=this._parts.length;if(!e)return-1;for(let s=0;s<e;s++){const r=this._parts[s];if(r&&!(r.type!==t.type||r.index>t.index))return s}return-1}getPart(t,e){for(const s of this._parts)if(!(s.type!==t||s.id!==e))return s;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class jj{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._index=t.index,this._clubLevel=t.club||0,this._isSelectable=t.selectable,this._rgb=parseInt("0x"+t.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class KO{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._colors=new Is,this.append(t)}append(t){for(const e of t.colors){const s=new jj(e);this._colors.add(e.id.toString(),s)}}getColor(t){return t===void 0||t<0?null:this._colors.getValue(t.toString())||null}get id(){return this._id}get colors(){return this._colors}}class _E{constructor(t){if(!t)throw new Error("invalid_data");this._type=t.type,this._paletteId=t.paletteId,this._isMandatory={},this._isMandatory.F=[t.mandatory_f_0,t.mandatory_f_1],this._isMandatory.M=[t.mandatory_m_0,t.mandatory_m_1],this._partSets=new Is,this.append(t)}dispose(){for(const t of this._partSets.getValues())t.dispose();this._partSets=null}cleanUp(t){for(const e of t.sets){const s=e.id.toString(),r=this._partSets.getValue(s);r&&(r.dispose(),this._partSets.remove(s))}}append(t){if(!(!t||!t.sets))for(const e of t.sets)this._partSets.add(e.id.toString(),new Uj(this._type,e))}getDefaultPartSet(t){for(const e of this._partSets.getValues())if(e&&e.clubLevel===0&&(e.gender===t||e.gender==="U"))return e;return null}getPartSet(t){return this._partSets.getValue(t.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(t,e){return this._isMandatory[t.toUpperCase()][Math.min(e,1)]}optionalFromClubLevel(t){return this._isMandatory[t.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class wj{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(t){if(!t)return!1;for(const e of t.palettes){const s=new KO(e);s&&this._palettes.set(s.id.toString(),s)}for(const e of t.setTypes){const s=new _E(e);s&&this._setTypes.set(s.type,s)}return!0}injectJSON(t){for(const e of t.setTypes){const s=this._setTypes.get(e.type);s?s.cleanUp(e):this._setTypes.set(e.type,new _E(e))}this.appendJSON(t)}appendJSON(t){if(!t)return!1;for(const e of t.palettes){const s=e.id.toString(),r=this._palettes.get(s);r?r.append(e):this._palettes.set(s,new KO(e))}for(const e of t.setTypes){const s=e.type,r=this._setTypes.get(s);r?r.append(e):this._setTypes.set(s,new _E(e))}return!1}getMandatorySetTypeIds(t,e){const s=[];for(const r of this._setTypes.values())!r||!r.isMandatory(t,e)||s.push(r.type);return s}getDefaultPartSet(t,e){const s=this._setTypes.get(t);return s?s.getDefaultPartSet(e):null}getSetType(t){return this._setTypes.get(t)||null}getPalette(t){return this._palettes.get(t.toString())||null}getFigurePartSet(t){for(const e of this._setTypes.values()){const s=e.getPartSet(t);if(s)return s}return null}}class XO{constructor(t){if(this._id=t.id,this._parts=[],t.activeParts&&t.activeParts.length>0)for(const e of t.activeParts)e&&this._parts.push(e.setType)}get parts(){return this._parts}}class gE{constructor(t){if(!t)throw new Error("invalid_data");this._setType=t.setType,this._flippedSetType=t.flippedSetType||null,this._removeSetType=t.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(t){this._staticId=t}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(t){this._flippedSetType=t}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(t){this._appendToFigure=t}}class Fj{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new gE(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new XO(e));return!0}appendJSON(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new gE(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new XO(e));return!1}getActiveParts(t){const e=this._activePartSets.get(t.activePartSet);return e?e.parts:[]}getPartDefinition(t){const e=this._parts.get(t);return e||null}addPartDefinition(t){const e=t.setType;let s=this._parts.get(e);return s||(s=new gE(t),this._parts.set(e,s)),s}getActivePartSet(t){const e=this._activePartSets.get(t.activePartSet);return e||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class fE{constructor(t,e,s,r,n,o,l,c,u="",h=!1,d=1){this._bodyPartId=t,this._partType=e,this._partId=s,this._color=r,this._frames=n,this._action=o,this._isColorable=l,this._paletteMapId=c,this._flippedPartType=u,this._isBlendable=h,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(t){if(!this._frames||!this._frames.length)return 0;const e=t%this._frames.length;return this._frames[e]instanceof d_?this._frames[e].number:e}getFrameDefinition(t){const e=t%this._frames.length;return this._frames&&this._frames.length>e&&this._frames[e]instanceof d_?this._frames[e]:null}getCacheableKey(t){const e=t%this._frames.length;if(this._frames&&this._frames.length>e&&this._frames[e]instanceof d_){const s=this._frames[e];return this.partId+":"+s.assetPartDefinition+":"+s.number}return this.partId+":"+e}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(t){this._isColorable=t}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}class ER{constructor(t){if(this._id=t.id,this._isMain=t.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],t.avatarSets&&t.avatarSets.length>0)for(const s of t.avatarSets){if(!s)continue;const r=new ER(s);this._avatarSets.set(r.id,r)}if(t.bodyParts&&t.bodyParts.length>0)for(const s of t.bodyParts)s&&this._bodyParts.push(s.id);let e=this._bodyParts.concat();for(const s of this._avatarSets.values())s&&(e=e.concat(s.getBodyParts()));this._allBodyParts=e}findAvatarSet(t){if(t===this._id)return this;for(const e of this._avatarSets.values())if(e&&e.findAvatarSet(t))return e;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const t of this._avatarSets.values())if(t&&t.isMain)return!0;return!1}}class qO extends GN{constructor(t,e=!1){super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._normal=new w(parseFloat(t.nx),parseFloat(t.ny),parseFloat(t.nz)),this._isDoubleSided=t.double||!1,this._isDynamic=e}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return`${this._id}: ${this.location.toString()} - ${this.transformedLocation.toString()}`}get isDynamic(){return this._isDynamic}}class Gj extends GN{constructor(t){if(super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._parts=new Map,this._dynamicParts=new Map,t.items&&t.items.length>0)for(const e of t.items){if(!e)continue;const s=new qO(e);this._parts.set(s.id,s)}}getDynamicParts(t){const e=this._dynamicParts.get(t),s=[];if(e)for(const r in e){const n=e[r];n&&s.push(n)}return s}getPartIds(t){const e=[];for(const s of this._parts.values())s&&e.push(s.id);if(t){const s=this._dynamicParts.get(t);if(s)for(const r in s){const n=s[r];n&&e.push(n.id)}}return e}removeDynamicParts(t){return this._dynamicParts.delete(t),!0}addPart(t,e){if(this.hasPart(t.id,e))return!1;let s=this._dynamicParts.get(e);return s||(s={},this._dynamicParts.set(e,s)),s[t.id]=new qO(t,!0),!0}hasPart(t,e){let s=this._parts.get(t)||null;return!s&&this._dynamicParts.get(e)!==void 0&&(s=this._dynamicParts.get(e)[t]||null),s!==null}getParts(t,e,s,r){const n=[];for(const c of this._parts.values())c&&(c.applyTransform(t),n.push([c.getDistance(e),c]));const o=this._dynamicParts.get(r);if(o)for(const c in o){const u=o[c];u&&(u.applyTransform(t),n.push([u.getDistance(e),u]))}n.sort((c,u)=>{const h=c[0],d=u[0];return h<d?-1:h>d?1:0});const l=[];for(const c of n)c&&l.push(c[1].id);return l}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get radius(){return this._radius}}class kj{constructor(t){this._camera=new w(0,0,10),this._avatarSet=new ER(t.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new Bu,this._canvases=new Map;const e=t.camera;if(e&&(this._camera.x=parseFloat(e.x),this._camera.y=parseFloat(e.y),this._camera.z=parseFloat(e.z)),t.canvases&&t.canvases.length>0)for(const s of t.canvases){if(!s)continue;const r=s.scale,n=new Map;if(s.geometries&&s.geometries.length>0)for(const o of s.geometries){if(!o)continue;const l=new Pj(o,r);n.set(l.id,l)}this._canvases.set(r,n)}if(t.types&&t.types.length>0)for(const s of t.types){if(!s)continue;const r=new Map,n=new Map;if(s.bodyParts&&s.bodyParts.length>0)for(const o of s.bodyParts){if(!o)continue;const l=new Gj(o);r.set(l.id,l);for(const c of l.getPartIds(null))n.set(c,l)}this._geometryTypes.set(s.id,r),this._itemIdToBodyPartMap.set(s.id,n)}}removeDynamicItems(t){for(const e of this._geometryTypes.values())if(e)for(const s of e.values())s&&s.removeDynamicParts(t)}getBodyPartIdsInAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.getBodyParts():[]}isMainAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.isMain:!1}getCanvas(t,e){const s=this._canvases.get(t);return s&&s.get(e)||null}typeExists(t){return!!this._geometryTypes.get(t)}hasBodyPart(t,e){if(this.typeExists(t)){const s=this._geometryTypes.get(t);if(s&&s.get(e))return!0}return!1}getBodyPartIDs(t){const e=this.getBodyPartsOfType(t),s=[];if(e)for(const r of e.values())r&&s.push(r.id);return s}getBodyPartsOfType(t){return this.typeExists(t)?this._geometryTypes.get(t):new Map}getBodyPart(t,e){return this.getBodyPartsOfType(t).get(e)||null}getBodyPartOfItem(t,e,s){const r=this._itemIdToBodyPartMap.get(t);if(r){const n=r.get(e);if(n)return n;const o=this.getBodyPartsOfType(t);if(o){for(const l of o.values())if(l&&l.hasPart(e,s))return l}}return null}getBodyPartsInAvatarSet(t,e){const s=this.getBodyPartIdsInAvatarSet(e),r=[];for(const n of s){if(!n)continue;const o=t.get(n);o&&r.push(o)}return r}getBodyPartsAtAngle(t,e,s){if(!s)return[];const r=this.getBodyPartsOfType(s),n=this.getBodyPartsInAvatarSet(r,t),o=[],l=[];this._transformation=Bu.getYRotationMatrix(e);for(const c of n.values())c&&(c.applyTransform(this._transformation),o.push([c.getDistance(this._camera),c]));o.sort((c,u)=>{const h=c[0],d=u[0];return h<d?-1:h>d?1:0});for(const c of o)c&&l.push(c[1].id);return l}getParts(t,e,s,r,n){if(this.hasBodyPart(t,e)){const o=this.getBodyPartsOfType(t).get(e);return this._transformation=Bu.getYRotationMatrix(s),o.getParts(this._transformation,this._camera,r,n)}return[]}}class Bj{constructor(t){this._renderManager=t,this._geometry=null,this._figureData=new wj,this._partSetsData=new Fj,this._animationData=new vj,this._animationManager=new Mj,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}initGeometry(t){t&&(this._geometry=new kj(t))}initActions(t,e){e&&(this._actionManager=new Sj(t,e),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(t){this._actionManager.updateActions(t),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(t){return t&&this._partSetsData.parse(t)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(t){return t?this._animationData.parse(t):!1}initFigureData(t){return t?this._figureData.parse(t):!1}injectFigureData(t){this._figureData.injectJSON(t)}registerAnimations(t,e="fx",s=200){let r=0;for(;r<s;){const n=t.getCollection(e+r);if(n){const o=n.data;this._animationManager.registerAnimation(this,o.animations)}r++}}registerAnimation(t){this._animationManager.registerAnimation(this,t)}getPartColor(t,e,s=0){const r=t.getPartColorIds(e);if(!r||r.length<s)return null;const n=this._figureData.getSetType(e);if(n==null)return null;const o=this._figureData.getPalette(n.paletteID);return o?o.getColor(r[s]):null}getBodyPartData(t,e,s){return this._animationManager.getLayerData(t,e,s)}getAnimation(t){return this._animationManager.getAnimation(t)}getActionDefinition(t){return this._actionManager.getActionDefinition(t)}getActionDefinitionWithState(t){return this._actionManager.getActionDefinitionWithState(t)}isMainAvatarSet(t){return this._geometry.isMainAvatarSet(t)}sortActions(t){return this._actionManager.sortActions(t)}maxFrames(t){let e=0;for(const s of t)e=Math.max(e,this._animationData.getFrameCount(s.definition));return e}getMandatorySetTypeIds(t,e){return this._mandatorySetTypeIds[t]||(this._mandatorySetTypeIds[t]=[]),this._mandatorySetTypeIds[t][e]?this._mandatorySetTypeIds[t][e]:(this._mandatorySetTypeIds[t][e]=this._figureData.getMandatorySetTypeIds(t,e),this._mandatorySetTypeIds[t][e])}getDefaultPartSet(t,e){return this._figureData.getDefaultPartSet(t,e)}getCanvasOffsets(t,e,s){return this._actionManager.getCanvasOffsets(t,e,s)}getCanvas(t,e){return this._geometry.getCanvas(t,e)}removeDynamicItems(t){this._geometry.removeDynamicItems(t)}getActiveBodyPartIds(t,e){let s=[];const r=[],n=t.definition.geometryType;if(t.definition.isAnimation){const o=t.definition.state+"."+t.actionParameter,l=this._animationManager.getAnimation(o);if(l&&(s=l.getAnimatedBodyPartIds(0,t.overridingAction),l.hasAddData())){const c={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},u={setType:""};for(const h of l.addData){const d=this._geometry.getBodyPart(n,h.align);if(d){c.id=h.id,d.addPart(c,e),u.setType=h.id;const f=this._partSetsData.addPartDefinition(u);f.appendToFigure=!0,h.base===""&&(f.staticId=1),r.indexOf(d.id)===-1&&r.push(d.id)}}}for(const c of s){const u=this._geometry.getBodyPart(n,c);u&&r.indexOf(u.id)===-1&&r.push(u.id)}}else{s=this._partSetsData.getActiveParts(t.definition);for(const o of s){const l=this._geometry.getBodyPartOfItem(n,o,e);l&&r.indexOf(l.id)===-1&&r.push(l.id)}}return r}getBodyPartsUnordered(t){return this._geometry.getBodyPartIdsInAvatarSet(t)}getBodyParts(t,e,s){const r=Jr.DIRECTION_TO_ANGLE[s];return this._geometry.getBodyPartsAtAngle(t,r,e)}getFrameBodyPartOffset(t,e,s,r){const n=this._animationData.getAction(t.definition);return n?n.getFrameBodyPartOffset(e,s,r):Zh.DEFAULT_OFFSET}getParts(t,e,s,r,n,o,l,c=null){let u=null,h=[],d=null;if(!s)return[];const f=this._partSetsData.getActiveParts(s.definition),E=[];let m=[0];const I=this._animationData.getAction(s.definition);if(s.definition.isAnimation){const S=s.definition.state+"."+s.actionParameter,L=this._animationManager.getAnimation(S);if(L){m=this.getPopulatedArray(L.frameCount(s.overridingAction));for(const M of L.getAnimatedBodyPartIds(0,s.overridingAction))if(M===t){const P=this._geometry.getBodyPart(r,M);if(P)for(const k of P.getDynamicParts(l))f.push(k.id)}}}const p=this._geometry.getParts(r,t,n,f,l),T=e.getPartTypeIds();for(const S of T){if(c&&c.get(S))continue;const L=e.getPartSetId(S),M=e.getPartColorIds(S),P=this._figureData.getSetType(S);if(P){const k=this._figureData.getPalette(P.paletteID);if(k){const G=P.getPartSet(L);if(G){o=o.concat(G.hiddenLayers);for(const j of G.parts)if(p.indexOf(j.type)>-1){if(I){const J=I.getPart(j.type);J?h=J.frames:h=m}else h=m;u=s.definition,f.indexOf(j.type)===-1&&(u=this._defaultAction);const F=this._partSetsData.getPartDefinition(j.type);let U=F?F.flippedSetType:j.type;(!U||U==="")&&(U=j.type),M&&M.length>j.colorLayerIndex-1&&(d=k.getColor(M[j.colorLayerIndex-1]));const K=j.colorLayerIndex>0,B=new fE(t,j.type,j.id.toString(),d,h,u,K,j.paletteMap,U);E.push(B)}}}}}const R=[];for(const S of p){let L=null,M=!1;const P=c&&c.get(S);for(const k of E)k.partType===S&&(P?L=k.color:(M=!0,o.indexOf(S)===-1&&R.push(k)));if(!M){if(P){const k=c.get(S);let G=0,j=0;for(;j<k.length;)G=G+k.charCodeAt(j),j++;if(I){const U=I.getPart(S);U?h=U.frames:h=m}else h=m;const F=new fE(t,S,k,L,h,s.definition,L!=null,-1,S,!1,1);R.push(F)}else if(f.indexOf(S)>-1){const k=this._geometry.getBodyPartOfItem(r,S,l);if(t===k.id){const G=this._partSetsData.getPartDefinition(S);let j=!1,F=1;if(G.appendToFigure){let U="1";if(s.actionParameter!==""&&(U=s.actionParameter),G.hasStaticId()&&(U=G.staticId.toString()),I){const B=I.getPart(S);B?h=B.frames:h=m}else h=m;const K=new fE(t,S,U,null,h,s.definition,!1,-1,S,j,F);R.push(K)}}}}}return R}getPopulatedArray(t){const e=[];let s=0;for(;s<t;)e.push(s),s++;return e}getItemIds(){if(this._actionManager){const t=this._actionManager.getActionDefinition("CarryItem").params,e=[];for(const s of t.values())e.push(s);return e}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const wr=class wr{constructor(t,e,s,r){this._state=wr.NOT_LOADED,this._animation=null,this._libraryName=t,this._revision=e,this._downloadUrl=s,this._assetManager=r,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this.checkIsLoaded()}async downloadAsset(){if(!(!this._assetManager||this._state===wr.LOADING||this._state===wr.LOADED)){if(!this.checkIsLoaded()&&(this._state=wr.LOADING,!await this._assetManager.downloadAsset(this._downloadUrl)))throw new Error("Could not download asset");this.checkIsLoaded()&&X().dispatchEvent(new op(vi.AVATAR_EFFECT_DOWNLOADED,this))}}checkIsLoaded(){const t=this._assetManager.getCollection(this._libraryName);return t?(this._state=wr.LOADED,this._animation=t.data.animations,!0):!1}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===wr.LOADED}};wr.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE",wr.NOT_LOADED=0,wr.LOADING=1,wr.LOADED=2;let Ap=wr;class Vj{constructor(t,e){this._missingMandatoryLibs=[],this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._currentDownloads=[],this._libraryNames=[],this._assets=t,this._structure=e}async init(){this._missingMandatoryLibs=jt().getValue("avatar.mandatory.effect.libraries");const t=jt().getValue("avatar.effectmap.url");if(!t||!t.length)throw new Error("Invalid effect map url");const e=await fetch(t);if(e.status!==200)throw new Error("Invalid effect map file");const s=await e.json();this.processEffectMap(s.effects),X().addEventListener(vi.AVATAR_EFFECT_DOWNLOADED,r=>this.onLibraryLoaded(r)),await this.processMissingLibraries()}processEffectMap(t){if(!t)return;const e=jt().getValue("avatar.asset.effect.url");for(const s of t){if(!s)continue;const r=s.id,n=s.lib,o=s.revision||"";if(this._libraryNames.indexOf(n)>=0)continue;this._libraryNames.push(n);const l=new Ap(n,o,e,this._assets);let c=this._effectMap.get(r);c||(c=[]),c.push(l),this._effectMap.set(r,c)}}async processMissingLibraries(){const t=[];this._missingMandatoryLibs.forEach(e=>{const s=this._effectMap.get(e);if(s)for(const r of s)t.push(r.downloadAsset())}),this._missingMandatoryLibs=[],await Promise.all(t)}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];this._structure.registerAnimation(t.library.animation);for(const[r,n]of this._incompleteEffects.entries()){let o=!0;for(const l of n)if(!(!l||l.isLoaded)){o=!1;break}if(o){e.push(r);const l=this._effectListeners.get(r);for(const c of l)!c||c.disposed||c.resetEffect(parseInt(r));this._effectListeners.delete(r),X().dispatchEvent(new se(vi.AVATAR_EFFECT_LOADED))}}for(const r of e)this._incompleteEffects.delete(r);let s=0;for(;s<this._currentDownloads.length;){const r=this._currentDownloads[s];r&&r.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}isAvatarEffectReady(t){return!this.getAvatarEffectPendingLibraries(t).length}getAvatarEffectPendingLibraries(t){const e=[];if(!this._structure)return e;const s=this._effectMap.get(t.toString());if(s)for(const r of s)!r||r.isLoaded||e.indexOf(r)===-1&&e.push(r);return e}downloadAvatarEffect(t,e){const s=this.getAvatarEffectPendingLibraries(t);if(s&&s.length){if(e&&!e.disposed){let r=this._effectListeners.get(t.toString());r||(r=[]),r.push(e),this._effectListeners.set(t.toString(),r)}this._incompleteEffects.set(t.toString(),s);for(const r of s)r&&r.downloadAsset()}else e&&!e.disposed&&e.resetEffect(t)}}const Wt=class Wt{constructor(){this._gender="M",this._avatarEffectType=-1}loadAvatarData(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(t)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(t){if(t)for(const e of t.split(".")){const s=e.split("-");if(s.length>0){const r=s[0],n=parseInt(s[1]),o=[];let l=2;for(;l<s.length;)o.push(parseInt(s[l])),l++;o.length||o.push(0),this.savePartSetId(r,n,!1),this.savePartSetColourId(r,o,!1)}}}hasSetType(t){return!!this._data.get(t)}getPartSetId(t){return this.hasSetType(t)?this._data.get(t):-1}getColourIds(t){return this._colors.get(t)?this._colors.get(t):[]}getFigureString(){let t="";const e=[];for(const[r,n]of this._data.entries()){let o=r+"-"+n;const l=this._colors.get(r);if(l)for(const c of l)o=o+("-"+c);e.push(o)}let s=0;for(;s<e.length;)t=t+e[s],s<e.length-1&&(t=t+"."),s++;return t}savePartData(t,e,s,r=!1){this.savePartSetId(t,e,r),this.savePartSetColourId(t,s,r)}savePartSetId(t,e,s=!0){switch(t){case Wt.HD:case Wt.HAIR:case Wt.HAT:case Wt.HEAD_ACCESSORIES:case Wt.EYE_ACCESSORIES:case Wt.FACE_ACCESSORIES:case Wt.SHIRT:case Wt.JACKET:case Wt.CHEST_ACCESSORIES:case Wt.CHEST_PRINTS:case Wt.TROUSERS:case Wt.SHOES:case Wt.TROUSER_ACCESSORIES:e>=0?this._data.set(t,e):this._data.delete(t)}}savePartSetColourId(t,e,s=!0){switch(t){case Wt.HD:case Wt.HAIR:case Wt.HAT:case Wt.HEAD_ACCESSORIES:case Wt.EYE_ACCESSORIES:case Wt.FACE_ACCESSORIES:case Wt.SHIRT:case Wt.JACKET:case Wt.CHEST_ACCESSORIES:case Wt.CHEST_PRINTS:case Wt.TROUSERS:case Wt.SHOES:case Wt.TROUSER_ACCESSORIES:this._colors.set(t,e);return}}getFigureStringWithFace(t){const e=[Wt.HD];let s="";const r=[];for(const o of e){const l=this._colors.get(o);if(l){let c=this._data.get(o);o===Wt.HD&&(c=t);let u=o+"-"+c;if(c>=0){let h=0;for(;h<l.length;)u=u+("-"+l[h]),h++}r.push(u)}}let n=0;for(;n<r.length;)s=s+r[n],n<r.length-1&&(s=s+"."),n++;return s}get gender(){return this._gender}};Wt.MALE="M",Wt.FEMALE="F",Wt.UNISEX="U",Wt.SCALE="h",Wt.STD="std",Wt.DEFAULT_FRAME="0",Wt.HD="hd",Wt.HAIR="hr",Wt.HAT="ha",Wt.HEAD_ACCESSORIES="he",Wt.EYE_ACCESSORIES="ea",Wt.FACE_ACCESSORIES="fa",Wt.JACKET="cc",Wt.SHIRT="ch",Wt.CHEST_ACCESSORIES="ca",Wt.CHEST_PRINTS="cp",Wt.TROUSERS="lg",Wt.SHOES="sh",Wt.TROUSER_ACCESSORIES="wa",Wt.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];let $h=Wt;class Hj extends F_{constructor(t,e,s,r,n){super(t,e,s,r,n,null)}isPlaceholder(){return!0}}class Wj{constructor(t,e){this._name=t,this._link=e.link,this._flipH=e.flipH,this._flipV=e.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class Yj{constructor(t,e){this._avatarRenderManager=t,this._aliases=new Map,this._assets=e,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const t of this._assets.collections.values()){if(!t)continue;const e=t.data&&t.data.aliases;if(e)for(const s in e){const r=e[s];r&&this._aliases.set(s,new Wj(s,r))}}}hasAlias(t){return!!this._aliases.get(t)}getAssetName(t){let e=t,s=5;for(;this.hasAlias(e)&&s>=0;)e=this._aliases.get(e).link,s--;return e}getAsset(t){if(!this._assets)return null;t=this.getAssetName(t);const e=this._assets.getAsset(t);return e||null}}const zj={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},Kj={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},Xj={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}},Gf=class Gf{constructor(){this._structure=new Bj(this),this._aliasCollection=new Yj(this,ae()),this._avatarAssetDownloadManager=new Ij(ae(),this._structure),this._effectAssetDownloadManager=new Vj(ae(),this._structure),this._placeHolderFigure=new Hu(Gf.DEFAULT_FIGURE)}async init(){var t,e,s;(t=this._structure)==null||t.initGeometry(Kj.geometry),(e=this._structure)==null||e.initPartSets(Xj.partSets),await this.loadActions(),(s=this._structure)==null||s.initAnimation(zj.animations),await this.loadFigureData(),this._aliasCollection.init(),X().addEventListener(vi.AVATAR_ASSET_LOADED,()=>this._aliasCollection.reset()),X().addEventListener(vi.AVATAR_EFFECT_LOADED,()=>this._aliasCollection.reset()),await this._avatarAssetDownloadManager.init(),await this._effectAssetDownloadManager.init()}async loadActions(){const t=jt().getValue("avatar.default.actions");t&&this._structure.initActions(ae(),t);const e=jt().getValue("avatar.actions.url");if(!e||!e.length)throw new Error("Invalid avatar action url");const s=await fetch(e);if(s.status!==200)throw new Error("Invalid avatar action file");this._structure.updateActions(await s.json())}async loadFigureData(){var r;const t=jt().getValue("avatar.default.figuredata");t&&((r=this._structure)==null||r.initFigureData(t));const e=jt().getValue("avatar.figuredata.url");if(!e||!e.length)throw new Error("Invalid figure data url");const s=await fetch(e);if(s.status!==200)throw new Error("Invalid figure data file");this._structure.figureData.appendJSON(await s.json()),this._structure.init()}createFigureContainer(t){return new Hu(t)}isFigureContainerReady(t){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(t):!1}createAvatarImage(t,e,s,r=null,n=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const o=new Hu(t);return s&&this.validateAvatarFigure(o,s),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(o)?new F_(this._structure,this._aliasCollection,o,e,this._effectAssetDownloadManager,n):(this._avatarAssetDownloadManager.downloadAvatarFigure(o,r),new Hj(this._structure,this._aliasCollection,this._placeHolderFigure,e,this._effectAssetDownloadManager))}downloadAvatarFigure(t,e){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(t,e)}validateAvatarFigure(t,e){let s=!1;const r=this._structure.getMandatorySetTypeIds(e,2);if(r){const n=this._structure.figureData;for(const o of r)if(t.hasPartType(o)){const l=n.getSetType(o);if(l&&!l.getPartSet(t.getPartSetId(o))){const u=this._structure.getDefaultPartSet(o,e);u&&(t.updatePart(o,u.id,[0]),s=!0)}}else{const l=this._structure.getDefaultPartSet(o,e);l&&(t.updatePart(o,l.id,[0]),s=!0)}}return!s}getFigureClubLevel(t,e,s=null){if(!this._structure)return 0;const r=this._structure.figureData,n=Array.from(t.getPartTypeIds());let o=0;for(const l of n){const c=r.getSetType(l);if(!c)continue;const u=t.getPartSetId(l),h=c.getPartSet(u);if(h){o=Math.max(h.clubLevel,o);const d=r.getPalette(c.paletteID),f=t.getPartColorIds(l);for(const E of f){const m=d.getColor(E);m&&(o=Math.max(m.clubLevel,o))}}}s||(s=this._structure.getBodyPartsUnordered(ai.FULL));for(const l of s){const c=r.getSetType(l);c&&n.indexOf(l)===-1&&(o=Math.max(c.optionalFromClubLevel(e),o))}return o}isValidFigureSetForGender(t,e){const r=this.structureData.getFigurePartSet(t);return!!(r&&(r.gender.toUpperCase()==="U"||r.gender.toUpperCase()===e.toUpperCase()))}getFigureStringWithFigureIds(t,e,s){const r=new $h;r.loadAvatarData(t,e);const n=this.resolveFigureSets(s);for(const o of n)r.savePartData(o.type,o.id,r.getColourIds(o.type));return r.getFigureString()}resolveFigureSets(t){const e=this.structureData,s=[];for(const r of t){const n=e.getFigurePartSet(r);n&&s.push(n)}return s}getMandatoryAvatarPartSetIds(t,e){return this._structure?this._structure.getMandatorySetTypeIds(t,e):null}getAssetByName(t){return this._aliasCollection.getAsset(t)}get assets(){return ae()}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}};Gf.DEFAULT_FIGURE="hd-99999-99999";let Np=Gf;const qj=new Np,is=()=>qj;class Qj{constructor(t,e=-1,s=null,r=null,n=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=t,this._minLevel=e,this._texture=s,this._colorMatrix=r,this._blendMode=n}get name(){return this._name}get texture(){return this._texture}set texture(t){this._texture=t}get colorMatrix(){return this._colorMatrix}set colorMatrix(t){this._colorMatrix=t}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t}get minLevel(){return this._minLevel}}class Jj{constructor(){this._effects=new Map,this._isLoaded=!1}async init(){if(this._isLoaded)return;this._isLoaded=!0;const t=jt().getValue("image.library.url")+"Habbo-Stories/",e=jt().getValue("camera.available.effects");for(const s of e){if(!s.enabled)continue;const r=new Qj(s.name,s.minLevel);if(s.colorMatrix.length)r.colorMatrix=s.colorMatrix;else{const n=`${t}${s.name}.png`;await ae().downloadAsset(n),r.texture=ae().getTexture(n),r.blendMode=s.blendMode}this._effects.set(r.name,r)}X().dispatchEvent(new Xh(Xh.INITIALIZED))}async applyEffects(t,e,s){const r=new $r,n=new Ve(t);r.addChild(n),s&&n.scale.set(2);const o=[],l=(c,u,h)=>{const d=new Fu;if(u)d.matrix=c;else{const f=[],E=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];for(let m=0;m<c.length;m++)f.push(c[m]*h+E[m]*(1-h));d.matrix=f}return d};for(const c of e){const u=c.effect;if(u)if(u.colorMatrix){const h=l(u.colorMatrix,!1,c.strength);o.push(h)}else{const h=new Ve(u.texture);h.alpha=c.strength,h.blendMode=u.blendMode,r.addChild(h)}}return r.filters=o,await me.generateImage(n)}get effects(){return this._effects}get isLoaded(){return this._isLoaded}}const Zj=new Jj,au=()=>Zj;class mE{constructor(t,e){this._effect=t,this._strength=e}get effect(){return this._effect}get strength(){return this._strength}}class $j{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(t){for(const[e,s]of t.events)this.registerMessageEventClass(e,s);for(const[e,s]of t.composers)this.registerMessageComposerClass(e,s)}registerMessageEventClass(t,e){!t||!e||this._messageIdByEvent.set(e,t)}registerMessageComposerClass(t,e){!t||!e||this._messageIdByComposer.set(e,t)}registerMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;let s=this._messageInstancesById.get(e);(!s||!s.length)&&(s=[],this._messageInstancesById.set(e,s)),s.push(t)}removeMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;const s=this._messageInstancesById.get(e);if(s){for(const[r,n]of s.entries())if(n&&n===t){s.splice(r,1),s.length===0&&this._messageInstancesById.delete(e),n.dispose();return}}}getEvents(t){if(!t)return;const e=this._messageInstancesById.get(t);if(e)return e}getEventId(t){if(!t)return-1;const e=t instanceof D?t.constructor:t,s=this._messageIdByEvent.get(e);return s||-1}getComposerId(t){if(!t)return-1;const e=this._messageIdByComposer.get(t.constructor);return e||-1}}const C=class C{};C.AREA_HIDE=6001,C.ACHIEVEMENT_LIST=305,C.AUTHENTICATED=2491,C.AUTHENTICATION=-1,C.AVAILABILITY_STATUS=2033,C.BUILDERS_CLUB_EXPIRED=1452,C.CLUB_OFFERS=2405,C.CATALOG_PAGE=804,C.CATALOG_PAGE_LIST=1032,C.CATALOG_PURCHASE_OK=869,C.CATALOG_PURCHASE_ERROR=1404,C.CATALOG_PURCHASE_NOT_ALLOWED=3770,C.PRODUCT_OFFER=3388,C.LIMITED_SOLD_OUT=377,C.CATALOG_PUBLISHED=1866,C.CFH_RESULT_MESSAGE=3635,C.CLIENT_LATENCY=10,C.CLIENT_PING=3928,C.DESKTOP_CAMPAIGN=1745,C.DESKTOP_NEWS=286,C.DESKTOP_VIEW=122,C.BUNDLE_DISCOUNT_RULESET=2347,C.FIRST_LOGIN_OF_DAY=793,C.FURNITURE_ALIASES=1723,C.FURNITURE_DATA=2547,C.FURNITURE_FLOOR=1778,C.FURNITURE_FLOOR_ADD=1534,C.FURNITURE_FLOOR_REMOVE=2703,C.FURNITURE_FLOOR_UPDATE=3776,C.FURNITURE_ITEMDATA=2202,C.FURNITURE_STATE=2376,C.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293,C.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366,C.GAME_CENTER_ACHIEVEMENTS=2265,C.GAME_CENTER_GAME_LIST=222,C.GAME_CENTER_STATUS=2893,C.GAME_CENTER_IN_ARENA_QUEUE=872,C.GAME_CENTER_STOP_COUNTER=3191,C.GAME_CENTER_USER_LEFT_GAME=3138,C.GAME_CENTER_DIRECTORY_STATUS=2246,C.GAME_CENTER_STARTING_GAME_FAILED=2142,C.GAME_CENTER_JOINING_FAILED=1730,C.GAMESTATUSMESSAGE=3805,C.GAMEACHIEVEMENTS=1689,C.GAMEINVITE=904,C.JOININGQUEUEFAILED=3035,C.JOINEDQUEUEMESSAGE=2260,C.LEFTQUEUE=1477,C.LOAD_GAME_URL=2624,C.LOADGAME=3654,C.UNLOADGAME=1715,C.ACHIEVEMENTRESOLUTIONCOMPLETED=740,C.ACHIEVEMENTRESOLUTIONPROGRESS=3370,C.ACHIEVEMENTRESOLUTIONS=66,C.GENERIC_ALERT=3801,C.MODERATOR_MESSAGE=2030,C.GENERIC_ERROR=1600,C.GIFT_WRAPPER_CONFIG=2234,C.GROUP_BADGES=2402,C.GROUP_CREATE_OPTIONS=2159,C.GROUP_FORUM_DATA=3011,C.GROUP_FORUM_LIST=3001,C.GROUP_FORUM_THREADS=1073,C.GROUP_FORUM_POST=2049,C.GROUP_FORUM_POST_THREAD=1862,C.GROUP_FORUM_THREAD_MESSAGES=509,C.GROUP_FORUM_UNREAD_COUNT=2379,C.GROUP_FORUM_UPDATE_MESSAGE=324,C.GROUP_FORUM_UPDATE_THREAD=2528,C.GROUP_INFO=1702,C.GROUP_LIST=420,C.GROUP_MEMBER=265,C.GROUP_MEMBERS=1200,C.GROUP_MEMBERS_REFRESH=2445,C.GROUP_MEMBER_REMOVE_CONFIRM=1876,C.GROUP_PURCHASED=2808,C.GROUP_SETTINGS=3965,C.GROUP_BADGE_PARTS=2238,C.GROUP_MEMBERSHIP_REQUESTED=1180,C.GROUP_DETAILS_CHANGED=1459,C.GROUP_HABBO_JOIN_FAILED=762,C.GUILD_EDIT_FAILED=3988,C.GUILD_MEMBER_MGMT_FAILED=818,C.ITEM_DIMMER_SETTINGS=2710,C.ITEM_STACK_HELPER=2816,C.ITEM_WALL=1369,C.ITEM_WALL_ADD=2187,C.ITEM_WALL_REMOVE=3208,C.ITEM_WALL_UPDATE=2009,C.MARKETPLACE_CONFIG=1823,C.MESSENGER_ACCEPT_FRIENDS=896,C.MESSENGER_CHAT=1587,C.MESSENGER_FIND_FRIENDS=1210,C.MESSENGER_FOLLOW_FAILED=3048,C.MESSENGER_FRIEND_NOTIFICATION=3082,C.MESSENGER_FRIENDS=3130,C.MESSENGER_INIT=1605,C.MESSENGER_INSTANCE_MESSAGE_ERROR=3359,C.MESSENGER_INVITE=3870,C.MESSENGER_INVITE_ERROR=462,C.MESSENGER_MESSAGE_ERROR=892,C.MESSENGER_MINIMAIL_COUNT=2803,C.MESSENGER_MINIMAIL_NEW=1911,C.MESSENGER_RELATIONSHIPS=2016,C.MESSENGER_REQUEST=2219,C.MESSENGER_REQUEST_ERROR=892,C.MESSENGER_REQUESTS=280,C.MESSENGER_SEARCH=973,C.MESSENGER_UPDATE=2800,C.MODERATION_REPORT_DISABLED=1651,C.MODERATION_TOOL=2696,C.MODERATION_USER_INFO=2866,C.MOTD_MESSAGES=2035,C.NAVIGATOR_CATEGORIES=1562,C.NAVIGATOR_COLLAPSED=1543,C.NAVIGATOR_EVENT_CATEGORIES=3244,C.NAVIGATOR_LIFTED=3104,C.NAVIGATOR_METADATA=3052,C.NAVIGATOR_OPEN_ROOM_CREATOR=2064,C.NAVIGATOR_SEARCH=2690,C.NAVIGATOR_SEARCHES=3984,C.NAVIGATOR_SETTINGS=518,C.THUMBNAIL_UPDATE_RESULT=1927,C.CAN_CREATE_ROOM=378,C.CATEGORIES_WITH_VISITOR_COUNT=1455,C.COMPETITION_ROOMS_DATA=3954,C.CONVERTED_ROOM_ID=1331,C.GUEST_ROOM_SEARCH_RESULT=52,C.NOTIFICATION_LIST=1992,C.NOTIFICATION_OFFER_REWARD_DELIVERED=2125,C.NOTIFICATION_SIMPLE_ALERT=5100,C.NOTIFICATION_ELEMENT_POINTER=1787,C.PET_FIGURE_UPDATE=1924,C.PET_INFO=2901,C.PET_TRAINING_PANEL=1164,C.PET_LEVEL_UPDATE=2824,C.PET_SCRATCH_FAILED=1130,C.PET_OPEN_PACKAGE_REQUESTED=2380,C.PET_OPEN_PACKAGE_RESULT=546,C.PET_BREEDING=1746,C.PET_CONFIRM_BREEDING_RESULT=1625,C.PET_GO_TO_BREEDING_NEST_FAILURE=2621,C.PET_NEST_BREEDING_SUCCESS=2527,C.PET_CONFIRM_BREEDING_REQUEST=634,C.PET_BREEDING_RESULT=1553,C.RECYCLER_PRIZES=3164,C.RECYCLER_STATUS=3433,C.RECYCLER_FINISHED=468,C.ROOM_BAN_LIST=1869,C.ROOM_BAN_REMOVE=3429,C.ROOM_CREATED=1304,C.ROOM_DOORBELL=2309,C.ROOM_DOORBELL_ACCEPTED=3783,C.ROOM_DOORBELL_REJECTED=878,C.ROOM_ENTER=758,C.ROOM_ENTER_ERROR=899,C.ROOM_FORWARD=160,C.ROOM_HEIGHT_MAP=2753,C.ROOM_HEIGHT_MAP_UPDATE=558,C.ROOM_INFO=687,C.ROOM_INFO_OWNER=749,C.ROOM_MODEL=1301,C.ROOM_MODEL_BLOCKED_TILES=3990,C.ROOM_MODEL_DOOR=1664,C.ROOM_MODEL_NAME=2031,C.ROOM_MUTED=2533,C.ROOM_MUTE_USER=826,C.ROOM_PAINT=2454,C.ROOM_PROMOTION=2274,C.ROOM_QUEUE_STATUS=2208,C.ROOM_RIGHTS=780,C.ROOM_RIGHTS_CLEAR=2392,C.ROOM_RIGHTS_LIST=1284,C.ROOM_RIGHTS_LIST_ADD=2088,C.ROOM_RIGHTS_LIST_REMOVE=1327,C.ROOM_RIGHTS_OWNER=339,C.ROOM_ROLLING=3207,C.ROOM_SCORE=482,C.ROOM_SETTINGS=1498,C.ROOM_SETTINGS_CHAT=1191,C.ROOM_SETTINGS_SAVE=948,C.ROOM_SETTINGS_SAVE_ERROR=1555,C.ROOM_INFO_UPDATED=3297,C.ROOM_SPECTATOR=1033,C.ROOM_THICKNESS=3547,C.ROOM_GET_FILTER_WORDS=2937,C.ROOM_MESSAGE_NOTIFICATION=1634,C.ROOM_POPULAR_TAGS_RESULT=2012,C.INFO_FEED_ENABLE=3284,C.SECURITY_MACHINE=1488,C.MYSTERY_BOX_KEYS=2833,C.GOTMYSTERYBOXPRIZEMESSAGE=3712,C.CANCELMYSTERYBOXWAITMESSAGE=596,C.SHOWMYSTERYBOXWAITMESSAGE=3201,C.TRADE_ACCEPTED=2568,C.TRADE_CLOSED=1373,C.TRADE_COMPLETED=1001,C.TRADE_CONFIRMATION=2720,C.TRADE_LIST_ITEM=2024,C.TRADE_NOT_OPEN=3128,C.TRADE_OPEN=2505,C.TRADE_OPEN_FAILED=217,C.TRADE_OTHER_NOT_ALLOWED=1254,C.TRADE_YOU_NOT_ALLOWED=3058,C.TRADE_NO_SUCH_ITEM=2873,C.UNIT=374,C.UNIT_CHANGE_NAME=2182,C.UNIT_CHAT=1446,C.UNIT_CHAT_SHOUT=1036,C.UNIT_CHAT_WHISPER=2704,C.UNIT_DANCE=2233,C.UNIT_EFFECT=1167,C.UNIT_EXPRESSION=1631,C.UNIT_HAND_ITEM=1474,C.UNIT_IDLE=1797,C.UNIT_INFO=3920,C.UNIT_NUMBER=2324,C.UNIT_REMOVE=2661,C.UNIT_STATUS=1640,C.UNIT_TYPING=1717,C.UNSEEN_ITEMS=2103,C.USER_ACHIEVEMENT_SCORE=1968,C.USER_BADGES=717,C.USER_BADGES_ADD=2493,C.USER_BADGES_CURRENT=1087,C.USER_BOT_REMOVE=233,C.USER_BOTS=3086,C.USER_CHANGE_NAME=118,C.USER_CLOTHING=1450,C.USER_CREDITS=3475,C.USER_CURRENCY=2018,C.ACTIVITY_POINT_NOTIFICATION=2275,C.USER_EFFECTS=340,C.USER_FAVORITE_ROOM=2524,C.USER_FAVORITE_ROOM_COUNT=151,C.USER_FIGURE=2429,C.USER_FURNITURE=994,C.USER_FURNITURE_ADD=104,C.USER_FURNITURE_POSTIT_PLACED=1501,C.USER_FURNITURE_REFRESH=3151,C.USER_FURNITURE_REMOVE=159,C.USER_HOME_ROOM=2875,C.ROOM_EVENT_CANCEL=3479,C.ROOM_EVENT=1840,C.USER_IGNORED=126,C.USER_IGNORED_RESULT=207,C.USER_INFO=2725,C.USER_OUTFITS=3315,C.USER_PERKS=2586,C.USER_PERMISSIONS=411,C.USER_PET_ADD=2101,C.USER_PET_REMOVE=3253,C.USER_PETS=3522,C.USER_PROFILE=3898,C.USER_RESPECT=2815,C.USER_SANCTION_STATUS=3679,C.USER_SETTINGS=513,C.USER_SUBSCRIPTION=954,C.USER_WARDROBE_PAGE=3315,C.USER_CLASSIFICATION=966,C.GET_USER_TAGS=1255,C.WIRED_ACTION=1434,C.WIRED_CONDITION=1108,C.WIRED_ERROR=156,C.WIRED_OPEN=1830,C.WIRED_REWARD=178,C.WIRED_SAVE=1155,C.WIRED_TRIGGER=383,C.PLAYING_GAME=448,C.FURNITURE_STATE_2=3431,C.REMOVE_BOT_FROM_INVENTORY=233,C.ADD_BOT_TO_INVENTORY=1352,C.ACHIEVEMENT_PROGRESSED=2107,C.MODTOOL_ROOM_INFO=1333,C.MODTOOL_USER_CHATLOG=3377,C.MODTOOL_ROOM_CHATLOG=3434,C.MODTOOL_VISITED_ROOMS_USER=1752,C.MODERATOR_ACTION_RESULT=2335,C.ISSUE_DELETED=3192,C.ISSUE_INFO=3609,C.ISSUE_PICK_FAILED=3150,C.CFH_CHATLOG=607,C.MODERATOR_TOOL_PREFERENCES=1576,C.LOVELOCK_FURNI_START=3753,C.LOVELOCK_FURNI_FRIEND_COMFIRMED=382,C.LOVELOCK_FURNI_FINISHED=770,C.GIFT_RECEIVER_NOT_FOUND=1517,C.GIFT_OPENED=56,C.FLOOD_CONTROL=566,C.REMAINING_MUTE=826,C.USER_EFFECT_LIST=340,C.USER_EFFECT_LIST_ADD=2867,C.USER_EFFECT_LIST_REMOVE=2228,C.USER_EFFECT_ACTIVATE=1959,C.AVATAR_EFFECT_SELECTED=3473,C.CLUB_GIFT_INFO=619,C.REDEEM_VOUCHER_ERROR=714,C.REDEEM_VOUCHER_OK=3336,C.IN_CLIENT_LINK=2023,C.BOT_COMMAND_CONFIGURATION=1618,C.BOT_SKILL_LIST_UPDATE=69,C.BOT_FORCE_OPEN_CONTEXT_MENU=296,C.HAND_ITEM_RECEIVED=354,C.PET_PLACING_ERROR=2913,C.BOT_ERROR=639,C.MARKETPLACE_SELL_ITEM=54,C.MARKETPLACE_ITEM_STATS=725,C.MARKETPLACE_OWN_ITEMS=3884,C.MARKETPLACE_CANCEL_SALE=3264,C.MARKETPLACE_ITEM_POSTED=1359,C.MARKETPLACE_ITEMS_SEARCHED=680,C.MARKETPLACE_AFTER_ORDER_STATUS=2032,C.CATALOG_RECEIVE_PET_BREEDS=3331,C.CATALOG_APPROVE_NAME_RESULT=1503,C.OBJECTS_DATA_UPDATE=1453,C.PET_EXPERIENCE=2156,C.COMMUNITY_GOAL_VOTE_EVENT=1435,C.PROMO_ARTICLES=286,C.COMMUNITY_GOAL_EARNED_PRIZES=3319,C.COMMUNITY_GOAL_PROGRESS=2525,C.CONCURRENT_USERS_GOAL_PROGRESS=2737,C.QUEST_DAILY=1878,C.QUEST_CANCELLED=3027,C.QUEST_COMPLETED=949,C.COMMUNITY_GOAL_HALL_OF_FAME=3005,C.EPIC_POPUP=3945,C.SEASONAL_QUESTS=1122,C.QUESTS=3625,C.QUEST=230,C.BONUS_RARE_INFO=1533,C.CRAFTABLE_PRODUCTS=1e3,C.CRAFTING_RECIPE=2774,C.CRAFTING_RECIPES_AVAILABLE=2124,C.CRAFTING_RESULT=618,C.CAMERA_PUBLISH_STATUS=2057,C.CAMERA_PURCHASE_OK=2783,C.CAMERA_STORAGE_URL=3696,C.CAMERA_SNAPSHOT=463,C.COMPETITION_STATUS=133,C.INIT_CAMERA=3878,C.THUMBNAIL_STATUS=3595,C.ACHIEVEMENT_NOTIFICATION=806,C.CLUB_GIFT_NOTIFICATION=2188,C.INTERSTITIAL_MESSAGE=1808,C.ROOM_AD_ERROR=1759,C.AVAILABILITY_TIME=600,C.HOTEL_CLOSED_AND_OPENS=3728,C.HOTEL_CLOSES_AND_OPENS_AT=2771,C.HOTEL_WILL_CLOSE_MINUTES=1050,C.HOTEL_MAINTENANCE=1350,C.JUKEBOX_PLAYLIST_FULL=105,C.JUKEBOX_SONG_DISKS=34,C.NOW_PLAYING=469,C.OFFICIAL_SONG_ID=1381,C.PLAYLIST=1748,C.PLAYLIST_SONG_ADDED=1140,C.TRAX_SONG_INFO=3365,C.USER_SONG_DISKS_INVENTORY=2602,C.CHECK_USER_NAME=563,C.CFH_SANCTION=2782,C.CFH_TOPICS=325,C.CFH_SANCTION_STATUS=2221,C.CAMPAIGN_CALENDAR_DATA=2531,C.CAMPAIGN_CALENDAR_DOOR_OPENED=2551,C.BUILDERS_CLUB_FURNI_COUNT=3828,C.BUILDERS_CLUB_SUBSCRIPTION=1452,C.CATALOG_PAGE_EXPIRATION=2668,C.CATALOG_EARLIEST_EXPIRY=2515,C.CLUB_GIFT_SELECTED=659,C.TARGET_OFFER_NOT_FOUND=1237,C.TARGET_OFFER=119,C.DIRECT_SMS_CLUB_BUY=195,C.ROOM_AD_PURCHASE=2468,C.NOT_ENOUGH_BALANCE=3914,C.LIMITED_OFFER_APPEARING_NEXT=44,C.IS_OFFER_GIFTABLE=761,C.CLUB_EXTENDED_OFFER=3964,C.SEASONAL_CALENDAR_OFFER=1889,C.COMPETITION_ENTRY_SUBMIT=1177,C.COMPETITION_VOTING_INFO=3506,C.COMPETITION_TIMING_CODE=1745,C.COMPETITION_USER_PART_OF=3841,C.COMPETITION_NO_OWNED_ROOMS=2064,C.COMPETITION_SECONDS_UNTIL=3926,C.BADGE_POINT_LIMITS=2501,C.BADGE_REQUEST_FULFILLED=2998,C.HELPER_TALENT_TRACK=3406,C.TALENT_TRACK_LEVEL=1203,C.TALENT_TRACK_LEVEL_UP=638,C.USER_BANNED=1683,C.BOT_RECEIVED=3684,C.PET_LEVEL_NOTIFICATION=859,C.PET_RECEIVED=1111,C.MODERATION_CAUTION=1890,C.YOUTUBE_CONTROL_VIDEO=1554,C.YOUTUBE_DISPLAY_PLAYLISTS=1112,C.YOUTUBE_DISPLAY_VIDEO=1411,C.CFH_DISABLED_NOTIFY=1651,C.QUESTION=2665,C.POLL_CONTENTS=2997,C.POLL_ERROR=662,C.POLL_OFFER=3785,C.POLL_ROOM_RESULT=5201,C.POLL_START_ROOM=5200,C.QUESTION_ANSWERED=2589,C.QUESTION_FINISHED=1066,C.CFH_PENDING_CALLS=1121,C.GUIDE_ON_DUTY_STATUS=1548,C.GUIDE_SESSION_ATTACHED=1591,C.GUIDE_SESSION_DETACHED=138,C.GUIDE_SESSION_ENDED=1456,C.GUIDE_SESSION_ERROR=673,C.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219,C.GUIDE_SESSION_MESSAGE=841,C.GUIDE_SESSION_PARTNER_IS_TYPING=1016,C.GUIDE_SESSION_REQUESTER_ROOM=1847,C.GUIDE_SESSION_STARTED=3209,C.GUIDE_TICKET_CREATION_RESULT=3285,C.GUIDE_TICKET_RESOLUTION=2674,C.GUIDE_REPORTING_STATUS=3463,C.HOTEL_MERGE_NAME_CHANGE=1663,C.ISSUE_CLOSE_NOTIFICATION=934,C.QUIZ_DATA=2927,C.QUIZ_RESULTS=2772,C.CFH_PENDING_CALLS_DELETED=77,C.CFH_REPLY=3796,C.CHAT_REVIEW_SESSION_DETACHED=30,C.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735,C.CHAT_REVIEW_SESSION_RESULTS=3276,C.CHAT_REVIEW_SESSION_STARTED=143,C.CHAT_REVIEW_SESSION_VOTING_STATUS=1829,C.SCR_SEND_KICKBACK_INFO=3277,C.PET_STATUS=1907,C.GROUP_DEACTIVATE=3129,C.PET_RESPECTED=2788,C.PET_SUPPLEMENT=3441,C.NOOBNESS_LEVEL=3738,C.DISCONNECT_REASON=4e3,C.CAN_CREATE_ROOM_EVENT=2599,C.FAVORITE_GROUP_UDPATE=3403,C.NO_SUCH_FLAT=84,C.ROOM_SETTINGS_ERROR=2897,C.SHOW_ENFORCE_ROOM_CATEGORY=3896,C.CUSTOM_USER_NOTIFICATION=909,C.NEW_USER_EXPERIENCE_GIFT_OFFER=3575,C.RESTORE_CLIENT=426,C.FIREWORK_CHARGE_DATA=5210,C.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639,C.CONNECTION_ERROR=1004,C.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243,C.PHONE_COLLECTION_STATE=2890,C.PHONE_TRY_NUMBER_RESULT=800,C.PHONE_TRY_VERIFICATION_CODE_RESULT=91,C.EXTENDED_PROFILE_CHANGED=876,C.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293,C.WELCOME_GIFT_STATUS=2707,C.HANDSHAKE_INIT_DIFFIE=1347,C.HANDSHAKE_COMPLETE_DIFFIE=3885,C.RENTABLE_SPACE_RENT_OK=2046,C.RENTABLE_SPACE_STATUS=3559,C.RENTABLE_SPACE_RENT_FAILED=1868,C.EMAIL_STATUS=612,C.CHANGE_EMAIL_RESULT=1815,C.WEEKLY_GAME_REWARD=2641,C.WEEKLY_GAME_REWARD_WINNERS=3097,C.WEEKLY_COMPETITIVE_LEADERBOARD=3512,C.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560,C.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270,C.WEEKLY_GAME2_LEADERBOARD=2196,C.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35,C.HANDSHAKE_IDENTITY_ACCOUNT=3523;let v=C;class tw{flush(){return this._canShowInterstitial=!1,!0}parse(t){return t?(this._canShowInterstitial=t.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class ew{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._filteredText=t.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class sw{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(t){return t?(this._isOpen=t.readBoolean(),this._onShutdown=t.readBoolean(),t.bytesAvailable&&(this._isAuthenticUser=t.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class iw{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(t){return t?(this._isOpen=t.readInt()>0,this._minutesUntilChange=t.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class rw{flush(){return this._openHour=0,this._openMinute=0,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class nw{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),this._userThrownOutAtClose=t.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class aw{flush(){return this._minutes=0,!0}parse(t){return t?(this._minutes=t.readInt(),!0):!1}get openMinute(){return this._minutes}}class ow{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(t){return t?(this._isInMaintenance=t.readBoolean(),this._minutesUntilMaintenance=t.readInt(),t.bytesAvailable&&(this._duration=t.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class lw{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class cw{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class uw{flush(){return this._figure="",this._gender="",!0}parse(t){return t?(this._figure=t.readString(),this._gender=t.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class hw{constructor(t){this._slotId=t.readInt(),this._figureString=t.readString(),this._gender=t.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class dw{flush(){return this._state=0,this._outfits=[],!0}parse(t){if(!t)return!1;this._state=t.readInt();let e=t.readInt();for(;e>0;)this._outfits.push(new hw(t)),e--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class pR{constructor(t){if(!t)throw new Error("invalid_parser");this._id=t.readInt(),this._name=t.readString(),this._motto=t.readString(),this._gender=t.readString(),this._figure=t.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class _w{flush(){return this._item=null,this._openInventory=!1,!0}parse(t){return t?(this._item=new pR(t),this._openInventory=t.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class gw{flush(){return this._items=null,!0}parse(t){this._items=new Map;let e=t.readInt();for(;e>0;){const s=new pR(t);this._items.set(s.id,s),e--}return!0}get items(){return this._items}}class fw{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(t){return t?(this._boughtAsGift=t.readBoolean(),this._item=new pR(t),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class mw{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class Ew{constructor(t){this._name=t.readString(),this._id=t.readInt(),this._consequence=t.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class pw{constructor(t){this._topics=[],this._name=t.readString();let e=t.readInt();for(;e>0;)this._topics.push(new Ew(t)),e--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class Iw{constructor(t){this._tradeLockInfo="",this._machineBanInfo="",this._name=t.readString(),this._sanctionLengthInHours=t.readInt(),this._probationDays=t.readInt(),this._avatarOnly=t.readBoolean(),t.bytesAvailable&&(this._tradeLockInfo=t.readString()),t.bytesAvailable&&(this._machineBanInfo=t.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class Tw{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(t){return t?(this._issueId=t.readInt(),this._accountId=t.readInt(),this._sanctionType=new Iw(t),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class Rw{flush(){return this._callForHelpCategories=null,!0}parse(t){if(!t)return!1;this._callForHelpCategories=[];let e=t.readInt();for(;e>0;)this._callForHelpCategories.push(new pw(t)),e--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class Sw{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(t){return t?(this._isSanctionNew=t.readBoolean(),this._isSanctionActive=t.readBoolean(),this._sanctionName=t.readString(),this._sanctionLengthHours=t.readInt(),t.readInt(),this._sanctionReason=t.readString(),this._sanctionCreationTime=t.readString(),this._probationHoursLeft=t.readInt(),this._nextSanctionName=t.readString(),this._nextSanctionLengthHours=t.readInt(),t.readInt(),this._hasCustomMute=t.readBoolean(),t.bytesAvailable&&(this._tradeLockExpiryTime=t.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class Ow{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._secondsToWait=t.readInt(),this._ok&&t.bytesAvailable&&(this._extraDataId=t.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class Aw{flush(){return!0}parse(t){return!!t}}class Nw{flush(){return this._roomType=null,this._roomId=-1,!0}parse(t){return t?(this._roomType=t.readString(),this._roomId=t.readInt(),!0):!1}get roomType(){return this._roomType}get roomId(){return this._roomId}}class Cw{flush(){return this._url="",!0}parse(t){return t?(this._url=t.readString(),!0):!1}get url(){return this._url}}class xw{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._errorReason=t.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class yw{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(t){return t?(this._creditPrice=t.readInt(),this._ducketPrice=t.readInt(),t.bytesAvailable&&(this._publishDucketPrice=t.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class Mw{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(t){return t?(t.bytesAvailable&&(this._ok=t.readBoolean(),this._renderLimitHit=t.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class IR{parse(t){if(!t)return!1;this._campaignName=t.readString(),this._campaignImage=t.readString(),this._currentDay=t.readInt(),this._campaignDays=t.readInt(),this._openedDays=[];let e=t.readInt();for(let s=0;s<e;s++)this._openedDays.push(t.readInt());this._missedDays=[],e=t.readInt();for(let s=0;s<e;s++)this._missedDays.push(t.readInt());return!0}clone(){const t=new IR;return t.campaignDays=this._campaignDays,t.campaignImage=this._campaignImage,t.campaignName=this._campaignName,t.currentDay=this._currentDay,t.missedDays=this._missedDays,t.openedDays=this._openedDays,t}get campaignName(){return this._campaignName}set campaignName(t){this._campaignName=t}get campaignImage(){return this._campaignImage}set campaignImage(t){this._campaignImage=t}get currentDay(){return this._currentDay}set currentDay(t){this._currentDay=t}get campaignDays(){return this._campaignDays}set campaignDays(t){this._campaignDays=t}get openedDays(){return this._openedDays}set openedDays(t){this._openedDays=t}get missedDays(){return this._missedDays}set missedDays(t){this._missedDays=t}}class bw{flush(){return this._calendarData=null,!0}parse(t){return t?(this._calendarData=new IR,this._calendarData.parse(t),!0):!1}get calendarData(){return this._calendarData}}class Dw{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(t){return t?(this._doorOpened=t.readBoolean(),this._productName=t.readString(),this._customImage=t.readString(),this._furnitureClassName=t.readString(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class vw{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(t){return t?(this._productType=t.readString(),this._productClassId=t.readInt(),this._totalCoinsForBonus=t.readInt(),this._coinsStillRequiredToBuy=t.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class Pw{flush(){return this._furniCount=0,!0}parse(t){return t?(this._furniCount=t.readInt(),!0):!1}get furniCount(){return this._furniCount}}class Lw{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(t){return t?(this._secondsLeft=t.readInt(),this._furniLimit=t.readInt(),this._maxFurniLimit=t.readInt(),t.bytesAvailable?this._secondsLeftWithGrace=t.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class Uw{constructor(t){this._maxPurchaseSize=t.readInt(),this._bundleSize=t.readInt(),this._bundleDiscountSize=t.readInt(),this._bonusThreshold=t.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let e=t.readInt();for(;e>0;)this._additionalBonusDiscountThresholdQuantities.push(t.readInt()),e--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class jw{flush(){return this._bundleDiscountRuleset=null,!0}parse(t){return t?(this._bundleDiscountRuleset=new Uw(t),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class TR{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(t){if(!t)return!1;this._visible=t.readBoolean(),this._icon=t.readInt(),this._pageId=t.readInt(),this._pageName=t.readString(),this._localization=t.readString();let e=t.readInt();for(;e>0;)this._offerIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._children.push(new TR(t)),s--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class ww{flush(){return this._root=null,!0}parse(t){return t?(this._root=new TR(t),this._newAdditionsAvailable=t.readBoolean(),this._catalogType=t.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class Fw{constructor(t){this._images=[],this._texts=[];let e=t.readInt();for(;e>0;)this._images.push(t.readString()),e--;let s=t.readInt();for(;s>0;)this._texts.push(t.readString()),s--}get images(){return this._images}get texts(){return this._texts}}class Gw{flush(){return this._pageName=null,this._pageId=0,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get pageId(){return this._pageId}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class Wa{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(t){switch(this._productType=t.readString().toUpperCase(),this._productType){case Mo.BADGE:return this._extraParam=t.readString(),this._productCount=1,!0;default:return this._furniClassId=t.readInt(),this._extraParam=t.readString(),this._productCount=t.readInt(),this._uniqueLimitedItem=t.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=t.readInt(),this._uniqueLimitedItemsLeft=t.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}}class Bm{constructor(t){this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean(),this._products=[];let e=t.readInt();for(;e>0;)this._products.push(new Wa(t)),e--;this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),this._isPet=t.readBoolean(),this._previewImage=t.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}const mo=class mo{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(t){if(!t)return!1;switch(this._position=t.readInt(),this._itemName=t.readString(),this._itemPromoImage=t.readString(),this._type=t.readInt(),this._type){case mo.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=t.readString();break;case mo.ITEM_PRODUCT_OFFER:this._productOfferId=t.readInt();break;case mo.ITEM_IAP:this._productCode=t.readString();break}const e=t.readInt();return this._expirationTime=e>0?e*1e3+0:0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}};mo.ITEM_CATALOGUE_PAGE=0,mo.ITEM_PRODUCT_OFFER=1,mo.ITEM_IAP=2;let td=mo;class kw{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(t){if(!t)return!1;this._pageId=t.readInt(),this._catalogType=t.readString(),this._layoutCode=t.readString(),this._localization=new Fw(t);let e=t.readInt();for(;e>0;)this._offers.push(new Bm(t)),e--;if(this._offerId=t.readInt(),this._acceptSeasonCurrencyAsCredits=t.readBoolean(),t.bytesAvailable){let s=t.readInt();for(;s>0;)this._frontPageItems.push(new td(t)),s--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class Bw{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class Vw{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(t){return t?(this._instantlyRefreshCatalogue=t.readBoolean(),t.bytesAvailable&&(this._newFurniDataHash=t.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class Hw{constructor(t){this._offerId=t.readInt(),this._isVip=t.readBoolean(),this._daysRequired=t.readInt(),this._isSelectable=t.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class Ww{flush(){return!0}parse(t){if(!t)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=t.readInt(),this._giftsAvailable=t.readInt();const e=t.readInt();for(let r=0;r<e;r++)this._offers.push(new Bm(t));const s=t.readInt();for(let r=0;r<s;r++){const n=new Hw(t);this._giftData.set(n.offerId,n)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(t){this._giftsAvailable=t}getOfferExtraData(t){return t?this._giftData.get(t):null}get giftData(){return this._giftData}}class Yw{flush(){return this._productCode=null,this._products=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._products.push(new Wa(t)),e--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class BN{constructor(t){if(!t)throw new Error("invalid_wrapper");this._offerId=t.readInt(),this._productCode=t.readString(),t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._vip=t.readBoolean(),this._months=t.readInt(),this._extraDays=t.readInt(),this._giftable=t.readBoolean(),this._daysLeftAfterPurchase=t.readInt(),this._year=t.readInt(),this._month=t.readInt(),this._day=t.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class zw extends BN{constructor(t){super(t),this._originalPrice=t.readInt(),this._originalActivityPointPrice=t.readInt(),this._originalActivityPointType=t.readInt(),this._subscriptionDaysLeft=t.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class Kw{flush(){return this._available=!1,this._pricePointUrl=null,this._market=null,this._lengthInDays=0,!0}parse(t){return t?(this._pricePointUrl=t.readString(),this._pricePointUrl!==""&&(this._available=!0),this._market=t.readString(),this._lengthInDays=t.readInt(),!0):!1}get available(){return this._available}get pricePointUrl(){return this._pricePointUrl}get market(){return this._market}get lengthInDays(){return this._lengthInDays}}class Xw{constructor(t){this._stuffId=t.readInt(),this._charges=t.readInt(),this._SafeStr_6935=t.readInt(),this._SafeStr_6936=t.readInt(),this._SafeStr_6518=t.readInt(),this._SafeStr_7875=t.readInt()}get stuffId(){return this._stuffId}get charges(){return this._charges}get _SafeStr_5946(){return this._SafeStr_6935}get _SafeStr_5944(){return this._SafeStr_6936}get _SafeStr_7876(){return this._SafeStr_7875}get _SafeStr_5945(){return this._SafeStr_6518}}class qw{flush(){return this._fireworkChargeData=null,!0}parse(t){return t?(this._fireworkChargeData=new Xw(t),!0):!1}get fireworkChargeData(){return this._fireworkChargeData}}class Qw{flush(){return!0}parse(t){return!!t}}class Jw{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(t){if(!t)return!1;const e=[],s=[],r=[],n=[];this._isEnabled=t.readBoolean(),this._price=t.readInt();let o=t.readInt(),l=0;for(;l<o;)e.push(t.readInt()),l++;for(o=t.readInt(),l=0;l<o;)s.push(t.readInt()),l++;for(o=t.readInt(),l=0;l<o;)r.push(t.readInt()),l++;for(o=t.readInt(),l=0;l<o;)n.push(t.readInt()),l++;return this._giftWrappers=e,this._ribbonTypes=r,this._giftFurnis=n,this._boxTypes=s,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class Zw{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new zw(t),!0):!1}get offer(){return this._offer}}class $w{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._offers.push(new BN(t)),e--;return!0}get offers(){return this._offers}}class t1{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._isGiftable=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class e1{flush(){return!0}parse(t){return!!t}}class s1{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(t){return t?(this._appearsInSeconds=t.readInt(),this._pageId=t.readInt(),this._offerId=t.readInt(),this._productType=t.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class i1{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(t){return t?(this._notEnoughCredits=t.readBoolean(),this._notEnoughActivityPoints=t.readBoolean(),t.bytesAvailable&&(this._activityPointType=t.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class r1{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new Bm(t),!0):!1}get offer(){return this._offer}}class n1{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class a1{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class o1{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let e=t.readInt();for(;e>0;)this._products.push(new Wa(t)),e--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class l1{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new o1(t),!0):!1}get offer(){return this._offer}}class c1{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(t){return t?(this._clubLevel=t.readInt(),this._securityLevel=t.readInt(),this._isAmbassador=t.readBoolean(),!0):!1}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}const kf=class kf{flush(){return!0}parse(t){return t?(this._status=t.readInt(),!0):!1}get status(){return this._status}};kf.SAFETY_LOCK_STATUS_LOCKED=0,kf.SAFETY_LOCK_STATUS_UNLOCKED=1;let G_=kf;class u1{flush(){return this._result=-1,this._validationInfo="",!0}parse(t){return t?(this._result=t.readInt(),this._validationInfo=t.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}const gO=class gO{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}};gO.EMAIL_STATUS_OK=0;let Cp=gO;class h1{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._relationshipStatusType=ur.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(t){return t?(this._relationshipStatusType=t.readInt(),this._friendCount=t.readInt(),this._randomFriendId=t.readInt(),this._randomFriendName=t.readString(),this._randomFriendFigure=t.readString(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class d1{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(t){if(!t)return!1;this._userId=t.readInt(),this._relationshipStatusMap=new Is;const e=t.readInt();for(let s=0;s<e;s++){const r=new h1(t);this._relationshipStatusMap.add(r.relationshipStatusType,r)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class _1{flush(){return this._userId=null,this._badges=[],!0}parse(t){if(!t)return!1;this._userId=t.readInt();let e=t.readInt();for(;e>0;){t.readInt();const s=t.readString();this._badges.push(s),e--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class g1{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._motto=t.readString(),this._realName=t.readString(),this._directMail=t.readBoolean(),this._respectsReceived=t.readInt(),this._respectsRemaining=t.readInt(),this._respectsPetRemaining=t.readInt(),this._streamPublishingAllowed=t.readBoolean(),this._lastAccessDate=t.readString(),this._canChangeName=t.readBoolean(),this._safetyLocked=t.readBoolean(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class f1{flush(){return this._userInfo=null,!0}parse(t){return!(!t||(this._userInfo=new g1(t),!this._userInfo))}get userInfo(){return this._userInfo}}class m1{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(t){return t?(this._webId=t.readInt(),this._id=t.readInt(),this._newName=t.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class VN{constructor(t){this._groupId=t.readInt(),this._groupName=t.readString(),this._badgeCode=t.readString(),this._colorA=t.readString(),this._colorB=t.readString(),this._favourite=t.readBoolean(),this._ownerId=t.readInt(),this._hasForum=t.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class E1{flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._motto=t.readString(),this._registration=t.readString(),this._achievementPoints=t.readInt(),this._friendsCount=t.readInt(),this._isMyFriend=t.readBoolean(),this._requestSent=t.readBoolean(),this._isOnline=t.readBoolean();const e=t.readInt();for(let s=0;s<e;s++)this._groups.push(new VN(t));return this._secondsSinceLastVisit=t.readInt(),this._openProfileWindow=t.readBoolean(),!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}}class p1{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(t){return t?(this._volumeSystem=t.readInt(),this._volumeFurni=t.readInt(),this._volumeTrax=t.readInt(),this._oldChat=t.readBoolean(),this._roomInvites=t.readBoolean(),this._cameraFollow=t.readBoolean(),this._flags=t.readInt(),this._chatType=t.readInt(),!0):!1}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class I1{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(t){if(!t)return!1;this._roomUnitId=t.readInt();let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class T1{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class R1{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class S1{flush(){return this._groupId=-1,!0}parse(t){return t?(this._groupId=t.readInt(),!0):!1}get groupId(){return this._groupId}}class O1{flush(){return this._groupId=-1,this._requester=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._requester=new bI(t),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}const fO=class fO{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};fO.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;let xp=fO;class A1{flush(){return this._guildId=-1,this._reason=-1,!0}parse(t){return t?(this._guildId=t.readInt(),this._reason=t.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class N1{flush(){return this._groups=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._groups.push(new VN(t)),e--;return!0}get groups(){return this._groups}}class C1{flush(){return this._badges=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),r=t.readString();this._badges.set(s,r),e--}return!0}get badges(){return this._badges}}const mO=class mO{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};mO.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;let yp=mO;class x1{flush(){return this._ignoredUsers=[],!0}parse(t){if(!t)return!1;this._ignoredUsers=[];let e=t.readInt();for(;e>0;)this._ignoredUsers.push(t.readString()),e--;return!0}get ignoredUsers(){return this._ignoredUsers}}class y1{flush(){return this._result=-1,this._name=null,!0}parse(t){return t?(this._result=t.readInt(),this._name=t.readString(),!0):!1}get result(){return this._result}get name(){return this._name}}class M1{flush(){return this._link=null,!0}parse(t){return t?(this._link=t.readString(),!0):!1}get link(){return this._link}}class b1{flush(){return this._credits=null,!0}parse(t){return t?(this._credits=t.readString(),!0):!1}get credits(){return this._credits}}class D1{flush(){return this._currencies=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._currencies.set(t.readInt(),t.readInt()),e--;return!0}get currencies(){return this._currencies}}const Pc=class Pc{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(t){return t?(this._productName=t.readString(),this._daysToPeriodEnd=t.readInt(),this._memberPeriods=t.readInt(),this._periodsSubscribedAhead=t.readInt(),this._responseType=t.readInt(),this._hasEverBeenMember=t.readBoolean(),this._isVip=t.readBoolean(),this._pastClubDays=t.readInt(),this._pastVipDays=t.readInt(),this._minutesUntilExpiration=t.readInt(),t.bytesAvailable&&(this._minutesSinceLastModified=t.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}};Pc.RESPONSE_TYPE_LOGIN=1,Pc.RESPONSE_TYPE_PURCHASE=2,Pc.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3,Pc.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;let k_=Pc;const Lc=class Lc{constructor(t){if(this._unseen=0,!t)throw new Error("invalid_parser");this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._scoreAtStartOfLevel=t.readInt(),this._scoreLimit=Math.max(1,t.readInt()),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._currentPoints=t.readInt(),this._finalLevel=t.readBoolean(),this._category=t.readString(),this._subCategory=t.readString(),this._levelCount=t.readInt(),this._displayMethod=t.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(t){this._unseen=t}get unseen(){return this._unseen}reset(t){this._achievementId=t._achievementId,this._level=t._level,this._badgeId=t._badgeId,this._scoreAtStartOfLevel=t._scoreAtStartOfLevel,this._scoreLimit=t._scoreLimit,this._levelRewardPoints=t._levelRewardPoints,this._levelRewardPointType=t._levelRewardPointType,this._currentPoints=t._currentPoints,this._finalLevel=t._finalLevel,this._category=t.category,this._subCategory=t._subCategory,this._levelCount=t._levelCount,this._displayMethod=t._displayMethod}};Lc.DISPLAY_METHOD_OBSOLETE=-1,Lc.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0,Lc.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1,Lc.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;let B_=Lc;class v1{flush(){return this._achievement=null,!0}parse(t){return t?(this._achievement=new B_(t),!0):!1}get achievement(){return this._achievement}}const Bf=class Bf{constructor(t){this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._requiredLevel=t.readInt(),this._state=t.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===Bf.STATE_SELECTABLE}get state(){return this._state}};Bf.STATE_SELECTABLE=0;let Mp=Bf;class P1{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(t){if(!t)return!1;this._achievements=[];let e=t.readInt();for(;e>0;)this._achievements.push(new B_(t)),e--;return this._defaultCategory=t.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class L1{flush(){return this._score=0,!0}parse(t){return t?(this._score=t.readInt(),!0):!1}get score(){return this._score}}class U1{get type(){return this._type}set type(t){this._type=t}get subType(){return this._subType}set subType(t){this._subType=t}get duration(){return this._duration}set duration(t){this._duration=t}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(t){this._inactiveEffectsInInventory=t}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(t){this._secondsLeftIfActive=t}get isPermanent(){return this._permanent}set isPermanent(t){this._permanent=t}}class j1{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._duration=t.readInt(),this._isPermanent=t.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class w1{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._subType=t.readInt(),this._duration=t.readInt(),this._permanent=t.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class F1{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class G1{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class k1{flush(){return this._effects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=new U1;s.type=t.readInt(),s.subType=t.readInt(),s.duration=t.readInt(),s.inactiveEffectsInInventory=t.readInt(),s.secondsLeftIfActive=t.readInt(),s.isPermanent=t.readBoolean(),this._effects.push(s),e--}return!0}get effects(){return this._effects}}class B1{constructor(t,e){if(!e)throw new Error("invalid_parser");this._badgeId="ACH_"+t+e.readInt(),this._limit=e.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class V1{flush(){return this._data=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readString(),r=t.readInt();let n=0;for(;n<r;)this._data.push(new B1(s,t)),n++;e--}return!0}get data(){return this._data}}class H1{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(t){return t?(this._badgeId=t.readInt(),this._badgeCode=t.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class W1{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(t){if(!t)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._badgeIds=new Is;let e=t.readInt();for(;e>0;){const s=t.readInt(),r=t.readString();this._badgeIds.add(r,s),this._allBadgeCodes.push(r),e--}for(e=t.readInt();e>0;){t.readInt();const s=t.readString();this._activeBadgeCodes.push(s),e--}return!0}getBadgeId(t){return this._badgeIds.getValue(t)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}}class Y1{flush(){return!0}parse(t){return t?(this._requestCode=t.readString(),this._fulfilled=t.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class z1{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._figureSetIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._boundFurnitureNames.push(t.readString()),s--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}const Uc=class Uc{flush(){return this._reason=0,this._parameter="",!0}parse(t){return t?(this._reason=t.readInt(),this._parameter=t.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}};Uc.REASON_FULL=1,Uc.REASON_CLOSED=2,Uc.REASON_QUEUE_ERROR=3,Uc.REASON_BANNED=4;let ou=Uc;class K1{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class X1{flush(){return!0}parse(t){return!!t}}class q1{flush(){return!0}parse(t){return!!t}}class Q1{flush(){return this._controllerLevel=Ce.NONE,!0}parse(t){return t?(this._controllerLevel=t.readInt(),!0):!1}get controllerLevel(){return this._controllerLevel}}class J1{flush(){return!0}parse(t){return!!t}}class Z1{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class $1{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(t){return t?(this._botId=t.readInt(),this._commandId=t.readInt(),this._data=t.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class tF{flush(){return this._botId=-1,!0}parse(t){return t?(this._botId=t.readInt(),!0):!1}get botId(){return this._botId}}class eF{constructor(t){this._id=t.readInt(),this._data=t.readString()}get id(){return this._id}get data(){return this._data}}class sF{flush(){return this._botId=-1,this._skillList=[],!0}parse(t){if(!t)return!1;this._botId=t.readInt();let e=t.readInt();for(;e>0;)this._skillList.push(new eF(t)),e--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class iF{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}}class rF{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;)this._bannedUsers.push(new iF(t)),e--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class nF{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(t){this._selected=t}}class aF{flush(){return this._roomId=0,this._data=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._data=new nF(t),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class oF{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class lF{flush(){return this._roomId=0,this._users=new Map,!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),r=t.readString();this._users.set(s,r),e--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class cF{flush(){return!0}parse(t){return t?(this._isMuted=t.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class uF{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}const Er=class Er{constructor(t){if(!t)throw new Error("invalid_wrapper");this._mode=t.readInt(),this._weight=t.readInt(),this._speed=t.readInt(),this._distance=t.readInt(),this._protection=t.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}};Er.CHAT_MODE_FREE_FLOW=0,Er.CHAT_MODE_LINE_BY_LINE=1,Er.CHAT_BUBBLE_WIDTH_WIDE=0,Er.CHAT_BUBBLE_WIDTH_NORMAL=1,Er.CHAT_BUBBLE_WIDTH_THIN=2,Er.CHAT_SCROLL_SPEED_FAST=0,Er.CHAT_SCROLL_SPEED_NORMAL=1,Er.CHAT_SCROLL_SPEED_SLOW=2,Er.FLOOD_FILTER_STRICT=0,Er.FLOOD_FILTER_NORMAL=1,Er.FLOOD_FILTER_LOOSE=2;let ss=Er;const hh=class hh{constructor(t){this._allowMute=t.readInt(),this._allowKick=t.readInt(),this._allowBan=t.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}};hh.MODERATION_LEVEL_NONE=0,hh.MODERATION_LEVEL_USER_WITH_RIGHTS=1,hh.MODERATION_LEVEL_ALL=2;let Hi=hh;const ti=class ti{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=ti.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=ti.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(t){const e=new ti;return e._roomId=t._roomId,e._name=t._name,e._description=t._description,e._doorMode=t._doorMode,e._categoryId=t._categoryId,e._maximumVisitors=t._maximumVisitors,e._maximumVisitorsLimit=t._maximumVisitorsLimit,e._tags=t._tags,e._tradeMode=t._tradeMode,e._allowPets=t._allowPets,e._allowFoodConsume=t._allowFoodConsume,e._allowWalkThrough=t._allowWalkThrough,e._hideWalls=t._hideWalls,e._wallThickness=t._wallThickness,e._floorThickness=t._floorThickness,e._controllersById=t._controllersById,e._controllerList=t._controllerList,e._highlightedUserId=t._highlightedUserId,e._bannedUsersById=t._bannedUsersById,e._bannedUsersList=t._bannedUsersList,e._roomModerationSettings=t._roomModerationSettings,e._chatSettings=t._chatSettings,e._allowNavigatorDynamicCats=t._allowNavigatorDynamicCats,e}static getDoorModeLocalizationKey(t){switch(t){case ti.DOORMODE_OPEN:return"${navigator.door.mode.open}";case ti.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case ti.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case ti.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case ti.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(t){this._allowFoodConsume=t}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(t){this._allowWalkThrough=t}get hideWalls(){return this._hideWalls}set hideWalls(t){this._hideWalls=t}get wallThickness(){return this._wallThickness}set wallThickness(t){this._wallThickness=t}get floorThickness(){return this._floorThickness}set floorThickness(t){this._floorThickness=t}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get name(){return this._name}set name(t){this._name=t}get description(){return this._description}set description(t){this._description=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get categoryId(){return this._categoryId}set categoryId(t){this._categoryId=t}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(t){this._maximumVisitors=t}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(t){this._maximumVisitorsLimit=t}get tags(){return this._tags}set tags(t){this._tags=t}setFlatController(t,e){this._controllersById.set(t,e),this._controllerList=null,this._highlightedUserId=t}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(t){this._roomModerationSettings=t}get controllersById(){return this._controllersById}set controllersById(t){this._controllersById=t}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const t of this._controllersById.values())this._controllerList.push(t);this._controllerList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}setBannedUser(t,e){this._bannedUsersById.set(t,e),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const t of this._bannedUsersById.values())this._bannedUsersList.push(t);this._bannedUsersList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(t){this._chatSettings=t}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(t){this._allowNavigatorDynamicCats=t}};ti.DOORMODE_OPEN=0,ti.DOORMODE_CLOSED=1,ti.DOORMODE_PASSWORD=2,ti.DOORMODE_INVISIBLE=3,ti.DOORMODE_NOOBS_ONLY=4,ti.TRADEMODE_NOT_ALLOWED=0,ti.TRADEMODE_WITH_CONTROLLER=1,ti.TRADEMODE_ALLOWED=2;let bp=ti;class hF{flush(){return this._roomSettingsData=null,!0}parse(t){if(!t)return!1;this._roomSettingsData=new bp,this._roomSettingsData.roomId=t.readInt(),this._roomSettingsData.name=t.readString(),this._roomSettingsData.description=t.readString(),this._roomSettingsData.doorMode=t.readInt(),this._roomSettingsData.categoryId=t.readInt(),this._roomSettingsData.maximumVisitors=t.readInt(),this._roomSettingsData.maximumVisitorsLimit=t.readInt(),this._roomSettingsData.tags=[];let e=t.readInt();for(;e>0;)this._roomSettingsData.tags.push(t.readString()),e--;return this._roomSettingsData.tradeMode=t.readInt(),this._roomSettingsData.allowPets=t.readInt()===1,this._roomSettingsData.allowFoodConsume=t.readInt()===1,this._roomSettingsData.allowWalkThrough=t.readInt()===1,this._roomSettingsData.hideWalls=t.readInt()===1,this._roomSettingsData.wallThickness=t.readInt(),this._roomSettingsData.floorThickness=t.readInt(),this._roomSettingsData.chatSettings=new ss(t),this._roomSettingsData.allowNavigatorDynamicCats=t.readBoolean(),this._roomSettingsData.roomModerationSettings=new Hi(t),!0}get data(){return this._roomSettingsData}}class dF{flush(){return this._roomId=0,this._code=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class _F{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}const Fi=class Fi{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),this._message=t.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}};Fi.ERROR_ROOM_NOT_FOUND=1,Fi.ERROR_NOT_OWNER=2,Fi.ERROR_INVALID_DOOR_MODE=3,Fi.ERROR_INVALID_USER_LIMIT=4,Fi.ERROR_INVALID_PASSWORD=5,Fi.ERROR_INVALID_CATEGORY=6,Fi.ERROR_INVALID_NAME=7,Fi.ERROR_UNACCEPTABLE_NAME=8,Fi.ERROR_INVALID_DESCRIPTION=9,Fi.ERROR_UNACCEPTABLE_DESCRIPTION=10,Fi.ERROR_INVALID_TAG=11,Fi.ERROR_NON_USER_CHOOSABLE_TAG=12,Fi.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;let ed=Fi;class gF{flush(){return this._selectionType=0,!0}parse(t){return t?(this._selectionType=t.readInt(),!0):!1}get selectionType(){return this._selectionType}}class fF{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class mF{flush(){return this._chat=null,!0}parse(t){return t?(this._chat=new ss(t),!0):!1}get chat(){return this._chat}}const Qs=class Qs{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._doorMode=t.readInt(),this._userCount=t.readInt(),this._maxUserCount=t.readInt(),this._description=t.readString(),this._tradeMode=t.readInt(),this._score=t.readInt(),this._ranking=t.readInt(),this._categoryId=t.readInt(),this.parseTags(t),this.parseBitMask(t),!0):!1}parseTags(t){if(!t)return!1;this._tags=[];let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}parseBitMask(t){return t?(this._bitMask=t.readInt(),this._bitMask&Qs.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=t.readString()),this._bitMask&Qs.GROUPDATA_BITMASK&&(this._groupId=t.readInt(),this._groupName=t.readString(),this._groupBadge=t.readString()),this._bitMask&Qs.ROOMAD_BITMASK&&(this._adName=t.readString(),this._adDescription=t.readString(),this._adExpiresIn=t.readInt()),this._showOwner=(this._bitMask&Qs.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&Qs.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&Qs.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(t){this._roomName=t}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(t){this._canMute=t}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(t){this._allInRoomMuted=t}};Qs.THUMBNAIL_BITMASK=1,Qs.GROUPDATA_BITMASK=2,Qs.ROOMAD_BITMASK=4,Qs.SHOWOWNER_BITMASK=8,Qs.ALLOW_PETS_BITMASK=16,Qs.DISPLAY_ROOMAD_BITMASK=32,Qs.OPEN_STATE=0,Qs.DOORBELL_STATE=1,Qs.PASSWORD_STATE=2,Qs.INVISIBLE_STATE=3,Qs.NOOB_STATE=4;let je=Qs;class EF{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(t){return t?(this._roomId=t.readInt(),this._isOwner=t.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class pF{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(t){return t?(this._totalLikes=t.readInt(),this._canLike=t.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class IF{constructor(t){this._furniId=t.readInt(),this._on=t.readBoolean(),this._rootX=t.readInt(),this._rootY=t.readInt(),this._width=t.readInt(),this._length=t.readInt(),this._invert=t.readBoolean()}get furniId(){return this._furniId}get on(){return this._on}get rootX(){return this._rootX}get rootY(){return this._rootY}get width(){return this._width}get length(){return this._length}get invert(){return this._invert}}class TF{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._groupId=t.readInt(),this._status=t.readInt(),this._groupName=t.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class RF{constructor(t,e,s){this._id=0,this._state=0,this._id=t,this._state=e,this._data=s}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class SF{flush(){return this._areaData=null,!0}parse(t){return t?(this._areaData=new IF(t),!0):!1}get areaData(){return this._areaData}}class OF{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get count(){return this._code}}class AF{flush(){return this._itemId=0,this._value=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._value=t.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class NF{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(t){return t?(this._isWallItem=t.readBoolean(),this._furniTypeName=t.readString(),this._buyout=t.readBoolean(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class CF{flush(){return this._aliases=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._aliases.set(t.readString(),t.readString()),e--;return!0}get aliases(){return this._aliases}}class Xo{flush(){return this._itemId=0,this._data=null,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=Xo.parseObjectData(t),!0):!1}static parseObjectData(t){if(!t)return null;const e=ra.getData(t.readInt());return e?(e.parseWrapper(t),e):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class xF{flush(){return this._furniId=-1,this._height=0,!0}parse(t){return t?(this._furniId=t.readInt(),this._height=t.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class yF{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(t){return t?(this._objectId=t.readInt(),this._guildId=t.readInt(),this._guildName=t.readString(),this._guildHomeRoomId=t.readInt(),this._userIsMember=t.readBoolean(),this._guildHasReadableForum=t.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class MF{flush(){return this._itemId=0,this._data="",!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=t.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class bF{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class DF{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class vF{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(t){return this._furniId=t.readInt(),this._start=t.readBoolean(),!0}}class PF{flush(){return this._itemId=0,this._state=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._state=t.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class LF{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class UF{flush(){return!0}parse(t){return t?(this._expiryTime=t.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}const Fr=class Fr{flush(){return this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(t){return t?(this._rented=t.readBoolean(),this._canRentErrorCode=t.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=t.readInt(),this._renterName=t.readString(),this._timeRemaining=t.readInt(),this._price=t.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}};Fr.SPACE_ALREADY_RENTED=100,Fr.SPACE_EXTEND_NOT_RENTED=101,Fr.SPACE_EXTEND_NOT_RENTED_BY_YOU=102,Fr.CAN_RENT_ONLY_ONE_SPACE=103,Fr.NOT_ENOUGH_CREDITS=200,Fr.NOT_ENOUGH_PIXELS=201,Fr.CANT_RENT_NO_PERMISSION=202,Fr.CANT_RENT_NO_HABBO_CLUB=203,Fr.CANT_RENT=300,Fr.CANT_RENT_GENERIC=400;let Dp=Fr;class jF{flush(){return this._itemId=-1,this._location="",!0}parse(t){return t?(this._itemId=t.readInt(),this._location=t.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class wF{constructor(t,e,s,r){this.id=t,this.type=e,this.color=s,this.brightness=r}}class FF{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(t){const e=t.readInt();this._selectedPresetId=t.readInt();for(let s=0;s<e;s++){const r=t.readInt(),n=t.readInt(),o=parseInt(t.readString().substr(1),16),l=t.readInt();this._presets.push(new wF(r,n,o,l))}return!0}getPreset(t){return t<0||t>=this.presetCount?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class GF{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._messageCount=t.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class kF{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),this._furniId=t.readInt(),this._requestedByUser=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class RR{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(t){return t?(this._itemId=t.readInt(),this._spriteId=t.readInt(),this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt()%8*45,this._z=parseFloat(t.readString()),this._stackHeight=parseFloat(t.readString()),this._extra=t.readInt(),this._data=Xo.parseObjectData(t),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=t.readString()),!0):!1}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get spriteName(){return this._spriteName}set spriteName(t){this._spriteName=t}}class BF{flush(){return this._item=null,!0}parse(t){return t?(this._item=new RR(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class VF{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new RR(t);if(!s)continue;const r=this._owners.get(s.userId);r&&(s.username=r),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class HF{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._isExpired=t.readBoolean(),this._userId=t.readInt(),this._delay=t.readInt(),!0):!1}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class WF{flush(){return this._item=null,!0}parse(t){return t?(this._item=new RR(t),!0):!1}get item(){return this._item}}class SR{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(t){if(!t)return!1;this._itemId=parseInt(t.readString()),this._spriteId=t.readInt(),this._location=t.readString(),this._stuffData=t.readString(),this._secondsToExpiration=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null;const e=parseFloat(this._stuffData);if(isNaN(e)||(this._state=Math.trunc(e)),this._location.indexOf(":")===0){this._isOldFormat=!1;let s=this._location.split(" ");if(s.length>=3){let r=s[0],n=s[1];const o=s[2];if(r.length>3&&n.length>2&&(r=r.substr(3),n=n.substr(2),s=r.split(","),s.length>=2)){const l=parseInt(s[0]),c=parseInt(s[1]);if(s=n.split(","),s.length>=2){const u=parseInt(s[0]),h=parseInt(s[1]);this._width=l,this._height=c,this._localX=u,this._localY=h,this._direction=o}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class YF{flush(){return this._item=null,!0}parse(t){return t?(this._item=new SR(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class zF{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new SR(t);if(!s)continue;const r=this._owners.get(s.userId);r&&(s.username=r),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class KF{flush(){return this._itemId=0,this._userId=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._userId=t.readInt(),!0):!1}get itemId(){return this._itemId}get userId(){return this._userId}}class XF{flush(){return this._item=null,!0}parse(t){return t?(this._item=new SR(t),!0):!1}get item(){return this._item}}class qF{parse(t){return this._furniId=t.readInt(),this._commandId=t.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class QF{constructor(t,e,s){this._video=t,this._title=e,this._description=s}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class JF{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(t){this._furniId=t.readInt();const e=t.readInt();this._playlists=[];for(let s=0;s<e;s++)this._playlists.push(new QF(t.readString(),t.readString(),t.readString()));return this._selectedPlaylistId=t.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class ZF{flush(){return!0}parse(t){return this._furniId=t.readInt(),this._videoId=t.readString(),this._startAtSeconds=t.readInt(),this._endAtSeconds=t.readInt(),this._state=t.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class $F{flush(){return this._objects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),r=Xo.parseObjectData(t),n=parseFloat(r.getLegacyString());this._objects.push(new RF(s,n,r)),e--}return!0}get objects(){return this._objects}}class tG{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(t){if(!t)return!1;const e=t.readInt(),s=t.readInt(),r=t.readInt(),n=t.readInt();let o=t.readInt();for(;o>0;){const d=t.readInt(),f=parseFloat(t.readString()),E=parseFloat(t.readString()),m=new Va(d,new w(e,s,f),new w(r,n,E));this._itemsRolling.push(m),o--}if(this._rollerId=t.readInt(),!t.bytesAvailable)return!0;const l=t.readInt(),c=t.readInt(),u=parseFloat(t.readString()),h=parseFloat(t.readString());switch(l){case 0:break;case 1:this._unitRolling=new Va(c,new w(e,s,u),new w(r,n,h),Va.MOVE);break;case 2:this._unitRolling=new Va(c,new w(e,s,u),new w(r,n,h),Va.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}const dh=class dh{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(t){if(!t)return!1;const e=t.readBoolean(),s=t.readInt(),r=t.readString();return this.parseExplicitly(r,s,e)}parseModel(t,e,s=!0){return this.parseExplicitly(t,e,s)}parseExplicitly(t,e,s=!0){this._scale=s?32:64,this._wallHeight=e,this._model=t;const r=this._model.split("\r"),n=r.length;let o=0,l=0;for(;l<n;){const c=r[l];c.length>o&&(o=c.length),l++}for(this._heightMap=[],l=0;l<n;){const c=[];let u=0;for(;u<o;)c.push(dh.TILE_BLOCKED),u++;this._heightMap.push(c),l++}for(this._width=o,this._height=n,l=0;l<n;){const c=this._heightMap[l],u=r[l];if(u.length>0){let h=0;for(;h<u.length;){const d=u.charAt(h);let f=dh.TILE_BLOCKED;d!=="x"&&d!=="X"&&(f=parseInt(d,36)),c[h]=f,h++}}l++}return!0}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return-110;const s=this._heightMap[e];if(s===void 0)return-110;const r=s[t];return r===void 0?-110:r}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}};dh.TILE_BLOCKED=-110;let V_=dh;class eG{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(t){return t?(this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class Uo{static decodeTileHeight(t){return t<0?-1:(t&16383)/256}static decodeIsStackingBlocked(t){return!!(t&16384)}static decodeIsRoomTile(t){return t>=0}getTileHeight(t,e){return t<0||t>=this._width||e<0||e>=this._height?-1:Uo.decodeTileHeight(this._heights[e*this._width+t])}getStackingBlocked(t,e){return t<0||t>=this._width||e<0||e>=this._height?!0:Uo.decodeIsStackingBlocked(this._heights[e*this._width+t])}isRoomTile(t,e){return t<0||t>=this._width||e<0||e>=this._height?!1:Uo.decodeIsRoomTile(this._heights[e*this._width+t])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(t){if(!t)return!1;this._width=t.readInt();const e=t.readInt();this._height=e/this._width;let s=0;for(;s<e;)this._heights[s]=t.readShort(),s++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class sG{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return Uo.decodeTileHeight(this._value)}isStackingBlocked(){return Uo.decodeIsStackingBlocked(this._value)}isRoomTile(){return Uo.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(t){return t?(this._wrapper=t,this._count=t.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class iG{flush(){return this._blockedTilesMap=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),r=t.readInt();this._blockedTilesMap[r]||(this._blockedTilesMap[r]=[]),this._blockedTilesMap[r][s]=!0,e--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class rG{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(t){if(!t)return!1;const e=t.readString(),s=t.readString();switch(e){case"floor":this._floorType=s;break;case"wallpaper":this._wallType=s;break;case"landscape":this._landscapeType=s;break;case"landscapeanim":this._landscapeAnimation=s;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class nG{flush(){return this._name=null,this._roomId=0,!0}parse(t){return t?(this._name=t.readString(),this._roomId=t.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class aG{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(t){if(!t)return!1;this._hideWalls=t.readBoolean();let e=t.readInt(),s=t.readInt();return e=e<-2?-2:e>1?1:e,s=s<-2?-2:s>1?1:s,this._thicknessWall=Math.pow(2,e),this._thicknessFloor=Math.pow(2,s),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class oG{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(t){return t?(this._resultData=new LO(t),this._otherResultData=new LO(t),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class lG{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(t){return t?(this._petId=t.readInt(),this._roomIndex=t.readInt(),this._gainedExperience=t.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class cG{flush(){return!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._figureData=new AR(t),this._hasSaddle=t.readBoolean(),this._isRiding=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class uG{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._maximumLevel=t.readInt(),this._experience=t.readInt(),this._levelExperienceGoal=t.readInt(),this._energy=t.readInt(),this._maximumEnergy=t.readInt(),this._happyness=t.readInt(),this._maximumHappyness=t.readInt(),this._respect=t.readInt(),this._ownerId=t.readInt(),this._age=t.readInt(),this._ownerName=t.readString(),this._rarityLevel=t.readInt(),this._saddle=t.readBoolean(),this._rider=t.readBoolean();let e=t.readInt();for(;e>0;)this._skillThresholds.push(t.readInt()),e--;return this._skillThresholds.sort(),this._publiclyRideable=t.readInt(),this._breedable=t.readBoolean(),this._fullyGrown=t.readBoolean(),this._dead=t.readBoolean(),this._unknownRarity=t.readInt(),this._maximumTimeToLive=t.readInt(),this._remainingTimeToLive=t.readInt(),this._remainingGrowTime=t.readInt(),this._publiclyBreedable=t.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class hG{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._canBreed=t.readBoolean(),this._canHarvest=t.readBoolean(),this._canRevive=t.readBoolean(),this._hasBreedingPermission=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class dG{flush(){return this._isPlaying=!1,!0}parse(t){return t?(this._isPlaying=t.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class _G{flush(){return!0}parse(t){return!0}}class gG{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class fG{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class OR{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._chatColours=null,this._messageLength=0,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._message=t.readString(),this._gesture=t.readInt(),this._bubble=t.readInt(),this.parseUrls(t),this._chatColours=t.readString(),this._messageLength=t.readInt(),!0):!1}parseUrls(t){if(!t)return!1;this._urls=[];let e=t.readInt();for(;e>0;)this._urls.push(t.readString()),e--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get chatColours(){return this._chatColours}get messageLength(){return this._messageLength}}class mG{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isTyping=t.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class EG{flush(){return this._unitId=null,this._danceId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._danceId=t.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class pG{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._effectId=t.readInt(),this._delay=t.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class IG{flush(){return this._unitId=null,this._expression=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._expression=t.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class TG{flush(){return this._unitId=null,this._handId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._handId=t.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class RG{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(t){return t?(this._giverUserId=t.readInt(),this._handItemType=t.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class SG{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isIdle=t.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class OG{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._figure=t.readString(),this._gender=t.readString().toLocaleUpperCase(),this._motto=t.readString(),this._achievementScore=t.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class AG{flush(){return this._unitId=null,this._value=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._value=t.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}const Vf=class Vf{constructor(t){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=t}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(t){this._isReadOnly||(this._x=t)}get y(){return this._y}set y(t){this._isReadOnly||(this._y=t)}get z(){return this._z}set z(t){this._isReadOnly||(this._z=t)}get dir(){return this._dir}set dir(t){this._isReadOnly||(this._dir=t)}get name(){return this._name}set name(t){this._isReadOnly||(this._name=t)}get userType(){return this._userType}set userType(t){this._isReadOnly||(this._userType=t)}get sex(){return this._sex}set sex(t){this._isReadOnly||(this._sex=t)}get figure(){return this._figure}set figure(t){this._isReadOnly||(this._figure=t)}get custom(){return this._custom}set custom(t){this._isReadOnly||(this._custom=t)}get activityPoints(){return this._activityPoints}set activityPoints(t){this._isReadOnly||(this._activityPoints=t)}get webID(){return this._webID}set webID(t){this._isReadOnly||(this._webID=t)}get groupID(){return this._groupID}set groupID(t){this._isReadOnly||(this._groupID=t)}get groupName(){return this._groupName}set groupName(t){this._isReadOnly||(this._groupName=t)}get groupStatus(){return this._groupStatus}set groupStatus(t){this._isReadOnly||(this._groupStatus=t)}get subType(){return this._subType}set subType(t){this._isReadOnly||(this._subType=t)}get ownerId(){return this._ownerId}set ownerId(t){this._isReadOnly||(this._ownerId=t)}get ownerName(){return this._ownerName}set ownerName(t){this._isReadOnly||(this._ownerName=t)}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._isReadOnly||(this._rarityLevel=t)}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._isReadOnly||(this._hasSaddle=t)}get isRiding(){return this._isRiding}set isRiding(t){this._isReadOnly||(this._isRiding=t)}get canBreed(){return this._canBreed}set canBreed(t){this._isReadOnly||(this._canBreed=t)}get canHarvest(){return this._canHarvest}set canHarvest(t){this._isReadOnly||(this._canHarvest=t)}get canRevive(){return this._canRevive}set canRevive(t){this._isReadOnly||(this._canRevive=t)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._isReadOnly||(this._hasBreedingPermission=t)}get petLevel(){return this._petLevel}set petLevel(t){this._isReadOnly||(this._petLevel=t)}get petPosture(){return this._petPosture}set petPosture(t){this._isReadOnly||(this._petPosture=t)}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isReadOnly||(this._isModerator=t)}};Vf.M="M",Vf.F="F";let gc=Vf;class NG{flush(){return this._users=[],!0}parse(t){if(!t)return!1;this._users=[];const e=t.readInt();let s=0;for(;s<e;){const r=t.readInt(),n=t.readString(),o=t.readString();let l=t.readString();const c=t.readInt(),u=t.readInt(),h=t.readInt(),d=parseFloat(t.readString()),f=t.readInt(),E=t.readInt(),m=new gc(c);if(m.dir=f,m.name=n,m.custom=o,m.x=u,m.y=h,m.z=d,this._users.push(m),E===1){m.webID=r,m.userType=Pe.USER,m.sex=this.resolveSex(t.readString()),m.groupID=t.readInt(),m.groupStatus=t.readInt(),m.groupName=t.readString();const I=t.readString();I!==""&&(l=this.convertSwimFigure(I,l,m.sex)),m.figure=l,m.activityPoints=t.readInt(),m.isModerator=t.readBoolean()}else if(E===2)m.userType=Pe.PET,m.figure=l,m.webID=r,m.subType=t.readInt().toString(),m.ownerId=t.readInt(),m.ownerName=t.readString(),m.rarityLevel=t.readInt(),m.hasSaddle=t.readBoolean(),m.isRiding=t.readBoolean(),m.canBreed=t.readBoolean(),m.canHarvest=t.readBoolean(),m.canRevive=t.readBoolean(),m.hasBreedingPermission=t.readBoolean(),m.petLevel=t.readInt(),m.petPosture=t.readString();else if(E===3)m.userType=Pe.BOT,m.webID=c*-1,l.indexOf("/")===-1?m.figure=l:m.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",m.sex=gc.M;else if(E===4){m.userType=Pe.RENTABLE_BOT,m.webID=r,m.sex=this.resolveSex(t.readString()),m.figure=l,m.ownerId=t.readInt(),m.ownerName=t.readString();const I=t.readInt();if(I){const p=[];let T=0;for(;T<I;)p.push(t.readShort()),T++;m.botSkills=p}}s++}return!0}resolveSex(t){return t.substr(0,1).toLowerCase()==="f"?gc.F:gc.M}convertSwimFigure(t,e,s){const r=e.split(".");let n=1,o=1,l=1;const c=1e4;let u=0;for(;u<r.length;){const E=r[u].split("-");E.length>2&&E[0]==="hd"&&(n=parseInt(E[2])),u++}const h=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],d=t.split("=");if(d.length>1){const f=d[1].split("/");f[0];const E=f[1];s==="F"?l=10010:l=10011;const m=h.indexOf(E);o=c+m+1}return e+(".bds-10001-"+n+".ss-"+l+"-"+o)}get users(){return this._users}}class CG{flush(){return this._unitId=null,!0}parse(t){return t?(this._unitId=parseInt(t.readString()),!0):!1}get unitId(){return this._unitId}}class xG{constructor(t,e){this._action=t,this._value=e}get action(){return this._action}get value(){return this._value}}class yG{constructor(t,e,s,r,n,o,l,c=0,u=0,h=0,d,f,E){this._id=t,this._x=e,this._y=s,this._z=r,this._height=n,this._headDirection=o,this._direction=l,this._targetX=c,this._targetY=u,this._targetZ=h,this._didMove=d,this._canStandUp=f,this._actions=E||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class MG{flush(){return this._statuses=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=this.parseStatus(t);if(!s){e--;continue}this._statuses.push(s),e--}return!0}parseStatus(t){if(!t)return null;const e=t.readInt(),s=t.readInt(),r=t.readInt(),n=parseFloat(t.readString()),o=t.readInt()%8*45,l=t.readInt()%8*45,c=t.readString();let u=0,h=0,d=0,f=0,E=!1,m=!1;if(c){const I=c.split("/"),p=[];for(const T of I){const R=T.split(" ");if(R[0]!==""&&R.length>=2){switch(R[0]){case"mv":{const S=R[1].split(",");S.length>=3&&(u=parseInt(S[0]),h=parseInt(S[1]),d=parseFloat(S[2]),m=!0);break}case"sit":{const S=parseFloat(R[1]);R.length>=3&&(E=R[2]==="1"),f=S;break}case"lay":{const S=parseFloat(R[1]);f=Math.abs(S);break}}p.push(new xG(R[0],R[1]))}}this._statuses.push(new yG(e,s,r,n,f,o,l,u,h,d,m,E,p))}}get statuses(){return this._statuses}}const jc=class jc{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(t){return t?(this._itemId=t.readInt(),this._furniType=t.readString(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._stuffData=Xo.parseObjectData(t),this._isRecyclable=t.readBoolean(),this._tradable=t.readBoolean(),this._isGroupable=t.readBoolean(),this._sellable=t.readBoolean(),this._secondsToExpiration=t.readInt(),this._expirationTimeStamp=0,this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=t.readBoolean(),this._flatId=t.readInt(),this._isWallItem=this._furniType===jc.WALL_ITEM,this._furniType===jc.FLOOR_ITEM&&(this._slotId=t.readString(),this._extra=t.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}};jc.WALL_ITEM="I",jc.FLOOR_ITEM="S";let H_=jc;class bG{flush(){return this._items=[],!0}parse(t){return t?(this._items.push(new H_(t)),!0):!1}get items(){return this._items}}class DG{flush(){return!0}parse(t){return!!t}}class vG{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;){const s=new H_(t);s&&this._fragment.set(s.itemId,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class PG{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class LG{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._itemsLeft=t.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class UG{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(t){return t?(this._itemType=t.readString(),this._classId=t.readInt(),this._productCode=t.readString(),this._placedItemId=t.readInt(),this._placedItemType=t.readString(),this._placedInRoom=t.readBoolean(),this._petFigureString=t.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class jG{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const t of this._rarityCategories)t&&t.dispose();return this._rarityCategories=[],!0}parse(t){if(!t)return!1;this._nestId=t.readInt(),this._pet1=new PO(t),this._pet2=new PO(t);let e=t.readInt();for(;e>0;)this._rarityCategories.push(new q0(t)),e--;return this._resultPetType=t.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class wG{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(t){return t?(this._breedingNestStuffId=t.readInt(),this._result=t.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}class FG{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(t){return this._petId=t.readInt(),this._rarityCategory=t.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class AR{constructor(t){this._typeId=t.readInt(),this._paletteId=t.readInt(),this._color=t.readString(),this._breedId=t.readInt(),this._customParts=[],this._customPartCount=t.readInt();let e=0;for(;e<this._customPartCount;)this._customParts.push(new Gu(t.readInt(),t.readInt(),t.readInt())),e++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let t=this.typeId+" "+this.paletteId+" "+this.color;t=t+(" "+this.customPartCount);for(const e of this.customParts)t=t+(" "+e.layerId+" "+e.partId+" "+e.paletteId);return t}get customParts(){return this._customParts}get customPartCount(){return this._customPartCount}}class Vm{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._figureData=new AR(t),this._level=t.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.customPartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class GG{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(t){return this._pet=new Vm(t),this._boughtAsGift=t.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}const _h=class _h{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(t){return t?(this._state=t.readInt(),this._ownPetId=t.readInt(),this._otherPetId=t.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};_h.STATE_CANCEL=1,_h.STATE_ACCEPT=2,_h.STATE_REQUEST=3;let vp=_h;class kG{flush(){return this._fragment=null,!0}parse(t){this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(this._fragment=new Map;e>0;){const s=new Vm(t);this._fragment.set(s.id,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class BG{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(t){return this._boughtAsGift=t.readBoolean(),this._pet=new Vm(t),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class VG{flush(){return!0}parse(t){return t?(this._petId=t.readInt(),!0):!1}get petId(){return this._petId}}class HG{constructor(t){this._itemId=t.readInt(),this._furniType=t.readString().toUpperCase(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._isGroupable=t.readBoolean(),this._stuffData=Xo.parseObjectData(t),this._secondsToExpiration=-1,this._expirationTimeStamp=zt(),this._hasRentPeriodStarted=!1,this._creationDay=t.readInt(),this._creationMonth=t.readInt(),this._creationYear=t.readInt(),this._extra=this.furniType==="S"?t.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class WG{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(t){return t?(this._userID=t.readInt(),this._userAccepts=t.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}const EO=class EO{flush(){return!0}parse(t){return t?(this._userId=t.readInt(),this._reason=t.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}};EO.ERROR_WHILE_COMMIT=1;let W_=EO;class YG{flush(){return!0}parse(t){return!!t}}class zG{flush(){return!0}parse(t){return!!t}}class KG{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(t){return!t||(this._firstUserID=t.readInt(),this._firstUserItemArray=[],!this.parseItems(t,this._firstUserItemArray))||(this._firstUserNumItems=t.readInt(),this._firstUserNumCredits=t.readInt(),this._secondUserID=t.readInt(),this._secondUserItemArray=[],!this.parseItems(t,this._secondUserItemArray))?!1:(this._secondUserNumItems=t.readInt(),this._secondUserNumCredits=t.readInt(),!0)}parseItems(t,e){let s=t.readInt();for(;s>0;)e.push(new HG(t)),s--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class XG{flush(){return!0}parse(t){return!!t}}class qG{flush(){return!0}parse(t){return!!t}}const Hf=class Hf{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),this._otherUserName=t.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}};Hf.REASON_YOU_ARE_ALREADY_TRADING=7,Hf.REASON_OTHER_USER_ALREADY_TRADING=8;let Pp=Hf;class QG{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._userCanTrade=t.readInt()===1,this._otherUserId=t.readInt(),this._otherUserCanTrade=t.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class JG{flush(){return!0}parse(t){return!!t}}class ZG{flush(){return!0}parse(t){return!!t}}class $G{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(t){return t?(this._respect=t.readInt(),this._petOwnerId=t.readInt(),this._petData=new Vm(t),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===Ds.MONSTERPLANT}}class tk{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(t){return t?(this._petId=t.readInt(),this._userId=t.readInt(),this._supplementType=t.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}const gl=class gl{};gl.WATER=0,gl.LIGHT=1,gl.REVIVE=2,gl.REBREED_FERTILIZER=3,gl.SPEED_FERTILIZER=4;let Wu=gl;class ek{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(t){return t?(this._userId=t.readInt(),this._respectsReceived=t.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class sk{constructor(t,e,s){this._hasControllers=!1,this._roomId=t,this._roomName=e,this._hasControllers=s}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class ik{constructor(t){this._currentHcStreak=t.readInt(),this._firstSubscriptionDate=t.readString(),this._kickbackPercentage=t.readDouble(),this._totalCreditsMissed=t.readInt(),this._totalCreditsRewarded=t.readInt(),this._totalCreditsSpent=t.readInt(),this._creditRewardForStreakBonus=t.readInt(),this._creditRewardForMonthlySpent=t.readInt(),this._timeUntilPayday=t.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class rk{flush(){return this._data=null,!0}parse(t){return this._data=new ik(t),!0}get data(){return this._data}}class nk{flush(){return this._looks=new Map,!0}parse(t){if(!t)return!1;t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),r=t.readString(),n=t.readString();this._looks.set(s,[r,n]),e--}return!0}get looks(){return this._looks}}class ak{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class ok{flush(){return this._isVip=!1,this._rooms=[],!0}parse(t){if(!t)return!1;this._isVip=t.readBoolean();let e=t.readInt();for(;e>0;)this._rooms.push(new sk(t.readInt(),t.readString(),t.readBoolean())),e--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class lk{flush(){return this._pageId=-1,this._data=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._data=new Bm(t),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class ck{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(t){return t?(this._type=t.readInt(),this._breedId=t.readInt(),this._paletteId=t.readInt(),this._sellable=t.readBoolean(),this._rare=t.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class uk{flush(){return this._productCode="",this._palettes=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._palettes.push(new ck(t)),e--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class hk{constructor(t){this._trackingState=t.readInt(),this._id=t.readInt(),this._identifier=t.readString(),this._productCode=t.readString(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),this._purchaseLimit=t.readInt();const e=t.readInt();this._expirationTime=e>0?e*1e3+Date.now():0,this._title=t.readString(),this._description=t.readString(),this._imageUrl=t.readString(),this._iconImageUrl=t.readString(),this._type=t.readInt(),this._subProductCodes=[];let s=t.readInt();for(;s>0;)this._subProductCodes.push(t.readString()),s--;return this}populate(t){t&&(this._id=t.id,this._identifier=t.identifier,this._type=t.type,this._title=t.title,this._description=t.description,this._imageUrl=t.imageUrl,this._iconImageUrl=t.iconImageUrl,this._productCode=t.productCode,this._purchaseLimit=t.purchaseLimit,this._expirationTime=t.expirationTime,this._priceInCredits=t.priceInCredits,this._priceInActivityPoints=t.priceInActivityPoints,this._activityPointType=t.activityPointType,this._subProductCodes=t.subProductCodes,this._trackingState=t.trackingState)}purchase(t){this._purchaseLimit=this._purchaseLimit-t}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class dk{flush(){return!0}parse(t){return!!t}}class _k{flush(){return this._data=null,!0}parse(t){return t?(this._data=new hk(t),!0):!1}get data(){return this._data}}class gk{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(t){return t?(this._errorCode=t.readString(),!0):!1}get errorCode(){return this._errorCode}}class fk{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(t){return t?(this._productDescription=t.readString(),this._productName=t.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class mk{flush(){return!0}parse(t){return!!t}}const Da=class Da{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(t){this._goalId=t.readInt(),this._goalCode=t.readString(),this._result=t.readInt(),this._requiredFurnis=[];let e=t.readInt();for(;e>0;)this._requiredFurnis.push(t.readString()),e--;for(e=t.readInt();e>0;)this._missingFurnis[t.readString()]="",e--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(t){return!!this._missingFurnis[t]}};Da.SUBMITTED=0,Da.ASK_FOR_SUBMIT=1,Da.ASK_FOR_CONFIRM=2,Da.PREREQUISITES_NOT_MET=3,Da.ROOM_DOOR_NOT_OPEN=4,Da.ROOM_TOO_OLD=5,Da.ASK_FOR_ACCEPT_RULES=6;let Lp=Da;const gh=class gh{};gh.ALLOWED=0,gh.REQUIRED_PERK_MISSING=1,gh.REQUIRED_BADGE_MISSING=2;let Up=gh;class Ek{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(t){return this._goalId=t.readInt(),this._goalCode=t.readString(),this._resultCode=t.readInt(),this._votesRemaining=t.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===Up.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class pk{flush(){return this._schedulingStr=null,this._code=null,!0}parse(t){return this._schedulingStr=t.readString(),this._code=t.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class Ik{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(t){return this._isPartOf=t.readBoolean(),this._targetId=t.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class Tk{flush(){return!0}parse(t){return!0}}class Rk{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(t){return this._timeStr=t.readString(),this._secondsUntil=t.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class HN{constructor(t){this._recipeName=t.readString(),this._itemName=t.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class Sk{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let r=0;r<e;r++)this._recipes.push(new HN(t));const s=t.readInt();for(let r=0;r<s;r++)this._ingredients.push(t.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class Ok{constructor(t){this._count=t.readInt(),this._itemName=t.readString()}get count(){return this._count}get itemName(){return this._itemName}}class Ak{constructor(){this._ingredients=[]}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._ingredients.push(new Ok(t));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class Nk{parse(t){return t?(this._count=t.readInt(),this._hasRecipes=t.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class Ck{parse(t){return t?(this._success=t.readBoolean(),this._success&&(this._result=new HN(t)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class xk{flush(){return!0}parse(t){return!!t}}class yk{constructor(t){if(!t)throw new Error("invalid_wrapper");this._senderId=t.readInt(),this._errorCode=t.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class Mk{flush(){return this._failuers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._failuers.push(new yk(t)),e--;return!0}get failures(){return this._failuers}}class bk{flush(){return this._success=!1,!0}parse(t){return t?(this._success=t.readBoolean(),!0):!1}get success(){return this._success}}class Dk{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class WN{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString()}get id(){return this._id}get name(){return this._name}}class jp{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._gender=t.readInt(),this._online=t.readBoolean(),this._followingAllowed=t.readBoolean(),this._figure=t.readString(),this._categoryId=t.readInt(),this._motto=t.readString(),this._realName=t.readString(),this._lastAccess=t.readString(),this._persistedMessageUser=t.readBoolean(),this._vipMember=t.readBoolean(),this._pocketHabboUser=t.readBoolean(),this._relationshipStatus=t.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class vk{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;)this._fragment.push(new jp(t)),e--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Pk{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new WN(t)),e--;let s=t.readInt();for(;s>0;){const r=t.readInt();r===-1?this._removedFriendIds.push(t.readInt()):r===0?this._updatedFriends.push(new jp(t)):r===1&&this._addedFriends.push(new jp(t)),s--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class Lk{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(t){return t?(this._typeCode=t.readInt(),this._avatarId=t.readInt(),this._message=t.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class YN{constructor(t){if(!t)throw new Error("invalid_wrapper");this._requestId=t.readInt(),this._requesterName=t.readString(),this._figureString=t.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class Uk{flush(){return this._totalRequests=0,this._requests=[],!0}parse(t){if(!t)return!1;this._totalRequests=t.readInt();let e=t.readInt();for(;e>0;)this._requests.push(new YN(t)),e--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class QO{constructor(t){if(!t)throw new Error("invalid_wrapper");this._avatarId=t.readInt(),this._avatarName=t.readString(),this._avatarMotto=t.readString(),this._isAvatarOnline=t.readBoolean(),this._canFollow=t.readBoolean(),this._lastOnlineData=t.readString(),this._avatarGender=t.readInt(),this._avatarFigure=t.readString(),this._realName=t.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class jk{flush(){return this._friends=[],this._others=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._friends.push(new QO(t)),e--;let s=t.readInt();for(;s>0;)this._others.push(new QO(t)),s--;return!0}get friends(){return this._friends}get others(){return this._others}}class wk{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._userId=t.readInt(),this._message=t.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class Fk{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(t){return t?(this._clientMessageId=t.readInt(),this._errorCode=t.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class Gk{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(t){if(!t)return!1;this._userFriendLimit=t.readInt(),this._normalFriendLimit=t.readInt(),this._extendedFriendLimit=t.readInt();let e=t.readInt();for(;e>0;)this._categories.push(new WN(t)),e--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class kk{flush(){return!0}parse(t){return!!t}}class Bk{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class Vk{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),this._secondsSinceSent=t.readInt(),t.bytesAvailable&&(this._extraData=t.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class Hk{flush(){return this._request=null,!0}parse(t){return t?(this._request=new YN(t),!0):!1}get request(){return this._request}}class Wk{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(t){if(!t)return!1;this._errorCode=t.readInt();let e=t.readInt();for(;e>0;)this._failedRecipients.push(t.readInt()),e--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class Yk{flush(){return this._senderId=0,this._messageText=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class zk{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._freeGamesLeft=t.readInt(),this._gamesPlayedTotal=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}const wc=class wc{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(t){return t?(this._status=t.readInt(),this._blockLength=t.readInt(),this._gamesPlayed=t.readInt(),this._freeGamesLeft=t.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}};wc.STATUS_OK=0,wc.STATUS_FAILED_REASON_UNKNOWN=1,wc.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2,wc.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;let wp=wc;class Kk{flush(){return this._position=-1,!0}parse(t){return t?(this._position=t.readInt(),!0):!1}get position(){return this._position}}const Fn=class Fn{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};Fn.KICKED=1,Fn.DUPLICATE_MACHINEID=2,Fn.INVITATION_REQUIRED=3,Fn.NO_SPACE_IN_TEAM=4,Fn.TEAM_NOT_FOUND=5,Fn.USER_HAS_ACTIVE_INSTANCE=6,Fn.USER_HAS_PENDING_INSTANCE_REQUEST=7,Fn.USER_HAS_NO_FREE_GAMES_LEFT=8;let Fp=Fn;const Wf=class Wf{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};Wf.NOT_ENOUGH_PLAYERS=1,Wf.GAME_HAS_NO_OWNER=2;let Gp=Wf;class Xk{flush(){return!0}parse(t){return!!t}}class qk{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class Qk{flush(){return!0}parse(t){return t?(this._stuffCode=t.readString(),this._badgeCode=t.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class Jk{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(t){return t?(this._stuffId=t.readInt(),this._achievementId=t.readInt(),this._requiredLevelBadgeCode=t.readString(),this._userProgress=t.readInt(),this._totalProgress=t.readInt(),this._endTime=t.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class Zk{flush(){return!0}parse(t){if(!t)return!1;this._stuffId=t.readInt();const e=t.readInt();let s=0;for(;s<e;)this._achievements.push(new Mp(t)),s++;return this._endTime=t.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class $k{constructor(t,e,s,r){this._gameTypeId=t,this._achievementId=e,this._achievementName=s,this._levels=r}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class tB{flush(){return!0}parse(t){if(!t)return!1;this._achievements=[];const e=t.readInt();let s=0;for(;s<e;){const r=t.readInt(),n=t.readInt();let o=0;for(;o<n;){const l=t.readInt(),c=t.readString(),u=t.readInt();this._achievements.push(new $k(r,l,c,u)),o++}s++}return!0}get achievements(){return this._achievements}}class eB{constructor(t,e,s,r,n,o){this._gameId=t,this._gameNameId=e,this._bgColor=s,this._textColor=r,this._assetUrl=n,this._supportUrl=o}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class sB{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._inviterId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class iB{flush(){return!0}parse(t){if(!t)return!1;this._games=[];const e=t.readInt();for(let s=0;s<e;s++){const r=t.readInt(),n=t.readString(),o=t.readString();let l=parseInt(o,16);l=l|4278190080;const c=t.readString();let u=parseInt(c,16);u=u|4278190080;const h=t.readString(),d=t.readString();this._games.push(new eB(r,n,l,u,h,d))}return!0}get games(){return this._games}}const Fc=class Fc{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._status=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==Fc.OK}get isInMaintenance(){return this._status==Fc.MAINTENANCE}};Fc.OK=0,Fc.MAINTENANCE=1;let kp=Fc;class rB{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}const pO=class pO{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._reason=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}};pO.DUPLICATE_MACHINEID=1;let Bp=pO;class nB{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class aB{flush(){return!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),this._quality=t.readString(),this._scaleMode=t.readString(),this._frameRate=t.readInt(),this._minMajorVersion=t.readInt(),this._minMinorVersion=t.readInt(),this._params=new Map;const e=t.readInt();let s=0;for(;s<e;)this._params.set(t.readString(),t.readString()),s++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class oB{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class lB{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class cB{flush(){return!0}parse(t){return!!t}}class Hm{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(t){return t?(this._year=t.readInt(),this._week=t.readInt(),this._maxOffset=t.readInt(),this._currentOffset=t.readInt(),this._minutesUntilReset=t.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class uB{constructor(t){this._name=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._rank=t.readInt(),this._score=t.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class hB{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._products.push(new Wa(t)),e--;return this._minutesUntilNextWeek=t.readInt(),this._rewardingOn=t.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class dB{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._winners.push(new uB(t)),e--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class _B{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class gB{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._phoneStatusCode=t.readInt(),this._collectionStatusCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class fB{flush(){return this._resultCode=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class mB{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class EB{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const l=t.readInt(),c=t.readString(),u=t.readString();this._bases.set(l,[c,u]),e--}let s=t.readInt();for(;s>0;){const l=t.readInt(),c=t.readString(),u=t.readString();this._symbols.set(l,[c,u]),s--}let r=t.readInt();for(;r>0;){const l=t.readInt(),c=t.readString();this._partColors.set(l,c),r--}let n=t.readInt();for(;n>0;){const l=t.readInt(),c=t.readString();this._colorsA.set(l,c),n--}let o=t.readInt();for(;o>0;){const l=t.readInt(),c=t.readString();this._colorsB.set(l,c),o--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class pB{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(t){if(!t)return!1;this._groupCost=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),r=t.readString();t.readBoolean(),this._availableRooms.set(s,r),e--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class IB{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(t){return t?(this._userId=t.readInt(),this._furnitureCount=t.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class TB{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(t){return t?(this._id=t.readInt(),t.readBoolean(),this._type=t.readInt(),this._title=t.readString(),this._description=t.readString(),this._badge=t.readString(),this._roomId=t.readInt(),this._roomName=t.readString(),this._membershipType=t.readInt(),this._membersCount=t.readInt(),this._isFavorite=t.readBoolean(),this._createdAt=t.readString(),this._isOwner=t.readBoolean(),this._isAdmin=t.readBoolean(),this._ownerName=t.readString(),this._flag=t.readBoolean(),this._canMembersDecorate=t.readBoolean(),this._pendingRequestsCount=t.readInt(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class RB{constructor(t){this.isBase=t,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}const fl=class fl{};fl.OWNER=0,fl.ADMIN=1,fl.MEMBER=2,fl.REQUESTED=3,fl.DELETED=4;let ci=fl;class SB{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(t){return t?(this._rank=t.readInt(),this._id=t.readInt(),this._name=t.readString(),this._figure=t.readString(),this._joinedAt=t.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class OB{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._groupTitle=t.readString(),this._roomId=t.readInt(),this._badge=t.readString(),this._totalMembersCount=t.readInt();let e=t.readInt();for(;e>0;)this._result.push(new SB(t)),e--;return this._admin=t.readBoolean(),this._pageSize=t.readInt(),this._pageIndex=t.readInt(),this._level=t.readInt(),this._query=t.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class AB{flush(){return this._roomId=0,this._groupId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._groupId=t.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class NB{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(t){if(!t)return!1;t.readInt()===1&&(this._roomId=t.readInt(),this._roomName=t.readString(),t.readBoolean()),t.readBoolean(),this._id=t.readInt(),this._title=t.readString(),this._description=t.readString(),t.readInt(),this._colorA=t.readInt(),this._colorB=t.readInt(),this._state=t.readInt(),this._canMembersDecorate=t.readInt()===0,t.readBoolean(),t.readString();const s=t.readInt();for(let r=0;r<s;r++){const n=new RB(r===0);n.key=t.readInt(),n.color=t.readInt(),n.position=t.readInt(),n.key===0&&(n.position=4),this._badgeParts.set(r,n)}return this._badgeCode=t.readString(),this._membersCount=t.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class CB{flush(){return!0}parse(t){return this._groupId=t.readInt(),!0}get groupId(){return this._groupId}}class sd{static parse(t){return this.fillFromMessage(new sd,t)}static fillFromMessage(t,e){return t._groupId=e.readInt(),t._name=e.readString(),t._description=e.readString(),t._icon=e.readString(),t._totalThreads=e.readInt(),t._leaderboardScore=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessages=e.readInt(),t._lastMessageId=e.readInt(),t._lastMessageAuthorId=e.readInt(),t._lastMessageAuthorName=e.readString(),t._lastMessageTimeAsSecondsAgo=e.readInt(),t}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(t){this._totalThreads=t._totalThreads,this._totalMessages=t._totalMessages,this._unreadMessages=t._unreadMessages,this._lastMessageAuthorId=t._lastMessageAuthorId,this._lastMessageAuthorName=t._lastMessageAuthorName,this._lastMessageId=t._lastMessageId,this._lastMessageTimeAsSecondsAgo=t._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(t){this._unreadMessages=this._totalMessages-t,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(t){this._lastMessageAuthorId=t.lastUserId,this._lastMessageAuthorName=t.lastUserName,this._lastMessageId=t.lastMessageId,this._lastMessageTimeAsSecondsAgo=t.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class NR extends sd{static parse(t){const e=new NR;return sd.fillFromMessage(e,t),e._readPermissions=t.readInt(),e._postMessagePermissions=t.readInt(),e._postThreadPermissions=t.readInt(),e._moderatePermissions=t.readInt(),e._readPermissionError=t.readString(),e._postMessagePermissionError=t.readString(),e._postThreadPermissionError=t.readString(),e._moderatePermissionError=t.readString(),e._reportPermissionError=t.readString(),e._canChangeSettings=t.readBoolean(),e._isStaff=t.readBoolean(),e}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class xB{flush(){return this._extendedForumData=null,!0}parse(t){return t?(this._extendedForumData=NR.parse(t),!0):!1}get extendedForumData(){return this._extendedForumData}}class yB{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(t){if(!t)return!1;this._listCode=t.readInt(),this._totalAmount=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._forums=[];let e=0;for(;e<this._amount;)this._forums.push(sd.parse(t)),e++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class xd{static parse(t){const e=new xd;return e._threadId=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._header=t.readString(),e._isPinned=t.readBoolean(),e._isLocked=t.readBoolean(),e._creationTimeAsSecondsAgo=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessagesCount=t.readInt(),e._lastMessageId=t.readInt(),e._lastUserId=t.readInt(),e._lastUserName=t.readString(),e._lastCommentTime=t.readInt(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSecondsAgo=t.readInt(),e}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(t){this._adminOperationTimeAsSecondsAgo=t}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(t){this._lastCommentTime=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(t){this._creationTimeAsSecondsAgo=t}get header(){return this._header}set header(t){this._header=t}get lastMessageId(){return this._lastMessageId}set lastMessageId(t){this._lastMessageId=t}get lastUserId(){return this._lastUserId}set lastUserId(t){this._lastUserId=t}get lastUserName(){return this._lastUserName}set lastUserName(t){this._lastUserName=t}get totalMessages(){return this._totalMessages}set totalMessages(t){this._totalMessages=t}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(t){this._unreadMessagesCount=t}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get isPinned(){return this._isPinned}set isPinned(t){this._isPinned=t}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked=t}}class MB{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._threads=[];let e=0;for(;e<this._amount;)this._threads.push(xd.parse(t)),e++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class yd{static parse(t){const e=new yd;return e._messageId=t.readInt(),e._messageIndex=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._authorFigure=t.readString(),e._creationTime=t.readInt(),e._messageText=t.readString(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSeccondsAgo=t.readInt(),e._authorPostCount=t.readInt(),e}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(t){this._adminOperationTimeAsSeccondsAgo=t}get messageId(){return this._messageId}set messageId(t){this._messageId=t}get creationTime(){return this._creationTime}set creationTime(t){this._creationTime=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get authorFigure(){return this._authorFigure}set authorFigure(t){this._authorFigure=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get messageIndex(){return this._messageIndex}set messageIndex(t){this._messageIndex=t}set groupID(t){this._groupId=t}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get messageText(){return this._messageText}set messageText(t){this._messageText=t}get authorPostCount(){return this._authorPostCount}set authorPostCount(t){this._authorPostCount=t}}class bB{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=yd.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class DB{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=xd.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class vB{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._threadId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._messages=[];let e=0;for(;e<this._amount;){const s=yd.parse(t);s.groupID=this._groupId,s.threadId=this._threadId,this._messages.push(s),e++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class PB{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class LB{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=yd.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class UB{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=xd.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class jB{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(t){return t?(this._encryptedPublicKey=t.readString(),t.bytesAvailable&&(this._serverClientEncryption=t.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class wB{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=0,t.bytesAvailable&&(this._reason=t.readInt()),!0):!1}get reason(){return this._reason}}class FB{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(t){if(!t)return!1;this._accounts=new Map;let e=t.readInt();for(;e>0;)this._accounts.set(t.readInt(),t.readString()),e--;return!0}get accounts(){return this._accounts}}class GB{flush(){return!0}parse(t){return t?(this._encryptedPrime=t.readString(),this._encryptedGenerator=t.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class kB{flush(){return this._noobnessLevel=0,!0}parse(t){return t?(this._noobnessLevel=t.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class BB{flush(){return!0}parse(t){return t?(this._infoUrl=t.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class VB{flush(){return!0}parse(t){return!0}}class HB{flush(){return this._calls=[],!0}parse(t){this._calls=[];const e=t.readInt();for(let s=0;s<e;s++){const r=t.readString(),n=t.readString(),o=t.readString();this._calls.push({callId:r,timeStamp:n,message:o})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class WB{flush(){return this._message=null,!0}parse(t){return this._message=t.readString(),!0}get message(){return this._message}}class YB{flush(){return this._resultType=0,this._messageText=null,!0}parse(t){return t?(this._resultType=t.readInt(),this._messageText=t.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class zB{flush(){return!0}parse(t){return!0}}class KB{flush(){return this._acceptanceTimeout=-1,!0}parse(t){return this._acceptanceTimeout=t.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class XB{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(t){this._finalStatus=[],this._winningVoteCode=t.readInt(),this._ownVoteCode=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._finalStatus.push(t.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class qB{flush(){return!0}parse(t){return this._votingTimeout=t.readInt(),this._chatRecord=t.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}const Eo=class Eo{flush(){return this._status=null,!0}parse(t){this._status=[];const e=t.readInt();for(let s=0;s<e;s++)this._status.push(t.readInt());return!0}get status(){return this._status}};Eo.AWAITING_VOTE=0,Eo.VOTED_OK=1,Eo.VOTED_BAD=2,Eo.VOTED_VERY_BAD=3,Eo.NO_VOTE=4,Eo.FINDING_NEW_VOTER=5;let Vp=Eo;class QB{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(t){return t?(this._onDuty=t.readBoolean(),this._guidesOnDuty=t.readInt(),this._helpersOnDuty=t.readInt(),this._guardiansOnDuty=t.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class JB{constructor(t,e,s,r,n,o,l){this._type=t,this._secondsAgo=e,this._isGuide=s,this._otherPartyName=r,this._otherPartyFigure=n,this._description=o,this._roomName=l}get type(){return this._type}set type(t){this._type=t}get secondsAgo(){return this._secondsAgo}set secondsAgo(t){this._secondsAgo=t}get isGuide(){return this._isGuide}set isGuide(t){this._isGuide=t}get otherPartyName(){return this._otherPartyName}set otherPartyName(t){this._otherPartyName=t}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(t){this._otherPartyFigure=t}get description(){return this._description}set description(t){this._description=t}get roomName(){return this._roomName}set roomName(t){this._roomName=t}}const Gc=class Gc{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(t){return t?(this._statusCode=t.readInt(),this._pendingTicket=new JB(t.readInt(),t.readInt(),t.readBoolean(),t.readString(),t.readString(),t.readString(),t.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}};Gc.GUIDE_REPORTING_STATUS_OK=0,Gc.GUIDE_REPORTING_STATUS_PENDING_TICKET=1,Gc.GUIDE_REPORTING_STATUS_ABUSIVE=2,Gc.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;let Hp=Gc;class ZB{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(t){return t?(this._asGuide=t.readBoolean(),this._helpRequestType=t.readInt(),this._helpRequestDescription=t.readString(),this._roleSpecificWaitTime=t.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class $B{flush(){return!0}parse(t){return!!t}}class tV{flush(){return this._endReason=0,!0}parse(t){return t?(this._endReason=t.readInt(),!0):!1}get endReason(){return this._endReason}}const ml=class ml{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}};ml.ERROR_GENERIC=0,ml.ERROR_GUIDES_REJECT=1,ml.ERROR_NOT_ENOUGH_GUIDES=2,ml.ERROR_NOT_ENOUGH_VOTES=3,ml.ERROR_NO_CHATLOG_FOUND=4;let Wp=ml;class eV{flush(){return this._roomId=0,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class sV{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(t){return t?(this._chatMessage=t.readString(),this._senderId=t.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class iV{flush(){return this._isTyping=!1,!0}parse(t){return t?(this._isTyping=t.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class rV{flush(){return this._requesterRoomId=0,!0}parse(t){return t?(this._requesterRoomId=t.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class nV{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(t){return t?(this._requesterUserId=t.readInt(),this._requesterName=t.readString(),this._requesterFigure=t.readString(),this._guideUserId=t.readInt(),this._guideName=t.readString(),this._guideFigure=t.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}const kc=class kc{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}};kc.CREATION_RESULT_OK=0,kc.CREATION_RESULT_UNABLE_TO_REPORT=1,kc.CREATION_RESULT_NO_CHATLOG_FOUND=2,kc.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;let Yp=kc;const fh=class fh{flush(){return this._resolution=0,!0}parse(t){return t?(this._resolution=t.readInt(),!0):!1}get resolution(){return this._resolution}};fh.RESOLUTION_GUARDIANS_TOOK_ACTION=0,fh.RESOLUTION_FORWARDED_TO_MODERATORS=1,fh.RESOLUTION_REPORTER_IS_ABUSIVE=2;let zp=fh;class aV{flush(){return!0}parse(t){return!!t}}class oV{flush(){return this._closeReason=0,this._messageText="",!0}parse(t){return t?(this._closeReason=t.readInt(),this._messageText=t.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class lV{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIds=[];for(let s=0;s<e;s++)this._questionIds.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class cV{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIdsForWrongAnswers=[];for(let s=0;s<e;s++)this._questionIdsForWrongAnswers.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}const mh=class mh{constructor(t){this._id=t.readInt(),this._title=t.readString(),this._bodyText=t.readString(),this._buttonText=t.readString(),this._linkType=t.readInt(),this._linkContent=t.readString(),this._imageUrl=t.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}};mh.LINK_TYPE_URL=0,mh.LINK_TYPE_INTERNAL=1,mh.LINK_TYPE_NO_LINK=2;let Kp=mh;class uV{flush(){return this._articles=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._articles.push(new Kp(t));return!0}get articles(){return this._articles}}class hV{flush(){return!0}parse(t){return t?(this._acknowledged=t.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class dV{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(t){return t?(this._result=t.readInt(),this._newOfferId=t.readInt(),this._newPrice=t.readInt(),this._requestedOfferId=t.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class _V{flush(){return this._offerId=0,this._success=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._success=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class gV{flush(){return this._tokenCount=0,this._result=0,!0}parse(t){return t?(this._result=t.readInt(),this._tokenCount=t.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class fV{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(t){return t?(this._enabled=t.readBoolean(),this._commission=t.readInt(),this._credits=t.readInt(),this._advertisements=t.readInt(),this._minimumPrice=t.readInt(),this._maximumPrice=t.readInt(),this._offerTime=t.readInt(),this._displayTime=t.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class mV{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class EV{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(t){if(!t)return!1;this._averagePrice=t.readInt(),this._currentOfferCount=t.readInt(),this._historyLength=t.readInt();let e=t.readInt();for(;e>0;)this._dayOffsets.push(t.readInt()),this._averagePrices.push(t.readInt()),this._soldAmounts.push(t.readInt()),e--;return this._furniCategoryId=t.readInt(),this._furniTypeId=t.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class zN{constructor(t,e,s,r,n,o,l,c,u,h=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=r,this._stuffData=n,this._price=o,this._status=l,this._timeLeftMinutes=c,this._averagePrice=u,this._offerCount=h}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}}const va=class va{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(t){if(!t)return!1;const e=t.readInt();let s=0;for(;s<e;){const r=t.readInt(),n=t.readInt();let o=t.readInt(),l=-1,c="",u=null;o===va.FURNITYPE_STUFF?(l=t.readInt(),u=Xo.parseObjectData(t)):o===va.FURNITYPE_WALL?(l=t.readInt(),c=t.readString()):o==va.FAKE_FURNITYPE_UNIQUE&&(l=t.readInt(),u=ra.getData(Di.FORMAT_KEY),u.uniqueNumber=t.readInt(),u.uniqueSeries=t.readInt(),o=va.FURNITYPE_STUFF);const h=t.readInt(),d=t.readInt(),f=t.readInt(),E=t.readInt(),m=new zN(r,l,o,c,u,h,n,d,f,E);s<this.MAX_LIST_LENGTH&&this._offers.push(m),s++}return this._totalItemsFound=t.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}};va.FURNITYPE_STUFF=1,va.FURNITYPE_WALL=2,va.FAKE_FURNITYPE_UNIQUE=3;let Xp=va;const Yf=class Yf{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;this._offers=[],this._creditsWaiting=t.readInt();const e=t.readInt();for(let s=0;s<e;s++){const r=t.readInt(),n=t.readInt();let o=t.readInt(),l,c,u;o==1?(l=t.readInt(),u=this.getStuffData(t)):o==2?(l=t.readInt(),c=t.readString()):o==3&&(l=t.readInt(),u=ra.getData(Di.FORMAT_KEY),u.uniqueNumber=t.readInt(),u.uniqueSeries=t.readInt(),o=1);const h=t.readInt(),d=t.readInt(),f=t.readInt(),E=new zN(r,l,o,c,u,h,n,d,f);s<Yf.MAX_LIST_LENGTH&&this._offers.push(E)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(t){const e=t.readInt(),s=ra.getData(e);return s.parseWrapper(t),s}};Yf.MAX_LIST_LENGTH=500;let qp=Yf;class pV{constructor(t,e,s,r,n){this._timestamp=t,this._habboId=e,this._username=s,this._message=r,this._hasHighlighting=n}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}const Pa=class Pa{constructor(t){this._context=new Map,this._chatlog=[],this._recordType=t.readByte();const e=t.readShort();for(let r=0;r<e;r++){const n=t.readString(),o=t.readByte();switch(o){case 0:this._context.set(n,t.readBoolean());break;case 1:this._context.set(n,t.readInt());break;case 2:this._context.set(n,t.readString());break;default:throw new Error("Unknown data type "+o)}}const s=t.readShort();for(let r=0;r<s;r++){const n=t.readString(),o=t.readInt(),l=t.readString(),c=t.readString(),u=t.readBoolean();this._chatlog.push(new pV(n,o,l,c,u))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(t){const e=this._context.get(t);return e||0}};Pa.TYPE_SIMPLE=0,Pa.TYPE_ROOM_CHAT=1,Pa.TYPE_IM_SESSION=2,Pa.TYPE_DISCUSSION_THREAD=3,Pa.TYPE_DISCUSSION_MESSAGE=4,Pa.TYPE_SELFIE=5,Pa.TYPE_PHOTO=6;let id=Pa;class IV{constructor(t){this._issueId=t.readInt(),this._callerUserId=t.readInt(),this._reportedUserId=t.readInt(),this._chatRecordId=t.readInt(),this._chatRecord=new id(t)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class TV{flush(){return this._data=null,!0}parse(t){return t?(this._data=new IV(t),!0):!1}get data(){return this._data}}class RV{flush(){return!0}parse(t){return this._issueId=parseInt(t.readString()),!0}get issueId(){return this._issueId}}const Eh=class Eh{constructor(t,e,s,r,n,o,l,c,u,h,d,f,E,m,I,p){this._disposed=!1,this._issueId=t,this._state=e,this._categoryId=s,this._reportedCategoryId=r,this._issueAgeInMilliseconds=n,this._priority=o,this._groupingId=l,this._reporterUserId=c,this._reporterUserName=u,this._reportedUserId=h,this._reportedUserName=d,this._pickerUserId=f,this._pickerUserName=E,this._message=m,this._chatRecordId=I,this._patterns=p,this._creationTimeInMilliseconds=0}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const t of this._patterns)t.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(t){const s=(this._issueAgeInMilliseconds+t-this._creationTimeInMilliseconds)/1e3/60,r=s%60,n=s/60,o=(r<10?"0":"")+r;return(n<10?"0":"")+n+":"+o}};Eh.STATE_OPEN=1,Eh.STATE_PICKED=2,Eh.STATE_CLOSED=3;let Ul=Eh;class SV{constructor(t){this._disposed=!1,this._pattern=t.readString(),this._startIndex=t.readInt(),this._endIndex=t.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class KN{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(t){const e=t.readInt(),s=t.readInt(),r=t.readInt(),n=t.readInt(),o=t.readInt(),l=t.readInt(),c=t.readInt(),u=t.readInt(),h=t.readString(),d=t.readInt(),f=t.readString(),E=t.readInt(),m=t.readString(),I=t.readString(),p=t.readInt(),T=t.readInt(),R=[];for(let S=0;S<T;S++)R.push(new SV(t));return this._issueData=new Ul(e,s,r,n,o,l,c,u,h,d,f,E,m,I,p,R),!0}}class OV{flush(){return this._issues=null,!0}parse(t){this._issues=[];const e=t.readInt();for(let s=0;s<e;s++){const r=t.readInt(),n=t.readInt(),o=t.readString(),l=new Ul(r,0,0,0,0,0,0,0,null,0,null,n,o,null,0,[]);this._issues.push(l)}return this._retryEnabled=t.readBoolean(),this._retryCount=t.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class AV{flush(){return this._message="",this._url=null,!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class NV{flush(){return this._userId=-1,this._success=!1,!0}parse(t){return this._userId=t.readInt(),this._success=t.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class CV{constructor(t){this._disposed=!1;const e=new KN;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let s=t.readInt(),r=0;for(;r<s;)e.parse(t)&&this._issues.push(e.issueData),r++;for(s=t.readInt(),r=0;r<s;)this._messageTemplates.push(t.readString()),r++;for(s=t.readInt(),r=0;r<s;)t.readString(),r++;for(this._cfhPermission=t.readBoolean(),this._chatlogsPermission=t.readBoolean(),this._alertPermission=t.readBoolean(),this._kickPermission=t.readBoolean(),this._banPermission=t.readBoolean(),this._roomAlertPermission=t.readBoolean(),this._roomKickPermission=t.readBoolean(),s=t.readInt(),r=0;r<s;)this._roomMessageTemplates.push(t.readString()),r++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class xV{constructor(){this._data=null}flush(){return this._data=null,!0}parse(t){return this._data=new CV(t),!0}get data(){return this._data}}class yV{flush(){return this._message="",this._url="",!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class MV{constructor(t){if(this._tags=[],this._exists=t.readBoolean(),!this.exists)return;this._name=t.readString(),this._desc=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._tags.push(t.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class bV{constructor(t){this._flatId=t.readInt(),this._userCount=t.readInt(),this._ownerInRoom=t.readBoolean(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._room=new MV(t)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class DV{flush(){return this._data=null,!0}parse(t){return t?(this._data=new bV(t),!0):!1}get data(){return this._data}}class vV{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(t){return this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class PV{constructor(t){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._registrationAgeInMinutes=t.readInt(),this._minutesSinceLastLogin=t.readInt(),this._online=t.readBoolean(),this._cfhCount=t.readInt(),this._abusiveCfhCount=t.readInt(),this._cautionCount=t.readInt(),this._banCount=t.readInt(),this._tradingLockCount=t.readInt(),this._tradingExpiryDate=t.readString(),this._lastPurchaseDate=t.readString(),this._identityId=t.readInt(),this._identityRelatedBanCount=t.readInt(),this._primaryEmailAddress=t.readString(),this._userClassification=t.readString(),t.bytesAvailable&&(this._lastSanctionTime=t.readString(),this._sanctionAgeHours=t.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class LV{flush(){return this._data=null,!0}parse(t){return t?(this._data=new PV(t),!0):!1}get data(){return this._data}}class UV{flush(){return this._data=null,!0}parse(t){return t?(this._data=new id(t),!0):!1}get data(){return this._data}}class jV{constructor(t){this._roomId=t.readInt(),this._roomName=t.readString(),this._enterHour=t.readInt(),this._enterMinute=t.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class wV{constructor(t){this._rooms=[],this._userId=t.readInt(),this._userName=t.readString();const e=t.readInt();let s=0;for(;s<e;)this._rooms.push(new jV(t)),s++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class FV{flush(){return!0}parse(t){return this._data=new wV(t),!0}get data(){return this._data}}class GV{flush(){return this._message="",!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class kV{constructor(t){this._roomChatlogs=[],this._userId=t.readInt(),this._username=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._roomChatlogs.push(new id(t))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class BV{flush(){return this._data=null,!0}parse(t){return t?(this._data=new kV(t),!0):!1}get data(){return this._data}}class VV{flush(){return!0}parse(t){return!!t}}class HV{flush(){return!0}parse(t){return t?(this._contentType=t.readString(),this._classId=t.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class WV{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(t){return t?(this._boxColor=t.readString(),this._keyColor=t.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class YV{flush(){return!0}parse(t){return!!t}}class zV{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(t){return t?(this._canCreate=t.readBoolean(),this._errorCode=t.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}const zf=class zf{flush(){return!0}parse(t){return t?(this._resultCode=t.readInt(),this._roomLimit=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}};zf.CREATION_ALLOWED=0,zf.ROOM_LIMIT_REACHED=1;let Qp=zf;class KV{constructor(t){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const e=t.readInt();for(let s=0;s<e;s++){const r=t.readInt(),n=t.readInt(),o=t.readInt();this._categoryToCurrentUserCountMap.set(r,n),this._categoryToMaxUserCountMap.set(r,o)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class XV{constructor(t,e=0,s=0){this._goalId=e,this._pageIndex=s,t&&(this._goalId=t.readInt(),this._pageIndex=t.readInt(),this._pageCount=t.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}const La=class La{constructor(t){this._index=t.readInt(),this._popupCaption=t.readString(),this._popupDesc=t.readString(),this._showDetails=t.readInt()==1,this._picText=t.readString(),this._picRef=t.readString(),this._folderId=t.readInt(),this._userCount=t.readInt(),this._type=t.readInt(),this._type==La.TYPE_TAG?this._tag=t.readString():this._type==La.TYPE_GUEST_ROOM?this._guestRoomData=new je(t):this._open=t.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==La.TYPE_TAG?0:this.type==La.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}};La.TYPE_TAG=1,La.TYPE_GUEST_ROOM=2,La.TYPE_FOLDER=4;let Jp=La;class qV{constructor(t){this._rooms=[],this._searchType=t.readInt(),this._searchParam=t.readString();const e=t.readInt();for(let r=0;r<e;r++)this._rooms.push(new je(t));t.readBoolean()&&(this._ad=new Jp(t))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const t of this._rooms)t.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class XN{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(t){return t?(this._id=t.readInt(),this._code=t.readString(),this._filter=t.readString(),this._localization=t.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class QV{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString(),this._action=t.readInt(),this._closed=t.readBoolean(),this._mode=t.readInt();let e=t.readInt();for(;e>0;)this._rooms.push(new je(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class JV{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString();let e=t.readInt();for(;e>0;)this._results.push(new QV(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class ZV{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._savedSearches=[],!0}parse(t){if(!t)return!1;this._code=t.readString();let e=t.readInt();for(;e>0;)this._savedSearches.push(new XN(t)),e--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class $V{constructor(t){this._adId=t.readInt(),this._ownerAvatarId=t.readInt(),this._ownerAvatarName=t.readString(),this._flatId=t.readInt(),this._eventType=t.readInt(),this._eventName=t.readString(),this._eventDescription=t.readString();const e=t.readInt(),s=t.readInt(),r=new Date;let n=r.getTime();const o=e*60*1e3;n=n-o;const l=new Date(n);this._creationTime=l.getDate()+"-"+l.getMonth()+"-"+l.getFullYear()+" "+l.getHours()+":"+l.getMinutes();let c=r.getTime();const u=s*60*1e3;c=c+u,this._expirationDate=new Date(c),this._categoryId=t.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class t2{flush(){return!0}parse(t){return t?(this._data=new KV(t),!0):!1}get data(){return this._data}}class e2{flush(){return!0}parse(t){return t?(this._data=new XV(t),!0):!1}get data(){return this._data}}class s2{flush(){return!0}parse(t){return t?(this._globalId=t.readString(),this._convertedId=t.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class i2{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class r2{flush(){return!0}parse(t){return t?(this._flatId=t.readInt(),this._added=t.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class n2{flush(){return!0}parse(t){if(!t)return!1;this._favouriteRoomIds=[],this._limit=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._favouriteRoomIds.push(t.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class a2{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class o2{flush(){return this._roomId=-1,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class l2{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(t){return t?(this._roomEnter=t.readBoolean(),this._data=new je(t),this._roomForward=t.readBoolean(),this._staffPick=t.readBoolean(),this._isGroupMember=t.readBoolean(),this.data.allInRoomMuted=t.readBoolean(),this._moderation=new Hi(t),this.data.canMute=t.readBoolean(),this._chat=new ss(t),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class c2{flush(){return!0}parse(t){return t?(this._data=new qV(t),!0):!1}get data(){return this._data}}class u2{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),this._automatic=t.readBoolean(),this._automaticCategoryKey=t.readString(),this._globalCategoryKey=t.readString(),this._staffOnly=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class h2{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(t.readString()),e--;return!0}get categories(){return this._categories}}class d2{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class _2{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(t){return t?(this._homeRoomId=t.readInt(),this._roomIdToEnter=t.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class g2{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._areaId=t.readInt(),this._image=t.readString(),this._caption=t.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class f2{flush(){return this._rooms=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._rooms.push(new g2(t)),e--;return!0}get rooms(){return this._rooms}}class m2{flush(){return this._topLevelContexts=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._topLevelContexts.push(new ZV(t)),e--;return!0}get topLevelContexts(){return this._topLevelContexts}}class E2{flush(){return!0}parse(t){return!!t}}class p2{flush(){return this._searches=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._searches.push(new XN(t)),e--;return!0}get searches(){return this._searches}}class I2{flush(){return this._result=null,!0}parse(t){return t?(this._result=new JV(t),!0):!1}get result(){return this._result}}class T2{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(t){return t?(this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),this._leftPanelHidden=t.readBoolean(),this._resultsMode=t.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class R2{constructor(t){this._tagName=t.readString(),this._userCount=t.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class S2{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._tags=[],!0}parse(t){if(!t)return!1;this._tags=[];const e=t.readInt();let s=0;for(;s<e;)this._tags.push(new R2(t)),s++;return!0}get tags(){return this._tags}}class O2{flush(){return this._data=null,!0}parse(t){return t?(this._data=new S2(t),!0):!1}get data(){return this._data}}class A2{flush(){return!0}parse(t){return!0}}class N2{flush(){return!0}parse(t){return this._data=new $V(t),!0}get data(){return this._data}}class C2{flush(){return this._words=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._words.push(t.readString()),e--;return!0}get words(){return this._words}}class x2{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class y2{flush(){return!0}parse(t){return this._flatId=t.readInt(),this._resultCode=t.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class M2{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new d2(t)),e--;return!0}get categories(){return this._categories}}class b2{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new u2(t)),e--;return!0}get categories(){return this._categories}}class D2{constructor(t){this._badgeCode="",this._removedBadgeCode="",this._type=t.readInt(),this._level=t.readInt(),this._badgeId=t.readInt(),this._badgeCode=t.readString(),this._points=t.readInt(),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._bonusPoints=t.readInt(),this._achievementID=t.readInt(),this._removedBadgeCode=t.readString(),this._category=t.readString(),this._showDialogToUser=t.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class v2{flush(){return this._data=null,!0}parse(t){return t?(this._data=new D2(t),!0):!1}get data(){return this._data}}class P2{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(t){return t?(this._amount=t.readInt(),this._amountChanged=t.readInt(),this._type=t.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class L2{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class U2{flush(){return this._numGifts=0,!0}parse(t){return t?(this._numGifts=t.readInt(),!0):!1}get numGifts(){return this._numGifts}}class j2{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(t){return t?(this._messageId=t.readInt(),this._errorCode=t.readInt(),this._timestamp=t.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class w2{flush(){return this._key=null,!0}parse(t){return t?(this._key=t.readString(),!0):!1}get key(){return this._key}}class F2{flush(){return this._message=null,!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class G2{flush(){return this._enabled=!1,!0}parse(t){return t?(this._enabled=t.readBoolean(),!0):!1}get enabled(){return this._enabled}}class k2{flush(){return this._messages=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._messages.push(t.readString()),e--;return!0}get messages(){return this._messages}}class B2{flush(){return this._type=null,this._parameters=new Map,!0}parse(t){if(!t)return!1;this._type=t.readString();let e=t.readInt();for(;e>0;)this._parameters.set(t.readString(),t.readString()),e--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class V2{flush(){return this._contentType=null,this._classId=0,this._name=null,this._description=null,!0}parse(t){return t?(this._contentType=t.readString(),this._classId=t.readInt(),this._name=t.readString(),this._description=t.readString(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}get name(){return this._name}get description(){return this._description}}class H2{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(t){return t?(this._petId=t.readInt(),this._petName=t.readString(),this._level=t.readInt(),this._figureData=new AR(t),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class W2{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class Y2{flush(){return!0}parse(t){return!0}}class z2{flush(){return this._alertMessage=null,!0}parse(t){return t?(this._alertMessage=t.readString(),t.bytesAvailable&&(this._titleMessage=t.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class K2{flush(){return this._items=new Is,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt();let r=t.readInt();const n=[];for(;r>0;)n.push(t.readInt()),r--;this._items.add(s,n),e--}return!0}getItemsByCategory(t){return this._items.getValue(t)}get categories(){return this._items.getKeys()}}class X2{constructor(t){this._itemName=t.readString(),this._extraInfo=t.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class q2{constructor(t){this._thumbnailUrl=t.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const e=t.readInt();let s=0;for(;s<e;)this._productOfferList.push(new X2(t)),s++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class Q2 extends D{constructor(t){super(t,$2)}getParser(){return this.parser}}class J2{constructor(t){this._dayIndex=t.readInt(),this._stepIndex=t.readInt(),this._options=[];const e=t.readInt();let s=0;for(;s<e;)this._options.push(new q2(t)),s++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class Z2 extends D{constructor(t){super(t,tH)}getParser(){return this.parser}}class $2{flush(){return!0}parse(t){if(!t)return!1;const e=t.readInt();this._giftOptions=[];let s=0;for(;s<e;)this._giftOptions.push(new J2(t)),s++;return!0}get giftOptions(){return this._giftOptions}}class tH{flush(){return!0}parse(t){return!!t}}class eH{constructor(t,e,s){this._code=t,this._errorMessage=e,this._isAllowed=s}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}const er=class er{};er.USE_GUIDE_TOOL="USE_GUIDE_TOOL",er.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR",er.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS",er.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS",er.CALL_ON_HELPERS="CALL_ON_HELPERS",er.CITIZEN="CITIZEN",er.TRADE="TRADE",er.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA",er.BUILDER_AT_WORK="BUILDER_AT_WORK",er.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA",er.CAMERA="CAMERA",er.MOUSE_ZOOM="MOUSE_ZOOM";let Y_=er;class sH{flush(){return this._perks=[],!0}parse(t){if(!t)return!1;this._perks=[];const e=t.readInt();for(let s=0;s<e;s++)this._perks.push(new eH(t.readString(),t.readString(),t.readBoolean()));return!0}isAllowed(t){let e=!1;for(const s of this._perks)if(s.code===t){e=s.isAllowed;break}return e}get perks(){return this._perks}}class iH{flush(){return this._objectId=-1,this._figureData=null,!0}parse(t){return this._objectId=t.readInt(),t.bytesAvailable&&(this._figureData=new da(t.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class rH{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(t){return this._objectId=t.readInt(),this._nameValidationStatus=t.readInt(),this._nameValidationInfo=t.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class nH{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(t){return this._roomIndex=t.readInt(),this._petId=t.readInt(),this._level=t.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class aH{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(t){return this._currentAge=t.readInt(),this._requiredAge=t.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class oH{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(t){this._petId=t.readInt();let e=t.readInt();for(;e>0;)this._commands.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._enabledCommands.push(t.readInt()),s--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class lH{constructor(t,e,s){this._value=t,this._choiceText=e,this._choiceType=s}get value(){return this._value}set value(t){this._value=t}get choiceText(){return this._choiceText}set choiceText(t){this._choiceText=t}get choiceType(){return this._choiceType}set choiceType(t){this._choiceType=t}}class cH{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get questionType(){return this._questionType}set questionType(t){this._questionType=t}get sortOrder(){return this._sortOrder}set sortOrder(t){this._sortOrder=t}get questionText(){return this._questionText}set questionText(t){this._questionText=t}get questionCategory(){return this._questionCategory}set questionCategory(t){this._questionCategory=t}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(t){this._questionAnswerType=t}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(t){this._questionAnswerCount=t}get children(){return this._children}set children(t){this._children=t}get questionChoices(){return this._questionChoices}set questionChoices(t){this._questionChoices=t}}class uH{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(t){this._id=t.readInt(),this._startMessage=t.readString(),this._endMessage=t.readString(),this._numQuestions=t.readInt();for(let e=0;e<this._numQuestions;e++){const s=this.parsePollQuestion(t),r=t.readInt();for(let n=0;n<r;n++)s.children.push(this.parsePollQuestion(t));this._questionArray.push(s)}return this._npsPoll=t.readBoolean(),!0}parsePollQuestion(t){const e=new cH;if(e.questionId=t.readInt(),e.sortOrder=t.readInt(),e.questionType=t.readInt(),e.questionText=t.readString(),e.questionCategory=t.readInt(),e.questionAnswerType=t.readInt(),e.questionAnswerCount=t.readInt(),e.questionType==1||e.questionType==2)for(let s=0;s<e.questionAnswerCount;s++)e.questionChoices.push(new lH(t.readString(),t.readString(),t.readInt()));return e}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class hH{flush(){throw!0}parse(t){return!0}}class dH{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(t){return this._id=t.readInt(),this._type=t.readString(),this._headline=t.readString(),this._summary=t.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class _H{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(t){this._userId=t.readInt(),this._value=t.readString(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const r=t.readString(),n=t.readInt();this._answerCounts.set(r,n)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class gH{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(t){this._questionId=t.readInt(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const r=t.readString(),n=t.readInt();this._answerCounts.set(r,n)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class fH{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(t){this._pollType=t.readString(),this._pollId=t.readInt(),this._questionId=t.readInt(),this._duration=t.readInt();const e=t.readInt(),s=t.readInt(),r=t.readInt(),n=t.readString();if(this._question={id:e,number:s,type:r,content:n},this._question.type==1||this._question.type==2){this._question.selection_min=t.readInt();const o=t.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=o,this._question.selection_max=o;for(let l=0;l<o;l++)this._question.selection_values.push(t.readString()),this._question.selections.push(t.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class mH{flush(){return this._question=null,this._choices=[],this._SafeStr_7651=[],this._SafeStr_7654=-1,!0}parse(t){this._question=t.readString(),this._choices=[],this._SafeStr_7651=[];let e=t.readInt();for(;e>0;)this._choices.push(t.readString()),this._SafeStr_7651.push(t.readInt()),e--;return this._SafeStr_7654=t.readInt(),!0}get question(){return this._question}get choices(){return this._choices}get SafeStr_7651(){return this._SafeStr_7651}get SafeStr_7654(){return this._SafeStr_7654}}class EH{flush(){return this._question=null,this._choices=[],!0}parse(t){this._question=t.readString(),this._choices=[];const e=t.readInt();let s=0;for(;s<e;)this._choices.push(t.readString()),s++;return!0}get question(){return this._question}get choices(){return this._choices.slice()}}class pH{constructor(t){this._rewardUserLimits=[],this._hasGoalExpired=t.readBoolean(),this._personalContributionScore=t.readInt(),this._personalContributionRank=t.readInt(),this._communityTotalScore=t.readInt(),this._communityHighestAchievedLevel=t.readInt(),this._scoreRemainingUntilNextLevel=t.readInt(),this._percentCompletionTowardsNextLevel=t.readInt(),this._goalCode=t.readString(),this._timeRemainingInSeconds=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._rewardUserLimits.push(t.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class IH{constructor(t){this._communityGoalId=t.readInt(),this._communityGoalCode=t.readString(),this._userRank=t.readInt(),this._rewardCode=t.readString(),this._badge=t.readBoolean(),this._localizedName=t.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class TH{flush(){return this._prizes=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._prizes.push(new IH(t));return!0}get prizes(){return this._prizes}}class RH{constructor(t){this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._rank=t.readInt(),this._currentScore=t.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class SH{constructor(t){this._hof=[],this._goalCode=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._hof.push(new RH(t))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class OH{flush(){return this._data=null,!0}parse(t){return t?(this._data=new SH(t),!0):!1}get data(){return this._data}}class AH{flush(){return this._data=null,!0}parse(t){return t?(this._data=new pH(t),!0):!1}get data(){return this._data}}class NH{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(t){return t?(this._state=t.readInt(),this._userCount=t.readInt(),this._userCountGoal=t.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class CH{flush(){return this._imageUri="",!0}parse(t){return t?(this._imageUri=t.readString(),!0):!1}get imageUri(){return this._imageUri}}class xH{flush(){return!0}parse(t){return t?(this._expired=t.readBoolean(),!0):!1}get expired(){return this._expired}}class Ql{constructor(t){this._receiveTime=new Date,this._campaignCode=t.readString(),this._completedQuestsInCampaign=t.readInt(),this._questCountInCampaign=t.readInt(),this._activityPointType=t.readInt(),this._id=t.readInt(),this._accepted=t.readBoolean(),this._type=t.readString(),this._imageVersion=t.readString(),this._rewardCurrencyAmount=t.readInt(),this._localizationCode=t.readString(),this._completedSteps=t.readInt(),this._totalSteps=t.readInt(),this._sortOrder=t.readInt(),this._catalogPageName=t.readString(),this._chainCode=t.readString(),this._easy=t.readBoolean()}static getCampaignLocalizationKeyForCode(t){return"quests."+t}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(t){this._accepted=t}get accepted(){return this._accepted}set id(t){this._id=t}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(t){this._waitPeriodSeconds=t}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const e=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(e/1e3))}getCampaignLocalizationKey(){return Ql.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class yH{flush(){return this._questData=null,!0}parse(t){return t?(this._questData=new Ql(t),this._showDialog=t.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class MH{flush(){return this._quest=null,!0}parse(t){return t?(t.readBoolean()&&(this._quest=new Ql(t),this._easyQuestCount=t.readInt(),this._hardQuestCount=t.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class bH{flush(){return this._quest=null,!0}parse(t){return t?(this._quest=new Ql(t),!0):!1}get quest(){return this._quest}}class DH{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new Ql(t));return this._openWindow=t.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class vH{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new Ql(t));return!0}get quests(){return this._quests}}class PH{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(t){return t?(this._recyclerFinishedStatus=t.readInt(),this._prizeId=t.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class LH{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(t){return t?(this._recyclerStatus=t.readInt(),this._recyclerTimeoutSeconds=t.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class CR{constructor(t){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=t.readBoolean(),this._furniLimit=t.readInt();let e=t.readInt();for(;e>0;)this._stuffIds.push(t.readInt()),e--;for(this._stuffTypeId=t.readInt(),this._id=t.readInt(),this._stringParam=t.readString(),e=t.readInt();e>0;)this._intParams.push(t.readInt()),e--;this._stuffTypeSelectionCode=t.readInt()}getBoolean(t){return this._intParams[t]===1}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(t){this._stuffTypeSelectionCode=t}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class xR extends CR{constructor(t){super(t),this._type=t.readInt()}get type(){return this._type}get code(){return this._type}}class yR extends CR{constructor(t){super(t),this._conflictingActions=[],this._triggerConf=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingActions.push(t.readInt()),e--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class MR extends CR{constructor(t){super(t),this._conflictingTriggers=[],this._type=t.readInt(),this._delayInPulses=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingTriggers.push(t.readInt()),e--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class UH{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new MR(t),!0):!1}get definition(){return this._definition}}class jH{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new xR(t),!0):!1}get definition(){return this._definition}}class wH{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new yR(t),!0):!1}get definition(){return this._definition}}class FH{flush(){return this._stuffId=0,!0}parse(t){return t?(this._stuffId=t.readInt(),!0):!1}get stuffId(){return this._stuffId}}class GH{flush(){return this._reason=0,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class kH{flush(){return!0}parse(t){return!!t}}class BH{flush(){return this._info=null,!0}parse(t){return t?(this._info=t.readString(),!0):!1}get info(){return this._info}}class VH{flush(){return!0}parse(t){return!!t}}class HH{flush(){return!0}parse(t){return!0}}class WH{constructor(){this._songDisks=new Is}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(t){this._maxLength=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._songDisks.add(t.readInt(),t.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class YH{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(t){return this._currentSongId=t.readInt(),this._currentPosition=t.readInt(),this._nextSongId=t.readInt(),this._nextPosition=t.readInt(),this._syncCount=t.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class zH{flush(){return this._songId=0,this._officialSongId="",!0}parse(t){return this._officialSongId=t.readString(),this._songId=t.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class bR{constructor(t,e,s,r){this._startPlayHead=0,this._id=t,this._length=e,this._name=s,this._creator=r}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(t){this._startPlayHead=t}}class KH{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(t){this._synchronizationCount=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._playlist.push(new bR(t.readInt(),t.readInt(),t.readString(),t.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class XH{flush(){return this._entry=null,!0}parse(t){return this._entry=new bR(t.readInt(),t.readInt(),t.readString(),t.readString()),!0}get entry(){return this._entry}}class qH extends bR{constructor(t,e,s,r,n){super(t,e,s,r),this._data="",this._data=n}get data(){return this._data}}class QH{flush(){return this._songs=[],!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++){const r=t.readInt();t.readString();const n=t.readString(),o=t.readString(),l=t.readInt(),c=t.readString(),u=new qH(r,l,n,c,o);this._songs.push(u)}return!0}get songs(){return this._songs}}class JH{constructor(){this._songDiskInventory=new Is}flush(){return this._songDiskInventory.reset(),!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++)this._songDiskInventory.add(t.readInt(),t.readInt());return!0}getDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}get songDiskCount(){return this._songDiskInventory.length}}class ZH{constructor(t){this._perkId=t.readInt()}get perkId(){return this._perkId}}class qN{constructor(t,e){this._productCode=t,this._vipDays=e}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class $H{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(t){if(!t)return!1;let e=0;this._talentTrackName=t.readString(),this._level=t.readInt();const s=t.readInt();for(;e<s;)this._rewardPerks.push(new ZH(t)),e++;const r=t.readInt();if(e<r)for(let n=0;n<r;n++){const o=t.readString(),l=t.readInt();this._rewardProducts.push(new qN(o,l)),e++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class tW{constructor(t,e,s,r,n){this._level=t,this._state=e,this._tasks=s,this._rewardPerks=r,this._rewardProducts=n}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class eW{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(t){return t?(this._talentTrackName=t.readString(),this._level=t.readInt(),this._maxLevel=t.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class sW{constructor(t,e,s,r,n,o){this._id=t,this._requiredLevel=e,this._badgeCode=s,this._state=r,this._currentScore=n,this._totalScore=o}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class iW{flush(){return this._type=null,this._levels=null,!0}parse(t){if(!t)return!1;this._type=t.readString(),this._levels=[];const e=t.readInt();for(let s=0;s<e;s++){const r=t.readInt(),n=t.readInt(),o=[],l=t.readInt();for(let f=0;f<l;f++){const E=t.readInt(),m=t.readInt(),I=t.readString(),p=t.readInt(),T=t.readInt(),R=t.readInt();o.push(new sW(E,m,I,p,T,R))}const c=[],u=t.readInt();for(let f=0;f<u;f++)c.push(t.readString());const h=[],d=t.readInt();for(let f=0;f<d;f++){const E=t.readString(),m=t.readInt();h.push(new qN(E,m))}this._levels.push(new tW(r,n,o,c,h))}return!0}get type(){return this._type}get levels(){return this._levels}}class rW{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(t){if(!t)return!1;let e,s,r,n=t.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;n>0;)e=t.readInt(),s=t.readString(),r=t.readString(),this._classifiedUsersNames.set(e,s),this._classifiedUsersClass.set(e,r),n--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class nW extends D{constructor(t){super(t,tw)}getParser(){return this.parser}}class aW extends D{constructor(t){super(t,ew)}getParser(){return this.parser}}class QN extends D{constructor(t){super(t,sw)}getParser(){return this.parser}}class oW extends D{constructor(t){super(t,iw)}getParser(){return this.parser}}class JN extends D{constructor(t){super(t,rw)}getParser(){return this.parser}}class ZN extends D{constructor(t){super(t,nw)}getParser(){return this.parser}}class $N extends D{constructor(t){super(t,aw)}getParser(){return this.parser}}class tC extends D{constructor(t){super(t,ow)}getParser(){return this.parser}}const Gn=class Gn extends D{constructor(t){super(t,lw)}getParser(){return this.parser}};Gn.NAME_OK=0,Gn.ERROR_NAME_REQUIRED=1,Gn.ERROR_NAME_TOO_SHORT=2,Gn.ERROR_NAME_TOO_LONG=3,Gn.ERROR_NAME_NOT_VALID=4,Gn.ERROR_NAME_IN_USE=5,Gn.ERROR_NAME_CHANGE_NOT_ALLOWED=6,Gn.ERROR_MERGE_HOTEL_DOWN=7;let rd=Gn;class eC extends D{constructor(t){super(t,cw)}getParser(){return this.parser}}class DR extends D{constructor(t){super(t,uw)}getParser(){return this.parser}}class lW extends D{constructor(t){super(t,dw)}getParser(){return this.parser}}class sC extends D{constructor(t){super(t,_w)}getParser(){return this.parser}}class iC extends D{constructor(t){super(t,gw)}getParser(){return this.parser}}class cW extends D{constructor(t){super(t,fw)}getParser(){return this.parser}}class rC extends D{constructor(t){super(t,mw)}getParser(){return this.parser}}class nC extends D{constructor(t){super(t,Tw)}getParser(){return this.parser}}class aC extends D{constructor(t){super(t,Rw)}getParser(){return this.parser}}class oC extends D{constructor(t){super(t,Sw)}getParser(){return this.parser}}class lC extends D{constructor(t){super(t,Ow)}getParser(){return this.parser}}class cC extends D{constructor(t){super(t,Aw)}getParser(){return this.parser}}class uW extends D{constructor(t){super(t,Nw)}getParser(){return this.parser}}class uC extends D{constructor(t){super(t,Cw)}getParser(){return this.parser}}class hW extends D{constructor(t){super(t,xw)}getParser(){return this.parser}}class hC extends D{constructor(t){super(t,yw)}getParser(){return this.parser}}class dW extends D{constructor(t){super(t,Mw)}getParser(){return this.parser}}class dC extends D{constructor(t){super(t,bw)}getParser(){return this.parser}}class _C extends D{constructor(t){super(t,Dw)}getParser(){return this.parser}}class gC extends D{constructor(t){super(t,vw)}getParser(){return this.parser}}class fC extends D{constructor(t){super(t,Pw)}getParser(){return this.parser}}class mC extends D{constructor(t){super(t,Lw)}getParser(){return this.parser}}class _W extends D{constructor(t){super(t,jw)}getParser(){return this.parser}}class gW extends D{constructor(t){super(t,Gw)}getParser(){return this.parser}}class EC extends D{constructor(t){super(t,kw)}getParser(){return this.parser}}class pC extends D{constructor(t){super(t,ww)}getParser(){return this.parser}}class fW extends D{constructor(t){super(t,Bw)}getParser(){return this.parser}}class IC extends D{constructor(t){super(t,Vw)}getParser(){return this.parser}}class vR extends D{constructor(t){super(t,Ww)}getParser(){return this.parser}}class TC extends D{constructor(t){super(t,Yw)}getParser(){return this.parser}}class mW extends D{constructor(t){super(t,Kw)}getParser(){return this.parser}}class EW extends D{constructor(t){super(t,qw)}getParser(){return this.parser}}class RC extends D{constructor(t){super(t,Qw)}getParser(){return this.parser}}class SC extends D{constructor(t){super(t,Jw)}getParser(){return this.parser}}class pW extends D{constructor(t){super(t,Zw)}getParser(){return this.parser}}class OC extends D{constructor(t){super(t,$w)}getParser(){return this.parser}}class IW extends D{constructor(t){super(t,t1)}getParser(){return this.parser}}class AC extends D{constructor(t){super(t,e1)}getParser(){return this.parser}}class TW extends D{constructor(t){super(t,s1)}getParser(){return this.parser}}class RW extends D{constructor(t){super(t,i1)}getParser(){return this.parser}}class NC extends D{constructor(t){super(t,r1)}getParser(){return this.parser}}class CC extends D{constructor(t){super(t,n1)}getParser(){return this.parser}}class xC extends D{constructor(t){super(t,a1)}getParser(){return this.parser}}class yC extends D{constructor(t){super(t,l1)}getParser(){return this.parser}}class MC extends D{constructor(t){super(t,ok)}getParser(){return this.parser}}class SW extends D{constructor(t){super(t,lk)}getParser(){return this.parser}}class bC extends D{constructor(t){super(t,uk)}getParser(){return this.parser}}class DC extends D{constructor(t){super(t,_k)}getParser(){return this.parser}}class OW extends D{constructor(t){super(t,dk)}getParser(){return this.parser}}class vC extends D{constructor(t){super(t,gk)}getParser(){return this.parser}}class PC extends D{constructor(t){super(t,fk)}getParser(){return this.parser}}class LC extends D{constructor(t){super(t,mk)}getParser(){return this.parser}}class AW extends D{constructor(t){super(t,Lp)}getParser(){return this.parser}}class NW extends D{constructor(t){super(t,Ek)}getParser(){return this.parser}}class CW extends D{constructor(t){super(t,pk)}getParser(){return this.parser}}class xW extends D{constructor(t){super(t,Ik)}getParser(){return this.parser}}class yW extends D{constructor(t){super(t,Tk)}getParser(){return this.parser}}class MW extends D{constructor(t){super(t,Rk)}getParser(){return this.parser}}class UC extends D{constructor(t){super(t,Sk)}getParser(){return this.parser}}class jC extends D{constructor(t){super(t,Ak)}getParser(){return this.parser}}class wC extends D{constructor(t){super(t,Nk)}getParser(){return this.parser}}class FC extends D{constructor(t){super(t,Ck)}getParser(){return this.parser}}class nd extends D{constructor(t){super(t,xk)}getParser(){return this.parser}}class bW extends D{constructor(t){super(t,Mk)}getParser(){return this.parser}}class GC extends D{constructor(t){super(t,bk)}getParser(){return this.parser}}class DW extends D{constructor(t){super(t,Dk)}getParser(){return this.parser}}class kC extends D{constructor(t){super(t,vk)}getParser(){return this.parser}}class BC extends D{constructor(t){super(t,Pk)}getParser(){return this.parser}}class vW extends D{constructor(t){super(t,Lk)}getParser(){return this.parser}}class VC extends D{constructor(t){super(t,Uk)}getParser(){return this.parser}}class HC extends D{constructor(t){super(t,jk)}getParser(){return this.parser}}class PW extends D{constructor(t){super(t,wk)}getParser(){return this.parser}}class LW extends D{constructor(t){super(t,Fk)}getParser(){return this.parser}}class WC extends D{constructor(t){super(t,Gk)}getParser(){return this.parser}}class UW extends D{constructor(t){super(t,kk)}getParser(){return this.parser}}class jW extends D{constructor(t){super(t,Bk)}getParser(){return this.parser}}class PR extends D{constructor(t){super(t,Vk)}getParser(){return this.parser}}class LR extends D{constructor(t){super(t,Hk)}getParser(){return this.parser}}class YC extends D{constructor(t){super(t,Wk)}getParser(){return this.parser}}class UR extends D{constructor(t){super(t,Yk)}getParser(){return this.parser}}class zC extends D{constructor(t){super(t,zk)}getParser(){return this.parser}}class wW extends D{constructor(t){super(t,wp)}getParser(){return this.parser}}class FW extends D{constructor(t){super(t,Kk)}getParser(){return this.parser}}class GW extends D{constructor(t){super(t,Fp)}getParser(){return this.parser}}class kW extends D{constructor(t){super(t,Gp)}getParser(){return this.parser}}class BW extends D{constructor(t){super(t,Xk)}getParser(){return this.parser}}class VW extends D{constructor(t){super(t,qk)}getParser(){return this.parser}}class HW extends D{constructor(t){super(t,Qk)}getParser(){return this.parser}}class WW extends D{constructor(t){super(t,Jk)}getParser(){return this.parser}}class YW extends D{constructor(t){super(t,Zk)}getParser(){return this.parser}}class zW extends D{constructor(t){super(t,tB)}getParser(){return this.parser}}class KW extends D{constructor(t){super(t,sB)}getParser(){return this.parser}}class KC extends D{constructor(t){super(t,iB)}getParser(){return this.parser}}class XC extends D{constructor(t){super(t,kp)}getParser(){return this.parser}}class XW extends D{constructor(t){super(t,rB)}getParser(){return this.parser}}class qW extends D{constructor(t){super(t,Bp)}getParser(){return this.parser}}class QW extends D{constructor(t){super(t,nB)}getParser(){return this.parser}}class JW extends D{constructor(t){super(t,aB)}getParser(){return this.parser}}class jR extends D{constructor(t){super(t,oB)}getParser(){return this.parser}}class ZW extends D{constructor(t){super(t,lB)}getParser(){return this.parser}}class $W extends D{constructor(t){super(t,cB)}getParser(){return this.parser}}class tY extends D{constructor(t){super(t,Hm)}getParser(){return this.parser}}class eY extends D{constructor(t){super(t,Hm)}getParser(){return this.parser}}class sY extends D{constructor(t){super(t,Hm)}getParser(){return this.parser}}class iY extends D{constructor(t){super(t,Hm)}getParser(){return this.parser}}class rY extends D{constructor(t){super(t,hB)}getParser(){return this.parser}}class nY extends D{constructor(t){super(t,dB)}getParser(){return this.parser}}class z_ extends D{constructor(t){super(t,_B)}getParser(){return this.parser}}class aY extends D{constructor(t){super(t,gB)}getParser(){return this.parser}}class oY extends D{constructor(t){super(t,fB)}getParser(){return this.parser}}class lY extends D{constructor(t){super(t,mB)}getParser(){return this.parser}}class wR extends D{constructor(t){super(t,EB)}getParser(){return this.parser}}class qC extends D{constructor(t){super(t,pB)}getParser(){return this.parser}}class QC extends D{constructor(t){super(t,IB)}getParser(){return this.parser}}class Du extends D{constructor(t){super(t,TB)}getParser(){return this.parser}}class JC extends D{constructor(t){super(t,OB)}getParser(){return this.parser}}class ZC extends D{constructor(t){super(t,AB)}getParser(){return this.parser}}class $C extends D{constructor(t){super(t,NB)}getParser(){return this.parser}}class tx extends D{constructor(t){super(t,CB)}getParser(){return this.parser}}class cY extends D{constructor(t){super(t,xB)}getParser(){return this.parser}}class uY extends D{constructor(t){super(t,yB)}getParser(){return this.parser}}class hY extends D{constructor(t){super(t,MB)}getParser(){return this.parser}}class dY extends D{constructor(t){super(t,bB)}getParser(){return this.parser}}class _Y extends D{constructor(t){super(t,DB)}getParser(){return this.parser}}class gY extends D{constructor(t){super(t,vB)}getParser(){return this.parser}}class fY extends D{constructor(t){super(t,PB)}getParser(){return this.parser}}class mY extends D{constructor(t){super(t,LB)}getParser(){return this.parser}}class EY extends D{constructor(t){super(t,UB)}getParser(){return this.parser}}class pY extends D{constructor(t){super(t,jB)}getParser(){return this.parser}}const Jt=class Jt{};Jt.LOGOUT=0,Jt.JUST_BANNED=1,Jt.CONCURRENT_LOGIN=2,Jt.CONNECTION_LOST_TO_PEER=3,Jt.AVATAR_IDENTITY_CHANGE=4,Jt.REMOVE_FURNITURE_TOOL=5,Jt.STILL_BANNED=10,Jt.DUAL_LOGIN_BY_USERID=11,Jt.HOTEL_CLOSED=12,Jt.DUAL_LOGIN_BY_IP=13,Jt.PEER_CONNECTION_MISSING=16,Jt.NO_LOGIN_PERMISSION=17,Jt.DUPLICATE_CONNECTION=18,Jt.HOTEL_CLOSING=19,Jt.INCORRECT_PASSWORD=20,Jt.INVALID_LOGIN_TICKET=22,Jt.VERSION_CHECK_URL=23,Jt.VERSION_CHECK_PROPERTY=24,Jt.VERSION_CHECK_MACHINE_ID=25,Jt.NO_MESSENGER_SESSION=26,Jt.USER_NOT_FOUND=27,Jt.CRYPTO_NOT_INITIALIZED=28,Jt.DEV_CRYPTO_NOT_ALLOWED=29,Jt.DUPLICATE_UUID_DETECTED=100,Jt.OLD_SESSION_IN_PROXY=101,Jt.PUBLIC_KEY_NOT_NUMERIC=102,Jt.PUBLIC_KEY_TOO_SHORT=103,Jt.SOCKET_READ_GENERIC=104,Jt.SOCKET_READ_FIRST_BYTE=105,Jt.SOCKET_READ_LENGTH=106,Jt.SOCKET_READ_BODY=107,Jt.SOCKET_READ_POLICY=108,Jt.SOCKET_IO_EXCEPTION=109,Jt.SOCKET_WRONG_CRYPTO=110,Jt.PROXY_RUNTIME_EXCEPTION=111,Jt.IDLE_CONNECTION=112,Jt.PONG_TIMEOUT=113,Jt.IDLE_CONNECTION_NOT_AUTH=114,Jt.IDLE_CONNECTION_NO_USER_ID=115,Jt.WRITE_CLOSED_CHANNEL=116,Jt.SOCKET_WRITE_EXCEPTION_1=117,Jt.SOCKET_WRITE_EXCEPTION_2=118,Jt.SOCKET_WRITE_EXCEPTION_3=119;let fc=Jt;class IY extends D{constructor(t){super(t,wB)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case fc.JUST_BANNED:case fc.STILL_BANNED:return"banned";case fc.CONCURRENT_LOGIN:return"concurrentlogin";case fc.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class TY extends D{constructor(t){super(t,FB)}getParser(){return this.parser}}class RY extends D{constructor(t){super(t,GB)}getParser(){return this.parser}}class ex extends D{constructor(t){super(t,kB)}getParser(){return this.parser}}class sx extends D{constructor(t){super(t,BB)}getParser(){return this.parser}}class ix extends D{constructor(t){super(t,VB)}getParser(){return this.parser}}class rx extends D{constructor(t){super(t,HB)}getParser(){return this.parser}}class nx extends D{constructor(t){super(t,WB)}getParser(){return this.parser}}class ax extends D{constructor(t){super(t,YB)}getParser(){return this.parser}}class SY extends D{constructor(t){super(t,zB)}getParser(){return this.parser}}class OY extends D{constructor(t){super(t,KB)}getParser(){return this.parser}}class AY extends D{constructor(t){super(t,XB)}getParser(){return this.parser}}class NY extends D{constructor(t){super(t,qB)}getParser(){return this.parser}}class CY extends D{constructor(t){super(t,Vp)}getParser(){return this.parser}}class ox extends D{constructor(t){super(t,QB)}getParser(){return this.parser}}class xY extends D{constructor(t){super(t,Hp)}getParser(){return this.parser}}class lx extends D{constructor(t){super(t,ZB)}getParser(){return this.parser}}class cx extends D{constructor(t){super(t,$B)}getParser(){return this.parser}}class FR extends D{constructor(t){super(t,tV)}getParser(){return this.parser}}class GR extends D{constructor(t){super(t,Wp)}getParser(){return this.parser}}class ux extends D{constructor(t){super(t,eV)}getParser(){return this.parser}}class hx extends D{constructor(t){super(t,sV)}getParser(){return this.parser}}class dx extends D{constructor(t){super(t,iV)}getParser(){return this.parser}}class _x extends D{constructor(t){super(t,rV)}getParser(){return this.parser}}class kR extends D{constructor(t){super(t,nV)}getParser(){return this.parser}}class yY extends D{constructor(t){super(t,Yp)}getParser(){return this.parser}}class MY extends D{constructor(t){super(t,zp)}getParser(){return this.parser}}class bY extends D{constructor(t){super(t,aV)}getParser(){return this.parser}}class gx extends D{constructor(t){super(t,oV)}getParser(){return this.parser}}class DY extends D{constructor(t){super(t,lV)}getParser(){return this.parser}}class vY extends D{constructor(t){super(t,cV)}getParser(){return this.parser}}class fx extends D{constructor(t){super(t,v1)}getParser(){return this.parser}}class mx extends D{constructor(t){super(t,P1)}getParser(){return this.parser}}class Ex extends D{constructor(t){super(t,L1)}getParser(){return this.parser}}class PY extends D{constructor(t){super(t,j1)}getParser(){return this.parser}}class LY extends D{constructor(t){super(t,w1)}getParser(){return this.parser}}class UY extends D{constructor(t){super(t,F1)}getParser(){return this.parser}}class jY extends D{constructor(t){super(t,G1)}getParser(){return this.parser}}class wY extends D{constructor(t){super(t,k1)}getParser(){return this.parser}}class BR extends D{constructor(t){super(t,V1)}getParser(){return this.parser}}class px extends D{constructor(t){super(t,H1)}getParser(){return this.parser}}class Ix extends D{constructor(t){super(t,W1)}getParser(){return this.parser}}class FY extends D{constructor(t){super(t,Y1)}getParser(){return this.parser}}class Tx extends D{constructor(t){super(t,z1)}getParser(){return this.parser}}class VR extends D{constructor(t){super(t,bG)}getParser(){return this.parser}}class K_ extends D{constructor(t){super(t,vG)}getParser(){return this.parser}}class Rx extends D{constructor(t){super(t,DG)}getParser(){return this.parser}}class HR extends D{constructor(t){super(t,PG)}getParser(){return this.parser}}class Sx extends D{constructor(t){super(t,LG)}getParser(){return this.parser}}class Ox extends D{constructor(t){super(t,UG)}getParser(){return this.parser}}class GY extends D{constructor(t){super(t,jG)}getParser(){return this.parser}}class kY extends D{constructor(t){super(t,wG)}getParser(){return this.parser}}class BY extends D{constructor(t){super(t,FG)}getParser(){return this.parser}}class Ax extends D{constructor(t){super(t,GG)}getParser(){return this.parser}}class Nx extends D{constructor(t){super(t,kG)}getParser(){return this.parser}}class Cx extends D{constructor(t){super(t,BG)}getParser(){return this.parser}}class xx extends D{constructor(t){super(t,VG)}getParser(){return this.parser}}class yx extends D{constructor(t){super(t,WG)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class Mx extends D{constructor(t){super(t,W_)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class bx extends D{constructor(t){super(t,YG)}getParser(){return this.parser}}class Dx extends D{constructor(t){super(t,zG)}getParser(){return this.parser}}class vx extends D{constructor(t){super(t,KG)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class VY extends D{constructor(t){super(t,XG)}getParser(){return this.parser}}class Px extends D{constructor(t){super(t,qG)}getParser(){return this.parser}}class Lx extends D{constructor(t){super(t,QG)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class Ux extends D{constructor(t){super(t,Pp)}getParser(){return this.parser}}class jx extends D{constructor(t){super(t,JG)}getParser(){return this.parser}}class wx extends D{constructor(t){super(t,ZG)}getParser(){return this.parser}}class Fx extends D{constructor(t){super(t,uV)}getParser(){return this.parser}}class HY extends D{constructor(t){super(t,hV)}getParser(){return this.parser}}class Gx extends D{constructor(t){super(t,dV)}getParser(){return this.parser}}class kx extends D{constructor(t){super(t,_V)}getParser(){return this.parser}}class WY extends D{constructor(t){super(t,gV)}getParser(){return this.parser}}class Bx extends D{constructor(t){super(t,fV)}getParser(){return this.parser}}class YY extends D{constructor(t){super(t,EV)}getParser(){return this.parser}}class Vx extends D{constructor(t){super(t,mV)}getParser(){return this.parser}}class Hx extends D{constructor(t){super(t,Xp)}getParser(){return this.parser}}class Wx extends D{constructor(t){super(t,qp)}getParser(){return this.parser}}class Yx extends D{constructor(t){super(t,TV)}getParser(){return this.parser}}class zx extends D{constructor(t){super(t,RV)}getParser(){return this.parser}}class Kx extends D{constructor(t){super(t,KN)}getParser(){return this.parser}}class Xx extends D{constructor(t){super(t,OV)}getParser(){return this.parser}}class qx extends D{constructor(t){super(t,NV)}getParser(){return this.parser}}class Qx extends D{constructor(t){super(t,AV)}getParser(){return this.parser}}class Jx extends D{constructor(t){super(t,xV)}getParser(){return this.parser}}class Zx extends D{constructor(t){super(t,yV)}getParser(){return this.parser}}class $x extends D{constructor(t){super(t,DV)}getParser(){return this.parser}}class ty extends D{constructor(t){super(t,vV)}getParser(){return this.parser}}class ey extends D{constructor(t){super(t,LV)}getParser(){return this.parser}}class sy extends D{constructor(t){super(t,UV)}getParser(){return this.parser}}class iy extends D{constructor(t){super(t,FV)}getParser(){return this.parser}}class ry extends D{constructor(t){super(t,GV)}getParser(){return this.parser}}class ny extends D{constructor(t){super(t,BV)}getParser(){return this.parser}}class ay extends D{constructor(t){super(t,VV)}getParser(){return this.parser}}class oy extends D{constructor(t){super(t,HV)}getParser(){return this.parser}}class ly extends D{constructor(t){super(t,WV)}getParser(){return this.parser}}class cy extends D{constructor(t){super(t,YV)}getParser(){return this.parser}}class zY extends D{constructor(t){super(t,Qp)}getParser(){return this.parser}}class uy extends D{constructor(t){super(t,zV)}getParser(){return this.parser}}class KY extends D{constructor(t){super(t,t2)}getParser(){return this.parser}}class XY extends D{constructor(t){super(t,e2)}getParser(){return this.parser}}class qY extends D{constructor(t){super(t,s2)}getParser(){return this.parser}}class WR extends D{constructor(t){super(t,i2)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class QY extends D{constructor(t){super(t,r2)}getParser(){return this.parser}}class JY extends D{constructor(t){super(t,n2)}getParser(){return this.parser}}class X_ extends D{constructor(t){super(t,a2)}getParser(){return this.parser}}class hy extends D{constructor(t){super(t,o2)}getParser(){return this.parser}}class $a extends D{constructor(t){super(t,l2)}getParser(){return this.parser}}class ZY extends D{constructor(t){super(t,c2)}getParser(){return this.parser}}class $Y extends D{constructor(t){super(t,h2)}getParser(){return this.parser}}class dy extends D{constructor(t){super(t,_2)}getParser(){return this.parser}}class t3 extends D{constructor(t){super(t,f2)}getParser(){return this.parser}}class _y extends D{constructor(t){super(t,m2)}getParser(){return this.parser}}class gy extends D{constructor(t){super(t,E2)}getParser(){return this.parser}}class e3 extends D{constructor(t){super(t,p2)}getParser(){return this.parser}}class fy extends D{constructor(t){super(t,I2)}getParser(){return this.parser}}class s3 extends D{constructor(t){super(t,T2)}getParser(){return this.parser}}class JO extends D{constructor(t){super(t,O2)}getParser(){return this.parser}}class i3 extends D{constructor(t){super(t,A2)}getParser(){return this.parser}}class my extends D{constructor(t){super(t,N2)}getParser(){return this.parser}}class Ey extends D{constructor(t){super(t,C2)}getParser(){return this.parser}}class py extends D{constructor(t){super(t,x2)}getParser(){return this.parser}}class r3 extends D{constructor(t){super(t,y2)}getParser(){return this.parser}}class Iy extends D{constructor(t){super(t,M2)}getParser(){return this.parser}}class Ty extends D{constructor(t){super(t,b2)}getParser(){return this.parser}}class Ry extends D{constructor(t){super(t,v2)}getParser(){return this.parser}}class YR extends D{constructor(t){super(t,P2)}getParser(){return this.parser}}class Sy extends D{constructor(t){super(t,L2)}getParser(){return this.parser}}class Oy extends D{constructor(t){super(t,U2)}getParser(){return this.parser}}class Ay extends D{constructor(t){super(t,j2)}getParser(){return this.parser}}class n3 extends D{constructor(t){super(t,w2)}getParser(){return this.parser}}class Ny extends D{constructor(t){super(t,F2)}getParser(){return this.parser}}class Cy extends D{constructor(t){super(t,G2)}getParser(){return this.parser}}class xy extends D{constructor(t){super(t,k2)}getParser(){return this.parser}}class yy extends D{constructor(t){super(t,B2)}getParser(){return this.parser}}class a3 extends D{constructor(t){super(t,V2)}getParser(){return this.parser}}class My extends D{constructor(t){super(t,H2)}getParser(){return this.parser}}class by extends D{constructor(t){super(t,W2)}getParser(){return this.parser}}class o3 extends D{constructor(t){super(t,Y2)}getParser(){return this.parser}}class Dy extends D{constructor(t){super(t,z2)}getParser(){return this.parser}}class vy extends D{constructor(t){super(t,K2)}getParser(){return this.parser}}class zR extends D{constructor(t){super(t,sH)}getParser(){return this.parser}}class l3 extends D{constructor(t){super(t,vp)}getParser(){return this.parser}}class Py extends D{constructor(t){super(t,iH)}getParser(){return this.parser}}class Ly extends D{constructor(t){super(t,rH)}getParser(){return this.parser}}class Uy extends D{constructor(t){super(t,nH)}getParser(){return this.parser}}class jy extends D{constructor(t){super(t,aH)}getParser(){return this.parser}}class wy extends D{constructor(t){super(t,oH)}getParser(){return this.parser}}class Fy extends D{constructor(t){super(t,uH)}getParser(){return this.parser}}class Gy extends D{constructor(t){super(t,hH)}getParser(){return this.parser}}class ky extends D{constructor(t){super(t,dH)}getParser(){return this.parser}}class By extends D{constructor(t){super(t,_H)}getParser(){return this.parser}}class Vy extends D{constructor(t){super(t,fH)}getParser(){return this.parser}}class Hy extends D{constructor(t){super(t,gH)}getParser(){return this.parser}}class Wy extends D{constructor(t){super(t,mH)}getParser(){return this.parser}}class Yy extends D{constructor(t){super(t,EH)}getParser(){return this.parser}}class c3 extends D{constructor(t){super(t,TH)}getParser(){return this.parser}}class zy extends D{constructor(t){super(t,OH)}getParser(){return this.parser}}class u3 extends D{constructor(t){super(t,AH)}getParser(){return this.parser}}class h3 extends D{constructor(t){super(t,NH)}getParser(){return this.parser}}class d3 extends D{constructor(t){super(t,CH)}getParser(){return this.parser}}class _3 extends D{constructor(t){super(t,xH)}getParser(){return this.parser}}class g3 extends D{constructor(t){super(t,yH)}getParser(){return this.parser}}class f3 extends D{constructor(t){super(t,MH)}getParser(){return this.parser}}class m3 extends D{constructor(t){super(t,bH)}getParser(){return this.parser}}class E3 extends D{constructor(t){super(t,DH)}getParser(){return this.parser}}class p3 extends D{constructor(t){super(t,vH)}getParser(){return this.parser}}const Kf=class Kf extends D{constructor(t){super(t,PH)}getParser(){return this.parser}};Kf.FINISHED_OK=1,Kf.FINISHED_FAIL=2;let Zp=Kf;const ph=class ph extends D{constructor(t){super(t,LH)}getParser(){return this.parser}};ph.SYSTEM_STATUS_ENABLED=1,ph.SYSTEM_STATUS_DISABLED=2,ph.SYSTEM_STATUS_TIMEOUT=3;let $p=ph;class q_ extends D{constructor(t){super(t,K1)}getParser(){return this.parser}}class tI extends D{constructor(t){super(t,X1)}getParser(){return this.parser}}class eI extends D{constructor(t){super(t,Q1)}getParser(){return this.parser}}class sI extends D{constructor(t){super(t,q1)}getParser(){return this.parser}}class Ky extends D{constructor(t){super(t,ou)}getParser(){return this.parser}}class Q_ extends D{constructor(t){super(t,J1)}getParser(){return this.parser}}class Xy extends D{constructor(t){super(t,Z1)}getParser(){return this.parser}}class qy extends D{constructor(t){super(t,$1)}getParser(){return this.parser}}class I3 extends D{constructor(t){super(t,tF)}getParser(){return this.parser}}class T3 extends D{constructor(t){super(t,sF)}getParser(){return this.parser}}class Qy extends D{constructor(t){super(t,mF)}getParser(){return this.parser}}class KR extends D{constructor(t){super(t,EF)}getParser(){return this.parser}}class Jy extends D{constructor(t){super(t,pF)}getParser(){return this.parser}}class Zy extends D{constructor(t){super(t,TF)}getParser(){return this.parser}}class iI extends D{constructor(t){super(t,$F)}getParser(){return this.parser}}class rI extends D{constructor(t){super(t,tG)}getParser(){return this.parser}}class nI extends D{constructor(t){super(t,SF)}getParser(){return this.parser}}class $y extends D{constructor(t){super(t,OF)}getParser(){return this.parser}}class aI extends D{constructor(t){super(t,AF)}getParser(){return this.parser}}class R3 extends D{constructor(t){super(t,NF)}getParser(){return this.parser}}class oI extends D{constructor(t){super(t,CF)}getParser(){return this.parser}}class lI extends D{constructor(t){super(t,Xo)}getParser(){return this.parser}}class tM extends D{constructor(t){super(t,xF)}getParser(){return this.parser}}class eM extends D{constructor(t){super(t,yF)}getParser(){return this.parser}}class cI extends D{constructor(t){super(t,MF)}getParser(){return this.parser}}class sM extends D{constructor(t){super(t,bF)}getParser(){return this.parser}}class iM extends D{constructor(t){super(t,DF)}getParser(){return this.parser}}class rM extends D{constructor(t){super(t,vF)}getParser(){return this.parser}}class uI extends D{constructor(t){super(t,PF)}getParser(){return this.parser}}class S3 extends D{constructor(t){super(t,LF)}getParser(){return this.parser}}class O3 extends D{constructor(t){super(t,UF)}getParser(){return this.parser}}class A3 extends D{constructor(t){super(t,Dp)}getParser(){return this.parser}}class nM extends D{constructor(t){super(t,jF)}getParser(){return this.parser}}class aM extends D{constructor(t){super(t,FF)}getParser(){return this.parser}}class N3 extends D{constructor(t){super(t,GF)}getParser(){return this.parser}}class C3 extends D{constructor(t){super(t,kF)}getParser(){return this.parser}}class hI extends D{constructor(t){super(t,BF)}getParser(){return this.parser}}class dI extends D{constructor(t){super(t,VF)}getParser(){return this.parser}}class _I extends D{constructor(t){super(t,HF)}getParser(){return this.parser}}class gI extends D{constructor(t){super(t,WF)}getParser(){return this.parser}}class fI extends D{constructor(t){super(t,YF)}getParser(){return this.parser}}class mI extends D{constructor(t){super(t,zF)}getParser(){return this.parser}}class EI extends D{constructor(t){super(t,KF)}getParser(){return this.parser}}class pI extends D{constructor(t){super(t,XF)}getParser(){return this.parser}}class oM extends D{constructor(t){super(t,qF)}getParser(){return this.parser}}class lM extends D{constructor(t){super(t,JF)}getParser(){return this.parser}}class cM extends D{constructor(t){super(t,ZF)}getParser(){return this.parser}}class J_ extends D{constructor(t){super(t,V_)}getParser(){return this.parser}}class Z_ extends D{constructor(t){super(t,eG)}getParser(){return this.parser}}class II extends D{constructor(t){super(t,Uo)}getParser(){return this.parser}}class TI extends D{constructor(t){super(t,sG)}getParser(){return this.parser}}class uM extends D{constructor(t){super(t,iG)}getParser(){return this.parser}}class RI extends D{constructor(t){super(t,rG)}getParser(){return this.parser}}class Ru extends D{constructor(t){super(t,nG)}getParser(){return this.parser}}class $_ extends D{constructor(t){super(t,aG)}getParser(){return this.parser}}class hM extends D{constructor(t){super(t,oG)}getParser(){return this.parser}}class dM extends D{constructor(t){super(t,lG)}getParser(){return this.parser}}class tg extends D{constructor(t){super(t,cG)}getParser(){return this.parser}}class _M extends D{constructor(t){super(t,uG)}getParser(){return this.parser}}class gM extends D{constructor(t){super(t,hG)}getParser(){return this.parser}}class fM extends D{constructor(t){super(t,dG)}getParser(){return this.parser}}class mM extends D{constructor(t){super(t,_G)}getParser(){return this.parser}}class EM extends D{constructor(t){super(t,gG)}getParser(){return this.parser}}class pM extends D{constructor(t){super(t,fG)}getParser(){return this.parser}}class XR extends D{constructor(t){super(t,OR)}getParser(){return this.parser}}class eg extends D{constructor(t){super(t,OR)}getParser(){return this.parser}}class sg extends D{constructor(t){super(t,OR)}getParser(){return this.parser}}class SI extends D{constructor(t){super(t,mG)}getParser(){return this.parser}}class ig extends D{constructor(t){super(t,EG)}getParser(){return this.parser}}class OI extends D{constructor(t){super(t,pG)}getParser(){return this.parser}}class rg extends D{constructor(t){super(t,NG)}getParser(){return this.parser}}class AI extends D{constructor(t){super(t,IG)}getParser(){return this.parser}}class NI extends D{constructor(t){super(t,TG)}getParser(){return this.parser}}class IM extends D{constructor(t){super(t,RG)}getParser(){return this.parser}}class CI extends D{constructor(t){super(t,SG)}getParser(){return this.parser}}class ng extends D{constructor(t){super(t,OG)}getParser(){return this.parser}}class xI extends D{constructor(t){super(t,AG)}getParser(){return this.parser}}class ag extends D{constructor(t){super(t,CG)}getParser(){return this.parser}}class yI extends D{constructor(t){super(t,MG)}getParser(){return this.parser}}class TM extends D{constructor(t){super(t,UH)}getParser(){return this.parser}}class RM extends D{constructor(t){super(t,jH)}getParser(){return this.parser}}class SM extends D{constructor(t){super(t,wH)}getParser(){return this.parser}}class OM extends D{constructor(t){super(t,FH)}getParser(){return this.parser}}const Xf=class Xf extends D{constructor(t){super(t,GH)}getParser(){return this.parser}};Xf.PRODUCT_DONATED_CODE=6,Xf.BADGE_DONATED_CODE=7;let MI=Xf;class AM extends D{constructor(t){super(t,kH)}getParser(){return this.parser}}class x3 extends D{constructor(t){super(t,BH)}getParser(){return this.parser}}class NM extends D{constructor(t){super(t,rF)}getParser(){return this.parser}}class CM extends D{constructor(t){super(t,aF)}getParser(){return this.parser}}class xM extends D{constructor(t){super(t,oF)}getParser(){return this.parser}}class yM extends D{constructor(t){super(t,lF)}getParser(){return this.parser}}class y3 extends D{constructor(t){super(t,cF)}getParser(){return this.parser}}class M3 extends D{constructor(t){super(t,uF)}getParser(){return this.parser}}class MM extends D{constructor(t){super(t,hF)}getParser(){return this.parser}}class b3 extends D{constructor(t){super(t,dF)}getParser(){return this.parser}}class D3 extends D{constructor(t){super(t,_F)}getParser(){return this.parser}}class bM extends D{constructor(t){super(t,ed)}getParser(){return this.parser}}class v3 extends D{constructor(t){super(t,gF)}getParser(){return this.parser}}class P3 extends D{constructor(t){super(t,fF)}getParser(){return this.parser}}class DM extends D{constructor(t){super(t,VH)}getParser(){return this.parser}}class vM extends D{constructor(t){super(t,HH)}getParser(){return this.parser}}class PM extends D{constructor(t){super(t,WH)}getParser(){return this.parser}}class LM extends D{constructor(t){super(t,YH)}getParser(){return this.parser}}class UM extends D{constructor(t){super(t,zH)}getParser(){return this.parser}}class L3 extends D{constructor(t){super(t,KH)}getParser(){return this.parser}}class U3 extends D{constructor(t){super(t,XH)}getParser(){return this.parser}}class jM extends D{constructor(t){super(t,QH)}getParser(){return this.parser}}class wM extends D{constructor(t){super(t,JH)}getParser(){return this.parser}}class j3 extends D{constructor(t){super(t,$H)}getParser(){return this.parser}}class w3 extends D{constructor(t){super(t,eW)}getParser(){return this.parser}}class F3 extends D{constructor(t){super(t,iW)}getParser(){return this.parser}}class qR extends D{constructor(t){super(t,c1)}getParser(){return this.parser}}class FM extends D{constructor(t){super(t,G_)}getParser(){return this.parser}}class GM extends D{constructor(t){super(t,u1)}getParser(){return this.parser}}class G3 extends D{constructor(t){super(t,Cp)}getParser(){return this.parser}}class QR extends D{constructor(t){super(t,d1)}getParser(){return this.parser}}class JR extends D{constructor(t){super(t,_1)}getParser(){return this.parser}}class Su extends D{constructor(t){super(t,f1)}getParser(){return this.parser}}class Wm extends D{constructor(t){super(t,m1)}getParser(){return this.parser}}class kM extends D{constructor(t){super(t,E1)}getParser(){return this.parser}}class ZR extends D{constructor(t){super(t,p1)}getParser(){return this.parser}}class BM extends D{constructor(t){super(t,I1)}getParser(){return this.parser}}class VM extends D{constructor(t){super(t,T1)}getParser(){return this.parser}}class HM extends D{constructor(t){super(t,R1)}getParser(){return this.parser}}class k3 extends D{constructor(t){super(t,S1)}getParser(){return this.parser}}class B3 extends D{constructor(t){super(t,O1)}getParser(){return this.parser}}class V3 extends D{constructor(t){super(t,xp)}getParser(){return this.parser}}class H3 extends D{constructor(t){super(t,A1)}getParser(){return this.parser}}class WM extends D{constructor(t){super(t,N1)}getParser(){return this.parser}}class YM extends D{constructor(t){super(t,C1)}getParser(){return this.parser}}class W3 extends D{constructor(t){super(t,yp)}getParser(){return this.parser}}class zM extends D{constructor(t){super(t,x1)}getParser(){return this.parser}}class $R extends D{constructor(t){super(t,y1)}getParser(){return this.parser}}class KM extends D{constructor(t){super(t,M1)}getParser(){return this.parser}}class XM extends D{constructor(t){super(t,b1)}getParser(){return this.parser}}class qM extends D{constructor(t){super(t,D1)}getParser(){return this.parser}}class QM extends D{constructor(t){super(t,k_)}getParser(){return this.parser}}const Gr=class Gr{constructor(t){this._type=t.readInt(),this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._memberSince=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==Gr.TYPE_ADMIN}get owner(){return this._type==Gr.TYPE_OWNER}get pending(){return this._type==Gr.TYPE_PENDING}get member(){return this._type!=Gr.TYPE_MEMBER}get blocked(){return this._type==Gr.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}};Gr.TYPE_OWNER=0,Gr.TYPE_ADMIN=1,Gr.TYPE_PENDING=2,Gr.TYPE_MEMBER=3,Gr.TYPE_BLOCKED=4;let bI=Gr;class JM extends D{constructor(t){super(t,$G)}getParser(){return this.parser}}class ZM extends D{constructor(t){super(t,tk)}getParser(){return this.parser}}class tS extends D{constructor(t){super(t,ek)}getParser(){return this.parser}}class $M extends D{constructor(t){super(t,rk)}getParser(){return this.parser}}class tb extends D{constructor(t){super(t,nk)}getParser(){return this.parser}}class Y3 extends D{constructor(t){super(t,ak)}getParser(){return this.parser}}class z3 extends D{constructor(t){super(t,rW)}getParser(){return this.parser}}const y=class y{};y.CLICK_FURNI=6002,y.ACHIEVEMENT_LIST=219,y.AUTHENTICATION=-1,y.BOT_CONFIGURATION=1986,y.BOT_PICKUP=3323,y.BOT_PLACE=1592,y.BOT_SKILL_SAVE=2624,y.GET_CLUB_OFFERS=3285,y.GET_CLUB_GIFT_INFO=487,y.GET_CATALOG_INDEX=1195,y.GET_CATALOG_PAGE=412,y.CATALOG_PURCHASE=3492,y.CATALOG_PURCHASE_GIFT=1411,y.GET_PRODUCT_OFFER=2594,y.CLIENT_LATENCY=295,y.CLIENT_LATENCY_MEASURE=96,y.CLIENT_POLICY=26979,y.CLIENT_PONG=2596,y.CLIENT_TOOLBAR_TOGGLE=2313,y.CLIENT_VARIABLES=1053,y.GET_CURRENT_TIMING_CODE=2912,y.DESKTOP_NEWS=1827,y.DESKTOP_VIEW=105,y.GET_BUNDLE_DISCOUNT_RULESET=223,y.EVENT_TRACKER=3457,y.FIND_NEW_FRIENDS=516,y.FURNITURE_ALIASES=3898,y.FURNITURE_FLOOR_UPDATE=248,y.FURNITURE_MULTISTATE=99,y.FURNITURE_PICKUP=3456,y.FURNITURE_PLACE=1258,y.FURNITURE_POSTIT_PLACE=2248,y.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283,y.FURNITURE_RANDOMSTATE=3617,y.FURNITURE_WALL_MULTISTATE=210,y.FURNITURE_WALL_UPDATE=168,y.GAMES_INIT=2914,y.GAMES_LIST=741,y.ACCEPTGAMEINVITE=3802,y.GAMEUNLOADEDMESSAGE=3207,y.GETGAMEACHIEVEMENTSMESSAGE=2399,y.GETGAMESTATUSMESSAGE=3171,y.GETUSERGAMEACHIEVEMENTSMESSAGE=389,y.JOINQUEUEMESSAGE=1458,y.LEAVEQUEUEMESSAGE=2384,y.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144,y.GETWEEKLYGAMEREWARDWINNERS=1054,y.GAME2GETACCOUNTGAMESTATUSMESSAGE=11,y.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259,y.GAME2EXITGAMEMESSAGE=1445,y.GAME2GAMECHATMESSAGE=2502,y.GAME2LOADSTAGEREADYMESSAGE=2415,y.GAME2PLAYAGAINMESSAGE=3196,y.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598,y.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232,y.GAME2GETWEEKLYLEADERBOARD=2565,y.GET_GIFT_WRAPPING_CONFIG=418,y.GROUP_ADMIN_ADD=2894,y.GROUP_ADMIN_REMOVE=722,y.GROUP_CREATE_OPTIONS=798,y.GROUP_FAVORITE=3549,y.GET_FORUM_STATS=3149,y.GET_FORUM_THREADS=873,y.GET_FORUMS_LIST=436,y.GET_FORUM_MESSAGES=232,y.GET_FORUM_THREAD=3900,y.GET_UNREAD_FORUMS_COUNT=2908,y.FORUM_MODERATE_MESSAGE=286,y.FORUM_MODERATE_THREAD=1397,y.FORUM_POST_MESSAGE=3529,y.UPDATE_FORUM_READ_MARKER=1855,y.UPDATE_FORUM_SETTINGS=2214,y.FORUM_UPDATE_THREAD=3045,y.GROUP_INFO=2991,y.GROUP_DELETE=1134,y.GROUP_MEMBER_REMOVE_CONFIRM=3593,y.GROUP_MEMBER_REMOVE=593,y.GROUP_MEMBERS=312,y.GROUP_MEMBERSHIPS=367,y.GROUP_REQUEST=998,y.GROUP_REQUEST_ACCEPT=3386,y.GROUP_REQUEST_DECLINE=1894,y.GROUP_SETTINGS=1004,y.GROUP_PARTS=813,y.GROUP_BUY=230,y.GROUP_SAVE_INFORMATION=3137,y.GROUP_SAVE_BADGE=1991,y.GROUP_SAVE_COLORS=1764,y.GROUP_SAVE_PREFERENCES=3435,y.GROUP_BADGES=21,y.GROUP_UNBLOCK_MEMBER=2864,y.GET_BADGE_POINTS_LIMITS=1371,y.REQUESTABADGE=3077,y.GETISBADGEREQUESTFULFILLED=1364,y.ITEM_CLOTHING_REDEEM=3374,y.ITEM_COLOR_WHEEL_CLICK=2144,y.ITEM_DICE_CLICK=1990,y.ITEM_DICE_CLOSE=1533,y.ITEM_DIMMER_SAVE=1648,y.ITEM_DIMMER_SETTINGS=2813,y.ITEM_DIMMER_TOGGLE=2296,y.ITEM_EXCHANGE_REDEEM=3115,y.ITEM_PAINT=711,y.SET_OBJECT_DATA=3608,y.ITEM_STACK_HELPER=3839,y.ITEM_WALL_CLICK=210,y.ITEM_WALL_UPDATE=168,y.MARKETPLACE_CONFIG=2597,y.ACCEPT_FRIEND=137,y.MESSENGER_CHAT=3567,y.DECLINE_FRIEND=2890,y.FOLLOW_FRIEND=3997,y.MESSENGER_FRIENDS=1523,y.MESSENGER_INIT=2781,y.MESSENGER_RELATIONSHIPS=2138,y.SET_RELATIONSHIP_STATUS=3768,y.REMOVE_FRIEND=1689,y.REQUEST_FRIEND=3157,y.GET_FRIEND_REQUESTS=2448,y.SEND_ROOM_INVITE=1276,y.HABBO_SEARCH=1210,y.FRIEND_LIST_UPDATE=1419,y.MOD_TOOL_USER_INFO=3295,y.GET_USER_FLAT_CATS=3027,y.NAVIGATOR_INIT=2110,y.NAVIGATOR_SEARCH=249,y.NAVIGATOR_SEARCH_CLOSE=1834,y.NAVIGATOR_SEARCH_OPEN=637,y.NAVIGATOR_SEARCH_SAVE=2226,y.GET_USER_EVENT_CATS=1782,y.NAVIGATOR_SETTINGS_SAVE=3159,y.NAVIGATOR_CATEGORY_LIST_MODE=1202,y.NAVIGATOR_DELETE_SAVED_SEARCH=1954,y.PET_INFO=2934,y.PET_PICKUP=1581,y.PET_PLACE=2647,y.PET_RESPECT=3202,y.PET_RIDE=1036,y.PET_MOVE=3449,y.PET_OPEN_PACKAGE=3698,y.PET_SELECTED=549,y.PETS_BREED=1638,y.PET_CANCEL_BREEDING=2713,y.PET_CONFIRM_BREEDING=3382,y.GET_PET_TRAINING_PANEL=2161,y.RECYCLER_PRIZES=398,y.RECYCLER_STATUS=1342,y.RECYCLER_ITEMS=2771,y.RELEASE_VERSION=4e3,y.CALL_FOR_HELP=1691,y.ROOM_AMBASSADOR_ALERT=2996,y.ROOM_BAN_GIVE=1477,y.ROOM_BAN_LIST=2267,y.ROOM_BAN_REMOVE=992,y.ROOM_CREATE=2752,y.ROOM_DELETE=532,y.ROOM_DOORBELL=1644,y.ROOM_ENTER=2312,y.ROOM_FAVORITE=3817,y.ROOM_FAVORITE_REMOVE=309,y.CAN_CREATE_ROOM=2128,y.CANCEL_ROOM_EVENT=2725,y.EDIT_ROOM_EVENT=3991,y.COMPETITION_ROOM_SEARCH=433,y.FORWARD_TO_RANDOM_PROMOTED_ROOM=10,y.FORWARD_TO_SOME_ROOM=1703,y.GET_CATEGORIES_WITH_USER_COUNT=3782,y.GET_GUEST_ROOM=2230,y.GET_OFFICIAL_ROOMS=1229,y.GET_POPULAR_ROOM_TAGS=826,y.GUILD_BASE_SEARCH=2930,y.MY_FAVOURITE_ROOMS_SEARCH=2578,y.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002,y.MY_FRIENDS_ROOM_SEARCH=2266,y.MY_GUILD_BASES_SEARCH=39,y.MY_RECOMMENDED_ROOMS=2537,y.MY_ROOM_HISTORY_SEARCH=2264,y.MY_ROOM_RIGHTS_SEARCH=272,y.MY_ROOMS_SEARCH=2277,y.POPULAR_ROOMS_SEARCH=2758,y.ROOM_AD_EVENT_TAB_CLICKED=2412,y.ROOM_AD_EVENT_TAB_VIEWED=2668,y.ROOM_AD_SEARCH=2809,y.ROOM_TEXT_SEARCH=3943,y.ROOMS_WHERE_MY_FRIENDS_ARE=1786,y.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939,y.SET_ROOM_SESSION_TAGS=3305,y.UPDATE_ROOM_THUMBNAIL=2468,y.ROOM_KICK=1320,y.ROOM_LIKE=3582,y.ROOM_MODEL=2300,y.GET_OCCUPIED_TILES=1687,y.GET_ROOM_ENTRY_TILE=3559,y.ROOM_MODEL_SAVE=875,y.ROOM_MUTE=3637,y.ROOM_MUTE_USER=3485,y.ROOM_RIGHTS_GIVE=808,y.ROOM_RIGHTS_LIST=3385,y.ROOM_RIGHTS_REMOVE=2064,y.ROOM_RIGHTS_REMOVE_ALL=2683,y.ROOM_RIGHTS_REMOVE_OWN=3182,y.ROOM_SETTINGS=3129,y.ROOM_SETTINGS_SAVE=1969,y.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265,y.ROOM_STAFF_PICK=1918,y.ROOM_FILTER_WORDS=1911,y.ROOM_FILTER_WORDS_MODIFY=3001,y.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012,y.MYSTERYBOX_OPEN_TROPHY=3074,y.SECURITY_MACHINE=2490,y.SECURITY_TICKET=2419,y.TRADE=1481,y.TRADE_ACCEPT=3863,y.TRADE_CANCEL=2341,y.TRADE_CLOSE=2551,y.TRADE_CONFIRM=2760,y.TRADE_ITEM=3107,y.TRADE_ITEM_REMOVE=3845,y.TRADE_ITEMS=1263,y.TRADE_UNACCEPT=1444,y.UNIT_ACTION=2456,y.UNIT_CHAT=1314,y.UNIT_CHAT_SHOUT=2085,y.UNIT_CHAT_WHISPER=1543,y.UNIT_DANCE=2080,y.UNIT_DROP_HAND_ITEM=2814,y.UNIT_GIVE_HANDITEM=2941,y.UNIT_LOOK=3301,y.UNIT_POSTURE=2235,y.UNIT_SIGN=1975,y.UNIT_TYPING=1597,y.UNIT_TYPING_STOP=1474,y.UNIT_WALK=3320,y.USER_BADGES=2769,y.USER_BADGES_CURRENT=2091,y.USER_BADGES_CURRENT_UPDATE=644,y.USER_BOTS=3848,y.USER_CURRENCY=273,y.USER_EFFECT_ACTIVATE=2959,y.USER_EFFECT_ENABLE=1752,y.USER_FIGURE=2730,y.USER_FURNITURE=3150,y.REQUESTFURNIINVENTORYWHENNOTINROOM=3500,y.USER_HOME_ROOM=1740,y.USER_INFO=357,y.USER_MOTTO=2228,y.USER_IGNORED=3878,y.USER_PETS=3095,y.USER_PROFILE=3265,y.USER_PROFILE_BY_NAME=2249,y.USER_RESPECT=2694,y.GET_SOUND_SETTINGS=2388,y.USER_SETTINGS_CAMERA=1461,y.USER_SETTINGS_CHAT_STYLE=1030,y.USER_SETTINGS_INVITES=1086,y.USER_SETTINGS_OLD_CHAT=1262,y.USER_SETTINGS_VOLUME=1367,y.USER_SUBSCRIPTION=3166,y.GET_WARDROBE=2742,y.SAVE_WARDROBE_OUTFIT=800,y.USER_TAGS=17,y.PEER_USERS_CLASSIFICATION=1160,y.USER_CLASSIFICATION=2285,y.VISIT_USER=2970,y.WIRED_ACTION_SAVE=2281,y.WIRED_APPLY_SNAPSHOT=3373,y.WIRED_CONDITION_SAVE=3203,y.WIRED_OPEN=768,y.WIRED_TRIGGER_SAVE=1520,y.GET_ITEM_DATA=3964,y.ONE_WAY_DOOR_CLICK=2765,y.REMOVE_WALL_ITEM=3336,y.SET_ITEM_DATA=3666,y.CATALOG_REDEEM_VOUCHER=339,y.ROOM_TONER_APPLY=2880,y.FRIEND_FURNI_CONFIRM_LOCK=3775,y.MANNEQUIN_SAVE_NAME=2850,y.MANNEQUIN_SAVE_LOOK=2209,y.PRESENT_OPEN_PRESENT=3558,y.CATALOG_SELECT_VIP_GIFT=2276,y.USER_IGNORE_ID=3314,y.USER_IGNORE=1117,y.USER_UNIGNORE=2061,y.MODTOOL_REQUEST_ROOM_INFO=707,y.MODTOOL_CHANGE_ROOM_SETTINGS=3260,y.MODTOOL_REQUEST_USER_CHATLOG=1391,y.MODTOOL_REQUEST_ROOM_CHATLOG=2587,y.MODTOOL_SANCTION_ALERT=229,y.MODTOOL_SANCTION_BAN=2766,y.MODTOOL_SANCTION_KICK=2582,y.MODTOOL_SANCTION_TRADELOCK=3742,y.MODTOOL_ALERTEVENT=1840,y.MODTOOL_SANCTION_MUTE=1945,y.MODTOOL_REQUEST_USER_ROOMS=3526,y.MODTOOL_ROOM_ALERT=3842,y.MODTOOL_PREFERENCES=31,y.CLOSE_ISSUE_DEFAULT_ACTION=2717,y.CLOSE_ISSUES=2067,y.DEFAULT_SANCTION=1681,y.GET_CFH_CHATLOG=211,y.MODTOOL_SANCTION=1392,y.PICK_ISSUES=15,y.RELEASE_ISSUES=1572,y.CONVERT_GLOBAL_ROOM_ID=314,y.REQUEST_SELL_ITEM=848,y.REQUEST_MARKETPLACE_ITEM_STATS=3288,y.MARKETPLACE_SELL_ITEM=3447,y.MARKETPLACE_REQUEST_OWN_ITEMS=2105,y.MARKETPLACE_TAKE_BACK_ITEM=434,y.MARKETPLACE_REDEEM_CREDITS=2650,y.MARKETPLACE_REQUEST_OFFERS=2407,y.MARKETPLACE_BUY_OFFER=1603,y.MARKETPLACE_BUY_TOKENS=1866,y.CATALOG_REQUESET_PET_BREEDS=1756,y.APPROVE_NAME=2109,y.UNIT_GIVE_HANDITEM_PET=2768,y.PET_MOUNT=1036,y.PET_SUPPLEMENT=749,y.FURNITURE_GROUP_INFO=2651,y.ACHIEVEMENT_RESOLUTION_OPEN=359,y.USE_PET_PRODUCT=1328,y.REMOVE_PET_SADDLE=186,y.TOGGLE_PET_RIDING=1472,y.TOGGLE_PET_BREEDING=3379,y.UNSEEN_RESET_CATEGORY=3493,y.UNSEEN_RESET_ITEMS=2343,y.COMMUNITY_GOAL_VOTE_COMPOSER=3536,y.GET_PROMO_ARTICLES=1827,y.ACCEPT_QUEST=3604,y.ACTIVATE_QUEST=793,y.CANCEL_QUEST=3133,y.FRIEND_REQUEST_QUEST_COMPLETE=1148,y.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688,y.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167,y.GET_COMMUNITY_GOAL_PROGRESS=1145,y.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343,y.GET_CONCURRENT_USERS_REWARD=3872,y.GET_DAILY_QUEST=2486,y.GET_QUESTS=3333,y.GET_SEASONAL_QUESTS_ONLY=1190,y.OPEN_QUEST_TRACKER=2750,y.REDEEM_COMMUNITY_GOAL_PRIZE=90,y.REJECT_QUEST=2397,y.START_CAMPAIGN=1697,y.GET_BONUS_RARE_INFO=957,y.CRAFT=3591,y.CRAFT_SECRET=1251,y.GET_CRAFTABLE_PRODUCTS=633,y.GET_CRAFTING_RECIPE=1173,y.GET_CRAFTING_RECIPES_AVAILABLE=3086,y.PHOTO_COMPETITION=3959,y.PUBLISH_PHOTO=2068,y.PURCHASE_PHOTO=2408,y.RENDER_ROOM=3226,y.RENDER_ROOM_THUMBNAIL=1982,y.REQUEST_CAMERA_CONFIGURATION=796,y.ADD_JUKEBOX_DISK=753,y.GET_JUKEBOX_PLAYLIST=1435,y.GET_NOW_PLAYING=1325,y.GET_OFFICIAL_SONG_ID=3189,y.GET_SONG_INFO=3082,y.GET_SOUND_MACHINE_PLAYLIST=3498,y.GET_USER_SONG_DISKS=2304,y.REMOVE_JUKEBOX_DISK=3050,y.INTERSTITIAL_SHOWN=1109,y.GET_INTERSTITIAL=2519,y.CHANGE_USERNAME=2977,y.CHECK_USERNAME=3950,y.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889,y.OPEN_CAMPAIGN_CALENDAR_DOOR=2257,y.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051,y.BUILDERS_CLUB_PLACE_WALL_ITEM=462,y.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529,y.GET_CATALOG_PAGE_EXPIRATION=742,y.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135,y.GET_DIRECT_CLUB_BUY_AVAILABLE=801,y.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603,y.GET_HABBO_CLUB_EXTEND_OFFER=2462,y.GET_IS_OFFER_GIFTABLE=1347,y.GET_LIMITED_OFFER_APPEARING_NEXT=410,y.GET_NEXT_TARGETED_OFFER=596,y.GET_ROOM_AD_PURCHASE_INFO=1075,y.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257,y.GET_TARGETED_OFFER=2487,y.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150,y.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735,y.PURCHASE_ROOM_AD=777,y.PURCHASE_TARGETED_OFFER=1826,y.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407,y.ROOM_AD_PURCHASE_INITIATED=2283,y.SET_TARGETTED_OFFER_STATE=2041,y.SHOP_TARGETED_OFFER_VIEWED=3483,y.HELPER_TALENT_TRACK=196,y.TALENT_TRACK_GET_LEVEL=2127,y.FORWARD_TO_A_COMPETITION_ROOM=172,y.FORWARD_TO_A_SUBMITTABLE_ROOM=1450,y.FORWARD_TO_RANDOM_COMPETITION_ROOM=865,y.GET_IS_USER_PART_OF_COMPETITION=2077,y.GET_SECONDS_UNTIL=271,y.ROOM_COMPETITION_INIT=1334,y.SUBMIT_ROOM_TO_COMPETITION=2595,y.VOTE_FOR_ROOM=143,y.GET_GIFT=2436,y.RESET_PHONE_NUMBER_STATE=2741,y.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379,y.TRY_PHONE_NUMBER=790,y.VERIFY_CODE=2721,y.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005,y.GET_YOUTUBE_DISPLAY_STATUS=336,y.SET_YOUTUBE_DISPLAY_PLAYLIST=2069,y.GO_TO_FLAT=685,y.CHANGE_QUEUE=3093,y.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412,y.CALL_FOR_HELP_FROM_FORUM_THREAD=534,y.CALL_FOR_HELP_FROM_IM=2950,y.CALL_FOR_HELP_FROM_PHOTO=2492,y.CALL_FOR_HELP_FROM_SELFIE=2755,y.CHAT_REVIEW_GUIDE_DECIDES=3365,y.CHAT_REVIEW_GUIDE_DETACHED=2501,y.CHAT_REVIEW_GUIDE_VOTE=3961,y.CHAT_REVIEW_SESSION_CREATE=3060,y.DELETE_PENDING_CALLS_FOR_HELP=3605,y.GET_CFH_STATUS=2746,y.GET_FAQ_CATEGORY=3445,y.GET_FAQ_TEXT=1849,y.GET_GUIDE_REPORTING_STATUS=3786,y.GET_PENDING_CALLS_FOR_HELP=3267,y.GET_QUIZ_QUESTIONS=1296,y.GUIDE_SESSION_CREATE=3338,y.GUIDE_SESSION_FEEDBACK=477,y.GUIDE_SESSION_GET_REQUESTER_ROOM=1052,y.GUIDE_SESSION_GUIDE_DECIDES=1424,y.GUIDE_SESSION_INVITE_REQUESTER=234,y.GUIDE_SESSION_IS_TYPING=519,y.GUIDE_SESSION_MESSAGE=3899,y.GUIDE_SESSION_ON_DUTY_UPDATE=1922,y.GUIDE_SESSION_REPORT=3969,y.GUIDE_SESSION_REQUESTER_CANCELS=291,y.GUIDE_SESSION_RESOLVED=887,y.POST_QUIZ_ANSWERS=3720,y.SEARCH_FAQS=2031,y.POLL_ANSWER=3505,y.POLL_REJECT=1773,y.POLL_START=109,y.POLL_VOTE_COUNTER=6200,y.DISCONNECT=2445,y.SCR_GET_KICKBACK_INFO=869,y.COMPOST_PLANT=3835,y.HARVEST_PET=1521,y.SET_CLOTHING_CHANGE_DATA=924,y.GROUP_UNFAVORITE=1820,y.NEW_USER_EXPERIENCE_GET_GIFTS=1822,y.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299,y.HANDSHAKE_INIT_DIFFIE=3110,y.HANDSHAKE_COMPLETE_DIFFIE=773,y.WELCOME_OPEN_GIFT=2638,y.WELCOME_GIFT_CHANGE_EMAIL=66,y.EMAIL_GET_STATUS=2557,y.EMAIL_CHANGE=3965,y.APPROVE_ALL_MEMBERSHIP_REQUESTS=882,y.RENTABLE_SPACE_CANCEL_RENT=1667,y.RENTABLE_SPACE_RENT=2946,y.RENTABLE_SPACE_STATUS=872,y.TRACKING_PERFORMANCE_LOG=3230,y.TRACKING_LAG_WARNING_REPORT=3847,y.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736,y.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115,y.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071,y.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518,y.DELETE_ITEM=10018;let b=y;class K3{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class X3{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class eb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class ib{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class rb{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nb{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class q3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ab{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ob{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class og{constructor(t="",e="",s="",r=-1,n=-1){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}async assignBitmap(t){const e=await me.generateImageUrl(t);if(!e)return;const s=e.split(",")[1],r=Uint8Array.from(atob(s),n=>n.charCodeAt(0));this._data.push(r.byteLength,r.buffer)}assignBase64(t){const e=t.split(",")[1],s=Uint8Array.from(atob(e),r=>r.charCodeAt(0));this._data.push(s.byteLength,s.buffer)}}class DI extends og{constructor(t="",e="",s="",r=-1,n=-1){super(t,e,s,r,n)}}class lb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class cb{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class ub{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class hb{constructor(t,e,s,r,n,o){this._data=[t,e,s,r,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class db{constructor(t,e,s,r){this._data=[t,e,s,r]}dispose(){this._data=null}getMessageArray(){return this._data}}class _b{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class gb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Q3{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class fb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mb{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class J3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Z3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class eS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Eb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class $3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class pb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class t5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class e5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class s5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class i5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class r5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Ib{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Tb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class n5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Rb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class a5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class o5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Sb{constructor(t,e,s,r,n,o,l,c,u){this._data=[t,e,s,r,n,o,l,c,u]}getMessageArray(){return this._data}dispose(){}}class Md{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class Ob{constructor(t,e,s,r,n,o,l){this._data=[t,e,s,r,n,o,l]}getMessageArray(){return this._data}dispose(){}}class Ab{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class l5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Nb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class c5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Cb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class u5{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class h5{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class d5{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class g5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class f5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class m5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class E5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class p5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const Bc=class Bc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}};Bc.CONFIRM_LEVEL_NOT_ACCEPTED=0,Bc.CONFIRM_LEVEL_NOT_SUBMITTED=1,Bc.CONFIRM_LEVEL_NOT_CONFIRMED=2,Bc.CONFIRM_LEVEL_COMMIT=3;let vI=Bc;class I5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class T5{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class yb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Mb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class R5{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class bb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Db{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class vb{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class PI{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Pb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ym{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Lb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ub{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Fb{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class iS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}let Gb=class{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}};class kb{constructor(t,e){this._data=[e.length,...e,t]}getMessageArray(){return this._data}dispose(){}}class mc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class S5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bb{constructor(t=!0){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class O5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class A5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class N5{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class C5{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Vb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class x5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class y5{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class M5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class b5{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Hb{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Wb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Yb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class D5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class zb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class v5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class P5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class L5{constructor(t,e,s,r,n,o){this._data=[t,e,s,r,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class U5{constructor(t,e,s,r,n,o){this._data=[t,e,s,r,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class j5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class w5{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}const IO=class IO{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}};IO.NO_ISSUE_ID=-1;let LI=IO;class F5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const TO=class TO{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}};TO.NO_ISSUE_ID=-1;let UI=TO;class G5{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class k5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class B5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Kb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Xb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class qb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Qb{constructor(t,e,s,r,n,o){this._data=[t,e,s,r,n,o.length,...o]}getMessageArray(){return this._data}dispose(){}}class Jb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Zb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class $b{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ou{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class eD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jI{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class sD{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class iD{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class zm{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class rD{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class nD{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class aD{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class oD{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class lD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class V5{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class H5{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class W5{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class Y5{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class z5{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class K5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class X5{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class q5{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Q5{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class J5{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.k),this._data.push(e._arg_2),this._data.push(e._arg_3)})}getMessageArray(){return this._data}dispose(){}}class Z5{constructor(t,e,s,r,n){this._data=[t,e,s,r,n]}getMessageArray(){return this._data}dispose(){}}class $5{constructor(t,e,s,r){this._data=[t,e,r,s]}getMessageArray(){return this._data}dispose(){}}class tz{constructor(t,e,s){if(this._type=t,e.length===s.length){this._data=[];for(let r=0;r<e.length;r++)this._data.push(e[r]),this._data.push(s[r])}}getMessageArray(){return this._data}dispose(){}}class uD{constructor(t,e,s,r){this._data=[`NITRO-${fu.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",JE.HTML5,QE.BROWSER]}getMessageArray(){return this._data}dispose(){}}class ez{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class hD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class iz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class dD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _D{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class gD{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class rz{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class fD{constructor(t,e,s,r,n){this._data=[t,e,s,r,n]}getMessageArray(){return this._data}dispose(){}}class mD{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class ED{constructor(t,e,s,r){this._data=[t,e,s,r.length/2,...r]}getMessageArray(){return this._data}dispose(){}}class pD{constructor(t,e,s,r,n){this._data=[t,e,s,r,n]}getMessageArray(){return this._data}dispose(){}}class nz{constructor(t,e,s,r,n){this._data=[t,e,s,r,n]}getMessageArray(){return this._data}dispose(){}}class ID{constructor(t,e,s,r,n){this._data=[t,e,s,r,n.length/2,...n]}getMessageArray(){return this._data}dispose(){}}class az{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class oz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class lz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cz{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class TD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class RD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class SD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _z{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OD{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class AD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ND{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class CD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wI{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class fz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mz{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Ez{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pz{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Iz{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Tz{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Rz{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Sz{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class DD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vD{constructor(){this._badges=[]}getMessageArray(){const t=[];for(let e=1;e<=this._badges.length;e++)t.push(e),t.push(this._badges[e-1]);return t}dispose(){}addActivatedBadge(t){this._badges.push(t)}}class FI{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PD{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class LD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Oz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Az{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Nz{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class GI{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class UD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class FD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kI{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class GD{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class kD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class BD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class WD{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class YD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Cz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class BI{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class xz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class zD{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class yz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Mz{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){this._data=null}}class XD{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){this._data=null}}class qD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class QD{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class JD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class bz{constructor(t,e,s){this._data=[t,e.length,...e,s]}getMessageArray(){return this._data}dispose(){}}const Ih=class Ih{constructor(t,e){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}};Ih.RESOLUTION_USELESS=1,Ih.RESOLUTION_ABUSIVE=2,Ih.RESOLUTION_RESOLVED=3;let Ml=Ih;const qf=class qf{constructor(t,e,s,r,n,o=-1){this._data=[t,e,s,r,n],o!=qf.NO_ISSUE_ID&&this._data.push(o)}getMessageArray(){return this._data}dispose(){}};qf.NO_ISSUE_ID=-1;let _a=qf;class ZD{constructor(t,e,s,r=-1){this._data=[t,e,s],r!=_a.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class $D{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ev{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sv{constructor(t,e=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class iv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nv{constructor(t,e,s,r=-1){this._data=[t,e,s],r!=_a.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class VI{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}const Vc=class Vc{constructor(t,e,s){this._data=[],this._data.push(t),this._data.push(e),this._data.push(s)}getMessageArray(){return this._data}dispose(){}};Vc.ACTION_ALERT=0,Vc.ACTION_KICK=1,Vc.ACTION_MESSAGE=3,Vc.ACTION_MESSAGE_AND_SOFT_KICK=4;let bl=Vc;class av{constructor(t,e,s,r=-1){this._data=[t,e,s],r!=_a.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class rS{constructor(t,e,s,r=-1){this._data=[],this._data.push(t),this._data.push(e),this._data.push(""),this._data.push(""),this._data.push(s),r!=_a.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class ov{constructor(t,e,s,r=-1){this._data=[t,e,s],r!=_a.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class Dz{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class vz{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class lv{constructor(t,e,s,r,n=-1){this._data=[t,e,s,r],n!=_a.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}class cv{constructor(t,e,s,r){this._data=[t.length,...t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class nS{constructor(t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class uv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Pz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Lz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Uz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jz{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class hv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dv{constructor(t,e,s,r,n,o){this._data=[t,e,s,r,n,o]}getMessageArray(){return this._data}dispose(){}}class wz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _v{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Fz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Gz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ad{constructor(t,e,s){this._data=[t,e?1:0,s?1:0]}getMessageArray(){return this._data}dispose(){}}class Bz{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Vz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class aS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class fv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Hz{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Wz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Yz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Kz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Xz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Qz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Jz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Zz{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class $z{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class t4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Vl{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class e4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class s4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class i4{constructor(t,e,s,r,n,o){this._data=[t,e,s,r,n,o]}getMessageArray(){return this._data}dispose(){}}class r4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ev{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class n4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class a4{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class o4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class l4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class c4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class u4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class h4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class d4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class pv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Iv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Tv{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class _4{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class g4{constructor(...t){this._data=[t.length*3],t.forEach(e=>{this._data.push(e.dayIndex),this._data.push(e.stepIndex),this._data.push(e.giftIndex)})}dispose(){this._data=null}getMessageArray(){return this._data}}class Rv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Sv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class HI{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class bd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class f4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ov{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Av{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Nv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Cv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class yv{constructor(t,e,s){this._data=[t,e,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class Mv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Dv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class m4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class E4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class p4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class I4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class T4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class R4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class S4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class O4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class A4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class N4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class C4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class x4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class y4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class M4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class D4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class v4{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.itemId)})}getMessageArray(){return this._data}dispose(){}}class Pv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Lv{constructor(t,e=null){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Uv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wv{constructor(t,e=0,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Fv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Gv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bv{constructor(t,e,s=0){this._data=[t,s,e]}getMessageArray(){return this._data}dispose(){}}class oS{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Vv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Hv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Wv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Yv{constructor(t,e,s,r,n,o,l,c,u,h,d,f,E,m,I,p,T,R,S,L,M,P,k,G){this._data=[],this._data.push(t,e,s,r,n,o,l),this._data.push(u.length,...u),this._data.push(h,d,f,E,m,I,p,T,R,S,L,M,P,k,G)}getMessageArray(){return this._data}dispose(){}}class zv{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Km{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Dn{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class WI{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Kv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Xv extends Kv{constructor(t){super(t)}}class qv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Qv extends Kv{constructor(t){super(t)}}class YI{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class Jv{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Zv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $v{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tP{constructor(t,e,s=""){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class eP{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class uS{constructor(t,e){this._data=[t,e.size*2];for(const[s,r]of e.entries())this._data.push(s,r)}getMessageArray(){return this._data}dispose(){}}class sP{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class iP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class rP{constructor(t,e,s,r,n){this._data=[t,e,s,r,n]}getMessageArray(){return this._data}dispose(){}}class nP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class P4{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class L4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class zI{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class aP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class oP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class hS{constructor(t,e,s,r,n,o){this._itemId=t,this._category=e,this._wallLocation=s,this._x=r,this._y=n,this._direction=o}getMessageArray(){switch(this._category){case Y.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case Y.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class Yu{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class U4{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class uP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _P{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Au{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class gP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lg{constructor(t,e=-100){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class mP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class EP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class IP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class dS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class j4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class w4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class F4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class G4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RP{constructor(t,e,s,r){this._data=[t,e,s,r]}getMessageArray(){return this._data}dispose(){}}class SP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class wu{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class OP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class KI{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class AP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class XI{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class NP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _S{constructor(t,e,s,r,n,o,l){this._data=[t,e,s,r,n,o,l]}getMessageArray(){return this._data}dispose(){}}class CP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gS{constructor(t,e=0,s=""){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class MP{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class bP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class DP{constructor(t,e,s){this._data=[t+" "+e,s]}getMessageArray(){return this._data}dispose(){}}class vP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class LP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class GP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class BP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}const Th=class Th{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}};Th.STATE_START=0,Th.STATE_CANCEL=1,Th.STATE_ACCEPT=2;let qI=Th;class k4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class B4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class V4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class HP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WP{constructor(t,e,s,r,n,o){this._data=[t,e.length,...e,s,r.length,...r,n,o]}getMessageArray(){return this._data}dispose(){}}class YP{constructor(t,e,s,r,n){this._data=[t,e.length,...e,s,r.length,...r,n]}getMessageArray(){return this._data}dispose(){}}class zP{constructor(t,e,s,r,n){this._data=[t,e.length,...e,s,r.length,...r,n]}getMessageArray(){return this._data}dispose(){}}class H4{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class KP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class XP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class QP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class JP{constructor(...t){this._data=[t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class W4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Y4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $P{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class z4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class K4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class X4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class q4{constructor(t,e,s,r,n,o,l,c,u,h,d){this._data=[t,e,s,r,n,o,l,c,u,h,d]}getMessageArray(){return this._data}dispose(){}}class tL{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class mS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Q4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class J4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ES{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class aL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class oL{constructor(t,e=!0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class IS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Z4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class lL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class cL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class QI{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class hL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _L{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gL{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class $4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class fL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class EL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eK{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(v.INTERSTITIAL_MESSAGE,nW),this._events.set(v.ROOM_AD_ERROR,aW),this._events.set(v.AVAILABILITY_STATUS,QN),this._events.set(v.AVAILABILITY_TIME,oW),this._events.set(v.HOTEL_CLOSED_AND_OPENS,JN),this._events.set(v.HOTEL_CLOSES_AND_OPENS_AT,ZN),this._events.set(v.HOTEL_WILL_CLOSE_MINUTES,$N),this._events.set(v.HOTEL_MAINTENANCE,tC),this._events.set(v.USER_CHANGE_NAME,rd),this._events.set(v.CHECK_USER_NAME,eC),this._events.set(v.USER_FIGURE,DR),this._events.set(v.USER_OUTFITS,lW),this._events.set(v.ADD_BOT_TO_INVENTORY,sC),this._events.set(v.USER_BOTS,iC),this._events.set(v.BOT_RECEIVED,cW),this._events.set(v.REMOVE_BOT_FROM_INVENTORY,rC),this._events.set(v.CFH_SANCTION,nC),this._events.set(v.CFH_TOPICS,aC),this._events.set(v.CFH_SANCTION_STATUS,oC),this._events.set(v.CAMERA_PUBLISH_STATUS,lC),this._events.set(v.CAMERA_PURCHASE_OK,cC),this._events.set(v.CAMERA_STORAGE_URL,uC),this._events.set(v.COMPETITION_STATUS,hW),this._events.set(v.INIT_CAMERA,hC),this._events.set(v.THUMBNAIL_STATUS,dW),this._events.set(v.CAMERA_SNAPSHOT,uW),this._events.set(v.CAMPAIGN_CALENDAR_DATA,dC),this._events.set(v.CAMPAIGN_CALENDAR_DOOR_OPENED,_C),this._events.set(v.BONUS_RARE_INFO,gC),this._events.set(v.BUILDERS_CLUB_FURNI_COUNT,fC),this._events.set(v.BUILDERS_CLUB_SUBSCRIPTION,mC),this._events.set(v.BUNDLE_DISCOUNT_RULESET,_W),this._events.set(v.CATALOG_PAGE_EXPIRATION,gW),this._events.set(v.CATALOG_PAGE,EC),this._events.set(v.CATALOG_PAGE_LIST,pC),this._events.set(v.CATALOG_EARLIEST_EXPIRY,fW),this._events.set(v.CATALOG_PUBLISHED,IC),this._events.set(v.CLUB_GIFT_INFO,vR),this._events.set(v.CLUB_GIFT_SELECTED,TC),this._events.set(v.DIRECT_SMS_CLUB_BUY,mW),this._events.set(v.GIFT_RECEIVER_NOT_FOUND,RC),this._events.set(v.GIFT_WRAPPER_CONFIG,SC),this._events.set(v.CLUB_EXTENDED_OFFER,pW),this._events.set(v.CLUB_OFFERS,OC),this._events.set(v.IS_OFFER_GIFTABLE,IW),this._events.set(v.LIMITED_SOLD_OUT,AC),this._events.set(v.LIMITED_OFFER_APPEARING_NEXT,TW),this._events.set(v.NOT_ENOUGH_BALANCE,RW),this._events.set(v.PRODUCT_OFFER,NC),this._events.set(v.CATALOG_PURCHASE_ERROR,CC),this._events.set(v.CATALOG_PURCHASE_NOT_ALLOWED,xC),this._events.set(v.CATALOG_PURCHASE_OK,yC),this._events.set(v.ROOM_AD_PURCHASE,MC),this._events.set(v.SEASONAL_CALENDAR_OFFER,SW),this._events.set(v.CATALOG_RECEIVE_PET_BREEDS,bC),this._events.set(v.TARGET_OFFER,DC),this._events.set(v.TARGET_OFFER_NOT_FOUND,OW),this._events.set(v.REDEEM_VOUCHER_ERROR,vC),this._events.set(v.REDEEM_VOUCHER_OK,PC),this._events.set(v.CLIENT_PING,LC),this._events.set(v.COMPETITION_ENTRY_SUBMIT,AW),this._events.set(v.COMPETITION_VOTING_INFO,NW),this._events.set(v.COMPETITION_TIMING_CODE,CW),this._events.set(v.COMPETITION_USER_PART_OF,xW),this._events.set(v.COMPETITION_NO_OWNED_ROOMS,yW),this._events.set(v.COMPETITION_SECONDS_UNTIL,MW),this._events.set(v.CRAFTABLE_PRODUCTS,UC),this._events.set(v.CRAFTING_RECIPE,jC),this._events.set(v.CRAFTING_RECIPES_AVAILABLE,wC),this._events.set(v.CRAFTING_RESULT,FC),this._events.set(v.DESKTOP_VIEW,nd),this._events.set(v.MESSENGER_ACCEPT_FRIENDS,bW),this._events.set(v.MESSENGER_FIND_FRIENDS,GC),this._events.set(v.MESSENGER_FOLLOW_FAILED,DW),this._events.set(v.MESSENGER_FRIENDS,kC),this._events.set(v.MESSENGER_UPDATE,BC),this._events.set(v.MESSENGER_FRIEND_NOTIFICATION,vW),this._events.set(v.MESSENGER_REQUESTS,VC),this._events.set(v.MESSENGER_SEARCH,HC),this._events.set(v.MESSENGER_INSTANCE_MESSAGE_ERROR,PW),this._events.set(v.MESSENGER_MESSAGE_ERROR,LW),this._events.set(v.MESSENGER_INIT,WC),this._events.set(v.MESSENGER_MINIMAIL_NEW,UW),this._events.set(v.MESSENGER_MINIMAIL_COUNT,jW),this._events.set(v.MESSENGER_CHAT,PR),this._events.set(v.MESSENGER_REQUEST,LR),this._events.set(v.MESSENGER_INVITE_ERROR,YC),this._events.set(v.MESSENGER_INVITE,UR),this._composers.set(b.DELETE_ITEM,PD),this._events.set(v.ACHIEVEMENTRESOLUTIONCOMPLETED,HW),this._events.set(v.ACHIEVEMENTRESOLUTIONPROGRESS,WW),this._events.set(v.ACHIEVEMENTRESOLUTIONS,YW),this._events.set(v.LOAD_GAME_URL,jR),this._events.set(v.LOADGAME,JW),this._events.set(v.UNLOADGAME,ZW),this._events.set(v.GAME_CENTER_GAME_LIST,KC),this._events.set(v.GAMESTATUSMESSAGE,XC),this._events.set(v.GAME_CENTER_ACHIEVEMENTS,$W),this._events.set(v.GAME_CENTER_STATUS,zC),this._events.set(v.GAME_CENTER_IN_ARENA_QUEUE,FW),this._events.set(v.GAME_CENTER_STOP_COUNTER,BW),this._events.set(v.GAME_CENTER_USER_LEFT_GAME,VW),this._events.set(v.GAME_CENTER_DIRECTORY_STATUS,wW),this._events.set(v.GAME_CENTER_STARTING_GAME_FAILED,kW),this._events.set(v.GAME_CENTER_JOINING_FAILED,GW),this._events.set(v.GAMEACHIEVEMENTS,zW),this._events.set(v.GAMEINVITE,KW),this._events.set(v.JOINEDQUEUEMESSAGE,XW),this._events.set(v.JOININGQUEUEFAILED,qW),this._events.set(v.LEFTQUEUE,QW),this._events.set(v.WEEKLY_GAME_REWARD,rY),this._events.set(v.WEEKLY_GAME_REWARD_WINNERS,nY),this._events.set(v.WEEKLY_COMPETITIVE_LEADERBOARD,iY),this._events.set(v.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,sY),this._events.set(v.WEEKLY_GAME2_FRIENDS_LEADERBOARD,tY),this._events.set(v.WEEKLY_GAME2_LEADERBOARD,eY),this._events.set(v.GROUP_INFO,Du),this._events.set(v.GROUP_MEMBER_REMOVE_CONFIRM,QC),this._events.set(v.GROUP_MEMBERS,JC),this._events.set(v.GROUP_CREATE_OPTIONS,qC),this._events.set(v.GROUP_BADGE_PARTS,wR),this._events.set(v.GROUP_SETTINGS,$C),this._events.set(v.GROUP_PURCHASED,ZC),this._events.set(v.GROUP_BADGES,YM),this._events.set(v.GROUP_DEACTIVATE,tx),this._events.set(v.GROUP_MEMBERSHIP_REQUESTED,B3),this._events.set(v.GROUP_DETAILS_CHANGED,k3),this._events.set(v.GROUP_HABBO_JOIN_FAILED,W3),this._events.set(v.GROUP_FORUM_DATA,cY),this._events.set(v.GROUP_FORUM_LIST,uY),this._events.set(v.GROUP_FORUM_THREADS,hY),this._events.set(v.GROUP_FORUM_POST,dY),this._events.set(v.GROUP_FORUM_POST_THREAD,_Y),this._events.set(v.GROUP_FORUM_THREAD_MESSAGES,gY),this._events.set(v.GROUP_FORUM_UNREAD_COUNT,fY),this._events.set(v.GROUP_FORUM_UPDATE_MESSAGE,mY),this._events.set(v.GROUP_FORUM_UPDATE_THREAD,EY),this._events.set(v.CFH_DISABLED_NOTIFY,sx),this._events.set(v.CFH_PENDING_CALLS_DELETED,ix),this._events.set(v.CFH_PENDING_CALLS,rx),this._events.set(v.CFH_REPLY,nx),this._events.set(v.CFH_RESULT_MESSAGE,ax),this._events.set(v.GUIDE_ON_DUTY_STATUS,ox),this._events.set(v.GUIDE_SESSION_ATTACHED,lx),this._events.set(v.GUIDE_SESSION_DETACHED,cx),this._events.set(v.GUIDE_SESSION_ENDED,FR),this._events.set(v.GUIDE_SESSION_ERROR,GR),this._events.set(v.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,ux),this._events.set(v.GUIDE_SESSION_MESSAGE,hx),this._events.set(v.GUIDE_SESSION_PARTNER_IS_TYPING,dx),this._events.set(v.GUIDE_SESSION_REQUESTER_ROOM,_x),this._events.set(v.GUIDE_SESSION_STARTED,kR),this._events.set(v.GUIDE_TICKET_CREATION_RESULT,yY),this._events.set(v.GUIDE_TICKET_RESOLUTION,MY),this._events.set(v.GUIDE_REPORTING_STATUS,xY),this._events.set(v.HOTEL_MERGE_NAME_CHANGE,bY),this._events.set(v.ISSUE_CLOSE_NOTIFICATION,gx),this._events.set(v.QUIZ_DATA,DY),this._events.set(v.QUIZ_RESULTS,vY),this._events.set(v.CHAT_REVIEW_SESSION_DETACHED,SY),this._events.set(v.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,OY),this._events.set(v.CHAT_REVIEW_SESSION_RESULTS,AY),this._events.set(v.CHAT_REVIEW_SESSION_STARTED,NY),this._events.set(v.CHAT_REVIEW_SESSION_VOTING_STATUS,CY),this._events.set(v.ACHIEVEMENT_PROGRESSED,fx),this._events.set(v.ACHIEVEMENT_LIST,mx),this._events.set(v.USER_ACHIEVEMENT_SCORE,Ex),this._events.set(v.USER_EFFECT_ACTIVATE,PY),this._events.set(v.USER_EFFECT_LIST_ADD,LY),this._events.set(v.USER_EFFECT_LIST_REMOVE,UY),this._events.set(v.USER_EFFECT_LIST,wY),this._events.set(v.AVATAR_EFFECT_SELECTED,jY),this._events.set(v.USER_BADGES,Ix),this._events.set(v.USER_BADGES_ADD,px),this._events.set(v.BADGE_POINT_LIMITS,BR),this._events.set(v.BADGE_REQUEST_FULFILLED,FY),this._events.set(v.USER_CLOTHING,Tx),this._events.set(v.USER_FURNITURE_ADD,VR),this._events.set(v.USER_FURNITURE,K_),this._events.set(v.USER_FURNITURE_REFRESH,Rx),this._events.set(v.USER_FURNITURE_REMOVE,HR),this._events.set(v.USER_FURNITURE_POSTIT_PLACED,Sx),this._events.set(v.USER_PETS,Nx),this._events.set(v.USER_PET_REMOVE,xx),this._events.set(v.USER_PET_ADD,Ax),this._events.set(v.PET_RECEIVED,Cx),this._events.set(v.PET_PLACING_ERROR,by),this._events.set(v.YOUTUBE_CONTROL_VIDEO,oM),this._events.set(v.YOUTUBE_DISPLAY_PLAYLISTS,lM),this._events.set(v.YOUTUBE_DISPLAY_VIDEO,cM),this._events.set(v.TRADE_ACCEPTED,yx),this._events.set(v.TRADE_CLOSED,Mx),this._events.set(v.TRADE_COMPLETED,bx),this._events.set(v.TRADE_CONFIRMATION,Dx),this._events.set(v.TRADE_LIST_ITEM,vx),this._events.set(v.TRADE_NOT_OPEN,Px),this._events.set(v.TRADE_OPEN_FAILED,Ux),this._events.set(v.TRADE_OPEN,Lx),this._events.set(v.TRADE_OTHER_NOT_ALLOWED,jx),this._events.set(v.TRADE_YOU_NOT_ALLOWED,wx),this._events.set(v.TRADE_NO_SUCH_ITEM,VY),this._events.set(v.COMMUNITY_GOAL_VOTE_EVENT,HY),this._events.set(v.PROMO_ARTICLES,Fx),this._events.set(v.MARKETPLACE_AFTER_ORDER_STATUS,Gx),this._events.set(v.MARKETPLACE_CANCEL_SALE,kx),this._events.set(v.MARKETPLACE_SELL_ITEM,WY),this._events.set(v.MARKETPLACE_CONFIG,Bx),this._events.set(v.MARKETPLACE_ITEM_STATS,YY),this._events.set(v.MARKETPLACE_ITEM_POSTED,Vx),this._events.set(v.MARKETPLACE_ITEMS_SEARCHED,Hx),this._events.set(v.MARKETPLACE_OWN_ITEMS,Wx),this._events.set(v.USER_BANNED,ry),this._events.set(v.MODERATION_CAUTION,Qx),this._events.set(v.MODTOOL_ROOM_INFO,$x),this._events.set(v.MODTOOL_USER_CHATLOG,ny),this._events.set(v.MODTOOL_ROOM_CHATLOG,sy),this._events.set(v.MODERATION_USER_INFO,ey),this._events.set(v.MODERATION_TOOL,Jx),this._events.set(v.MODTOOL_VISITED_ROOMS_USER,iy),this._events.set(v.CFH_CHATLOG,Yx),this._events.set(v.ISSUE_DELETED,zx),this._events.set(v.ISSUE_INFO,Kx),this._events.set(v.ISSUE_PICK_FAILED,Xx),this._events.set(v.MODERATOR_ACTION_RESULT,qx),this._events.set(v.MODERATOR_MESSAGE,Zx),this._events.set(v.MODERATOR_TOOL_PREFERENCES,ty),this._events.set(v.MYSTERY_BOX_KEYS,ly),this._events.set(v.GOTMYSTERYBOXPRIZEMESSAGE,oy),this._events.set(v.CANCELMYSTERYBOXWAITMESSAGE,ay),this._events.set(v.SHOWMYSTERYBOXWAITMESSAGE,cy),this._events.set(v.CAN_CREATE_ROOM,zY),this._events.set(v.CAN_CREATE_ROOM_EVENT,uy),this._events.set(v.CATEGORIES_WITH_VISITOR_COUNT,KY),this._events.set(v.COMPETITION_ROOMS_DATA,XY),this._events.set(v.CONVERTED_ROOM_ID,qY),this._events.set(v.ROOM_DOORBELL,WR),this._events.set(v.USER_FAVORITE_ROOM,QY),this._events.set(v.USER_FAVORITE_ROOM_COUNT,JY),this._events.set(v.ROOM_DOORBELL_REJECTED,X_),this._events.set(v.ROOM_CREATED,hy),this._events.set(v.ROOM_INFO,$a),this._events.set(v.GUEST_ROOM_SEARCH_RESULT,ZY),this._events.set(v.USER_HOME_ROOM,dy),this._events.set(v.ROOM_EVENT_CANCEL,i3),this._events.set(v.ROOM_EVENT,my),this._events.set(v.ROOM_INFO_UPDATED,py),this._events.set(v.THUMBNAIL_UPDATE_RESULT,r3),this._events.set(v.NAVIGATOR_EVENT_CATEGORIES,Iy),this._events.set(v.NAVIGATOR_CATEGORIES,Ty),this._events.set(v.NAVIGATOR_COLLAPSED,$Y),this._events.set(v.NAVIGATOR_LIFTED,t3),this._events.set(v.NAVIGATOR_METADATA,_y),this._events.set(v.NAVIGATOR_OPEN_ROOM_CREATOR,gy),this._events.set(v.NAVIGATOR_SEARCHES,e3),this._events.set(v.NAVIGATOR_SEARCH,fy),this._events.set(v.NAVIGATOR_SETTINGS,s3),this._events.set(v.GENERIC_ALERT,Ny),this._events.set(v.MOTD_MESSAGES,xy),this._events.set(v.NOTIFICATION_LIST,yy),this._events.set(v.UNSEEN_ITEMS,vy),this._events.set(v.ACHIEVEMENT_NOTIFICATION,Ry),this._events.set(v.INFO_FEED_ENABLE,Cy),this._events.set(v.CLUB_GIFT_NOTIFICATION,Oy),this._events.set(v.ACTIVITY_POINT_NOTIFICATION,YR),this._events.set(v.BOT_ERROR,Sy),this._events.set(v.PET_LEVEL_NOTIFICATION,My),this._events.set(v.NOTIFICATION_OFFER_REWARD_DELIVERED,a3),this._events.set(v.NOTIFICATION_SIMPLE_ALERT,Dy),this._events.set(v.NOTIFICATION_ELEMENT_POINTER,n3),this._events.set(v.USER_PERKS,zR),this._events.set(v.PET_TRAINING_PANEL,wy),this._events.set(v.PET_LEVEL_UPDATE,Uy),this._events.set(v.PET_SCRATCH_FAILED,jy),this._events.set(v.PET_OPEN_PACKAGE_REQUESTED,Py),this._events.set(v.PET_OPEN_PACKAGE_RESULT,Ly),this._events.set(v.PET_BREEDING_RESULT,hM),this._events.set(v.QUESTION,Vy),this._events.set(v.POLL_CONTENTS,Fy),this._events.set(v.POLL_ERROR,Gy),this._events.set(v.POLL_OFFER,ky),this._events.set(v.POLL_START_ROOM,Yy),this._events.set(v.QUESTION_ANSWERED,By),this._events.set(v.QUESTION_FINISHED,Hy),this._events.set(v.POLL_ROOM_RESULT,Wy),this._events.set(v.COMMUNITY_GOAL_EARNED_PRIZES,c3),this._events.set(v.COMMUNITY_GOAL_PROGRESS,u3),this._events.set(v.CONCURRENT_USERS_GOAL_PROGRESS,h3),this._events.set(v.QUEST_DAILY,f3),this._events.set(v.QUEST_CANCELLED,_3),this._events.set(v.QUEST_COMPLETED,g3),this._events.set(v.COMMUNITY_GOAL_HALL_OF_FAME,zy),this._events.set(v.EPIC_POPUP,d3),this._events.set(v.SEASONAL_QUESTS,p3),this._events.set(v.QUESTS,E3),this._events.set(v.QUEST,m3),this._events.set(v.ROOM_ENTER_ERROR,Ky),this._events.set(v.ROOM_ENTER,Q_),this._events.set(v.ROOM_FORWARD,Xy),this._events.set(v.ROOM_DOORBELL_ACCEPTED,q_),this._events.set(v.ROOM_RIGHTS_CLEAR,tI),this._events.set(v.ROOM_RIGHTS_OWNER,sI),this._events.set(v.ROOM_RIGHTS,eI),this._events.set(v.BOT_COMMAND_CONFIGURATION,qy),this._events.set(v.BOT_SKILL_LIST_UPDATE,T3),this._events.set(v.BOT_FORCE_OPEN_CONTEXT_MENU,I3),this._events.set(v.ROOM_SETTINGS_CHAT,Qy),this._events.set(v.ROOM_INFO_OWNER,KR),this._events.set(v.ROOM_SCORE,Jy),this._events.set(v.ROOM_ROLLING,rI),this._events.set(v.FURNITURE_FLOOR_ADD,hI),this._events.set(v.FURNITURE_FLOOR,dI),this._events.set(v.FURNITURE_FLOOR_REMOVE,_I),this._events.set(v.FURNITURE_FLOOR_UPDATE,gI),this._events.set(v.ITEM_WALL_ADD,fI),this._events.set(v.ITEM_WALL,mI),this._events.set(v.ITEM_WALL_REMOVE,EI),this._events.set(v.ITEM_WALL_UPDATE,pI),this._events.set(v.FURNITURE_ALIASES,oI),this._events.set(v.FURNITURE_DATA,lI),this._events.set(v.FURNITURE_ITEMDATA,cI),this._events.set(v.ITEM_STACK_HELPER,tM),this._events.set(v.FURNITURE_STATE,uI),this._events.set(v.ITEM_DIMMER_SETTINGS,aM),this._events.set(v.FURNITURE_STATE_2,aI),this._events.set(v.LOVELOCK_FURNI_FINISHED,sM),this._events.set(v.LOVELOCK_FURNI_FRIEND_COMFIRMED,iM),this._events.set(v.LOVELOCK_FURNI_START,rM),this._events.set(v.OBJECTS_DATA_UPDATE,iI),this._events.set(v.FURNITURE_GROUP_CONTEXT_MENU_INFO,eM),this._events.set(v.FURNITURE_POSTIT_STICKY_POLE_OPEN,nM),this._events.set(v.ROOM_SPECTATOR,mM),this._events.set(v.CUSTOM_USER_NOTIFICATION,$y),this._events.set(v.ROOM_MESSAGE_NOTIFICATION,N3),this._events.set(v.ROOM_POPULAR_TAGS_RESULT,JO),this._events.set(v.ROOM_POPULAR_TAGS_RESULT,JO),this._events.set(v.ROOM_RIGHTS_LIST,yM),this._events.set(v.ROOM_RIGHTS_LIST_ADD,CM),this._events.set(v.ROOM_RIGHTS_LIST_REMOVE,xM),this._events.set(v.ROOM_BAN_LIST,NM),this._events.set(v.ROOM_SETTINGS_SAVE_ERROR,bM),this._events.set(v.ROOM_SETTINGS,MM),this._events.set(v.ROOM_SETTINGS_SAVE,D3),this._events.set(v.ROOM_SETTINGS_ERROR,b3),this._events.set(v.SHOW_ENFORCE_ROOM_CATEGORY,v3),this._events.set(v.ROOM_BAN_REMOVE,P3),this._events.set(v.ROOM_MUTED,y3),this._events.set(v.NO_SUCH_FLAT,M3),this._events.set(v.FAVORITE_GROUP_UDPATE,Zy),this._events.set(v.ROOM_MODEL_DOOR,Z_),this._events.set(v.ROOM_HEIGHT_MAP,II),this._events.set(v.ROOM_HEIGHT_MAP_UPDATE,TI),this._events.set(v.ROOM_MODEL,J_),this._events.set(v.ROOM_MODEL_NAME,Ru),this._events.set(v.ROOM_PAINT,RI),this._events.set(v.ROOM_THICKNESS,$_),this._events.set(v.ROOM_GET_FILTER_WORDS,Ey),this._events.set(v.ROOM_MODEL_BLOCKED_TILES,uM),this._events.set(v.PET_FIGURE_UPDATE,tg),this._events.set(v.PET_INFO,_M),this._events.set(v.PET_STATUS,gM),this._events.set(v.PET_EXPERIENCE,dM),this._events.set(v.PLAYING_GAME,fM),this._events.set(v.UNIT_DANCE,ig),this._events.set(v.UNIT_EFFECT,OI),this._events.set(v.UNIT,rg),this._events.set(v.UNIT_EXPRESSION,AI),this._events.set(v.UNIT_HAND_ITEM,NI),this._events.set(v.UNIT_IDLE,CI),this._events.set(v.UNIT_INFO,ng),this._events.set(v.UNIT_NUMBER,xI),this._events.set(v.UNIT_REMOVE,ag),this._events.set(v.UNIT_STATUS,yI),this._events.set(v.HAND_ITEM_RECEIVED,IM),this._events.set(v.FLOOD_CONTROL,EM),this._events.set(v.REMAINING_MUTE,pM),this._events.set(v.UNIT_CHAT,XR),this._events.set(v.UNIT_CHAT_SHOUT,eg),this._events.set(v.UNIT_CHAT_WHISPER,sg),this._events.set(v.UNIT_TYPING,SI),this._events.set(v.WIRED_ACTION,TM),this._events.set(v.WIRED_CONDITION,RM),this._events.set(v.WIRED_TRIGGER,SM),this._events.set(v.WIRED_OPEN,OM),this._events.set(v.WIRED_REWARD,MI),this._events.set(v.WIRED_SAVE,AM),this._events.set(v.WIRED_ERROR,x3),this._events.set(v.AUTHENTICATED,DM),this._events.set(v.JUKEBOX_PLAYLIST_FULL,vM),this._events.set(v.JUKEBOX_SONG_DISKS,PM),this._events.set(v.NOW_PLAYING,LM),this._events.set(v.OFFICIAL_SONG_ID,UM),this._events.set(v.PLAYLIST,L3),this._events.set(v.PLAYLIST_SONG_ADDED,U3),this._events.set(v.TRAX_SONG_INFO,jM),this._events.set(v.USER_SONG_DISKS_INVENTORY,wM),this._events.set(v.HELPER_TALENT_TRACK,F3),this._events.set(v.TALENT_TRACK_LEVEL,w3),this._events.set(v.TALENT_TRACK_LEVEL_UP,j3),this._events.set(v.IN_CLIENT_LINK,KM),this._events.set(v.USER_IGNORED,zM),this._events.set(v.USER_IGNORED_RESULT,$R),this._events.set(v.USER_RESPECT,tS),this._events.set(v.USER_PERMISSIONS,qR),this._events.set(v.USER_BADGES_CURRENT,JR),this._events.set(v.USER_INFO,Su),this._events.set(v.UNIT_CHANGE_NAME,Wm),this._events.set(v.USER_SETTINGS,ZR),this._events.set(v.USER_PROFILE,kM),this._events.set(v.MESSENGER_RELATIONSHIPS,QR),this._events.set(v.GIFT_OPENED,Ox),this._events.set(v.USER_CREDITS,XM),this._events.set(v.USER_CURRENCY,qM),this._events.set(v.USER_SUBSCRIPTION,QM),this._events.set(v.USER_WARDROBE_PAGE,tb),this._events.set(v.USER_CLASSIFICATION,z3),this._events.set(v.GET_USER_TAGS,BM),this._events.set(v.SCR_SEND_KICKBACK_INFO,$M),this._events.set(v.PET_RESPECTED,JM),this._events.set(v.PET_SUPPLEMENT,ZM),this._events.set(v.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,FM),this._events.set(v.GENERIC_ERROR,z_),this._events.set(v.GROUP_LIST,WM),this._events.set(v.CATALOG_APPROVE_NAME_RESULT,GM),this._events.set(v.CONNECTION_ERROR,Ay),this._events.set(v.GUILD_EDIT_FAILED,V3),this._events.set(v.GUILD_MEMBER_MGMT_FAILED,H3),this._events.set(v.EXTENDED_PROFILE_CHANGED,HM),this._events.set(v.NOOBNESS_LEVEL,ex),this._events.set(v.DISCONNECT_REASON,IY),this._events.set(v.HANDSHAKE_INIT_DIFFIE,RY),this._events.set(v.HANDSHAKE_COMPLETE_DIFFIE,pY),this._events.set(v.HANDSHAKE_IDENTITY_ACCOUNT,TY),this._events.set(v.NEW_USER_EXPERIENCE_GIFT_OFFER,Q2),this._events.set(v.NEW_USER_EXPERIENCE_NOT_COMPLETE,Z2),this._events.set(v.RESTORE_CLIENT,o3),this._events.set(v.FIREWORK_CHARGE_DATA,EW),this._events.set(v.PHONE_COLLECTION_STATE,aY),this._events.set(v.PHONE_TRY_NUMBER_RESULT,oY),this._events.set(v.PHONE_TRY_VERIFICATION_CODE_RESULT,lY),this._events.set(v.WELCOME_GIFT_CHANGE_EMAIL_RESULT,Y3),this._events.set(v.WELCOME_GIFT_STATUS,C3),this._events.set(v.RENTABLE_SPACE_RENT_OK,O3),this._events.set(v.RENTABLE_SPACE_STATUS,A3),this._events.set(v.RENTABLE_SPACE_RENT_FAILED,S3),this._events.set(v.RECYCLER_STATUS,$p),this._events.set(v.RECYCLER_FINISHED,Zp),this._events.set(v.EMAIL_STATUS,VM),this._events.set(v.CHANGE_EMAIL_RESULT,G3),this._events.set(v.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,R3),this._events.set(v.AREA_HIDE,nI)}registerComposers(){this._composers.set(b.CLICK_FURNI,WI),this._composers.set(b.AUTHENTICATION,tz),this._composers.set(b.INTERSTITIAL_SHOWN,X3),this._composers.set(b.GET_INTERSTITIAL,K3),this._composers.set(b.GET_WARDROBE,rb),this._composers.set(b.SAVE_WARDROBE_OUTFIT,nb),this._composers.set(b.CHANGE_USERNAME,sb),this._composers.set(b.CHECK_USERNAME,ib),this._composers.set(b.REQUEST_CAMERA_CONFIGURATION,lb),this._composers.set(b.RENDER_ROOM,og),this._composers.set(b.RENDER_ROOM_THUMBNAIL,DI),this._composers.set(b.PURCHASE_PHOTO,ob),this._composers.set(b.PUBLISH_PHOTO,ab),this._composers.set(b.PHOTO_COMPETITION,q3),this._composers.set(b.OPEN_CAMPAIGN_CALENDAR_DOOR,ub),this._composers.set(b.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,cb),this._composers.set(b.BUILDERS_CLUB_PLACE_ROOM_ITEM,hb),this._composers.set(b.BUILDERS_CLUB_PLACE_WALL_ITEM,db),this._composers.set(b.BUILDERS_CLUB_QUERY_FURNI_COUNT,_b),this._composers.set(b.GET_CATALOG_INDEX,fb),this._composers.set(b.GET_CATALOG_PAGE,mb),this._composers.set(b.CATALOG_PURCHASE,Md),this._composers.set(b.CATALOG_PURCHASE_GIFT,Sb),this._composers.set(b.GET_PRODUCT_OFFER,Ib),this._composers.set(b.GET_CLUB_OFFERS,Eb),this._composers.set(b.GET_CLUB_GIFT_INFO,eS),this._composers.set(b.CATALOG_REDEEM_VOUCHER,Nb),this._composers.set(b.GROUP_MEMBERSHIPS,mS),this._composers.set(b.GET_GIFT_WRAPPING_CONFIG,pb),this._composers.set(b.CATALOG_SELECT_VIP_GIFT,Cb),this._composers.set(b.CATALOG_REQUESET_PET_BREEDS,Rb),this._composers.set(b.GET_BONUS_RARE_INFO,gb),this._composers.set(b.GET_BUNDLE_DISCOUNT_RULESET,Q3),this._composers.set(b.GET_CATALOG_PAGE_EXPIRATION,J3),this._composers.set(b.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,Z3),this._composers.set(b.GET_DIRECT_CLUB_BUY_AVAILABLE,$3),this._composers.set(b.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,t5),this._composers.set(b.GET_HABBO_CLUB_EXTEND_OFFER,e5),this._composers.set(b.GET_IS_OFFER_GIFTABLE,s5),this._composers.set(b.GET_LIMITED_OFFER_APPEARING_NEXT,i5),this._composers.set(b.GET_NEXT_TARGETED_OFFER,r5),this._composers.set(b.GET_ROOM_AD_PURCHASE_INFO,Tb),this._composers.set(b.GET_SEASONAL_CALENDAR_DAILY_OFFER,n5),this._composers.set(b.GET_TARGETED_OFFER,sS),this._composers.set(b.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,a5),this._composers.set(b.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,o5),this._composers.set(b.PURCHASE_ROOM_AD,Ob),this._composers.set(b.PURCHASE_TARGETED_OFFER,Ab),this._composers.set(b.PURCHASE_VIP_MEMBERSHIP_EXTENSION,l5),this._composers.set(b.ROOM_AD_PURCHASE_INITIATED,c5),this._composers.set(b.SET_TARGETTED_OFFER_STATE,u5),this._composers.set(b.SHOP_TARGETED_OFFER_VIEWED,h5),this._composers.set(b.FORWARD_TO_A_COMPETITION_ROOM,d5),this._composers.set(b.FORWARD_TO_A_SUBMITTABLE_ROOM,_5),this._composers.set(b.FORWARD_TO_RANDOM_COMPETITION_ROOM,g5),this._composers.set(b.GET_CURRENT_TIMING_CODE,f5),this._composers.set(b.GET_IS_USER_PART_OF_COMPETITION,m5),this._composers.set(b.GET_SECONDS_UNTIL,E5),this._composers.set(b.ROOM_COMPETITION_INIT,p5),this._composers.set(b.SUBMIT_ROOM_TO_COMPETITION,vI),this._composers.set(b.VOTE_FOR_ROOM,I5),this._composers.set(b.CRAFT,xb),this._composers.set(b.CRAFT_SECRET,T5),this._composers.set(b.GET_CRAFTABLE_PRODUCTS,Mb),this._composers.set(b.GET_CRAFTING_RECIPE,yb),this._composers.set(b.GET_CRAFTING_RECIPES_AVAILABLE,R5),this._composers.set(b.FRIEND_FURNI_CONFIRM_LOCK,Db),this._composers.set(b.ACCEPT_FRIEND,vb),this._composers.set(b.DECLINE_FRIEND,PI),this._composers.set(b.FIND_NEW_FRIENDS,Pb),this._composers.set(b.FOLLOW_FRIEND,Ym),this._composers.set(b.FRIEND_LIST_UPDATE,Lb),this._composers.set(b.GET_FRIEND_REQUESTS,Ub),this._composers.set(b.HABBO_SEARCH,jb),this._composers.set(b.MESSENGER_INIT,wb),this._composers.set(b.REMOVE_FRIEND,Fb),this._composers.set(b.REQUEST_FRIEND,iS),this._composers.set(b.MESSENGER_CHAT,Gb),this._composers.set(b.SEND_ROOM_INVITE,kb),this._composers.set(b.SET_RELATIONSHIP_STATUS,mc),this._composers.set(b.VISIT_USER,S5),this._composers.set(b.ACHIEVEMENT_RESOLUTION_OPEN,Yb),this._composers.set(b.ACCEPTGAMEINVITE,y5),this._composers.set(b.GAMEUNLOADEDMESSAGE,M5),this._composers.set(b.GETGAMEACHIEVEMENTSMESSAGE,b5),this._composers.set(b.GAMES_LIST,Hb),this._composers.set(b.GETGAMESTATUSMESSAGE,Wb),this._composers.set(b.GETUSERGAMEACHIEVEMENTSMESSAGE,D5),this._composers.set(b.JOINQUEUEMESSAGE,zb),this._composers.set(b.LEAVEQUEUEMESSAGE,v5),this._composers.set(b.RESETRESOLUTIONACHIEVEMENTMESSAGE,P5),this._composers.set(b.GAMES_INIT,j5),this._composers.set(b.GETWEEKLYGAMEREWARDWINNERS,w5),this._composers.set(b.GAME2GETACCOUNTGAMESTATUSMESSAGE,Vb),this._composers.set(b.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,C5),this._composers.set(b.GAME2EXITGAMEMESSAGE,Bb),this._composers.set(b.GAME2GAMECHATMESSAGE,O5),this._composers.set(b.GAME2LOADSTAGEREADYMESSAGE,A5),this._composers.set(b.GAME2PLAYAGAINMESSAGE,N5),this._composers.set(b.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,x5),this._composers.set(b.GAME2GETWEEKLYFRIENDSLEADERBOARD,L5),this._composers.set(b.GAME2GETWEEKLYLEADERBOARD,U5),this._composers.set(b.GET_GIFT,LI),this._composers.set(b.RESET_PHONE_NUMBER_STATE,F5),this._composers.set(b.SET_PHONE_NUMBER_VERIFICATION_STATUS,UI),this._composers.set(b.TRY_PHONE_NUMBER,G5),this._composers.set(b.VERIFY_CODE,k5),this._composers.set(b.GET_FORUM_STATS,H5),this._composers.set(b.GET_FORUMS_LIST,V5),this._composers.set(b.GET_FORUM_MESSAGES,W5),this._composers.set(b.GET_FORUM_THREAD,Y5),this._composers.set(b.GET_FORUM_THREADS,z5),this._composers.set(b.GET_UNREAD_FORUMS_COUNT,K5),this._composers.set(b.FORUM_MODERATE_MESSAGE,X5),this._composers.set(b.FORUM_MODERATE_THREAD,q5),this._composers.set(b.FORUM_POST_MESSAGE,Q5),this._composers.set(b.UPDATE_FORUM_READ_MARKER,J5),this._composers.set(b.UPDATE_FORUM_SETTINGS,Z5),this._composers.set(b.FORUM_UPDATE_THREAD,$5),this._composers.set(b.CLIENT_PONG,dD),this._composers.set(b.RELEASE_VERSION,uD),this._composers.set(b.SECURITY_TICKET,_D),this._composers.set(b.USER_INFO,hD),this._composers.set(b.DISCONNECT,sz),this._composers.set(b.SECURITY_MACHINE,gD),this._composers.set(b.CLIENT_VARIABLES,rz),this._composers.set(b.HANDSHAKE_INIT_DIFFIE,iz),this._composers.set(b.HANDSHAKE_COMPLETE_DIFFIE,ez),this._composers.set(b.CALL_FOR_HELP_FROM_FORUM_MESSAGE,fD),this._composers.set(b.CALL_FOR_HELP_FROM_FORUM_THREAD,mD),this._composers.set(b.CALL_FOR_HELP_FROM_IM,ED),this._composers.set(b.CALL_FOR_HELP_FROM_PHOTO,pD),this._composers.set(b.CALL_FOR_HELP_FROM_SELFIE,nz),this._composers.set(b.CALL_FOR_HELP,ID),this._composers.set(b.CHAT_REVIEW_GUIDE_DECIDES,az),this._composers.set(b.CHAT_REVIEW_GUIDE_DETACHED,oz),this._composers.set(b.CHAT_REVIEW_GUIDE_VOTE,lz),this._composers.set(b.CHAT_REVIEW_SESSION_CREATE,cz),this._composers.set(b.DELETE_PENDING_CALLS_FOR_HELP,TD),this._composers.set(b.GET_CFH_STATUS,RD),this._composers.set(b.GET_FAQ_CATEGORY,uz),this._composers.set(b.GET_FAQ_TEXT,hz),this._composers.set(b.GET_GUIDE_REPORTING_STATUS,dz),this._composers.set(b.GET_PENDING_CALLS_FOR_HELP,SD),this._composers.set(b.GET_QUIZ_QUESTIONS,_z),this._composers.set(b.GUIDE_SESSION_CREATE,OD),this._composers.set(b.GUIDE_SESSION_FEEDBACK,AD),this._composers.set(b.GUIDE_SESSION_GET_REQUESTER_ROOM,ND),this._composers.set(b.GUIDE_SESSION_GUIDE_DECIDES,CD),this._composers.set(b.GUIDE_SESSION_INVITE_REQUESTER,xD),this._composers.set(b.GUIDE_SESSION_IS_TYPING,gz),this._composers.set(b.GUIDE_SESSION_MESSAGE,yD),this._composers.set(b.GUIDE_SESSION_ON_DUTY_UPDATE,wI),this._composers.set(b.GUIDE_SESSION_REPORT,fz),this._composers.set(b.GUIDE_SESSION_REQUESTER_CANCELS,MD),this._composers.set(b.GUIDE_SESSION_RESOLVED,bD),this._composers.set(b.POST_QUIZ_ANSWERS,mz),this._composers.set(b.SEARCH_FAQS,Ez),this._composers.set(b.DESKTOP_VIEW,bb),this._composers.set(b.GROUP_INFO,Ou),this._composers.set(b.GROUP_REQUEST,eD),this._composers.set(b.GROUP_MEMBER_REMOVE_CONFIRM,Zb),this._composers.set(b.GROUP_MEMBER_REMOVE,zm),this._composers.set(b.GROUP_MEMBERS,jI),this._composers.set(b.GROUP_ADMIN_ADD,Kb),this._composers.set(b.GROUP_ADMIN_REMOVE,Xb),this._composers.set(b.GROUP_REQUEST_ACCEPT,sD),this._composers.set(b.GROUP_REQUEST_DECLINE,iD),this._composers.set(b.GROUP_DELETE,$b),this._composers.set(b.GROUP_CREATE_OPTIONS,Jb),this._composers.set(b.GROUP_PARTS,qb),this._composers.set(b.GROUP_BUY,Qb),this._composers.set(b.GROUP_SETTINGS,lD),this._composers.set(b.GROUP_SAVE_BADGE,rD),this._composers.set(b.GROUP_SAVE_COLORS,nD),this._composers.set(b.GROUP_SAVE_INFORMATION,aD),this._composers.set(b.GROUP_SAVE_PREFERENCES,oD),this._composers.set(b.GROUP_FAVORITE,tD),this._composers.set(b.GROUP_UNFAVORITE,cD),this._composers.set(b.GROUP_BADGES,lL),this._composers.set(b.APPROVE_ALL_MEMBERSHIP_REQUESTS,B5),this._composers.set(b.GROUP_UNBLOCK_MEMBER,$4),this._composers.set(b.ROOM_FAVORITE,Pz),this._composers.set(b.CAN_CREATE_ROOM,Uz),this._composers.set(b.CANCEL_ROOM_EVENT,Lz),this._composers.set(b.CONVERT_GLOBAL_ROOM_ID,hv),this._composers.set(b.COMPETITION_ROOM_SEARCH,jz),this._composers.set(b.ROOM_CREATE,dv),this._composers.set(b.GET_USER_FLAT_CATS,fv),this._composers.set(b.GET_USER_EVENT_CATS,aS),this._composers.set(b.ROOM_FAVORITE_REMOVE,wz),this._composers.set(b.EDIT_ROOM_EVENT,_v),this._composers.set(b.FORWARD_TO_RANDOM_PROMOTED_ROOM,Fz),this._composers.set(b.FORWARD_TO_SOME_ROOM,Gz),this._composers.set(b.GET_CATEGORIES_WITH_USER_COUNT,kz),this._composers.set(b.GET_GUEST_ROOM,ad),this._composers.set(b.GET_OFFICIAL_ROOMS,Bz),this._composers.set(b.GET_POPULAR_ROOM_TAGS,Vz),this._composers.set(b.GUILD_BASE_SEARCH,Hz),this._composers.set(b.MY_FAVOURITE_ROOMS_SEARCH,Wz),this._composers.set(b.MY_FREQUENT_ROOM_HISTORY_SEARCH,Yz),this._composers.set(b.MY_FRIENDS_ROOM_SEARCH,zz),this._composers.set(b.MY_GUILD_BASES_SEARCH,Kz),this._composers.set(b.MY_RECOMMENDED_ROOMS,Xz),this._composers.set(b.MY_ROOM_HISTORY_SEARCH,qz),this._composers.set(b.MY_ROOM_RIGHTS_SEARCH,Qz),this._composers.set(b.MY_ROOMS_SEARCH,Jz),this._composers.set(b.POPULAR_ROOMS_SEARCH,r4),this._composers.set(b.ROOM_LIKE,Ev),this._composers.set(b.ROOM_RIGHTS_REMOVE_OWN,n4),this._composers.set(b.ROOM_AD_EVENT_TAB_CLICKED,a4),this._composers.set(b.ROOM_AD_EVENT_TAB_VIEWED,o4),this._composers.set(b.ROOM_AD_SEARCH,l4),this._composers.set(b.ROOM_TEXT_SEARCH,h4),this._composers.set(b.ROOMS_WHERE_MY_FRIENDS_ARE,c4),this._composers.set(b.ROOMS_WITH_HIGHEST_SCORE_SEARCH,u4),this._composers.set(b.SET_ROOM_SESSION_TAGS,d4),this._composers.set(b.ROOM_STAFF_PICK,pv),this._composers.set(b.ROOM_FILTER_WORDS,gv),this._composers.set(b.ROOM_FILTER_WORDS_MODIFY,Tv),this._composers.set(b.USER_HOME_ROOM,Iv),this._composers.set(b.UPDATE_ROOM_THUMBNAIL,_4),this._composers.set(b.NAVIGATOR_INIT,mv),this._composers.set(b.NAVIGATOR_SEARCH_CLOSE,t4),this._composers.set(b.NAVIGATOR_SEARCH,Vl),this._composers.set(b.NAVIGATOR_SEARCH_OPEN,e4),this._composers.set(b.NAVIGATOR_SEARCH_SAVE,s4),this._composers.set(b.NAVIGATOR_SETTINGS_SAVE,i4),this._composers.set(b.NAVIGATOR_CATEGORY_LIST_MODE,Zz),this._composers.set(b.NAVIGATOR_DELETE_SAVED_SEARCH,$z),this._composers.set(b.POLL_ANSWER,yv),this._composers.set(b.POLL_REJECT,Mv),this._composers.set(b.POLL_START,bv),this._composers.set(b.POLL_VOTE_COUNTER,Dv),this._composers.set(b.USER_EFFECT_ACTIVATE,pz),this._composers.set(b.USER_EFFECT_ENABLE,Iz),this._composers.set(b.USER_BADGES,DD),this._composers.set(b.USER_BADGES_CURRENT_UPDATE,vD),this._composers.set(b.GET_BADGE_POINTS_LIMITS,Tz),this._composers.set(b.REQUESTABADGE,Sz),this._composers.set(b.GETISBADGEREQUESTFULFILLED,Rz),this._composers.set(b.USER_BOTS,FI),this._composers.set(b.USER_FURNITURE,LD),this._composers.set(b.REQUESTFURNIINVENTORYWHENNOTINROOM,Oz),this._composers.set(b.USER_PETS,GI),this._composers.set(b.TRADE_ACCEPT,UD),this._composers.set(b.TRADE_CANCEL,jD),this._composers.set(b.TRADE_CLOSE,wD),this._composers.set(b.TRADE_CONFIRM,FD),this._composers.set(b.TRADE_ITEM,kI),this._composers.set(b.TRADE_ITEMS,GD),this._composers.set(b.TRADE_ITEM_REMOVE,kD),this._composers.set(b.TRADE,BD),this._composers.set(b.TRADE_UNACCEPT,VD),this._composers.set(b.UNSEEN_RESET_CATEGORY,HD),this._composers.set(b.UNSEEN_RESET_ITEMS,WD),this._composers.set(b.ACHIEVEMENT_LIST,eb),this._composers.set(b.PET_MOUNT,HI),this._composers.set(b.PET_RESPECT,bd),this._composers.set(b.PET_SUPPLEMENT,f4),this._composers.set(b.REMOVE_PET_SADDLE,Ov),this._composers.set(b.PET_INFO,Av),this._composers.set(b.TOGGLE_PET_BREEDING,Nv),this._composers.set(b.TOGGLE_PET_RIDING,Cv),this._composers.set(b.USE_PET_PRODUCT,xv),this._composers.set(b.GET_PET_TRAINING_PANEL,Sv),this._composers.set(b.PET_OPEN_PACKAGE,dS),this._composers.set(b.PET_SELECTED,k4),this._composers.set(b.PETS_BREED,qI),this._composers.set(b.PET_CANCEL_BREEDING,Az),this._composers.set(b.PET_CONFIRM_BREEDING,Nz),this._composers.set(b.ROOM_ENTER,Lv),this._composers.set(b.ROOM_DOORBELL,Pv),this._composers.set(b.GO_TO_FLAT,yP),this._composers.set(b.CHANGE_QUEUE,xP),this._composers.set(b.ROOM_AMBASSADOR_ALERT,jv),this._composers.set(b.ROOM_BAN_GIVE,wv),this._composers.set(b.ROOM_BAN_REMOVE,Vv),this._composers.set(b.ROOM_RIGHTS_GIVE,Gv),this._composers.set(b.ROOM_KICK,kv),this._composers.set(b.ROOM_MUTE_USER,Bv),this._composers.set(b.ROOM_RIGHTS_REMOVE,oS),this._composers.set(b.ROOM_RIGHTS_REMOVE_ALL,Uv),this._composers.set(b.ROOM_DELETE,Fv),this._composers.set(b.ROOM_SETTINGS,cS),this._composers.set(b.ROOM_SETTINGS_SAVE,Yv),this._composers.set(b.ROOM_RIGHTS_LIST,Wv),this._composers.set(b.ROOM_BAN_LIST,lS),this._composers.set(b.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,H4),this._composers.set(b.BOT_CONFIGURATION,Hv),this._composers.set(b.GET_ITEM_DATA,qv),this._composers.set(b.REMOVE_WALL_ITEM,$v),this._composers.set(b.BOT_PLACE,zv),this._composers.set(b.BOT_PICKUP,Km),this._composers.set(b.BOT_SKILL_SAVE,Dn),this._composers.set(b.PET_PLACE,Jv),this._composers.set(b.PET_MOVE,YI),this._composers.set(b.PET_PICKUP,Zv),this._composers.set(b.SET_ITEM_DATA,eP),this._composers.set(b.SET_OBJECT_DATA,uS),this._composers.set(b.COMPOST_PLANT,Xv),this._composers.set(b.HARVEST_PET,Qv),this._composers.set(b.SET_CLOTHING_CHANGE_DATA,tP),this._composers.set(b.FURNITURE_ALIASES,aP),this._composers.set(b.FURNITURE_GROUP_INFO,oP),this._composers.set(b.FURNITURE_PICKUP,lP),this._composers.set(b.FURNITURE_PLACE,hS),this._composers.set(b.ITEM_PAINT,Yu),this._composers.set(b.FURNITURE_POSTIT_PLACE,cP),this._composers.set(b.FURNITURE_POSTIT_SAVE_STICKY_POLE,sP),this._composers.set(b.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,wu),this._composers.set(b.GET_YOUTUBE_DISPLAY_STATUS,OP),this._composers.set(b.SET_YOUTUBE_DISPLAY_PLAYLIST,KI),this._composers.set(b.FURNITURE_FLOOR_UPDATE,zI),this._composers.set(b.FURNITURE_WALL_UPDATE,SP),this._composers.set(b.ITEM_DIMMER_SETTINGS,iP),this._composers.set(b.ITEM_DIMMER_SAVE,rP),this._composers.set(b.ITEM_DIMMER_TOGGLE,nP),this._composers.set(b.ROOM_TONER_APPLY,RP),this._composers.set(b.ITEM_COLOR_WHEEL_CLICK,uP),this._composers.set(b.ITEM_DICE_CLICK,hP),this._composers.set(b.ITEM_DICE_CLOSE,dP),this._composers.set(b.FURNITURE_MULTISTATE,Au),this._composers.set(b.FURNITURE_RANDOMSTATE,fP),this._composers.set(b.ITEM_STACK_HELPER,lg),this._composers.set(b.FURNITURE_WALL_MULTISTATE,mP),this._composers.set(b.ONE_WAY_DOOR_CLICK,gP),this._composers.set(b.ITEM_EXCHANGE_REDEEM,_P),this._composers.set(b.ITEM_CLOTHING_REDEEM,CP),this._composers.set(b.ROOM_MODEL,XI),this._composers.set(b.GET_OCCUPIED_TILES,AP),this._composers.set(b.GET_ROOM_ENTRY_TILE,NP),this._composers.set(b.ROOM_MODEL_SAVE,_S),this._composers.set(b.UNIT_ACTION,LP),this._composers.set(b.UNIT_DANCE,UP),this._composers.set(b.UNIT_DROP_HAND_ITEM,jP),this._composers.set(b.UNIT_GIVE_HANDITEM,wP),this._composers.set(b.UNIT_GIVE_HANDITEM_PET,fS),this._composers.set(b.UNIT_LOOK,FP),this._composers.set(b.UNIT_SIGN,kP),this._composers.set(b.UNIT_POSTURE,GP),this._composers.set(b.UNIT_WALK,BP),this._composers.set(b.UNIT_CHAT,gS),this._composers.set(b.UNIT_CHAT_SHOUT,MP),this._composers.set(b.USER_SETTINGS_CHAT_STYLE,bP),this._composers.set(b.UNIT_CHAT_WHISPER,DP),this._composers.set(b.UNIT_TYPING,vP),this._composers.set(b.UNIT_TYPING_STOP,PP),this._composers.set(b.WIRED_APPLY_SNAPSHOT,V4),this._composers.set(b.WIRED_OPEN,VP),this._composers.set(b.WIRED_ACTION_SAVE,WP),this._composers.set(b.WIRED_CONDITION_SAVE,YP),this._composers.set(b.WIRED_TRIGGER_SAVE,zP),this._composers.set(b.ROOM_MUTE,HP),this._composers.set(b.APPROVE_NAME,tL),this._composers.set(b.USER_RESPECT,fL),this._composers.set(b.SCR_GET_KICKBACK_INFO,uL),this._composers.set(b.PEER_USERS_CLASSIFICATION,mL),this._composers.set(b.USER_CLASSIFICATION,EL),this._composers.set(b.USER_IGNORED,eL),this._composers.set(b.USER_IGNORE,iL),this._composers.set(b.USER_IGNORE_ID,rL),this._composers.set(b.USER_UNIGNORE,nL),this._composers.set(b.USER_BADGES_CURRENT,ES),this._composers.set(b.USER_FIGURE,pS),this._composers.set(b.USER_MOTTO,aL),this._composers.set(b.USER_PROFILE,oL),this._composers.set(b.USER_PROFILE_BY_NAME,J4),this._composers.set(b.USER_TAGS,sL),this._composers.set(b.MESSENGER_RELATIONSHIPS,IS),this._composers.set(b.MANNEQUIN_SAVE_NAME,pP),this._composers.set(b.MANNEQUIN_SAVE_LOOK,EP),this._composers.set(b.PRESENT_OPEN_PRESENT,TP),this._composers.set(b.MARKETPLACE_CONFIG,KD),this._composers.set(b.MARKETPLACE_SELL_ITEM,QD),this._composers.set(b.MARKETPLACE_REQUEST_OWN_ITEMS,qD),this._composers.set(b.MARKETPLACE_TAKE_BACK_ITEM,zD),this._composers.set(b.MARKETPLACE_REQUEST_OFFERS,XD),this._composers.set(b.MARKETPLACE_BUY_OFFER,BI),this._composers.set(b.MARKETPLACE_REDEEM_CREDITS,JD),this._composers.set(b.MARKETPLACE_BUY_TOKENS,xz),this._composers.set(b.REQUEST_SELL_ITEM,yz),this._composers.set(b.REQUEST_MARKETPLACE_ITEM_STATS,Mz),this._composers.set(b.USER_BOTS,FI),this._composers.set(b.USER_PETS,GI),this._composers.set(b.USER_CURRENCY,cL),this._composers.set(b.USER_SUBSCRIPTION,QI),this._composers.set(b.MODTOOL_REQUEST_ROOM_INFO,tv),this._composers.set(b.MODTOOL_CHANGE_ROOM_SETTINGS,VI),this._composers.set(b.MODTOOL_REQUEST_USER_CHATLOG,rv),this._composers.set(b.MODTOOL_REQUEST_ROOM_CHATLOG,sv),this._composers.set(b.MOD_TOOL_USER_INFO,ev),this._composers.set(b.MODTOOL_SANCTION_ALERT,nv),this._composers.set(b.MODTOOL_SANCTION_BAN,_a),this._composers.set(b.MODTOOL_SANCTION_KICK,av),this._composers.set(b.MODTOOL_SANCTION_TRADELOCK,lv),this._composers.set(b.MODTOOL_ALERTEVENT,rS),this._composers.set(b.MODTOOL_SANCTION_MUTE,ov),this._composers.set(b.MODTOOL_REQUEST_USER_ROOMS,iv),this._composers.set(b.MODTOOL_ROOM_ALERT,bl),this._composers.set(b.CLOSE_ISSUE_DEFAULT_ACTION,bz),this._composers.set(b.CLOSE_ISSUES,Ml),this._composers.set(b.DEFAULT_SANCTION,ZD),this._composers.set(b.GET_CFH_CHATLOG,$D),this._composers.set(b.MODTOOL_PREFERENCES,Dz),this._composers.set(b.MODTOOL_SANCTION,vz),this._composers.set(b.PICK_ISSUES,cv),this._composers.set(b.RELEASE_ISSUES,nS),this._composers.set(b.MYSTERYBOXWAITINGCANCELEDMESSAGE,uv),this._composers.set(b.MYSTERYBOX_OPEN_TROPHY,IP),this._composers.set(b.USER_SETTINGS_CAMERA,hL),this._composers.set(b.USER_SETTINGS_OLD_CHAT,dL),this._composers.set(b.USER_SETTINGS_INVITES,_L),this._composers.set(b.USER_SETTINGS_VOLUME,gL),this._composers.set(b.COMMUNITY_GOAL_VOTE_COMPOSER,Cz),this._composers.set(b.GET_PROMO_ARTICLES,YD),this._composers.set(b.ACCEPT_QUEST,m4),this._composers.set(b.ACTIVATE_QUEST,E4),this._composers.set(b.CANCEL_QUEST,p4),this._composers.set(b.FRIEND_REQUEST_QUEST_COMPLETE,I4),this._composers.set(b.GET_COMMUNITY_GOAL_EARNED_PRIZES,T4),this._composers.set(b.GET_COMMUNITY_GOAL_HALL_OF_FAME,vv),this._composers.set(b.GET_COMMUNITY_GOAL_PROGRESS,R4),this._composers.set(b.GET_CONCURRENT_USERS_GOAL_PROGRESS,S4),this._composers.set(b.GET_CONCURRENT_USERS_REWARD,O4),this._composers.set(b.GET_DAILY_QUEST,A4),this._composers.set(b.GET_QUESTS,N4),this._composers.set(b.GET_SEASONAL_QUESTS_ONLY,C4),this._composers.set(b.OPEN_QUEST_TRACKER,x4),this._composers.set(b.REDEEM_COMMUNITY_GOAL_PRIZE,y4),this._composers.set(b.REJECT_QUEST,M4),this._composers.set(b.START_CAMPAIGN,b4),this._composers.set(b.GET_SOUND_SETTINGS,Y4),this._composers.set(b.ADD_JUKEBOX_DISK,KP),this._composers.set(b.GET_JUKEBOX_PLAYLIST,XP),this._composers.set(b.GET_NOW_PLAYING,qP),this._composers.set(b.GET_OFFICIAL_SONG_ID,QP),this._composers.set(b.GET_SONG_INFO,JP),this._composers.set(b.GET_SOUND_MACHINE_PLAYLIST,W4),this._composers.set(b.GET_USER_SONG_DISKS,ZP),this._composers.set(b.REMOVE_JUKEBOX_DISK,$P),this._composers.set(b.HELPER_TALENT_TRACK,K4),this._composers.set(b.TALENT_TRACK_GET_LEVEL,z4),this._composers.set(b.NEW_USER_EXPERIENCE_GET_GIFTS,g4),this._composers.set(b.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,Rv),this._composers.set(b.WELCOME_OPEN_GIFT,j4),this._composers.set(b.WELCOME_GIFT_CHANGE_EMAIL,tK),this._composers.set(b.EMAIL_GET_STATUS,Z4),this._composers.set(b.EMAIL_CHANGE,Q4),this._composers.set(b.RENTABLE_SPACE_CANCEL_RENT,w4),this._composers.set(b.RENTABLE_SPACE_RENT,F4),this._composers.set(b.RENTABLE_SPACE_STATUS,G4),this._composers.set(b.RECYCLER_STATUS,D4),this._composers.set(b.RECYCLER_ITEMS,v4),this._composers.set(b.TRACKING_PERFORMANCE_LOG,q4),this._composers.set(b.TRACKING_LAG_WARNING_REPORT,X4),this._composers.set(b.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,B4),this._composers.set(b.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,L4),this._composers.set(b.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,P4),this._composers.set(b.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,U4)}get events(){return this._events}get composers(){return this._composers}}class sK{constructor(t){this._value=t}get value(){return this._value}}class iK{constructor(t,e){this._header=t,this._buffer=e}readBytes(t){return this._buffer?this._buffer.readBytes(t):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const t=this.readShort();return this._buffer.readBytes(t).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class rK{constructor(t){this._value=t}get value(){return this._value}}class nK{encode(t,e){const s=new UO;s.writeShort(t);for(const n of e){let o=typeof n;switch(o==="object"&&(n===null?o="null":n instanceof sK?o="byte":n instanceof rK?o="short":n instanceof ArrayBuffer&&(o="arraybuffer")),o){case"undefined":case"null":s.writeShort(0);break;case"byte":s.writeByte(n.value);break;case"short":s.writeShort(n.value);break;case"number":s.writeInt(n);break;case"boolean":s.writeByte(n?1:0);break;case"string":n?s.writeString(n,!0):s.writeShort(0);break;case"arraybuffer":s.writeBytes(n);break}}const r=s.getBuffer();return r?new UO().writeInt(r.byteLength).writeBytes(r):null}decode(t){if(!t||!t.dataBuffer||!t.dataBuffer.byteLength)return null;const e=[];for(;t.dataBuffer.byteLength&&!(t.dataBuffer.byteLength<4);){const s=new Fm(t.dataBuffer),r=s.readInt();if(r>t.dataBuffer.byteLength-4)break;const n=s.readBytes(r);e.push(new iK(n.readShort(),n)),t.dataBuffer=t.dataBuffer.slice(r+4)}return e}}class aK{constructor(){this._socket=null,this._messages=new $j,this._codec=new nK,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1}init(t){!t||!t.length||(this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(t),this._socket.binaryType="arraybuffer",this._socket.addEventListener(hc.CONNECTION_OPENED,e=>X().dispatchEvent(new se(vi.SOCKET_OPENED))),this._socket.addEventListener(hc.CONNECTION_CLOSED,e=>X().dispatchEvent(new se(vi.SOCKET_CLOSED))),this._socket.addEventListener(hc.CONNECTION_ERROR,e=>X().dispatchEvent(new se(vi.SOCKET_ERROR))),this._socket.addEventListener(hc.CONNECTION_MESSAGE,e=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,e.data),this.processReceivedData()}))}ready(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}authenticated(){this._isAuthenticated=!0}send(...t){if(!t)return!1;if(t=[...t],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages.push(...t),!1;for(const e of t){if(!e)continue;const s=this._messages.getComposerId(e);if(s===-1){Lt.packets("Unknown Composer",e.constructor.name);continue}const r=e.getMessageArray(),n=this._codec.encode(s,r);if(!n){Lt.packets("Encoding Failed",e.constructor.name);continue}Lt.packets("OutgoingComposer",s,e.constructor.name,r),this.write(n.getBuffer())}return!0}write(t){this._socket.readyState===WebSocket.OPEN&&this._socket.send(t)}processReceivedData(){try{this.processData()}catch(t){Lt.error(t)}}processData(){const t=this.splitReceivedMessages();if(!(!t||!t.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...t);return}this.processWrappers(...t)}}processWrappers(...t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=this.getMessagesForWrapper(e);!s||!s.length||(Lt.packets("IncomingMessage",e.header,s[0].constructor.name,s[0].parser),this.handleMessages(...s))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(t,e){const s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(e),t.byteLength),s.buffer}getMessagesForWrapper(t){if(!t)return null;const e=this._messages.getEvents(t.header);if(!e||!e.length)return Lt.packets("IncomingMessage",t.header,"UNREGISTERED",t),null;try{const s=new e[0].parserClass;if(!s||!s.flush()||!s.parse(t))return null;for(const r of e)r.parser=s}catch(s){return Lt.error("Error parsing message",s,e[0].constructor.name),null}return e}handleMessages(...t){t=[...t];for(const e of t)e&&(e.connection=this,e.callBack&&e.callBack(e))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){!t||!this._messages||this._messages.registerMessageEvent(t)}removeMessageEvent(t){!t||!this._messages||this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class oK{constructor(){this._connection=new aK,this._messages=new eK,this._pongInterval=null,this._connection.registerMessages(this._messages)}getGpu(){const t=document.createElement("canvas");let e,s,r,n;try{if(e=t.getContext("webgl")||t.getContext("experimental-webgl"),s=e.getExtension("WEBGL_debug_renderer_info"),e===null||s===null)return""}catch{return""}return r=e.getParameter(s.UNMASKED_VENDOR_WEBGL),n=e.getParameter(s.UNMASKED_RENDERER_WEBGL),r+"|"+n}getMathResult(){let t;t="";try{return t="<mathroutines>"+(Math.exp(10)+1/Math.exp(10))/2+"|"+Math.tan(-1e300)+"</mathroutines>",t}catch{return"<mathroutines>Error</mathroutines>"}}getCanvas(){const t=document.createElement("canvas"),e=t.getContext("2d");new Date().toString();const s="ThiosIsVerrySeCuRe02938883721moreStuff! | ${userAgent} | ${screenInfo} | ${currentDate}";e.textBaseline="top",e.font="16px 'Arial'",e.textBaseline="alphabetic",e.rotate(.05),e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(s,2,15),e.fillStyle="rgba(102, 200, 0, 0.7)",e.fillText(s,4,17),e.shadowBlur=10,e.shadowColor="blue",e.fillRect(-20,10,234,5);const r=t.toDataURL();document.body.appendChild(t);let n=0;if(r.length===0)return"nothing!";for(let o=0;o<r.length;o++)n=(n<<5)-n+r.charCodeAt(o),n&=n;return n}generateMachineID(){const t=new _0.ClientJS,e=t.getCustomFingerprint(t.getAvailableResolution(),t.getOS(),t.getCPU(),t.getColorDepth(),this.getGpu(),t.getSilverlightVersion(),t.getOSVersion(),this.getMathResult(),t.getCanvasPrint(),this.getCanvas());return e==null?"FAILED":`IID-${e}`}async init(){return X().addEventListener(vi.SOCKET_CLOSED,()=>{this.stopPong()}),new Promise((t,e)=>{X().addEventListener(vi.SOCKET_OPENED,()=>{jt().getValue("system.pong.manually",!1)&&this.startPong();const s=this.generateMachineID();this._connection.send(new uD(null,null,null,null)),this._connection.send(new _D(jt().getValue("sso.ticket",null),zt())),this._connection.send(new gD(s,"",""))}),X().addEventListener(vi.SOCKET_ERROR,()=>{e()}),this._connection.addMessageEvent(new LC(s=>this.sendPong())),this._connection.addMessageEvent(new DM(s=>{this._connection.authenticated(),t(),s.connection.send(new hD)})),this._connection.init(jt().getValue("socket.url"))})}startPong(){this._pongInterval&&this.stopPong(),this._pongInterval=setInterval(()=>this.sendPong(),jt().getValue("system.pong.interval.ms",2e4))}stopPong(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(){var t;(t=this._connection)==null||t.send(new dD)}registerMessageEvent(t){return this._connection&&this._connection.addMessageEvent(t),t}removeMessageEvent(t){this._connection&&this._connection.removeMessageEvent(t)}get connection(){return this._connection}}const lK=new oK,it=()=>lK;class EE{constructor(t){this._badgeId="",this._level=1,this._base="",this._badgeId=t,this.parseText()}parseText(){let t=this._badgeId.length-1;for(;t>0&&this.isNumber(this._badgeId.charAt(t));)t--;this._base=this._badgeId.substr(0,t+1);const e=this._badgeId.substr(t+1,this._badgeId.length);e&&e!==""&&(this._level=Number.parseInt(e))}isNumber(t){const e=t.charCodeAt(0);return e>=48&&e<=57}get level(){return this._level}set level(t){this._level=Math.max(1,t)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class cK{constructor(){this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"]}async init(){try{const t=jt().getValue("external.texts.url").slice();if(!t||!t.length)throw new Error("Invalid localization urls");for(let e of t){if(!e||!e.length)return;e=jt().interpolate(e);const s=await fetch(e);if(s.status!==200)throw new Error("Invalid localization file");this.parseLocalization(await s.json())}it().registerMessageEvent(new BR(this.onBadgePointLimitsEvent.bind(this)))}catch(t){throw new Error(t)}}parseLocalization(t){if(!t)return!1;for(const e in t)this._definitions.set(e,t[e]);return!0}onBadgePointLimitsEvent(t){const e=t.getParser();for(const s of e.data)this.setBadgePointLimit(s.badgeId,s.limit)}getBadgePointLimit(t){return this._badgePointLimits.get(t)||-1}setBadgePointLimit(t,e){this._badgePointLimits.set(t,e)}getRomanNumeral(t){return this._romanNumerals[Math.max(0,t-1)]}getPreviousLevelBadgeId(t){const e=new EE(t);return e.level--,e.getBadgeId}hasValue(t){return this._definitions.has(t)}getValue(t,e=!0){if(!t||!t.length)return null;const s=t.match(/\$\{.[^}]*\}/g);if(s&&s.length)for(const n of s)t=t.replace(n,this.getValue(n.slice(2,-1),e));let r=this._definitions.get(t)||null;if(!r&&(r=jt().definitions.get(t),r))return r;if(r&&e){const n=this._parameters.get(t);if(n)for(const[o,l]of n)r=r.replace("%"+o+"%",l)}return r||t}getValueWithParameter(t,e,s){const r=this.getValue(t,!1),n=r.replace("%"+e+"%",s);if(r.startsWith("%{")){const o=new RegExp("%{"+e.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),l=r.match(o);if(!l)return n;let c=-1;switch(Number.parseInt(s)){case 0:c=1;break;case 1:c=2;break;default:case 2:c=3;break}if(c==-1||typeof l[c]>"u")return n;const h=l[c];if(h)return h.replace("%%",s)}return n}getValueWithParameters(t,e,s){let r=this.getValue(t,!1);if(e)for(let n=0;n<e.length;n++){const o=e[n],l=s[n];if(l!==void 0&&(r=r.replace("%"+o+"%",l),r.startsWith("%{"))){const c=new RegExp("%{"+o.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),u=r.match(c);if(!u)continue;const h=parseInt(l);let d=-1;switch(h){case 0:d=1;break;case 1:d=2;break;case 2:default:d=3;break}if(d===-1||typeof u[d]>"u")continue;const f=u[d];f&&(r=f.replace("%%",l))}}return r}setValue(t,e){this._definitions.set(t,e)}registerParameter(t,e,s){if(!t||t.length===0||!e||e.length===0)return;let r=this._parameters.get(t);r||(r=new Map,this._parameters.set(t,r)),r.set(e,s)}getBadgeName(t){const e=new EE(t),s=["badge_name_"+t,"badge_name_"+e.base];let r=this.fixBadLocalization(this.getExistingKey(s));return r=r.replace("%roman%",this.getRomanNumeral(e.level)),r}getBadgeDesc(t){const e=new EE(t),s=["badge_desc_"+t,"badge_desc_"+e.base];let r=this.fixBadLocalization(this.getExistingKey(s));const n=this.getBadgePointLimit(t);return n>-1&&(r=r.replace("%limit%",n.toString())),r=r.replace("%roman%",this.getRomanNumeral(e.level)),r}getExistingKey(t){for(const e of t){const s=this.getValue(e);if(s!=e)return s}return""}fixBadLocalization(t){return t.replace("${","$").replace("{","$").replace("}","$")}}const uK=new cK,Tn=()=>uK,kn=class kn{constructor(){this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}getUserData(t){return this.getDataByType(t,kn.TYPE_USER)}getPetData(t){return this.getDataByType(t,kn.TYPE_PET)}getBotData(t){return this.getDataByType(t,kn.TYPE_BOT)}getRentableBotData(t){return this.getDataByType(t,kn.TYPE_RENTABLE_BOT)}getDataByType(t,e){const s=this._userDataByType.get(e);if(!s)return null;const r=s.get(t);return r||null}getUserDataByIndex(t){const e=this._userDataByRoomIndex.get(t);return e||null}getUserDataByName(t){for(const e of this._userDataByRoomIndex.values())if(!(!e||e.name!==t))return e;return null}updateUserData(t){if(!t)return;this.removeUserData(t.roomIndex);let e=this._userDataByType.get(t.type);e||(e=new Map,this._userDataByType.set(t.type,e)),e.set(t.webID,t),this._userDataByRoomIndex.set(t.roomIndex,t)}removeUserData(t){const e=this.getUserDataByIndex(t);if(!e)return;this._userDataByRoomIndex.delete(t);const s=this._userDataByType.get(e.type);s&&s.delete(e.webID)}getUserBadges(t){it().connection.send(new ES(t));const e=this._userBadges.get(t);return e||[]}setUserBadges(t,e){this._userBadges.set(t,e)}updateFigure(t,e,s,r,n){const o=this.getUserDataByIndex(t);o&&(o.figure=e,o.sex=s,o.hasSaddle=r,o.isRiding=n)}updateName(t,e){const s=this.getUserDataByIndex(t);s&&(s.name=e)}updateMotto(t,e){const s=this.getUserDataByIndex(t);s&&(s.custom=e)}updateAchievementScore(t,e){const s=this.getUserDataByIndex(t);s&&(s.activityPoints=e)}updatePetLevel(t,e){const s=this.getUserDataByIndex(t);s&&(s.petLevel=e)}updatePetBreedingStatus(t,e,s,r,n){const o=this.getUserDataByIndex(t);o&&(o.canBreed=e,o.canHarvest=s,o.canRevive=r,o.hasBreedingPermission=n)}requestPetInfo(t){this.getPetData(t)&&it().connection.send(new Av(t))}};kn.TYPE_USER=1,kn.TYPE_PET=2,kn.TYPE_BOT=3,kn.TYPE_RENTABLE_BOT=4;let JI=kn;class pL{constructor(){this._userData=new JI,this._roomId=0,this._password=null,this._state=yt.CREATED,this._tradeMode=nu.NO_TRADING,this._doorMode=0,this._allowPets=!1,this._controllerLevel=Ce.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}setControllerLevel(t){if(t>=Ce.NONE&&t<=Ce.MODERATOR){this._controllerLevel=t;return}this._controllerLevel=Ce.NONE}setOwnRoomIndex(t){this._ownRoomIndex=t}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==yt.CREATED||!it().connection?!1:(this._state=yt.STARTED,this.enterRoom())}enterRoom(){return it().connection?(it().connection.send(new Lv(this._roomId,this._password)),!0):!1}reset(t){t!==this._roomId&&(this._roomId=t)}sendChatMessage(t,e,s){it().connection.send(new gS(t,e,s))}sendShoutMessage(t,e,s){it().connection.send(new MP(t,e,s))}sendWhisperMessage(t,e,s){it().connection.send(new DP(t,e,s))}sendChatTypingMessage(t){t?it().connection.send(new vP):it().connection.send(new PP)}sendMottoMessage(t){it().connection.send(new aL(t))}sendDanceMessage(t){it().connection.send(new UP(t))}sendExpressionMessage(t){it().connection.send(new LP(t))}sendSignMessage(t){t<0||t>17||it().connection.send(new kP(t))}sendPostureMessage(t){it().connection.send(new GP(t))}sendDoorbellApprovalMessage(t,e){it().connection.send(new Pv(t,e))}sendAmbassadorAlertMessage(t){it().connection.send(new jv(t))}sendWhisperGroupMessage(t){it().connection.send(new ChatWhisperGroupComposer(t))}sendKickMessage(t){it().connection.send(new kv(t))}sendMuteMessage(t,e){it().connection.send(new Bv(t,e,this._roomId))}sendBanMessage(t,e){it().connection.send(new wv(t,this._roomId,e))}sendGiveRightsMessage(t){it().connection.send(new Gv(t))}sendTakeRightsMessage(t){it().connection.send(new oS(t))}sendPollStartMessage(t){it().connection.send(new bv(t))}sendPollRejectMessage(t){it().connection.send(new Mv(t))}sendPollAnswerMessage(t,e,s){it().connection.send(new yv(t,e,s))}sendPeerUsersClassificationMessage(t){it().connection.send(new mL(t))}sendOpenPetPackageMessage(t,e){it().connection.send(new dS(t,e))}sendRoomUsersClassificationMessage(t){it().connection.send(new EL(t))}updateMoodlightData(t,e,s,r,n){let o="000000"+s.toString(16).toUpperCase();o="#"+o.substring(o.length-6),it().connection.send(new rP(t,e,o,r,n))}toggleMoodlightState(){it().connection.send(new nP)}pickupPet(t){it().connection&&it().connection.send(new Zv(t))}pickupBot(t){it().connection&&it().connection.send(new Km(t))}requestMoodlightSettings(){it().connection&&it().connection.send(new iP)}openGift(t){it().connection.send(new TP(t))}mountPet(t){it().connection.send(new HI(t,!0))}dismountPet(t){it().connection.send(new HI(t,!1))}usePetProduct(t,e){it().connection.send(new xv(t,e))}removePetSaddle(t){it().connection.send(new Ov(t))}togglePetBreeding(t){it().connection.send(new Nv(t))}togglePetRiding(t){it().connection.send(new Cv(t))}useMultistateItem(t){it().connection.send(new Au(t))}harvestPet(t){it().connection.send(new Qv(t))}compostPlant(t){it().connection.send(new Xv(t))}requestPetCommands(t){it().connection.send(new Sv(t))}sendScriptProceed(){it().connection.send(new Rv)}sendUpdateClothingChangeFurniture(t,e,s){it().connection.send(new tP(t,e,s))}changeQueue(t){it().connection.send(new xP(t))}votePoll(t){it().connection.send(new Dv(t))}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get password(){return this._password}set password(t){this._password=t}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(t){this._isGuildRoom=t}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(t){this._isDecorating=t}get isSpectator(){return this._isSpectator}set isSpectator(t){this._isSpectator=t}get moderationSettings(){return this._moderationSettings}set moderationSettings(t){this._moderationSettings=t}}class Cn{constructor(t,e){this._connection=t,this._listener=e,this._roomId=0}dispose(){this._connection=null,this._listener=null}setRoomId(t){this._roomId=t}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class hK extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new z_(this.onRoomGenericError.bind(this)))}onRoomGenericError(t){if(!(t instanceof z_))return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let r="";switch(e.errorCode){case $E.KICKED_OUT_OF_ROOM:r=ue.RSEME_KICKED;break;default:return}!r||r.length==0||X().dispatchEvent(new ue(r,s))}}class dK extends Cn{constructor(t,e){super(t,e),it().registerMessageEvent(new Py(this.onOpenPetPackageRequested.bind(this))),it().registerMessageEvent(new Ly(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new bo(bo.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,s,e.objectId,e.figureData,0,null))}onOpenPetPackageResult(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new bo(bo.RSOPPE_OPEN_PET_PACKAGE_RESULT,s,e.objectId,null,e.nameValidationStatus,e.nameValidationInfo))}}class _K extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new Fy(this.onPollContentsEvent.bind(this))),t.addMessageEvent(new ky(this.onPollOfferEvent.bind(this))),t.addMessageEvent(new Gy(this.onPollErrorEvent.bind(this))),t.addMessageEvent(new Yy(this.onStartRoomPollEvent.bind(this))),t.addMessageEvent(new Wy(this.onRoomPollResultEvent.bind(this)))}onPollContentsEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=new mn(mn.CONTENT,e,s.id);r.startMessage=s.startMessage,r.endMessage=s.endMessage,r.numQuestions=s.numQuestions,r.questionArray=s.questionArray,r.npsPoll=s.npsPoll,X().dispatchEvent(r)}onPollOfferEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=new mn(mn.OFFER,e,s.id);r.summary=s.headline,r.summary=s.summary,X().dispatchEvent(r)}onPollErrorEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e||!t.getParser())return;const r=new mn(mn.ERROR,e,-1);r.headline="???",r.summary="???",X().dispatchEvent(r)}onStartRoomPollEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=new _c(_c.VOTE_QUESTION,e,s.question,s.choices);X().dispatchEvent(r)}onRoomPollResultEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=new _c(_c.VOTE_RESULT,e,s.question,s.choices,s.SafeStr_7651,s.SafeStr_7654);X().dispatchEvent(r)}}class gK extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new XR(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new eg(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new sg(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new IM(this.onRoomUnitHandItemReceivedEvent.bind(this))),t.addMessageEvent(new tS(this.onRespectReceivedEvent.bind(this))),t.addMessageEvent(new JM(this.onPetRespectNoficationEvent.bind(this))),t.addMessageEvent(new ZM(this.onPetSupplementedNotificationEvent.bind(this))),t.addMessageEvent(new EM(this.onFloodControlEvent.bind(this))),t.addMessageEvent(new pM(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;let r=fe.CHAT_TYPE_SPEAK;t instanceof eg?r=fe.CHAT_TYPE_SHOUT:t instanceof sg&&(r=fe.CHAT_TYPE_WHISPER);const n=new fe(fe.CHAT_EVENT,e,s.roomIndex,s.message,r,s.bubble,s.chatColours);X().dispatchEvent(n)}onRoomUnitHandItemReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&X().dispatchEvent(new fe(fe.CHAT_EVENT,e,s.giverUserId,"",fe.CHAT_TYPE_HAND_ITEM_RECEIVED,yo.GENERIC,[],s.handItemType))}onRespectReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=e.userDataManager.getUserData(s.userId);r&&X().dispatchEvent(new fe(fe.CHAT_EVENT,e,r.roomIndex,"",fe.CHAT_TYPE_RESPECT,yo.GENERIC))}onPetRespectNoficationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=e.userDataManager.getPetData(s.petData.id);if(!r)return;let n=fe.CHAT_TYPE_PETRESPECT;s.isTreat&&(n=fe.CHAT_TYPE_PETTREAT),X().dispatchEvent(new fe(fe.CHAT_EVENT,e,r.roomIndex,"",n,yo.GENERIC))}onPetSupplementedNotificationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=e.userDataManager.getPetData(s.petId);if(!r)return;let n=-1;const o=e.userDataManager.getUserData(s.userId);o&&(n=o.roomIndex);let l=fe.CHAT_TYPE_PETREVIVE;switch(s.supplementType){case Wu.REVIVE:l=fe.CHAT_TYPE_PETREVIVE;break;case Wu.REBREED_FERTILIZER:l=fe.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case Wu.SPEED_FERTILIZER:l=fe.CHAT_TYPE_PET_SPEED_FERTILIZE;break}X().dispatchEvent(new fe(fe.CHAT_EVENT,e,r.roomIndex,"",l,yo.GENERIC,null,n))}onFloodControlEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=s.seconds;X().dispatchEvent(new fe(fe.FLOOD_EVENT,e,-1,r.toString(),0,0))}onRemainingMuteEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&X().dispatchEvent(new fe(fe.CHAT_EVENT,e,e.ownRoomIndex,"",fe.CHAT_TYPE_MUTE_REMAINING,yo.GENERIC,[],s.seconds))}}class fK extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new $a(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(t){if(!(t instanceof $a))return;const e=t.getParser();if(!e||e.roomForward)return;const s=this.listener.getSession(this.roomId);if(!s)return;const r=e.data;s.tradeMode=r.tradeMode,s.isGuildRoom=r.habboGroupId!==0,s.doorMode=r.doorMode,s.allowPets=r.allowPets,s.moderationSettings=e.moderation,X().dispatchEvent(new D_(D_.RSDUE_ALLOW_PETS,s)),X().dispatchEvent(new yt(yt.ROOM_DATA,s))}}class mK extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new aM(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const r=new Qh(Qh.ROOM_DIMMER_PRESETS,s);r.selectedPresetId=e.selectedPresetId;let n=0;for(;n<e.presetCount;){const o=e.getPreset(n);o&&r.storePreset(o.id,o.type,o.color,o.brightness),n++}X().dispatchEvent(r)}}class EK extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new eI(this.onRoomRightsEvent.bind(this))),t.addMessageEvent(new tI(this.onRoomRightsClearEvent.bind(this))),t.addMessageEvent(new sI(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(t){if(!(t instanceof eI))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(t.getParser().controllerLevel)}onRoomRightsClearEvent(t){if(!(t instanceof tI))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(Ce.NONE)}onRoomRightsOwnerEvent(t){if(!(t instanceof sI))return;const e=this.listener.getSession(this.roomId);e&&e.setRoomOwner()}}class pK extends Cn{constructor(t,e){super(t,e),t&&t.addMessageEvent(new Ox(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new Jh(Jh.RSPE_PRESENT_OPENED,s,e.classId,e.itemType,e.productCode,e.placedItemId,e.placedItemType,e.placedInRoom,e.petFigureString))}}const Ua=class Ua extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new Q_(this.onRoomEnterEvent.bind(this))),t.addMessageEvent(new Ru(this.onRoomReadyMessageEvent.bind(this))),t.addMessageEvent(new nd(this.onDesktopViewEvent.bind(this))),t.addMessageEvent(new q_(this.onRoomDoorbellAcceptedEvent.bind(this))),t.addMessageEvent(new X_(this.onRoomDoorbellRejectedEvent.bind(this))),t.addMessageEvent(new mM(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(t){t instanceof Q_&&this.listener&&this.listener.sessionUpdate(this.roomId,Ua.RS_CONNECTED)}onRoomReadyMessageEvent(t){if(!(t instanceof Ru))return;const e=this.roomId,s=t.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(e,s),this.listener.sessionUpdate(this.roomId,Ua.RS_READY))}onDesktopViewEvent(t){t instanceof nd&&this.listener&&this.listener.sessionUpdate(this.roomId,Ua.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(t){if(!(t instanceof q_)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.connection.send(new yP(this.roomId));else{const r=this.listener.getSession(this.roomId);if(!r)return;X().dispatchEvent(new In(In.RSDE_ACCEPTED,r,s))}}onRoomDoorbellRejectedEvent(t){if(!(t instanceof X_)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.listener.sessionUpdate(this.roomId,Ua.RS_DISCONNECTED);else{const r=this.listener.getSession(this.roomId);if(!r)return;X().dispatchEvent(new In(In.RSDE_REJECTED,r,s))}}onYouAreSpectatorMessageEvent(t){if(this.listener){const e=this.listener.getSession(this.roomId);if(!e)return;e.isSpectator=!0,X().dispatchEvent(new v_(v_.SPECTATOR_MODE,e))}}};Ua.RS_CONNECTED="RS_CONNECTED",Ua.RS_READY="RS_READY",Ua.RS_DISCONNECTED="RS_DISCONNECTED";let Ec=Ua;class IK{constructor(){this._adultLevel=7}get id(){return this._id}set id(t){this._id=t}get level(){return this._level}set level(t){this._level=t}get maximumLevel(){return this._maximumLevel}set maximumLevel(t){this._maximumLevel=t}get experience(){return this._experience}set experience(t){this._experience=t}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(t){this._levelExperienceGoal=t}get energy(){return this._energy}set energy(t){this._energy=t}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(t){this._maximumEnergy=t}get happyness(){return this._happyness}set happyness(t){this._happyness=t}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(t){this._maximumHappyness=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get respect(){return this._respect}set respect(t){this._respect=t}get age(){return this._age}set age(t){this._age=t}get unknownRarity(){return this._unknownRarity}set unknownRarity(t){this._unknownRarity=t}get saddle(){return this._saddle}set saddle(t){this._saddle=t}get rider(){return this._rider}set rider(t){this._rider=t}get skillTresholds(){return this._skillThresholds}set skillTresholds(t){this._skillThresholds=t}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(t){this._publiclyRideable=t}get breedable(){return this._breedable}set breedable(t){this._breedable=t}get fullyGrown(){return this._fullyGrown}set fullyGrown(t){this._fullyGrown=t}get dead(){return this._dead}set dead(t){this._dead=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(t){this._maximumTimeToLive=t}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(t){this._remainingTimeToLive=t}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(t){this._remainingGrowTime=t}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(t){this._publiclyBreedable=t}get adultLevel(){return this._adultLevel}}class IL{constructor(t){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=t}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get sex(){return this._sex}set sex(t){this._sex=t}get figure(){return this._figure}set figure(t){this._figure=t}get custom(){return this._custom}set custom(t){this._custom=t}get webID(){return this._webID}set webID(t){this._webID=t}get groupId(){return this._groupID}set groupId(t){this._groupID=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupStatus(){return this._groupStatus}set groupStatus(t){this._groupStatus=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._hasSaddle=t}get isRiding(){return this._isRiding}set isRiding(t){this._isRiding=t}get canBreed(){return this._canBreed}set canBreed(t){this._canBreed=t}get canHarvest(){return this._canHarvest}set canHarvest(t){this._canHarvest=t}get canRevive(){return this._canRevive}set canRevive(t){this._canRevive=t}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._hasBreedingPermission=t}get petLevel(){return this._petLevel}set petLevel(t){this._petLevel=t}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isModerator=t}}class TK extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new rg(this.onRoomUnitEvent.bind(this))),t.addMessageEvent(new ng(this.onRoomUnitInfoEvent.bind(this))),t.addMessageEvent(new ag(this.onRoomUnitRemoveEvent.bind(this))),t.addMessageEvent(new ig(this.onRoomUnitDanceEvent.bind(this))),t.addMessageEvent(new JR(this.onUserCurrentBadgesEvent.bind(this))),t.addMessageEvent(new WR(this.onRoomDoorbellEvent.bind(this))),t.addMessageEvent(new Wm(this.onUserNameChangeMessageEvent.bind(this))),t.addMessageEvent(new LR(this.onNewFriendRequestEvent.bind(this))),t.addMessageEvent(new _M(this.onPetInfoEvent.bind(this))),t.addMessageEvent(new gM(this.onPetStatusUpdateEvent.bind(this))),t.addMessageEvent(new l3(this.onPetBreedingMessageEvent.bind(this))),t.addMessageEvent(new Uy(this.onPetLevelUpdateMessageEvent.bind(this))),t.addMessageEvent(new kY(this.onConfirmBreedingResultEvent.bind(this))),t.addMessageEvent(new BY(this.onNestBreedingSuccessEvent.bind(this))),t.addMessageEvent(new GY(this.onConfirmBreedingRequestEvent.bind(this))),t.addMessageEvent(new tg(this.onPetFigureUpdateEvent.bind(this))),t.addMessageEvent(new hM(this.onPetBreedingResultEvent.bind(this))),t.addMessageEvent(new by(this.onPetPlacingError.bind(this))),t.addMessageEvent(new Sy(this.onBotError.bind(this))),t.addMessageEvent(new Zy(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser().users,r=[];if(s&&s.length)for(const n of s){if(!n)continue;const o=new IL(n.roomIndex);o.name=n.name,o.custom=n.custom,o.activityPoints=n.activityPoints,o.figure=n.figure,o.type=n.userType,o.webID=n.webID,o.groupId=n.groupID,o.groupName=n.groupName,o.groupStatus=n.groupStatus,o.sex=n.sex,o.ownerId=n.ownerId,o.ownerName=n.ownerName,o.rarityLevel=n.rarityLevel,o.hasSaddle=n.hasSaddle,o.isRiding=n.isRiding,o.canBreed=n.canBreed,o.canHarvest=n.canHarvest,o.canRevive=n.canRevive,o.hasBreedingPermission=n.hasBreedingPermission,o.petLevel=n.petLevel,o.botSkills=n.botSkills,o.isModerator=n.isModerator,e.userDataManager.getUserData(n.roomIndex)||r.push(o),e.userDataManager.updateUserData(o)}X().dispatchEvent(new L_(e,r))}onRoomUnitInfoEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&(e.userDataManager.updateFigure(s.unitId,s.figure,s.gender,!1,!1),e.userDataManager.updateMotto(s.unitId,s.motto),e.userDataManager.updateAchievementScore(s.unitId,s.achievementScore),X().dispatchEvent(new U_(e,s.unitId,s.figure,s.gender,s.motto,s.achievementScore)))}onRoomUnitRemoveEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);e&&e.userDataManager.removeUserData(t.getParser().unitId)}onRoomUnitDanceEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new x_(s,e.unitId,e.danceId))}onUserCurrentBadgesEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.setUserBadges(e.userId,e.badges),X().dispatchEvent(new P_(s,e.userId,e.badges)))}onRoomDoorbellEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)return;const r=this.listener.getSession(this.roomId);r&&X().dispatchEvent(new In(In.DOORBELL,r,s))}onUserNameChangeMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.updateName(e.id,e.newName)}onNewFriendRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const r=e.request;X().dispatchEvent(new _p(s,r.requestId,r.requesterUserId,r.requesterName))}onPetInfoEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const r=new IK;r.id=e.id,r.level=e.level,r.maximumLevel=e.maximumLevel,r.experience=e.experience,r.levelExperienceGoal=e.levelExperienceGoal,r.energy=e.energy,r.maximumEnergy=e.maximumEnergy,r.happyness=e.happyness,r.maximumHappyness=e.maximumHappyness,r.ownerId=e.ownerId,r.ownerName=e.ownerName,r.respect=e.respect,r.age=e.age,r.unknownRarity=e.unknownRarity,r.saddle=e.saddle,r.rider=e.rider,r.breedable=e.breedable,r.fullyGrown=e.fullyGrown,r.rarityLevel=e.rarityLevel,r.dead=e.dead,r.skillTresholds=e.skillTresholds,r.publiclyRideable=e.publiclyRideable,r.maximumTimeToLive=e.maximumTimeToLive,r.remainingTimeToLive=e.remainingTimeToLive,r.remainingGrowTime=e.remainingGrowTime,r.publiclyBreedable=e.publiclyBreedable,X().dispatchEvent(new M_(s,r))}onPetStatusUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetBreedingStatus(e.roomIndex,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission),X().dispatchEvent(new b_(s,e.petId,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission)))}onPetBreedingMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new fp(s,e.state,e.ownPetId,e.otherPetId))}onPetLevelUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetLevel(e.roomIndex,e.level),X().dispatchEvent(new pp(s,e.petId,e.level)))}onConfirmBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new dp(s,e.breedingNestStuffId,e.result))}onNestBreedingSuccessEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new gp(s,e.petId,e.rarityCategory))}onConfirmBreedingRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new hp(s,e.nestId,e.pet1,e.pet2,e.rarityCategories,e.resultPetType))}onPetFigureUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const r=e.figureData.figuredata;s.userDataManager.updateFigure(e.roomIndex,r,"",e.hasSaddle,e.isRiding),X().dispatchEvent(new Ep(s,e.petId,r))}onPetBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&X().dispatchEvent(new mp(s,e.resultData,e.otherResultData))}onPetPlacingError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let r="";switch(e.errorCode){case 0:r=ue.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:r=ue.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:r=ue.RSEME_MAX_PETS;break;case 3:r=ue.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:r=ue.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:r=ue.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!r||r.length==0||X().dispatchEvent(new ue(r,s))}onBotError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let r="";switch(e.errorCode){case 0:r=ue.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:r=ue.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:r=ue.RSEME_BOT_LIMIT_REACHED;break;case 3:r=ue.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:r=ue.RSEME_BOT_NAME_NOT_ACCEPTED;break}!r||r.length==0||X().dispatchEvent(new ue(r,s))}onFavoriteMembershipUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser(),s=this.listener.getSession(this.roomId);if(!s)return;const r=s.userDataManager.getUserDataByIndex(e.roomIndex);r&&(r.groupId=e.groupId,r.groupName=e.groupName,X().dispatchEvent(new y_(s,e.roomIndex,e.groupId,e.status,e.groupName)))}}class RK extends Cn{constructor(t,e){super(t,e),t.addMessageEvent(new Vy(this.onQuestionEvent.bind(this))),t.addMessageEvent(new By(this.onQuestionAnsweredEvent.bind(this))),t.addMessageEvent(new Hy(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=new En(En.QUESTION,e,s.pollId);r.question=s.question,r.duration=s.duration,r.pollType=s.pollType,r.questionId=s.questionId,r.pollId=s.pollId,X().dispatchEvent(r)}onQuestionAnsweredEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=new En(En.ANSWERED,e,s.userId);r.value=s.value,r.userId=s.userId,r.answerCounts=s.answerCounts,X().dispatchEvent(r)}onQuestionFinishedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const r=new En(En.FINISHED,e);r.questionId=s.questionId,r.answerCounts=s.answerCounts,X().dispatchEvent(r)}}class SK{constructor(){this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null}async init(){this.createHandlers(),this.processPendingSession()}createHandlers(){const t=it().connection;t&&this._handlers.push(new gK(t,this),new fK(t,this),new mK(t,this),new EK(t,this),new Ec(t,this),new TK(t,this),new pK(t,this),new hK(t,this),new RK(t,this),new _K(t,this),new dK(t,this))}setHandlers(t){if(!(!this._handlers||!this._handlers.length))for(const e of this._handlers)e&&e.setRoomId(t.roomId)}processPendingSession(){this._pendingSession&&(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(t){const e=this._sessions.get(this.getRoomId(t));return e||null}createSession(t,e=null){const s=new pL;return s.roomId=t,s.password=e,this.addSession(s)}addSession(t){return this._sessionStarting=!0,this._sessions.get(this.getRoomId(t.roomId))&&this.removeSession(t.roomId,!1),this._sessions.set(this.getRoomId(t.roomId),t),X().dispatchEvent(new yt(yt.CREATED,t)),this._viewerSession=t,this.startSession(this._viewerSession),!0}startSession(t){return t.state===yt.STARTED?!1:(this._sessionStarting=!1,t.start()?(X().dispatchEvent(new yt(yt.STARTED,t)),this.setHandlers(t),!0):(this.removeSession(t.roomId),!1))}removeSession(t,e=!0){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),X().dispatchEvent(new yt(yt.ENDED,s,e)))}sessionUpdate(t,e){if(this.getSession(t))switch(e){case Ec.RS_CONNECTED:return;case Ec.RS_READY:return;case Ec.RS_DISCONNECTED:this.removeSession(t);return}}sessionReinitialize(t,e){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),s.reset(e),this._sessions.set(this.getRoomId(e),s),this.setHandlers(s))}getRoomId(t){return"hard_coded_room_id"}get viewerSession(){return this._viewerSession}}const OK=new SK,Yi=()=>OK;class AK{constructor(){this._groupBadges=new Map}init(){it().registerMessageEvent(new Ru(this.onRoomReadyMessageEvent.bind(this))),it().registerMessageEvent(new YM(this.onGroupBadgesEvent.bind(this)))}onRoomReadyMessageEvent(t){it().connection.send(new lL)}onGroupBadgesEvent(t){const e=t.getParser();for(const[s,r]of e.badges.entries())this._groupBadges.set(s,r)}getGroupBadge(t){return this._groupBadges.get(t)??""}}class NK{constructor(){this._ignoredUsers=[]}init(){it().registerMessageEvent(new zM(this.onIgnoredUsersEvent.bind(this))),it().registerMessageEvent(new $R(this.onIgnoreResultEvent.bind(this)))}requestIgnoredUsers(t){it().connection.send(new eL(t))}onIgnoredUsersEvent(t){if(!t)return;const e=t.getParser();e&&(this._ignoredUsers=e.ignoredUsers)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.name;switch(e.result){case 0:return;case 1:this.addUserToIgnoreList(s);return;case 2:this.addUserToIgnoreList(s),this._ignoredUsers.shift();return;case 3:this.removeUserFromIgnoreList(s);return}}addUserToIgnoreList(t){this._ignoredUsers.indexOf(t)<0&&this._ignoredUsers.push(t)}removeUserFromIgnoreList(t){const e=this._ignoredUsers.indexOf(t);e>=0&&this._ignoredUsers.splice(e,1)}ignoreUserId(t){it().connection.send(new rL(t))}ignoreUser(t){it().connection.send(new iL(t))}unignoreUser(t){it().connection.send(new nL(t))}isIgnored(t){return this._ignoredUsers.indexOf(t)>=0}}class ZO{constructor(t,e){this._image=t,this._placeHolder=e}get image(){return this._image}get placeHolder(){return this._placeHolder}}class CK{constructor(t){this._code=t,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}var hs;let lu=(hs=class{constructor(t,e=0,s=0,r=0){this.type=t,this.key=e,this.color=s,this.position=r}get code(){return this.key===0?null:hs.getCode(this.type,this.key,this.color,this.position)}static getCode(t,e,s,r){return(t===hs.BASE?t:e>=100?hs.SYMBOL_ALT:hs.SYMBOL)+(e<10?"0":"")+(t===hs.BASE?e:e>=100?e-100:e)+(s<10?"0":"")+s+r}calculatePosition(t){const e=this.calculateGridPos(this.position);let s=hs.CELL_WIDTH*e.x+hs.CELL_WIDTH/2-t.width/2,r=hs.CELL_HEIGHT*e.y+hs.CELL_HEIGHT/2-t.height/2;return s<0&&(s=0),s+t.width>hs.IMAGE_WIDTH&&(s=hs.IMAGE_WIDTH-t.width),r<0&&(r=0),r+t.height>hs.IMAGE_HEIGHT&&(r=hs.IMAGE_HEIGHT-t.height),new Qt(Math.floor(s),Math.floor(r))}calculateGridPos(t){const e=new Qt;return e.x=Math.floor(t%3),e.y=Math.floor(t/3),e}},hs.BASE="b",hs.SYMBOL="s",hs.SYMBOL_ALT="t",hs.BASE_PART=0,hs.LAYER_PART=1,hs.IMAGE_WIDTH=39,hs.IMAGE_HEIGHT=39,hs.CELL_WIDTH=13,hs.CELL_HEIGHT=13,hs);const kr=class kr{constructor(){this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){it().registerMessageEvent(new wR(this.onGroupBadgePartsEvent.bind(this)))}getBadgeImage(t,e=kr.NORMAL_BADGE,s=!0){return this.getBadgeTexture(t,e)}getBadgeInfo(t){const e=this.getBadgeTexture(t);return e?new ZO(e,!1):new ZO(this.getBadgePlaceholder(),!0)}loadBadgeImage(t,e=kr.NORMAL_BADGE){return ae().getTexture(this.getBadgeUrl(t,e))?t:(this.getBadgeTexture(t,e),null)}getBadgeTexture(t,e=kr.NORMAL_BADGE){const s=this.getBadgeUrl(t,e);if(!s||!s.length)return null;const r=ae().getTexture(s);if(r)return r;if(e===kr.NORMAL_BADGE)(async()=>{await ae().downloadAsset(s);const o=ae().getTexture(s);o&&X().dispatchEvent(new Za(t,o))})();else if(e===kr.GROUP_BADGE){if(this._groupBadgesQueue.get(t))return;this._groupBadgesQueue.set(t,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(t)}return this.getBadgePlaceholder()}getBadgePlaceholder(){return ae().getTexture(jt().getValue("images.url")+"/loading_icon.png")}getBadgeUrl(t,e=kr.NORMAL_BADGE){let s=null;switch(e){case kr.NORMAL_BADGE:s=jt().getValue("badge.asset.url").replace("%badgename%",t);break;case kr.GROUP_BADGE:s=t;break}return s}loadGroupBadge(t){const e=new CK(t),s=[...t.matchAll(/[b|s][0-9]{4,6}/g)];for(const r of s){const n=r[0],o=n.length===6,l=n[0],c=parseInt(n.slice(1,o?3:4)),u=parseInt(n.slice(o?3:4,o?5:6)),h=n.length<6?0:parseInt(n.slice(o?5:6,o?6:7)),d=new lu(l,c,u,h);e.parts.push(d)}this.renderGroupBadge(e)}renderGroupBadge(t){const e=new $r,s=new Ve(Es.EMPTY);s.width=lu.IMAGE_WIDTH,s.height=lu.IMAGE_HEIGHT,e.addChild(s);for(const n of t.parts){let o=!0;const l=n.type==="b"?this._groupBases.get(n.key):this._groupSymbols.get(n.key);if(l)for(const c of l){if(!c||!c.length)continue;const u=ae().getTexture(`badgepart_${c}`);if(!u)continue;const{x:h,y:d}=n.calculatePosition(u),f=new Ve(u);f.position.set(h,d),o&&(f.tint=parseInt(this._groupPartColors.get(n.color),16)),o=!1,e.addChild(f)}}this._requestedBadges.delete(t.code),this._groupBadgesQueue.delete(t.code);const r=me.generateTexture(e);ae().setTexture(t.code,r),X().dispatchEvent(new Za(t.code,r))}onGroupBadgePartsEvent(t){if(!t)return;const e=t.getParser();if(e){e.bases.forEach((s,r)=>this._groupBases.set(r,s.map(n=>n.replace(".png","").replace(".gif","")))),e.symbols.forEach((s,r)=>this._groupSymbols.set(r,s.map(n=>n.replace(".png","").replace(".gif","")))),this._groupPartColors=e.partColors,this._readyToGenerateGroupBadges=!0;for(const s of this._groupBadgesQueue.keys())this.loadGroupBadge(s)}}};kr.GROUP_BADGE="group_badge",kr.NORMAL_BADGE="normal_badge";let pc=kr;class $O{constructor(t,e,s,r,n,o,l,c,u,h,d,f,E,m,I,p,T,R,S,L,M,P,k,G,j,F,U,K,B){this._type=t,this._id=e,this._fullName=s,this._className=r,this._category=n,this._revision=c,this._tileSizeX=u,this._tileSizeY=h,this._tileSizeZ=d,this._colors=f,this._hasIndexedColor=E,this._colourIndex=m,this._localizedName=o,this._description=l,this._adUrl=I,this._purchaseOfferId=p,this._purchaseCouldBeUsedForBuyout=T,this._rentOfferId=R,this._rentCouldBeUsedForBuyout=S,this._customParams=M,this._specialType=P,this._availableForBuildersClub=L,this._canStandOn=k,this._canSitOn=G,this._canLayOn=j,this._excludedFromDynamic=F,this._furniLine=U,this._environment=K,this._rare=B}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(t){this._className=t}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}class xK{constructor(t,e){this._floorItems=t,this._wallItems=e}async init(){const t=jt().getValue("furnidata.url");if(!t||!t.length)throw new Error("invalid furni data url");const e=await fetch(t);if(e.status!==200)throw new Error("Invalid furni data file");const s=await e.json();s.roomitemtypes&&this.parseFloorItems(s.roomitemtypes),s.wallitemtypes&&this.parseWallItems(s.wallitemtypes)}parseFloorItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=[];if(e.partcolors)for(const u of e.partcolors.color){let h=u;h.charAt(0)==="#"&&(h=h.replace("#","")),s.push(parseInt(h,16))}const r=e.classname.split("*"),n=r[0],o=r.length>1?parseInt(r[1]):0,l=r.length>1,c=new $O(Mo.FLOOR,e.id,e.classname,n,e.category,e.name,e.description,e.revision,e.xdim,e.ydim,0,s,l,o,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,e.customparams,e.specialtype,e.canstandon,e.cansiton,e.canlayon,e.excludeddynamic,e.furniline,e.environment,e.rare);this._floorItems.set(c.id,c),this.updateLocalizations(c)}}parseWallItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=new $O(Mo.WALL,e.id,e.classname,e.classname,e.category,e.name,e.description,e.revision,0,0,0,null,!1,0,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,null,e.specialtype,!1,!1,!1,e.excludeddynamic,e.furniline,e.environment,e.rare);this._wallItems.set(s.id,s),this.updateLocalizations(s)}}updateLocalizations(t){switch(t.type){case Mo.FLOOR:Tn().setValue("roomItem.name."+t.id,t.name),Tn().setValue("roomItem.desc."+t.id,t.description);return;case Mo.WALL:Tn().setValue("wallItem.name."+t.id,t.name),Tn().setValue("wallItem.desc."+t.id,t.description);return}}}class yK{constructor(t,e,s){this._type=t,this._name=e,this._description=s}get type(){return this._type}get name(){return this._name}get description(){return this._description}}class MK{constructor(t){this._products=t}async init(){const t=jt().getValue("productdata.url");if(!t||!t.length)throw new Error("invalid product data url");const e=await fetch(t);if(e.status!==200)throw new Error("Invalid product data file");const s=await e.json();this.parseProducts(s.productdata)}parseProducts(t){if(t)for(const e of t.product)e&&this._products.set(e.code,new yK(e.code,e.name,e.description))}}class bK{constructor(){this._ignoredUsersManager=new NK,this._groupInformationManager=new AK,this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=new xK(this._floorItems,this._wallItems),this._productData=new MK(this._products),this._tags=[],this._badgeImageManager=new pc,this.resetUserInfo()}async init(){await Promise.all([this._furnitureData.init(),this._productData.init(),this._badgeImageManager.init(),this._ignoredUsersManager.init(),this._groupInformationManager.init()]),it().registerMessageEvent(new DR(t=>{this._figure=t.getParser().figure,this._gender=t.getParser().gender,Nn.updateFigure(this._figure)})),it().registerMessageEvent(new Su(this.onUserInfoEvent.bind(this))),it().registerMessageEvent(new qR(this.onUserPermissionsEvent.bind(this))),it().registerMessageEvent(new QN(this.onAvailabilityStatusMessageEvent.bind(this))),it().registerMessageEvent(new jy(this.onPetRespectFailed.bind(this))),it().registerMessageEvent(new rd(this.onChangeNameUpdateEvent.bind(this))),it().registerMessageEvent(new Wm(this.onUserNameChangeMessageEvent.bind(this))),it().registerMessageEvent(new BM(this.onUserTags.bind(this))),it().registerMessageEvent(new Ru(this.onRoomModelNameEvent.bind(this))),it().registerMessageEvent(new KM(this.onInClientLinkEvent.bind(this))),it().registerMessageEvent(new ly(this.onMysteryBoxKeysEvent.bind(this))),it().registerMessageEvent(new ex(this.onNoobnessLevelMessageEvent.bind(this))),it().registerMessageEvent(new FM(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),it().registerMessageEvent(new VM(this.onEmailStatus.bind(this))),X().addEventListener(mu.SETTINGS_UPDATED,t=>{this._isRoomCameraFollowDisabled=t.cameraFollow,this._uiFlags=t.flags,X().dispatchEvent(new Ip(this._uiFlags))})}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}getAllFurnitureData(){return[...Array.from(this._floorItems.values()),...Array.from(this._wallItems.values())]}onUserInfoEvent(t){if(!t||!t.connection)return;this.resetUserInfo();const e=t.getParser().userInfo;e&&(this._userId=e.userId,this._name=e.username,this._figure=e.figure,this._gender=e.gender,this._realName=e.realName,this._respectsReceived=e.respectsReceived,this._respectsLeft=e.respectsRemaining,this._respectsPetLeft=e.respectsPetRemaining,this._canChangeName=e.canChangeName,this._safetyLocked=e.safetyLocked,this._ignoredUsersManager.requestIgnoredUsers(e.username))}onUserPermissionsEvent(t){!t||!t.connection||(this._clubLevel=t.getParser().clubLevel,this._securityLevel=t.getParser().securityLevel,this._isAmbassador=t.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._systemOpen=e.isOpen,this._systemShutdown=e.onShutdown,this._isAuthenticHabbo=e.isAuthenticUser)}onPetRespectFailed(t){!t||!t.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.resultCode===rd.NAME_OK&&(this._canChangeName=!1,X().dispatchEvent(new j_(e.name)))}onUserNameChangeMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.webId===this.userId&&(this._name=e.newName,this._canChangeName=!1,X().dispatchEvent(new j_(this._name)))}onUserTags(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._tags=e.tags)}onRoomModelNameEvent(t){if(!t)return;const e=t.getParser();e&&Nn.roomVisited(e.roomId)}onInClientLinkEvent(t){if(!t)return;const e=t.getParser();e&&ht(e.link)}onMysteryBoxKeysEvent(t){if(!t)return;const e=t.getParser();e&&X().dispatchEvent(new C_(e.boxColor,e.keyColor))}onNoobnessLevelMessageEvent(t){this._noobnessLevel=t.getParser().noobnessLevel,this._noobnessLevel!==ku.OLD_IDENTITY&&jt().setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(t){if(!t)return;const e=t.getParser();e&&(this._safetyLocked=e.status===G_.SAFETY_LOCK_STATUS_LOCKED)}onEmailStatus(t){var e;this._isEmailVerified=((e=t==null?void 0:t.getParser())==null?void 0:e.isVerified)??!1}getFloorItemData(t){const e=this._floorItems.get(t);return e||null}getFloorItemDataByName(t){if(!t||!this._floorItems||!this._floorItems.size)return null;for(const e of this._floorItems.values())if(!(!e||e.className!==t))return e;return null}getWallItemData(t){const e=this._wallItems.get(t);return e||null}getWallItemDataByName(t){if(!t||!this._wallItems||!this._wallItems.size)return null;for(const e of this._wallItems.values())if(!(!e||e.className!==t))return e;return null}getProductData(t){return this._products.get(t)}getBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t)}getGroupBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t,pc.GROUP_BADGE)}getBadgeImage(t){return this._badgeImageManager.getBadgeImage(t)}getGroupBadgeImage(t){return this._badgeImageManager.getBadgeImage(t,pc.GROUP_BADGE)}getUserTags(t){t<0||this.send(new sL(t))}loadBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t)}loadGroupBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t,pc.GROUP_BADGE)}hasSecurity(t){return this._securityLevel>=t}giveRespect(t){t<0||this._respectsLeft<=0||(this.send(new fL(t)),this._respectsLeft--)}givePetRespect(t){t<0||this._respectsPetLeft<=0||(this.send(new bd(t)),this._respectsPetLeft--)}sendSpecialCommandMessage(t,e=0){this.send(new gS(t))}ignoreUser(t){this._ignoredUsersManager.ignoreUser(t)}unignoreUser(t){this._ignoredUsersManager.unignoreUser(t)}isUserIgnored(t){return this._ignoredUsersManager.isIgnored(t)}getGroupBadge(t){return this._groupInformationManager.getGroupBadge(t)}send(t){it().connection.send(t)}get communication(){return it()}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isEmailVerified(){return this._isEmailVerified}get isNoob(){return this._noobnessLevel!==ku.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===ku.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=kl.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}get tags(){return this._tags}}const DK=new bK,tt=()=>DK,Rh=class Rh{};Rh.NO_CLUB=0,Rh.CLUB=1,Rh.VIP=2;let Pi=Rh;const Sh=class Sh{constructor(t,e,s,r,n,o,l){this._layerTags=[],this._primaryColor=t&16777215,this._secondaryColor=e&16777215,this._breed=s,this._tag=r>-1&&r<Sh.COLOR_TAGS.length?Sh.COLOR_TAGS[r]:"",this._id=n,this._isMaster=o,this._layerTags=l}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}};Sh.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];let ZI=Sh;const ye=class ye{constructor(){this._images=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[]}async init(){this.processFurnitureData(tt().getAllFurnitureData());for(const[t,e]of jt().getValue("pet.types").entries())this._pets[e]=t;await Promise.all(ye.MANDATORY_LIBRARIES.map(t=>this.downloadAsset(t)))}processFurnitureData(t){if(t)for(const e of t){if(!e)continue;const s=e.id;let r=e.className;e.hasIndexedColor&&(r=r+"*"+e.colorIndex);const n=e.revision,o=e.adUrl;o&&o.length>0&&this._objectTypeAdUrls.set(r,o);let l=e.className;e.type===Mo.FLOOR?(this._activeObjectTypes.set(s,r),this._activeObjectTypeIds.set(r,s),this._activeObjects[l]||(this._activeObjects[l]=1)):e.type===Mo.WALL&&(l==="post.it"&&(r="post_it",l="post_it"),l==="post.it.vd"&&(r="post_it_vd",l="post_id_vd"),this._wallItemTypes.set(s,r),this._wallItemTypeIds.set(r,s),this._wallItems[l]||(this._wallItems[l]=1));const c=this._furniRevisions.get(l);n>c&&(this._furniRevisions.delete(l),this._furniRevisions.set(l,n))}}getFurnitureFloorNameForTypeId(t){const e=this._activeObjectTypes.get(t);return this.removeColorIndex(e)}getFurnitureWallNameForTypeId(t,e=null){let s=this._wallItemTypes.get(t);return s==="poster"&&e!==null&&(s=s+e),this.removeColorIndex(s)}getFurnitureFloorColorIndex(t){const e=this._activeObjectTypes.get(t);return e?this.getColorIndexFromName(e):-1}getFurnitureWallColorIndex(t){const e=this._wallItemTypes.get(t);return e?this.getColorIndexFromName(e):-1}getColorIndexFromName(t){if(!t)return-1;const e=t.indexOf("*");return e===-1?0:parseInt(t.substr(e+1))}removeColorIndex(t){if(!t)return null;const e=t.indexOf("*");return e===-1?t:t.substr(0,e)}getRoomObjectAdUrl(t){const e=this._objectTypeAdUrls.get(t);return e||""}getPetColorResult(t,e){const s=this._petColors.get(t);return s?s.get(e):null}getPetColorResultsForTag(t,e){const s=this._petColors.get(t),r=[];if(s)for(const n of s.values())n.tag===e&&r.push(n);return r}getCollection(t){return ae().getCollection(t)}getImage(t){if(!t)return null;const e=this._images.get(t);if(!e)return null;const s=new Image;return s.src=e.src,s}addAssetToCollection(t,e,s,r=!0){return ae().addAssetToCollection(t,e,s,r)}getPlaceholderName(t){switch(this.getCategoryForType(t)){case Y.FLOOR:return ye.PLACE_HOLDER;case Y.WALL:return ye.PLACE_HOLDER_WALL;default:return this._pets[t]!==void 0?ye.PLACE_HOLDER_PET:ye.PLACE_HOLDER_DEFAULT}}getCategoryForType(t){return t?this._activeObjects[t]!==void 0?Y.FLOOR:this._wallItems[t]!==void 0?Y.WALL:this._pets[t]!==void 0?Y.UNIT:t.indexOf("poster")===0?Y.WALL:t==="room"?Y.ROOM:t===Ue.USER||t===Ue.PET||t===Ue.BOT||t===Ue.RENTABLE_BOT?Y.UNIT:t===ye.TILE_CURSOR||t===ye.SELECTION_ARROW?Y.CURSOR:Y.MINIMUM:Y.MINIMUM}getPetNameForType(t){return jt().getValue("pet.types")[t]||null}isLoaderType(t){return t=Ue.getRealType(t),t!==mt.USER}downloadImage(t,e,s,r=null){let n=null,o=[];if(e&&e.indexOf(",")>=0&&(n=e,e=n.split(",")[0]),n?o=this.getAssetUrls(n,s,!0):o=this.getAssetUrls(e,s,!0),o&&o.length){const l=o[0],c=new Image;return c.src=l,c.onload=()=>{c.onerror=null,this._images.set([e,s].join("_"),c),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!0)},c.onerror=()=>{c.onload=null,Lt.error("Failed to download asset",l),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!1)},!0}return!1}async downloadAsset(t){var r;const e=(r=this.getAssetUrls(t))==null?void 0:r[0];if(!e||!e.length||this._pendingContentTypes.indexOf(t)>=0)return;if(this._pendingContentTypes.push(t),!await ae().downloadAsset(e)){X().dispatchEvent(new Ya(Ya.RCLE_FAILURE,t));return}const s=this._pets[t];if(s!==void 0){const n=this.getCollection(t),o=n.getPaletteNames(),l=new Map;for(const c of o){const u=n.getPalette(c),h=n.data.palettes[c],d=u.primaryColor,f=u.secondaryColor,E=h.breed!==void 0?h.breed:0,m=h.colorTag!==void 0?h.colorTag:-1,I=h.master!==void 0?h.master:!1,p=h.tags!==void 0?h.tags:[];l.set(parseInt(c),new ZI(d,f,E,m,c,I,p))}this._petColors.set(s,l)}X().dispatchEvent(new Ya(Ya.RCLE_SUCCESS,t))}getAssetAliasName(t){const e=this._objectAliases.get(t);return e||t}setAssetAliasName(t,e){this._objectAliases.set(t,e),this._objectOriginalNames.set(e,t)}getAssetOriginalName(t){const e=this._objectOriginalNames.get(t);return e||t}getAssetUrls(t,e=null,s=!1){switch(t){case ye.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(ye.PLACE_HOLDER)];case ye.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(ye.PLACE_HOLDER_WALL)];case ye.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(ye.PLACE_HOLDER_PET)];case ye.ROOM:return[this.getAssetUrlWithGenericBase("room")];case ye.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(ye.TILE_CURSOR)];case ye.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(ye.SELECTION_ARROW)];default:{const r=this.getCategoryForType(t);if(r===Y.FLOOR||r===Y.WALL){const n=this.getAssetAliasName(t);let o=s?this.getAssetUrlWithFurniIconBase(n):this.getAssetUrlWithFurniBase(t);if(s){const l=e&&e!==""&&this._activeObjectTypeIds.has(n+"*"+e);o=o.replace(/%param%/gi,l?"_"+e:"")}return[o]}return r===Y.UNIT?[this.getAssetUrlWithPetBase(t)]:null}}}getAssetIconUrl(t,e){let s=null,r=[];return t&&t.indexOf(",")>=0&&(s=t,t=s.split(",")[0]),s?r=this.getAssetUrls(s,e,!0):r=this.getAssetUrls(t,e,!0),r&&r.length?r[0]:null}getAssetUrlWithGenericBase(t){return jt().getValue("generic.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniBase(t){return jt().getValue("furni.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniIconBase(t){return jt().getValue("furni.asset.icon.url").replace(/%libname%/gi,t)}getAssetUrlWithPetBase(t){return jt().getValue("pet.asset.url").replace(/%libname%/gi,t)}setRoomObjectRoomId(t,e){const s=t&&t.model;s&&s.setValue(A.OBJECT_ROOM_ID,e)}setIconListener(t){this._iconListener=t}get pets(){return this._pets}};ye.PLACE_HOLDER="place_holder",ye.PLACE_HOLDER_WALL="place_holder_wall",ye.PLACE_HOLDER_PET="place_holder_pet",ye.PLACE_HOLDER_DEFAULT=ye.PLACE_HOLDER,ye.ROOM="room",ye.TILE_CURSOR="tile_cursor",ye.SELECTION_ARROW="selection_arrow",ye.MANDATORY_LIBRARIES=[ye.PLACE_HOLDER,ye.PLACE_HOLDER_WALL,ye.PLACE_HOLDER_PET,ye.ROOM,ye.TILE_CURSOR,ye.SELECTION_ARROW];let $I=ye;const vK=new $I,Sr=()=>vK;class tA{constructor(t,e,s,r){this._x=t,this._y=e,this._width=s,this._height=r}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}class TL{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0}}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get wallHeight(){return this._wallHeight}set wallHeight(t){this._wallHeight=t}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(t){this._fixedWallsHeight=t}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}}class PK{constructor(){this._masks=[]}get masks(){return this._masks}}class RL{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(t){return this._map.get(t)}setValue(t,e){this._map.has(t)&&this._map.get(t)===e||(this._map.set(t,e),this._updateCounter++)}removeKey(t){t&&(this._map.delete(t),this._updateCounter++)}get updateCounter(){return this._updateCounter}}const Qf=class Qf{constructor(t,e,s){this._model=new RL,this._location=new w,this._direction=new w,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1,this._id=t,this._instanceId=Qf.OBJECT_COUNTER++,this._type=s;let r=e-1;for(;r>=0;)this._states[r]=0,r--}dispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose()}getLocation(){return this._location}setLocation(t){t&&(t.x===this._location.x&&t.y===this._location.y&&t.z===this._location.z||(this._location.x=t.x,this._location.y=t.y,this._location.z=t.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(t){t&&(t.x===this._direction.x&&t.y===this._direction.y&&t.z===this._direction.z||(this._direction.x=(t.x%360+360)%360,this._direction.y=(t.y%360+360)%360,this._direction.z=(t.z%360+360)%360,this._updateCounter++))}getState(t=0){return t>=0&&t<this._states.length?this._states[t]:-1}setState(t,e=0){return e>=0&&e<this._states.length?(this._states[e]!==t&&(this._states[e]=t,this._updateCounter++),!0):!1}setVisualization(t){this._visualization!==t&&(this._visualization&&this._visualization.dispose(),this._visualization=t,this._visualization&&(this._visualization.object=this))}setLogic(t){if(this._logic===t)return;const e=this._logic;if(e&&(this._logic=null,e.setObject(null)),this._logic=t,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const s=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(s)}}processUpdateMessage(t){if(this._logic)return this._logic.processUpdateMessage(t);this._pendingLogicMessages.push(t)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(t){this._updateCounter=t}get isReady(){return this._isReady}set isReady(t){this._isReady=t}};Qf.OBJECT_COUNTER=0;let tT=Qf;const Jf=class Jf{constructor(t,e,s){this.type=t,this.loc=e,this.category=s}get loc(){return this._loc}set loc(t){this._loc||(this._loc=new w),this._loc.assign(t)}get type(){return this._type}set type(t){this._type=t}get category(){return this._category}set category(t){this._category=t}dispose(){this._loc=null}};Jf.WINDOW="window",Jf.HOLE="hole";let Hl=Jf;class SL{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(t){if(!t)return!1;if(this._masks.clear(),t.masks.length)for(const e of t.masks){if(!e)continue;const s=e.locations.length?e.locations[0]:null;s&&this._masks.set(e.id,new Hl(e.type,s,e.category))}return!0}reset(){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}addMask(t,e,s,r){const n=new Hl(e,s,r);this._masks.delete(t),this._masks.set(t,n)}removeMask(t){const e=this._masks.get(t);return e?(this._masks.delete(t),e.dispose(),!0):!1}getXML(){const t=new PK;for(const[e,s]of this._masks.entries()){if(!s)continue;const r=this.getMaskType(s),n=this.getMaskCategory(s),o=this.getMaskLocation(s);if(r&&n&&o){const l={id:e,type:r,category:n,locations:[{x:o.x,y:o.y,z:o.z}]};t.masks.push(l)}}return t}getMaskLocation(t){return t?t.loc:null}getMaskType(t){return t?t.type:null}getMaskCategory(t){return t?t.category:null}get masks(){return this._masks}}class LK{constructor(t,e,s,r){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=r}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const El=class El{constructor(t,e,s,r,n){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let o,l,c,u,h,d,f,E;if(this._secondaryNormals=[],this._masks=[],this._loc=new w,this._loc.assign(e),this._leftSide=new w,this._leftSide.assign(s),this._rightSide=new w,this._rightSide.assign(r),this._type=t,s!=null&&r!=null&&(this._normal=w.crossProduct(s,r),o=0,l=0,c=0,u=0,h=0,this.normal.x!=0||this.normal.y!=0?(u=this.normal.x,h=this.normal.y,o=360+Math.atan2(h,u)/Math.PI*180,o>=360&&(o=o-360),u=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),h=this.normal.z,l=360+Math.atan2(h,u)/Math.PI*180,l>=360&&(l=l-360)):this.normal.z<0?l=90:l=270,this._normalDirection=new w(o,l,c)),n!=null&&n.length>0)for(d=0;d<n.length;)f=n[d],f!=null&&f.length>0&&(E=new w,E.assign(f),E.multiply(1/E.length),this._secondaryNormals.push(E)),d++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(t){if(t<0||t>=this.secondaryNormalCount)return null;const e=new w;return e.assign(this._secondaryNormals[t]),e}addMask(t,e,s,r){const n=new LK(t,e,s,r);this._masks.push(n)}getMask(t){return t<0||t>=this.maskCount?null:this._masks[t]}getMaskLeftSideLoc(t){const e=this.getMask(t);return e!=null?e.leftSideLoc:-1}getMaskRightSideLoc(t){const e=this.getMask(t);return e!=null?e.rightSideLoc:-1}getMaskLeftSideLength(t){const e=this.getMask(t);return e!=null?e.leftSideLength:-1}getMaskRightSideLength(t){const e=this.getMask(t);return e!=null?e.rightSideLength:-1}};El.PLANE_UNDEFINED=0,El.PLANE_FLOOR=1,El.PLANE_WALL=2,El.PLANE_LANDSCAPE=3,El.PLANE_BILLBOARD=4;let Ss=El;const Hc=class Hc{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(t,e,s,r,n){(this._addDuplicates||this.checkIsNotDuplicate(t,e,s,r,n))&&(this._corners.push(t),this._directions.push(e),this._lengths.push(s),this._borders.push(r),this._leftTurns.push(n),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(t,e,s,r,n){let o=0;for(;o<this._count;){if(this._corners[o].x==t.x&&this._corners[o].y==t.y&&this._directions[o]==e&&this._lengths[o]==s&&this._borders[o]==r&&this._leftTurns[o]==n)return!1;o++}return!0}get count(){return this._count}getCorner(t){return this._corners[t]}getEndPoint(t){return this.calculateWallEndPoints(),this._endPoints[t]}getLength(t){return this._lengths[t]}getDirection(t){return this._directions[t]}getBorder(t){return this._borders[t]}getHideWall(t){return this._hideWalls[t]}getLeftTurn(t){return this._leftTurns[t]}getManuallyLeftCut(t){return this._manuallyLeftCut[t]}getManuallyRightCut(t){return this._manuallyRightCut[t]}setHideWall(t,e){this._hideWalls[t]=e}setLength(t,e){e<this._lengths[t]&&(this._lengths[t]=e,this._manuallyRightCut[t]=!0)}moveCorner(t,e){let s;if(e>0&&e<this._lengths[t]){const r=this._corners[t];s=Hc.WALL_DIRECTION_VECTORS[this.getDirection(t)],this._corners[t]=new Qt(r.x+e*s.x,r.y+e*s.y),this._lengths[t]=this._lengths[t]-e,this._manuallyLeftCut[t]=!0}}calculateWallEndPoints(){let t,e,s,r,n;if(this._endPoints.length!=this.count)for(this._endPoints=[],t=0;t<this.count;)e=this.getCorner(t),s=new Qt(e.x,e.y),r=Hc.WALL_DIRECTION_VECTORS[this.getDirection(t)],n=this.getLength(t),s.x=s.x+r.x*n,s.y=s.y+r.y*n,this._endPoints.push(s),t++}};Hc.WALL_DIRECTION_VECTORS=[new w(1,0,0),new w(0,1,0),new w(-1,0,0),new w(0,-1,0)],Hc.WALL_NORMAL_VECTORS=[new w(0,1,0),new w(-1,0,0),new w(0,-1,0),new w(1,0,0)];let vn=Hc;const ce=class ce{constructor(){this._width=0,this._height=0,this._fixedWallHeight=-1,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._highlights=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map,this._floorHolesInverted=new Map}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(t){t<0&&(t=0),this._wallHeight=t}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(t){t<0&&(t=0),this._wallThicknessMultiplier=t}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(t){t<0&&(t=0),this._floorThicknessMultiplier=t}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}static getFloorHeight(t){const e=t.length;if(!e)return 0;let s=0,r=0;for(;r<e;){const n=t[r];let o=0;for(;o<n.length;){const l=n[o];l>s&&(s=l),o++}r++}return s}static findEntranceTile(t){if(!t)return null;const e=t.length;if(!e)return null;const s=[];let r=0;for(;r<e;){const n=t[r];if(!n||!n.length)return null;let o=0;for(;o<n.length;){if(n[o]>=0){s.push(o);break}o++}s.length<r+1&&s.push(n.length+1),r++}for(r=1;r<s.length-1;){if(Math.trunc(s[r])<=Math.trunc(s[r-1])-1&&Math.trunc(s[r])<=Math.trunc(s[r+1])-1)return new Qt(Math.trunc(s[r]|0),r);r++}return null}static expandFloorTiles(t){let e,s,r,n,o,l,c,u,h,d,f,E;const m=t.length,I=t[0].length,p=[];for(s=0;s<m*4;)p[s]=[],s++;let T=0;for(s=0;s<m;){for(o=0,e=0;e<I;){if(l=t[s][e],l<0||l<=255)for(n=0;n<4;){for(r=0;r<4;)p[T+n]===void 0&&(p[T+n]=[]),p[T+n][o+r]=l<0?l:l*4,r++;n++}else{for(c=(l&255)*4,u=c+(l>>11&1)*3,h=c+(l>>10&1)*3,d=c+(l>>9&1)*3,f=c+(l>>8&1)*3,r=0;r<3;)E=r+1,p[T][o+r]=(u*(3-r)+h*r)/3,p[T+3][o+E]=(d*(3-E)+f*E)/3,p[T+E][o]=(u*(3-E)+d*E)/3,p[T+r][o+3]=(h*(3-r)+f*r)/3,r++;p[T+1][o+1]=u>c?c+2:c+1,p[T+1][o+2]=h>c?c+2:c+1,p[T+2][o+1]=d>c?c+2:c+1,p[T+2][o+2]=f>c?c+2:c+1}o=o+4,e++}T=T+4,s++}return p}static addTileTypes(t){let e,s,r,n,o,l,c,u,h,d,f,E,m;const I=t.length-1,p=t[0].length-1;for(s=1;s<I;){for(e=1;e<p;)r=t[s][e],r<0||(n=t[s-1][e-1]&255,o=t[s-1][e]&255,l=t[s-1][e+1]&255,c=t[s][e-1]&255,u=t[s][e+1]&255,h=t[s+1][e-1]&255,d=t[s+1][e]&255,f=t[s+1][e+1]&255,E=r+1,m=(n==E||o==E||c==E?8:0)|(l==E||o==E||u==E?4:0)|(h==E||d==E||c==E?2:0)|(f==E||d==E||u==E?1:0),m==15&&(m=0),t[s][e]=r|m<<8),e++;s++}}static unpadHeightMap(t){t.shift(),t.pop();for(const e of t)e.shift(),e.pop()}static padHeightMap(t){const e=[],s=[];for(const r of t)r.push(ce.TILE_BLOCKED),r.unshift(ce.TILE_BLOCKED);for(const r of t[0])e.push(ce.TILE_BLOCKED),s.push(ce.TILE_BLOCKED);t.push(s),t.unshift(e)}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null),this._floorHolesInverted!=null&&(this._floorHolesInverted.clear(),this._floorHolesInverted=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(t,e){t<0&&(t=0),e<0&&(e=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let s=0;for(;s<e;){const r=[],n=[],o=[];let l=0;for(;l<t;)r[l]=ce.TILE_BLOCKED,n[l]=ce.TILE_BLOCKED,o[l]=!1,l++;this._tileMatrix.push(r),this._tileMatrixOriginal.push(n),this._floorHoleMatrix.push(o),s++}return this._width=t,this._height=e,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(t,e,s){let r,n,o,l,c;if(t>=0&&t<this._width&&e>=0&&e<this._height){if(r=this._tileMatrix[e],r[t]=s,s>=0)t<this._minX&&(this._minX=t),t>this._maxX&&(this._maxX=t),e<this._minY&&(this._minY=e),e>this._maxY&&(this._maxY=e);else{if(t==this._minX||t==this._maxX){for(n=!1,o=this._minY;o<this._maxY;){if(this.getTileHeightInternal(t,o)>=0){n=!0;break}o++}n||(t==this._minX&&this._minX++,t==this._maxX&&this._maxX--)}if(e==this._minY||e==this._maxY){for(l=!1,c=this._minX;c<this._maxX;){if(this.getTileHeight(c,e)>=0){l=!0;break}c++}l||(e==this._minY&&this._minY++,e==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return ce.TILE_BLOCKED;const s=this._tileMatrix[e];return s[t]===void 0?0:Math.abs(s[t])}initializeFromTileData(t=-1){let e,s;for(this._fixedWallHeight=t,s=0;s<this._height;){for(e=0;e<this._width;)this._tileMatrixOriginal[s]===void 0&&(this._tileMatrixOriginal[s]=[]),this._tileMatrixOriginal[s][e]=this._tileMatrix[s][e],e++;s++}const r=ce.findEntranceTile(this._tileMatrix);for(s=0;s<this._height;){for(e=0;e<this._width;)this._floorHoleMatrix[s]===void 0&&(this._floorHoleMatrix[s]=[]),this._floorHoleMatrix[s][e]&&this.setTileHeight(e,s,ce.TILE_HOLE),e++;s++}return this.initialize(r)}initializeHighlightArea(t,e,s,r){this.clearHighlightArea(),this.extractPlanes(this.floorTiles,t*4,e*4,s*4,r*4,!0)}clearHighlightArea(){const t=this._highlights.length;return this._planes=this._planes.slice(0,this._planes.length-this._highlights.length),this._highlights.length=0,t}initializeFromMapData(t){if(!t)return!1;this.reset(),this.resetFloorHoles();const e=t.width,s=t.height,r=t.wallHeight,n=t.fixedWallsHeight;if(this.initializeTileMap(e,s),t.tileMap){let o=0;for(;o<t.tileMap.length;){const l=t.tileMap[o];if(l){let c=0;for(;c<l.length;){const u=l[c];u&&this.setTileHeight(c,o,u.height),c++}}o++}}if(t.holeMap&&t.holeMap.length){let o=0;for(;o<t.holeMap.length;){const l=t.holeMap[o];l&&(this.addFloorHole(l.id,l.x,l.y,l.width,l.height,l.invert),o++)}this.initializeHoleMap()}return this.wallHeight=r,this.initializeFromTileData(n),!0}isPlaneTemporaryHighlighter(t){if(t<0||t>=this.planeCount)return!1;const e=this._planes[t];return e==null?!1:this._highlights.indexOf(e)!=-1}getMapData(){const t=new TL;t.width=this._width,t.height=this._height,t.wallHeight=this._wallHeight,t.fixedWallsHeight=this._fixedWallHeight,t.dimensions.minX=this.minX,t.dimensions.maxX=this.maxX,t.dimensions.minY=this.minY,t.dimensions.maxY=this.maxY;let e=0;for(;e<this._height;){const s=[],r=this._tileMatrixOriginal[e];let n=0;for(;n<this._width;){const o=r[n];s.push({height:o}),n++}t.tileMap.push(s),e++}for(const[s,r]of this._floorHoles.entries())r&&t.holeMap.push({id:s,x:r.x,y:r.y,width:r.width,height:r.height,invert:!1});for(const[s,r]of this._floorHolesInverted.entries())r&&t.holeMap.push({id:s,x:r.x,y:r.y,width:r.width,height:r.height,invert:!0});return t}getPlaneLocation(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.loc:null}getPlaneNormal(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normal:null}getPlaneLeftSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.leftSide:null}getPlaneRightSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.rightSide:null}getPlaneNormalDirection(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normalDirection:null}getPlaneSecondaryNormals(t){let e,s;if(t<0||t>=this.planeCount)return null;const r=this._planes[t];if(r!=null){for(e=[],s=0;s<r.secondaryNormalCount;)e.push(r.getSecondaryNormal(s)),s++;return e}return null}getPlaneType(t){if(t<0||t>=this.planeCount)return Ss.PLANE_UNDEFINED;const e=this._planes[t];return e?e.type:Ss.PLANE_UNDEFINED}getPlaneMaskCount(t){if(t<0||t>=this.planeCount)return 0;const e=this._planes[t];return e?e.maskCount:0}getPlaneMaskLeftSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLoc(e):-1}getPlaneMaskRightSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLoc(e):-1}getPlaneMaskLeftSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLength(e):-1}getPlaneMaskRightSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLength(e):-1}addFloorHole(t,e,s,r,n,o=!1){this.removeFloorHole(t),o?this._floorHolesInverted.set(t,new tA(e,s,r,n)):this._floorHoles.set(t,new tA(e,s,r,n))}removeFloorHole(t){this._floorHoles.delete(t),this._floorHolesInverted.delete(t)}resetFloorHoles(){this._floorHoles.clear(),this._floorHolesInverted.clear()}getTileHeightOriginal(t,e){return t<0||t>=this._width||e<0||e>=this._height?ce.TILE_BLOCKED:this._floorHoleMatrix[e][t]?ce.TILE_HOLE:this._tileMatrixOriginal[e][t]}getTileHeightInternal(t,e){return t<0||t>=this._width||e<0||e>=this._height?ce.TILE_BLOCKED:this._tileMatrix[e][t]}initialize(t){let e=0;t!=null&&(e=this.getTileHeight(t.x,t.y),this.setTileHeight(t.x,t.y,ce.TILE_BLOCKED)),this._floorHeight=ce.getFloorHeight(this._tileMatrix),this.createWallPlanes();const s=[];for(const r of this._tileMatrix)s.push(r.concat());return ce.padHeightMap(s),ce.addTileTypes(s),ce.unpadHeightMap(s),this.floorTiles=ce.expandFloorTiles(s),this.extractPlanes(this.floorTiles),t!=null&&(this.setTileHeight(t.x,t.y,e),this.addFloor(new w(t.x+.5,t.y+.5,e),new w(-1,0,0),new w(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(t,e){let s,r,n,o,l;const c=new vn,u=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let h=0,d=new Qt(t.x,t.y),f=0;for(;f++<1e3;){if(s=!1,r=!1,n=h,(d.x<this.minX||d.x>this.maxX||d.y<this.minY||d.y>this.maxY)&&(s=!0),o=u[h](d,e),o==null)return null;if(l=Math.abs(o.x-d.x)+Math.abs(o.y-d.y),d.x==o.x||d.y==o.y?(h=(h-1+u.length)%u.length,l=l+1,r=!0):(h=(h+1)%u.length,l--),c.addWall(d,n,l,s,r),o.x==t.x&&o.y==t.y&&(o.x!=d.x||o.y!=d.y))break;d=o}return c.count==0?null:c}hidePeninsulaWallChains(t){let e,s,r,n,o=0;const l=t.count;for(;o<l;){const c=o;for(e=o,s=0,r=!1;!t.getBorder(o)&&o<l;)t.getLeftTurn(o)?s++:s>0&&s--,s>1&&(r=!0),e=o,o++;if(r)for(n=c;n<=e;)t.setHideWall(n,!0),n++;o++}}updateWallsNextToHoles(t){let e,s,r,n,o,l,c;const u=t.count;let h=0;for(;h<u;){if(!t.getHideWall(h)){for(e=t.getCorner(h),s=t.getDirection(h),r=t.getLength(h),n=vn.WALL_DIRECTION_VECTORS[s],o=vn.WALL_NORMAL_VECTORS[s],l=0,c=0;c<r;){if(this.getTileHeightInternal(e.x+c*n.x-o.x,e.y+c*n.y-o.y)==ce.TILE_HOLE){if(c>0&&l==0){t.setLength(h,c);break}l++}else if(l>0){t.moveCorner(h,l);break}c++}l==r&&t.setHideWall(h,!0)}h++}}resolveOriginalWallIndex(t,e,s){let r,n,o,l,c,u;const h=Math.min(t.y,e.y),d=Math.max(t.y,e.y),f=Math.min(t.x,e.x),E=Math.max(t.x,e.x),m=s.count;let I=0;for(;I<m;){if(r=s.getCorner(I),n=s.getEndPoint(I),t.x==e.x){if(r.x==t.x&&n.x==t.x&&(o=Math.min(r.y,n.y),l=Math.max(r.y,n.y),o<=h&&d<=l))return I}else if(t.y==e.y&&r.y==t.y&&n.y==t.y&&(c=Math.min(r.x,n.x),u=Math.max(r.x,n.x),c<=f&&E<=u))return I;I++}return-1}hideOriginallyHiddenWalls(t,e){let s,r,n,o,l;const c=t.count;let u=0;for(;u<c;)t.getHideWall(u)||(s=t.getCorner(u),r=new Qt(s.x,s.y),n=vn.WALL_DIRECTION_VECTORS[t.getDirection(u)],o=t.getLength(u),r.x=r.x+n.x*o,r.y=r.y+n.y*o,l=this.resolveOriginalWallIndex(s,r,e),l>=0?e.getHideWall(l)&&t.setHideWall(u,!0):t.setHideWall(u,!0)),u++}checkWallHiding(t,e){this.hidePeninsulaWallChains(e),this.updateWallsNextToHoles(t),this.hideOriginallyHiddenWalls(t,e)}addWalls(t,e){const s=t.count,r=e.count;let n=0;for(;n<s;){if(!t.getHideWall(n)){const o=t.getCorner(n),l=t.getDirection(n),c=t.getLength(n),u=vn.WALL_DIRECTION_VECTORS[l],h=vn.WALL_NORMAL_VECTORS[l];let d=-1,f=0;for(;f<c;){const U=this.getTileHeightInternal(o.x+f*u.x+h.x,o.y+f*u.y+h.y);U>=0&&(U<d||d<0)&&(d=U),f++}const E=d;let m=new w(o.x,o.y,E);m=w.sum(m,w.product(h,.5)),m=w.sum(m,w.product(u,-.5));const I=this.wallHeight+Math.min(ce.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-d,p=w.product(u,-c),T=new w(0,0,I);m=w.dif(m,p);const R=this.resolveOriginalWallIndex(o,t.getEndPoint(n),e);let S=0,L=0;R>=0?(S=e.getDirection((R+1)%r),L=e.getDirection((R-1+r)%r)):(S=t.getDirection((n+1)%s),L=t.getDirection((n-1+s)%s));let M=null;(S-l+4)%4==3?M=vn.WALL_NORMAL_VECTORS[S]:(l-L+4)%4==3&&(M=vn.WALL_NORMAL_VECTORS[L]);const P=t.getLeftTurn(n),k=t.getLeftTurn((n-1+s)%s),G=t.getHideWall((n+1)%s),j=t.getManuallyLeftCut(n),F=t.getManuallyRightCut(n);this.addWall(m,p,T,M,!k||j,!P||F,!G)}n++}}createWallPlanes(){const t=this._tileMatrix;if(t==null)return!1;let e,s,r;const n=t.length;let o=0;if(n==0)return!1;for(e=0;e<n;){if(r=t[e],r==null||r.length==0)return!1;o>0?o=Math.min(o,r.length):o=r.length,e++}const l=Math.min(ce.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:ce.getFloorHeight(t)),c=this.minX;let u=this.minY;for(u=this.minY;u<=this.maxY;){if(this.getTileHeightInternal(c,u)>ce.TILE_HOLE){u--;break}u++}if(u>this.maxY)return!1;const h=new Qt(c,u),d=this.generateWallData(h,!0),f=this.generateWallData(h,!1);for(d!=null&&(d.count,f.count,this.checkWallHiding(d,f),this.addWalls(d,f)),s=0;s<this.tileMapHeight;){for(e=0;e<this.tileMapWidth;)this.getTileHeightInternal(e,s)<0&&this.setTileHeight(e,s,-(l+this.wallHeight)),e++;s++}return!0}extractTopWall(t,e){if(t==null)return null;let s=1,r=ce.TILE_HOLE;for(e||(r=ce.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x+s,t.y)>r)return new Qt(t.x+s-1,t.y);if(this.getTileHeightInternal(t.x+s,t.y+1)<=r)return new Qt(t.x+s,t.y+1);s++}return null}extractRightWall(t,e){if(t==null)return null;let s=1,r=ce.TILE_HOLE;for(e||(r=ce.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y+s)>r)return new Qt(t.x,t.y+(s-1));if(this.getTileHeightInternal(t.x-1,t.y+s)<=r)return new Qt(t.x-1,t.y+s);s++}return null}extractBottomWall(t,e){if(t==null)return null;let s=1,r=ce.TILE_HOLE;for(e||(r=ce.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x-s,t.y)>r)return new Qt(t.x-(s-1),t.y);if(this.getTileHeightInternal(t.x-s,t.y-1)<=r)return new Qt(t.x-s,t.y-1);s++}return null}extractLeftWall(t,e){if(t==null)return null;let s=1,r=ce.TILE_HOLE;for(e||(r=ce.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y-s)>r)return new Qt(t.x,t.y-(s-1));if(this.getTileHeightInternal(t.x+1,t.y-s)<=r)return new Qt(t.x+1,t.y-s);s++}return null}addWall(t,e,s,r,n,o,l){this.addPlane(Ss.PLANE_WALL,t,e,s,[r]),this.addPlane(Ss.PLANE_LANDSCAPE,t,e,s,[r]);const c=ce.WALL_THICKNESS*this._wallThicknessMultiplier,u=ce.FLOOR_THICKNESS*this._floorThicknessMultiplier,h=w.crossProduct(e,s),d=w.product(h,1/h.length*-c);if(this.addPlane(Ss.PLANE_WALL,w.sum(t,s),e,d,[h,r]),n&&this.addPlane(Ss.PLANE_WALL,w.sum(w.sum(t,e),s),w.product(s,-(s.length+u)/s.length),d,[h,r]),o&&(this.addPlane(Ss.PLANE_WALL,w.sum(t,w.product(s,-u/s.length)),w.product(s,(s.length+u)/s.length),d,[h,r]),l)){const f=w.product(e,c/e.length);this.addPlane(Ss.PLANE_WALL,w.sum(w.sum(t,s),w.product(f,-1)),f,d,[h,e,r])}}addFloor(t,e,s,r,n,o,l,c=!1){let u,h,d;this.addPlane(Ss.PLANE_FLOOR,t,e,s,null,c)!=null&&(u=ce.FLOOR_THICKNESS*this._floorThicknessMultiplier,h=new w(0,0,u),d=w.dif(t,h),o&&this.addPlane(Ss.PLANE_FLOOR,d,e,h,null,c),l&&this.addPlane(Ss.PLANE_FLOOR,w.sum(d,w.sum(e,s)),w.product(e,-1),h,null,c),r&&this.addPlane(Ss.PLANE_FLOOR,w.sum(d,s),w.product(s,-1),h,null,c),n&&this.addPlane(Ss.PLANE_FLOOR,w.sum(d,e),s,h,null,c))}addPlane(t,e,s,r,n=null,o=!1){if(s.length==0||r.length==0)return null;const l=new Ss(t,e,s,r,n);return this._planes.push(l),o&&this._highlights.push(l),l}initializeHoleMap(){let t,e,s;for(e=0;e<this._height;){for(s=this._floorHoleMatrix[e],t=0;t<this._width;)s[t]=this._floorHolesInverted.size>0,t++;e++}for(const r of this._floorHolesInverted.values())this.initializeHole(r,!0);for(const r of this._floorHoles.values())this.initializeHole(r)}initializeHole(t,e=!1){let s,r,n,o,l,c,u;const h=t;if(h!=null)for(o=h.x,l=h.x+h.width-1,c=h.y,u=h.y+h.height-1,o=o<0?0:o,l=l>=this._width?this._width-1:l,c=c<0?0:c,u=u>=this._height?this._height-1:u,r=c;r<=u;){for(n=this._floorHoleMatrix[r],s=o;s<=l;)n[s]=!e,s++;r++}}extractPlanes(t,e=0,s=0,r=-1,n=-1,o=!1){let l=0,c=0,u=0,h=0,d=0,f=0,E=!1,m=!1,I=!1,p=!1,T=0,R=0,S=!1,L=NaN,M=NaN,P=NaN,k=NaN;const G=t.length,j=t[0].length,F=n==-1?G:Math.min(G,s+n),U=r==-1?j:Math.min(j,e+r),K=[];for(l=0;l<F;)K[l]=[],l++;for(c=s;c<F;){for(u=e;u<U;){if(!((h=t[c][u])<0||K[c][u])){for(E=u==0||t[c][u-1]!=h,m=c==0||t[c-1][u]!=h,d=u+1;d<U&&!(t[c][d]!=h||K[c][d]||c>0&&t[c-1][d]==h==m);)d++;for(I=d==j||t[c][d]!=h,S=!1,f=c+1;f<=F&&!S&&(p=f==G||t[f][u]!=h,S=f==F||p||u>0&&t[f][u-1]==h==E||d<j&&t[f][d]==h==I,f!=G);){for(T=u;T<d;){if(t[f][T]==h==p){S=!0,d=T;break}T++}if(S)break;f++}for(p||(p=f==G),I=d==j||t[c][d]!=h,R=c;R<f;){for(T=u;T<d;)K[R][T]=!0,T++;R++}L=u/4-.5,M=c/4-.5,P=(d-u)/4,k=(f-c)/4,this.addFloor(new w(L+P,M+k,h/4),new w(-P,0,0),new w(0,-k,0),I,E,p,m,o)}u++}c++}}};ce.TILE_BLOCKED=-110,ce.TILE_HOLE=-100,ce.FLOOR_THICKNESS=.25,ce.WALL_THICKNESS=.25,ce.MAX_WALL_ADDITIONAL_HEIGHT=20;let Bs=ce;class Vs{constructor(t,e){this._location=t,this._direction=e}get location(){return this._location}get direction(){return this._direction}}const Zf=class Zf extends Vs{constructor(t){super(null,null),this._type=t}get type(){return this._type}};Zf.IMAGE_LOADED="ROAUM_IMAGE_LOADED",Zf.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";let Aa=Zf;class Gs extends Vs{constructor(){super(null,null)}}class OL extends Gs{constructor(t,e){super(),this._itemType=t,this._itemName=e}get itemType(){return this._itemType}get itemName(){return this._itemName}}class TS extends Gs{constructor(t=0){super(),this._numberOfWords=t}get numberOfWords(){return this._numberOfWords}}class AL extends Gs{constructor(t=0){super(),this._danceStyle=t}get danceStyle(){return this._danceStyle}}class NL extends Gs{constructor(t,e=0){super(),this._effect=t,this._delayMilliseconds=e}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class CL extends Gs{constructor(t){super(),this._gainedExperience=t}get gainedExperience(){return this._gainedExperience}}class xL extends Gs{constructor(t=0){super(),this._expressionType=t}get expressionType(){return this._expressionType}}class cg extends Gs{constructor(t,e=null,s=null,r=!1){super(),this._figure=t,this._gender=e,this._subType=s,this._isRiding=r}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class yL extends Gs{constructor(t=0){super(),this._level=t}get level(){return this._level}}class ML extends Gs{constructor(t=0){super(),this._gesture=t}get gesture(){return this._gesture}}class UK extends Gs{constructor(t){super(),this._guideStatus=t}get guideStatus(){return this._guideStatus}}class bL extends Gs{constructor(t=!1){super(),this._isMuted=t}get isMuted(){return this._isMuted}}class DL extends Gs{}class vL extends Gs{constructor(t){super(),this._gesture=t}get gesture(){return this._gesture}}class PL extends Gs{constructor(t){super(),this._value=t}get value(){return this._value}}class LL extends Gs{constructor(t){super(),this._isPlayingGame=t}get isPlayingGame(){return this._isPlayingGame}}class RS extends Gs{constructor(t,e=""){super(),this._postureType=t,this._parameter=e}get postureType(){return this._postureType}get parameter(){return this._parameter}}class ug extends Gs{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class UL extends Gs{constructor(t=0){super(),this._signType=t}get signType(){return this._signType}}class SS extends Gs{constructor(t=!1){super(),this._isSleeping=t}get isSleeping(){return this._isSleeping}}class jL extends Gs{constructor(t=!1){super(),this._isTyping=t}get isTyping(){return this._isTyping}}class jo extends Vs{constructor(t,e,s,r=!1){super(t,s),this._targetLocation=e,this._isSlide=r}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class hg extends jo{constructor(t,e,s,r,n,o){super(t,e,s),this._headDirection=r,this._canStandUp=n,this._baseY=o}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class wL extends Gs{constructor(t){super(),this._itemType=t}get itemType(){return this._itemType}}class we extends Vs{constructor(t,e,s=null){super(null,null),this._state=t,this._data=e,this._extra=s}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}const RO=class RO extends Vs{constructor(t,e){super(null,null),this._badgeId=t,this._assetName=e}get badgeId(){return this._badgeId}get assetName(){return this._assetName}};RO.BADGE_LOADED="ROGBUM_BADGE_LOADED";let Wl=RO;class FL extends Vs{constructor(t,e,s){super(t,e),this._height=s}get height(){return this._height}}class OS extends Vs{constructor(t){super(null,null),this._data=t}get data(){return this._data}}class GL extends Vs{constructor(t,e){super(null,null),this._numberKey=t,this._numberValue=e}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}const SO=class SO extends Vs{constructor(t,e,s,r){super(null,null),this._type=t,this._color=e,this._light=s,this._backgroundOnly=r}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}};SO.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";let od=SO;const $f=class $f extends Vs{constructor(t,e,s=0,r=0,n=0,o=0,l=!1){super(null,null),this._type=t,this._id=e,this._x=s,this._y=r,this._width=n,this._height=o,this._invert=l}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get invert(){return this._invert}};$f.ADD="ORPFHUM_ADD",$f.REMOVE="ORPFHUM_REMOVE";let Or=$f;const tm=class tm extends Vs{constructor(t){super(null,null),this._type=tm.UPDATE_MAP,this._mapData=t}get type(){return this._type}get mapData(){return this._mapData}};tm.UPDATE_MAP="RORMUM_UPDATE_MAP";let dg=tm;const pl=class pl extends Vs{constructor(t,e,s=null,r=null,n="window"){super(null,null),this._type=t,this._maskId=e,this._maskType=s,this._maskLocation=r?new w(r.x,r.y,r.z):null,this._maskCategory=n}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}};pl.ADD_MASK="RORMUM_ADD_MASK",pl.REMOVE_MASK="RORMUM_ADD_MASK",pl.DOOR="door",pl.WINDOW="window",pl.HOLE="hole";let Ai=pl;const em=class em extends Vs{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}};em.WALL_THICKNESS="RORPPUM_WALL_THICKNESS",em.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";let Ka=em;const sm=class sm extends Vs{constructor(t,e){super(null,null),this._type=t,this._visible=e}get type(){return this._type}get visible(){return this._visible}};sm.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY",sm.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";let Xa=sm;const Oh=class Oh extends Vs{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}};Oh.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE",Oh.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE",Oh.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";let ii=Oh;class ld extends Gs{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class uc extends Vs{constructor(t,e,s,r,n=!1){super(t,null),this._height=e,this._visible=s,this._sourceEventId=r,this._toggleVisibility=n}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}const im=class im extends Vs{constructor(t){super(null,null),this._type=t}get type(){return this._type}};im.ENABLED="ROVUM_ENABLED",im.DISABLED="ROVUM_DISABLED";let qa=im;class Xm{constructor(){this._events=null,this._object=null,this._time=0}initialize(t){}dispose(){this._object=null}update(t){this._time=t}processUpdateMessage(t){!t||!this._object||(this._object.setLocation(t.location),this._object.setDirection(t.direction))}getEventTypes(){return[]}mergeTypes(t,e){const s=t.concat();for(const r of e)!r||s.indexOf(r)>=0||s.push(r);return s}mouseEvent(t,e){}useObject(){}setObject(t){if(this._object!==t){if(this._object&&this._object.setLogic(null),!t){this.dispose(),this._object=null;return}this._object=t,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(t){this._events=t}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}const Wc=class Wc extends Xm{constructor(){super(),this._liftAmount=0,this._location=new w,this._locationDelta=new w,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=Wc.DEFAULT_UPDATE_INTERVAL}dispose(){this._liftAmount=0,super.dispose()}update(t){super.update(t);const e=this.getLocationOffset(),s=this.object&&this.object.model;if(s&&(e?this._liftAmount!==e.z&&(this._liftAmount=e.z,s.setValue(A.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,s.setValue(A.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||e){const r=Wc.TEMP_VECTOR;let n=this.time-this._changeTime;n===this._updateInterval>>1&&n++,n>this._updateInterval&&(n=this._updateInterval),this._locationDelta.length>0?(r.assign(this._locationDelta),r.multiply(n/this._updateInterval),r.add(this._location)):r.assign(this._location),e&&r.add(e),this.object.setLocation(r),n===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(t){super.setObject(t),t&&this._location.assign(t.getLocation())}processUpdateMessage(t){if(t&&(super.processUpdateMessage(t),t.location&&this._location.assign(t.location),t instanceof jo))return this.processMoveMessage(t)}processMoveMessage(t){!t||!this.object||!t.location||(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(t.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(t){t<=0&&(t=1),this._updateInterval=t}};Wc.DEFAULT_UPDATE_INTERVAL=500,Wc.TEMP_VECTOR=new w;let wo=Wc;const ys=class ys extends wo{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=zt()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const t=[Ut.CLICK,Ut.DOUBLE_CLICK,Mi.POSITION_CHANGED,Ut.MOUSE_ENTER,Ut.MOUSE_LEAVE,_t.MOUSE_BUTTON,_t.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Mi(Mi.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const s=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==s.x||this._reportedLocation.y!==s.y||this._reportedLocation.z!==s.z)&&(this._reportedLocation||(this._reportedLocation=new w),this._reportedLocation.assign(s),this.eventDispatcher.dispatchEvent(new Mi(Mi.POSITION_CHANGED,this.object)))}const e=this.object&&this.object.model;e&&this.updateModel(this.time,e)}updateModel(t,e){this._talkingEndTimestamp>0&&(t>this._talkingEndTimestamp?(e.setValue(A.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=t+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&t>this._talkingPauseStartTimestamp?(e.setValue(A.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&t>this._talkingPauseEndTimestamp&&(e.setValue(A.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&t>this._animationEndTimestamp&&(e.setValue(A.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(A.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&t>this._signEndTimestamp&&(e.setValue(A.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&t>this._carryObjectEndTimestamp&&(e.setValue(A.FIGURE_CARRY_OBJECT,0),e.setValue(A.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&t-this._carryObjectStartTimestamp>5e3&&((t-this._carryObjectStartTimestamp)%1e4<1e3?e.setValue(A.FIGURE_USE_OBJECT,1):e.setValue(A.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&t>this._blinkingStartTimestamp&&(e.setValue(A.FIGURE_BLINK,1),this._blinkingStartTimestamp=t+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=t+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&t>this._blinkingEndTimestamp&&(e.setValue(A.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&t>this._effectChangeTimeStamp&&(e.setValue(A.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&t>this._numberValueEndTimestamp&&(e.setValue(A.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof RS){e.setValue(A.FIGURE_POSTURE,t.postureType),e.setValue(A.FIGURE_POSTURE_PARAMETER,t.parameter);return}if(t instanceof TS){e.setValue(A.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof jL){e.setValue(A.FIGURE_IS_TYPING,t.isTyping?1:0);return}if(t instanceof bL){e.setValue(A.FIGURE_IS_MUTED,t.isMuted?1:0);return}if(t instanceof LL){e.setValue(A.FIGURE_IS_PLAYING_GAME,t.isPlayingGame?1:0);return}if(t instanceof hg){e.setValue(A.HEAD_DIRECTION,t.headDirection),e.setValue(A.FIGURE_CAN_STAND_UP,t.canStandUp),e.setValue(A.FIGURE_VERTICAL_OFFSET,t.baseY);return}if(t instanceof ML){e.setValue(A.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof xL){e.setValue(A.FIGURE_EXPRESSION,t.expressionType),this._animationEndTimestamp=St.getExpressionTimeout(e.getValue(A.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(t instanceof AL){e.setValue(A.FIGURE_DANCE,t.danceStyle);return}if(t instanceof SS){e.setValue(A.FIGURE_SLEEP,t.isSleeping?1:0),t.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(t instanceof PL){e.setValue(A.FIGURE_NUMBER_VALUE,t.value),this._numberValueEndTimestamp=this.time+3e3;return}if(t instanceof NL){this.updateAvatarEffect(t.effect,t.delayMilliseconds,e);return}if(t instanceof OL){e.setValue(A.FIGURE_CARRY_OBJECT,t.itemType),e.setValue(A.FIGURE_USE_OBJECT,0),t.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,t.itemType<ys.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=t.itemType<=ys.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(t instanceof wL){e.setValue(A.FIGURE_USE_OBJECT,t.itemType);return}if(t instanceof UL){e.setValue(A.FIGURE_SIGN,t.signType),this._signEndTimestamp=this.time+5e3;return}if(t instanceof yL){e.setValue(A.FIGURE_FLAT_CONTROL,t.level);return}if(t instanceof cg){e.setValue(A.FIGURE,t.figure),e.setValue(A.GENDER,t.gender);return}if(t instanceof ug){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof DL){e.setValue(A.OWN_USER,1);return}}}updateAvatarEffect(t,e,s){if(t===ys.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=zt()+ys.EFFECT_SPLASH_LENGTH,this._newEffect=ys.EFFECT_TYPE_SWIM;else if(t===ys.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=zt()+ys.EFFECT_SPLASH_LENGTH,this._newEffect=ys.EFFECT_TYPE_SWIM_DARK;else if(s.getValue(A.FIGURE_EFFECT)===ys.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=zt()+ys.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=ys.EFFECT_TYPE_SPLASH;else if(s.getValue(A.FIGURE_EFFECT)===ys.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=zt()+ys.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=ys.EFFECT_TYPE_SPLASH_DARK;else if(e===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=zt()+e,this._newEffect=t;return}s.setValue(A.FIGURE_EFFECT,t)}mouseEvent(t,e){let s=null;switch(t.type){case lt.MOUSE_CLICK:s=Ut.CLICK;break;case lt.DOUBLE_CLICK:s=Ut.DOUBLE_CLICK;break;case lt.ROLL_OVER:s=Ut.MOUSE_ENTER,this.object.model&&this.object.model.setValue(A.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new _t(_t.MOUSE_BUTTON,this.object));break;case lt.ROLL_OUT:s=Ut.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(A.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new _t(_t.MOUSE_ARROW,this.object));break}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ut(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}};ys.MAX_HAND_ID=999999999,ys.MAX_HAND_USE_ID=999,ys.EFFECT_TYPE_SPLASH=28,ys.EFFECT_SPLASH_LENGTH=500,ys.EFFECT_TYPE_SWIM=29,ys.EFFECT_TYPE_SPLASH_DARK=184,ys.EFFECT_TYPE_SWIM_DARK=185;let eT=ys;class jK extends wo{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const t=[Ut.CLICK,Mi.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic&&t.logic.model){const s=t.logic.model.directions;if(s&&s.length){for(const r of s)this._directions.push(r);this._directions.sort()}}e.setValue(A.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Mi(Mi.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const e=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==e.x||this._reportedLocation.y!==e.y||this._reportedLocation.z!==e.z)&&(this._reportedLocation||(this._reportedLocation=new w),this._reportedLocation.assign(e),this.eventDispatcher.dispatchEvent(new Mi(Mi.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(t,this.object.model)}updateModel(t,e){this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(A.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&t>this._talkingEndTimestamp&&(e.setValue(A.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&t>this._expressionEndTimestamp&&(e.setValue(A.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof hg){e.setValue(A.HEAD_DIRECTION,t.headDirection);return}if(t instanceof cg){const s=new da(t.figure);e.setValue(A.FIGURE,t.figure),e.setValue(A.RACE,t.subType),e.setValue(A.PET_PALETTE_INDEX,s.paletteId),e.setValue(A.PET_COLOR,s.color),e.setValue(A.PET_TYPE,s.typeId),e.setValue(A.PET_CUSTOM_LAYER_IDS,s.customLayerIds),e.setValue(A.PET_CUSTOM_PARTS_IDS,s.customPartIds),e.setValue(A.PET_CUSTOM_PALETTE_IDS,s.customPaletteIds),e.setValue(A.PET_IS_RIDING,t.isRiding?1:0);return}if(t instanceof RS){e.setValue(A.FIGURE_POSTURE,t.postureType);return}if(t instanceof TS){e.setValue(A.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof SS){e.setValue(A.FIGURE_SLEEP,t.isSleeping?1:0);return}if(t instanceof vL){e.setValue(A.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof ug){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof CL){e.setValue(A.FIGURE_EXPERIENCE_TIMESTAMP,this.time),e.setValue(A.FIGURE_GAINED_EXPERIENCE,t.gainedExperience);return}}}mouseEvent(t,e){let s=null;switch(t.type){case lt.MOUSE_CLICK:s=Ut.CLICK;break;case lt.DOUBLE_CLICK:break;case lt.MOUSE_DOWN:{this.object.model.getValue(A.PET_TYPE)===Ds.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ut(Ut.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown));break}}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ut(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}}class wK extends Xm{constructor(){super(),this._planeParser=new Bs,this._planeBitmapMaskParser=new SL,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const t=[Ut.MOUSE_MOVE,Ut.CLICK];return this.mergeTypes(super.getEventTypes(),t)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(t){!t||!this.object||t instanceof TL&&this._planeParser.initializeFromMapData(t)&&(this.object.model.setValue(A.ROOM_MAP_DATA,t),this.object.model.setValue(A.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(A.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(A.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(A.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=jt().getValue("room.color.skip.transition")===!0)}update(t){if(super.update(t),this.updateBackgroundColor(t),this._needsMapUpdate){if(this._lastHoleUpdate&&t-this._lastHoleUpdate<5)return;const e=this.object&&this.object.model;if(e){const s=this._planeParser.getMapData();e.setValue(A.ROOM_MAP_DATA,s),e.setValue(A.ROOM_FLOOR_HOLE_UPDATE_TIME,t),this._planeParser.initializeFromMapData(s)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(t){if(!this.object||!this._colorChangedTime)return;let e=this._color,s=this._light;if(t-this._colorChangedTime>=this._colorTransitionLength)e=this._targetColor,s=this._targetLight,this._colorChangedTime=0;else{let n=this._originalColor>>16&255,o=this._originalColor>>8&255,l=this._originalColor&255;const c=this._targetColor>>16&255,u=this._targetColor>>8&255,h=this._targetColor&255,d=(t-this._colorChangedTime)/this._colorTransitionLength;n=n+(c-n)*d,o=o+(u-o)*d,l=l+(h-l)*d,e=(n<<16)+(o<<8)+l,s=this._originalLight+(this._targetLight-this._originalLight)*d,this._color=e,this._light=s}let r=yr.rgbToHSL(e);r=(r&16776960)+s,e=yr.hslToRGB(r),this.object.model&&this.object.model.setValue(A.ROOM_BACKGROUND_COLOR,e)}processUpdateMessage(t){if(!t||!this.object)return;const e=this.object.model;if(e){if(t instanceof ii){this.onObjectRoomUpdateMessage(t,e);return}if(t instanceof Ai){this.onObjectRoomMaskUpdateMessage(t,e);return}if(t instanceof Xa){this.onObjectRoomPlaneVisibilityUpdateMessage(t,e);return}if(t instanceof Ka){this.onObjectRoomPlanePropertyUpdateMessage(t,e);return}if(t instanceof Or){this.onObjectRoomFloorHoleUpdateMessage(t,e);return}if(t instanceof od){this.onObjectRoomColorUpdateMessage(t,e);return}t instanceof dg&&this.onObjectRoomMapUpdateMessage(t)}}onObjectRoomUpdateMessage(t,e){switch(t.type){case ii.ROOM_FLOOR_UPDATE:e.setValue(A.ROOM_FLOOR_TYPE,t.value);return;case ii.ROOM_WALL_UPDATE:e.setValue(A.ROOM_WALL_TYPE,t.value);return;case ii.ROOM_LANDSCAPE_UPDATE:e.setValue(A.ROOM_LANDSCAPE_TYPE,t.value);return}}onObjectRoomMaskUpdateMessage(t,e){let s=null,r=!1;switch(t.type){case Ai.ADD_MASK:s=Hl.WINDOW,t.maskCategory===Ai.HOLE&&(s=Hl.HOLE),this._planeBitmapMaskParser.addMask(t.maskId,t.maskType,t.maskLocation,s),r=!0;break;case Ai.REMOVE_MASK:r=this._planeBitmapMaskParser.removeMask(t.maskId);break}r&&e.setValue(A.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(t,e){let s=0;switch(t.visible&&(s=1),t.type){case Xa.FLOOR_VISIBILITY:e.setValue(A.ROOM_FLOOR_VISIBILITY,s);return;case Xa.WALL_VISIBILITY:e.setValue(A.ROOM_WALL_VISIBILITY,s),e.setValue(A.ROOM_LANDSCAPE_VISIBILITY,s);return}}onObjectRoomPlanePropertyUpdateMessage(t,e){switch(t.type){case Ka.FLOOR_THICKNESS:e.setValue(A.ROOM_FLOOR_THICKNESS,t.value);return;case Ka.WALL_THICKNESS:e.setValue(A.ROOM_WALL_THICKNESS,t.value);return}}onObjectRoomFloorHoleUpdateMessage(t,e){switch(t.type){case Or.ADD:this._planeParser.addFloorHole(t.id,t.x,t.y,t.width,t.height),this._needsMapUpdate=!0;return;case Or.REMOVE:this._planeParser.removeFloorHole(t.id),this._needsMapUpdate=!0;return}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(t,e){!t||!e||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=t.color,this._targetLight=t.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,e.setValue(A.ROOM_COLORIZE_BG_ONLY,t.backgroundOnly))}onObjectRoomMapUpdateMessage(t){!t||!t.mapData||(this.object.model.setValue(A.ROOM_MAP_DATA,t.mapData),this.object.model.setValue(A.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(t.mapData))}mouseEvent(t,e){if(!t||!e||!this.object||!this.object.model)return;const s=t.spriteTag;let r=0;if(s&&s.indexOf("@")>=0&&(r=parseInt(s.substr(s.indexOf("@")+1))),r<1||r>this._planeParser.planeCount){t.type===lt.ROLL_OUT&&this.object.model.setValue(A.ROOM_SELECTED_PLANE,0);return}r--;let n=null;const o=this._planeParser.getPlaneLocation(r),l=this._planeParser.getPlaneLeftSide(r),c=this._planeParser.getPlaneRightSide(r),u=this._planeParser.getPlaneNormalDirection(r),h=this._planeParser.getPlaneType(r);if(o==null||l==null||c==null||u==null)return;const d=l.length,f=c.length;if(d==0||f==0)return;const E=t.screenX,m=t.screenY,I=new Qt(E,m);if(n=e.getPlanePosition(I,o,l,c),!n){this.object.model.setValue(A.ROOM_SELECTED_PLANE,0);return}const p=w.product(l,n.x/d);p.add(w.product(c,n.y/f)),p.add(o);const T=p.x,R=p.y,S=p.z;if(n.x>=0&&n.x<d&&n.y>=0&&n.y<f)this.object.model.setValue(A.ROOM_SELECTED_X,T),this.object.model.setValue(A.ROOM_SELECTED_Y,R),this.object.model.setValue(A.ROOM_SELECTED_Z,S),this.object.model.setValue(A.ROOM_SELECTED_PLANE,r+1);else{this.object.model.setValue(A.ROOM_SELECTED_PLANE,0);return}let L=null;switch(t.type===lt.MOUSE_MOVE||t.type===lt.ROLL_OVER?L=Ut.MOUSE_MOVE:t.type===lt.MOUSE_CLICK?L=Ut.CLICK:t.type===lt.MOUSE_DOWN&&(L=Ut.MOUSE_DOWN),t.type){case lt.MOUSE_MOVE:case lt.ROLL_OVER:case lt.MOUSE_DOWN:case lt.MOUSE_CLICK:{let M=null;if(h===Ss.PLANE_FLOOR)M=new bn(L,this.object,t.eventId,T,R,S,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);else if(h===Ss.PLANE_WALL||h===Ss.PLANE_LANDSCAPE){let P=90;u&&(P=u.x+90,P>360&&(P-=360));const k=l.length*n.x/d,G=c.length*n.y/f;M=new cc(L,this.object,t.eventId,o,l,c,k,G,P,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(M);return}}}}class FK extends Xm{initialize(t){this.object&&(this.object.model.setValue(A.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof qa&&this.object)switch(t.type){case qa.ENABLED:this.object.setState(0,0);return;case qa.DISABLED:this.object.setState(1,0);return}}}const Bn=class Bn extends Xm{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(t){this.object&&(this.object.model.setValue(A.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(Bn.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(t){t instanceof uc&&(this._lastEventId&&this._lastEventId===t.sourceEventId||(t.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(t),this.object&&(this._isHidden?this.object.setState(Bn.CURSOR_HIDDEN_STATE,0):t.visible?(this.object.model.setValue(A.TILE_CURSOR_HEIGHT,t.height),this.object.setState(t.height>.8?Bn.CURSOR_HEIGHT_STATE:Bn.CURSOR_VISIBLE_STATE)):this.object.setState(Bn.CURSOR_HIDDEN_STATE,0)),this._lastEventId=t.sourceEventId))}};Bn.CURSOR_VISIBLE_STATE=0,Bn.CURSOR_HIDDEN_STATE=1,Bn.CURSOR_HEIGHT_STATE=6;let sT=Bn;const sr=class sr extends wo{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new w,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,sr.BOUNCING_STEPS===-1&&(sr.BOUNCING_STEPS=jt().getValue("furni.rotation.bounce.steps",8)),sr.BOUNCING_Z===-1&&(sr.BOUNCING_Z=jt().getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const t=[he.STATE_CHANGE,Ut.CLICK,Ut.MOUSE_DOWN,Ut.MOUSE_DOWN_LONG,ts.ROOM_AD_TOOLTIP_SHOW,ts.ROOM_AD_TOOLTIP_HIDE,ts.ROOM_AD_FURNI_DOUBLE_CLICK,ts.ROOM_AD_FURNI_CLICK];return this.widget&&t.push(q.OPEN_WIDGET,q.CLOSE_WIDGET),this.contextMenu&&t.push(q.OPEN_FURNI_CONTEXT_MENU,q.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic){if(t.logic.model){const s=t.logic.model.dimensions;s&&(this._sizeX=s.x,this._sizeY=s.y,this._sizeZ=s.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const r=t.logic.model.directions;if(r&&r.length){for(const n of r)this._directions.push(n);this._directions.sort((n,o)=>n-o)}}if(t.logic.customVars){const s=t.logic.customVars.variables;s&&s.length&&e.setValue(A.FURNITURE_CUSTOM_VARIABLES,s)}}e.setValue(A.FURNITURE_SIZE_X,this._sizeX),e.setValue(A.FURNITURE_SIZE_Y,this._sizeY),e.setValue(A.FURNITURE_SIZE_Z,this._sizeZ),e.setValue(A.FURNITURE_CENTER_X,this._centerX),e.setValue(A.FURNITURE_CENTER_Y,this._centerY),e.setValue(A.FURNITURE_CENTER_Z,this._centerZ),e.setValue(A.FURNITURE_ALLOWED_DIRECTIONS,this._directions),e.setValue(A.FURNITURE_ALPHA_MULTIPLIER,1)}}dispose(){this._storedRotateMessage=null,this._directions=null,super.dispose()}setObject(t){super.setObject(t),t&&t.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(t){return t.getValue(A.FURNITURE_AD_URL)}handleAdClick(t,e,s){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ts(ts.ROOM_AD_FURNI_CLICK,this.object))}update(t){super.update(t),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>sr.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(t){if(t instanceof we){this.processDataUpdateMessage(t);return}if(t instanceof FL){this.processObjectHeightUpdateMessage(t);return}if(t instanceof OS){this.processItemDataUpdateMessage(t);return}if(this._mouseOver=!1,t.location&&t.direction){if(!(t instanceof jo)){const e=this.object.getDirection(),s=this.object.getLocation();e.x!==t.direction.x&&this._directionInitialized&&s.x===t.location.x&&s.y===t.location.y&&s.z===t.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new Vs(t.location,t.direction),t=null)}this._directionInitialized=!0}if(t instanceof ld&&this.contextMenu&&this.eventDispatcher&&this.object){const e=t.selected?q.OPEN_FURNI_CONTEXT_MENU:q.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new q(e,this.object))}super.processUpdateMessage(t)}processDataUpdateMessage(t){t&&(this.object.setState(t.state,0),t.data&&t.data.writeRoomObjectModel(this.object.model),t.extra!==null&&this.object.model.setValue(A.FURNITURE_EXTRAS,t.extra.toString()),this.object.model.setValue(A.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(t){t&&this.object.model.setValue(A.FURNITURE_SIZE_Z,t.height)}processItemDataUpdateMessage(t){t&&this.object.model.setValue(A.FURNITURE_ITEMDATA,t.data)}mouseEvent(t,e){const s=this.getAdClickUrl(this.object.model);switch(t.type){case lt.MOUSE_MOVE:if(this.eventDispatcher){const r=new Ut(Ut.MOUSE_MOVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);r.localX=t.localX,r.localY=t.localY,r.spriteOffsetX=t.spriteOffsetX,r.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(r)}return;case lt.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new ts(ts.ROOM_AD_TOOLTIP_SHOW,this.object));const r=new Ut(Ut.MOUSE_ENTER,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);r.localX=t.localX,r.localY=t.localY,r.spriteOffsetX=t.spriteOffsetX,r.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(r)}this._mouseOver=!0}return;case lt.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new ts(ts.ROOM_AD_TOOLTIP_HIDE,this.object));const r=new Ut(Ut.MOUSE_LEAVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);r.localX=t.localX,r.localY=t.localY,r.spriteOffsetX=t.spriteOffsetX,r.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(r)}this._mouseOver=!1}return;case lt.DOUBLE_CLICK:this.useObject();return;case lt.MOUSE_CLICK:if(this.eventDispatcher){const r=new Ut(Ut.CLICK,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);r.localX=t.localX,r.localY=t.localY,r.spriteOffsetX=t.spriteOffsetX,r.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(r),s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new ts(ts.ROOM_AD_TOOLTIP_HIDE,this.object)),s&&s.length&&this.handleAdClick(this.object.id,this.object.type,s)}return;case lt.MOUSE_DOWN:if(this.eventDispatcher){const r=new Ut(Ut.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(r)}return;case lt.MOUSE_DOWN_LONG:if(this.eventDispatcher){const r=new Ut(Ut.MOUSE_DOWN_LONG,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(r)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=sr.BOUNCING_STEPS/2?this._locationOffset.z=sr.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=sr.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=sr.BOUNCING_Z*(sr.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const t=this.getAdClickUrl(this.object.model);t&&t.length&&this.eventDispatcher.dispatchEvent(new ts(ts.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,t)),this.widget&&this.eventDispatcher.dispatchEvent(new q(q.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new he(he.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new q(q.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new q(q.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}};sr.BOUNCING_STEPS=-1,sr.BOUNCING_Z=-1;let Oe=sr;class kL extends Oe{getEventTypes(){const t=[q.BADGE_DISPLAY_ENGRAVING,Sn.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object){if(t instanceof we){const e=t.data;e instanceof An&&this.updateBadge(e.getValue(1));return}if(t instanceof Wl){t.assetName!=="loading_icon"&&(this.object.model.setValue(A.FURNITURE_BADGE_ASSET_NAME,t.assetName),this.object.model.setValue(A.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(zt()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(t){t!==""&&this.eventDispatcher&&(this.object.model.setValue(A.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new Sn(Sn.LOAD_BADGE,this.object,t,!1)))}}const ir=class ir extends kL{getEventTypes(){const t=[q.ACHIEVEMENT_RESOLUTION_OPEN,q.ACHIEVEMENT_RESOLUTION_ENGRAVING,q.ACHIEVEMENT_RESOLUTION_FAILED,Sn.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof Wl&&t.assetName!=="loading_icon"&&this.object.model.setValue(A.FURNITURE_BADGE_VISIBLE_IN_STATE,ir.BADGE_VISIBLE_IN_STATE),t instanceof ld){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new q(q.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let t=null;switch(this.object.getState(0)){case ir.STATE_RESOLUTION_NOT_STARTED:case ir.STATE_RESOLUTION_IN_PROGRESS:t=new q(q.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case ir.STATE_RESOLUTION_ACHIEVED:t=new q(q.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case ir.STATE_RESOLUTION_FAILED:t=new q(q.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}t&&this.eventDispatcher.dispatchEvent(t)}updateBadge(t){t!==ir.ACH_NOT_SET&&super.updateBadge(t)}};ir.STATE_RESOLUTION_NOT_STARTED=0,ir.STATE_RESOLUTION_IN_PROGRESS=1,ir.STATE_RESOLUTION_ACHIEVED=2,ir.STATE_RESOLUTION_FAILED=3,ir.ACH_NOT_SET="ach_0",ir.BADGE_VISIBLE_IN_STATE=2;let iT=ir;class Cs extends Oe{getEventTypes(){const t=[_t.MOUSE_BUTTON,_t.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case lt.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new _t(_t.MOUSE_BUTTON,this.object));break;case lt.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new _t(_t.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}}class GK extends Cs{getEventTypes(){const t=[q.AREA_HIDE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),this.object&&t instanceof we&&(t.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this.setupObject())}setupObject(){if(!this.object||!this.object.model)return;const t=new gu;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(0),s=t.getValue(1),r=t.getValue(2),n=t.getValue(3),o=t.getValue(4),l=t.getValue(5)===1,c=t.getValue(6)===1,u=t.getValue(7)===1;this.object.model.setValue(A.FURNITURE_AREA_HIDE_ROOT_X,s),this.object.model.setValue(A.FURNITURE_AREA_HIDE_ROOT_Y,r),this.object.model.setValue(A.FURNITURE_AREA_HIDE_WIDTH,n),this.object.model.setValue(A.FURNITURE_AREA_HIDE_LENGTH,o),this.object.model.setValue(A.FURNITURE_AREA_HIDE_INVISIBILITY,l?1:0),this.object.model.setValue(A.FURNITURE_AREA_HIDE_WALL_ITEMS,c?1:0),this.object.model.setValue(A.FURNITURE_AREA_HIDE_INVERT,u?1:0),this.object.setState(e,0)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.AREA_HIDE,this.object))}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case lt.DOUBLE_CLICK:{if(t.spriteTag==="turn_on"||t.spriteTag==="turn_off"?s=new he(he.STATE_CHANGE,this.object):s=new q(q.AREA_HIDE,this.object),this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}}super.mouseEvent(t,e)}}class kK extends Oe{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(t){super.initialize(t),this.eventDispatcher&&this.eventDispatcher.addEventListener(Iu.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(Iu.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(t){if(!t||!this.object)return;const e=this.object.getLocation(),s=t.targetLocation;if(!s)return;let r=this.object.model.getValue(A.FURNITURE_SIZE_X),n=this.object.model.getValue(A.FURNITURE_SIZE_Y);const o=(Math.floor(this.object.getDirection().x)+45)%360/90;(o===1||o===3)&&([r,n]=[n,r]),s.x>=e.x&&s.x<e.x+r&&s.y>=e.y&&s.y<e.y+n?this.object.setState(1,0):this.object.setState(0,0)}}class BK extends Oe{getEventTypes(){const t=[q.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);const e=this.object.model.getValue(A.FURNITURE_DATA);this.updateClothingData(e)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof we&&t.data&&this.updateClothingData(t.data.getLegacyString())}updateClothingData(t){if(!t||!t.length)return;const[e,s]=t.split(",");e&&e.length&&this.object.model.setValue(A.FURNITURE_CLOTHING_BOY,e),s&&s.length&&this.object.model.setValue(A.FURNITURE_CLOTHING_GIRL,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.CLOTHING_CHANGE,this.object))}}class VK extends Oe{getEventTypes(){const t=[he.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case lt.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new he(he.STATE_CHANGE,this.object,1);break;case"reset":s=new he(he.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new he(he.STATE_CHANGE,this.object,1))}}class HK extends Oe{processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(vs.INFOSTAND_EXTRA_PARAM,vs.CRACKABLE_FURNI)}}class WK extends Oe{get widget(){return Wh.CRAFTING}}class YK extends Oe{getEventTypes(){const t=[q.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);let e=0;t.logic&&t.logic.credits&&t.logic.credits!==""&&t.logic.credits.length>0&&(e=parseInt(t.logic.credits)),this.object.model.setValue(A.FURNITURE_CREDIT_VALUE,e)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new q(q.CREDITFURNI,this.object)),super.useObject())}}class zK extends Cs{constructor(){super(...arguments),this._state=1}getEventTypes(){const t=[za.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof we&&(this._state!==-1&&t.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=t.state)}dispatchSoundEvent(t){const e=Math.pow(2,t-1.2);this.eventDispatcher.dispatchEvent(new za(za.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",e))}}class KK extends Cs{getEventTypes(){const t=[q.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(A.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new q(q.STACK_HEIGHT,this.object)),super.useObject())}}class XK extends Oe{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const t=[_t.DICE_ACTIVATE,_t.DICE_OFF];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case lt.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(s=new _t(_t.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(s=new _t(_t.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):t.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?s=new _t(_t.DICE_ACTIVATE,this.object):t.spriteTag==="deactivate"&&(s=new _t(_t.DICE_OFF,this.object)),s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}}class qK extends Oe{getEventTypes(){const t=[q.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.ECOTRONBOX,this.object))}}class QK extends Oe{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[q.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(A.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===lt.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.INERNAL_LINK,this.object))}}class JK extends Oe{getEventTypes(){const t=[q.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.link&&t.logic.action.link!==""&&t.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(A.FURNITURE_INTERNAL_LINK,t.logic.action.link)}dispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.dispose()}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(A.FURNITURE_AUTOMATIC_STATE_INDEX,t)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new q(q.ROOM_LINK,this.object))}}class ZK extends Oe{getEventTypes(){const t=[q.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return es.EFFECT_BOX}}class $K extends Cs{getEventTypes(){const t=[q.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(super.initialize(t),!!t&&this.object&&this.object.model){let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(A.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(A.FURNITURE_PLANE_MASK_TYPE,e)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new q(q.EXTERNAL_IMAGE,this.object)),super.useObject())}}class t6 extends Oe{getEventTypes(){const t=[he.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(A.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case lt.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new he(he.STATE_CHANGE,this.object,1);break;case"reset":s=new he(he.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new he(he.STATE_CHANGE,this.object,0))}}const Il=class Il extends Cs{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const t=[Oi.ADD_HOLE,Oi.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._currentState===Il.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Oi(Oi.REMOVE_HOLE,this.object)),super.dispose()}update(t){super.update(t),this.handleAutomaticStateUpdate()}processUpdateMessage(t){if(super.processUpdateMessage(t),!this.object)return;t instanceof we&&this.handleStateUpdate(this.object.getState(0));const e=this.object.getLocation();this._currentLocation?(e.x!==this._currentLocation.x||e.y!==this._currentLocation.y)&&this._currentState===Il.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Oi(Oi.ADD_HOLE,this.object)):this._currentLocation=new w,this._currentLocation.assign(e)}handleStateUpdate(t){t!==this._currentState&&(this.eventDispatcher&&(t===Il.STATE_HOLE?this.eventDispatcher.dispatchEvent(new Oi(Oi.ADD_HOLE,this.object)):this._currentState===Il.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Oi(Oi.REMOVE_HOLE,this.object))),this._currentState=t)}handleAutomaticStateUpdate(){if(!this.object)return;const t=this.object.model;if(!t)return;const e=t.getValue(A.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(e)||this.handleStateUpdate(e%2)}};Il.STATE_HOLE=0;let rT=Il;const Tl=class Tl extends Cs{constructor(){super(...arguments),this._state=-1}initialize(t){super.initialize(t),this.object&&this.object.model.setValue(A.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(t){if(t instanceof we){const e=t.data;e?this._state=e.state:this._state=t.state}super.processUpdateMessage(t)}getEventTypes(){const t=[q.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||(this._state===Tl.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new q(q.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===Tl.STATE_UNLOCKED?es.FRIEND_FURNITURE:es.DUMMY}};Tl.STATE_UNINITIALIZED=-1,Tl.STATE_UNLOCKED=0,Tl.STATE_LOCKED=1;let _g=Tl;const Vn=class Vn extends Cs{getEventTypes(){const t=[Sn.LOAD_BADGE,q.GUILD_FURNI_CONTEXT_MENU,q.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof we){const e=t.data;e instanceof An&&(this.updateGroupId(e.getValue(Vn.GROUPID_KEY)),this.updateBadge(e.getValue(Vn.BADGE_KEY)),this.updateColors(e.getValue(Vn.COLOR1_KEY),e.getValue(Vn.COLOR2_KEY)))}else t instanceof Wl?t.assetName!=="loading_icon"&&(this.object.model.setValue(A.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,t.assetName),this.update(zt())):t instanceof ld&&(t.selected||this.eventDispatcher.dispatchEvent(new q(q.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(t){this.object.model.setValue(A.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(t))}updateBadge(t){this.eventDispatcher.dispatchEvent(new Sn(Sn.LOAD_BADGE,this.object,t,!0))}updateColors(t,e){this.object.model.setValue(A.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(t,16)),this.object.model.setValue(A.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(e,16))}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case lt.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(t,e)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new q(q.GUILD_FURNI_CONTEXT_MENU,this.object))}};Vn.GROUPID_KEY=1,Vn.BADGE_KEY=2,Vn.COLOR1_KEY=3,Vn.COLOR2_KEY=4;let gg=Vn;class e6 extends gg{getEventTypes(){const t=[q.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}updateGroupId(t){super.updateGroupId(t),this.object.model.setValue(A.FURNITURE_INTERNAL_LINK,`groupforum/${t}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new q(q.INERNAL_LINK,this.object)),super.useObject())}}class s6 extends Oe{getEventTypes(){const t=[_t.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _t(_t.USE_HABBOWHEEL,this.object))}}const rm=class rm extends Oe{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[q.HIGH_SCORE_DISPLAY,q.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new q(q.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(t){super.processUpdateMessage(t),this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&t instanceof we&&(t.state===rm.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new q(q.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new q(q.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=t.state)}};rm.SHOW_WIDGET_IN_STATE=1;let nT=rm;class i6 extends Oe{getEventTypes(){const t=[he.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case lt.DOUBLE_CLICK:switch(t.spriteTag){case"off":s=new he(he.STATE_CHANGE,this.object,3);break}break;case lt.MOUSE_CLICK:switch(t.spriteTag){case"inc":s=new he(he.STATE_CHANGE,this.object,2);break;case"dec":s=new he(he.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new he(he.STATE_CHANGE,this.object,3))}}class r6 extends _g{get engravingDialogType(){return m_.HABBOWEEN}}class n6 extends Cs{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(t){if(this._nextStateTimestamp>0&&t>=this._nextStateTimestamp){this._nextStateTimestamp=0;const e=new Di;e.setString(this._nextState.toString()),super.processUpdateMessage(new we(this._nextState,e,this._nextStateExtra))}super.update(t)}processUpdateMessage(t){if(t instanceof we){this.processUpdate(t);return}super.processUpdateMessage(t)}processUpdate(t){if(!t)return;const e=~~(t.state/1e3),s=~~(t.state%1e3);if(s)this._nextState=e,this._nextStateExtra=t.extra,this._nextStateTimestamp=this.time+s;else{this._nextStateTimestamp=0;const r=new Di;r.setString(e.toString()),super.processUpdateMessage(new we(e,r,t.extra))}}}class a6 extends Oe{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[q.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&(this.object.model.setValue(A.FURNITURE_INTERNAL_LINK,t.logic.action.link),t.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(A.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===lt.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.INERNAL_LINK,this.object))}}class o6 extends Cs{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[_t.JUKEBOX_START,_t.JUKEBOX_MACHINE_STOP,_t.JUKEBOX_DISPOSE,_t.JUKEBOX_INIT,q.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this.requestDispose(),super.dispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(vs.INFOSTAND_EXTRA_PARAM,vs.JUKEBOX),t instanceof we)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new _t(_t.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new _t(_t.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _t(_t.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _t(_t.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new q(q.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new he(he.STATE_CHANGE,this.object,-1)))}}class l6 extends _g{get engravingDialogType(){return m_.LOVE_LOCK}}const po=class po extends Oe{getEventTypes(){const t=[q.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof we&&(t.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const t=new Gl;t.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(A.FURNITURE_MANNEQUIN_GENDER,t.getValue(po.GENDER)),this.object.model.setValue(A.FURNITURE_MANNEQUIN_FIGURE,t.getValue(po.FIGURE)),this.object.model.setValue(A.FURNITURE_MANNEQUIN_NAME,t.getValue(po.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.MANNEQUIN,this.object))}};po.GENDER="GENDER",po.FIGURE="FIGURE",po.OUTFIT_NAME="OUTFIT_NAME";let aT=po;class c6 extends Cs{getEventTypes(){const t=[q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return es.MONSTERPLANT_SEED}}class u6 extends Cs{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(A.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class h6 extends Cs{getEventTypes(){const t=[q.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return es.MYSTERY_BOX}}class d6 extends Cs{getEventTypes(){const t=[q.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return es.MYSTERY_TROPHY}}class _6 extends Oe{getEventTypes(){const t=[_t.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _t(_t.ENTER_ONEWAYDOOR,this.object))}}class g6 extends Oe{getEventTypes(){const t=[q.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(vs.INFOSTAND_EXTRA_PARAM,vs.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.PET_PRODUCT_MENU,this.object))}}class f6 extends Oe{getEventTypes(){const t=[q.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.PLACEHOLDER,this.object))}}class m6 extends Oe{initialize(t){super.initialize(t),t.logic&&t.logic.planetSystems&&this.object.model.setValue(A.FURNITURE_PLANETSYSTEM_DATA,t.logic.planetSystems)}}const Br=class Br extends Oe{getEventTypes(){const t=[q.PRESENT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(A.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof we&&(t.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),t instanceof GL&&t.numberKey===A.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(A.FURNITURE_DISABLE_PICKING_ANIMATION,t.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const t=new Gl;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(Br.MESSAGE),s=this.object.model.getValue(A.FURNITURE_DATA);!e&&typeof s=="string"?this.object.model.setValue(A.FURNITURE_DATA,s.substr(1)):this.object.model.setValue(A.FURNITURE_DATA,t.getValue(Br.MESSAGE)),this.writeToModel(A.FURNITURE_TYPE_ID,t.getValue(Br.PRODUCT_CODE)),this.writeToModel(A.FURNITURE_PURCHASER_NAME,t.getValue(Br.PURCHASER_NAME)),this.writeToModel(A.FURNITURE_PURCHASER_FIGURE,t.getValue(Br.PURCHASER_FIGURE))}writeToModel(t,e){e&&this.object.model.setValue(t,e)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case lt.ROLL_OVER:this.eventDispatcher.dispatchEvent(new _t(_t.MOUSE_BUTTON,this.object));break;case lt.ROLL_OUT:this.eventDispatcher.dispatchEvent(new _t(_t.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.PRESENT,this.object))}};Br.MESSAGE="MESSAGE",Br.PRODUCT_CODE="PRODUCT_CODE",Br.EXTRA_PARAM="EXTRA_PARAM",Br.PURCHASER_NAME="PURCHASER_NAME",Br.PURCHASER_FIGURE="PURCHASER_FIGURE";let oT=Br;class E6 extends Cs{getEventTypes(){const t=[q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return es.PURCHASABLE_CLOTHING}}const ja=class ja extends Cs{constructor(){super(),this.updateInterval=wo.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new w}processUpdateMessage(t){if(!t)return;const e=t instanceof jo;if(this.object&&!e&&t.location){const s=this.object.getLocation(),r=w.dif(t.location,s);if(r&&Math.abs(r.x)<2&&Math.abs(r.y)<2){let n=s;(Math.abs(r.x)>1||Math.abs(r.y)>1)&&(n=w.sum(s,w.product(r,.5))),super.processUpdateMessage(new jo(n,t.location,t.direction));return}}if(t.location&&!e&&super.processUpdateMessage(new jo(t.location,t.location,t.direction)),t instanceof we){t.state>0?this.updateInterval=wo.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(t.state):this.updateInterval=1,this.handleDataUpdate(t);return}e&&t.isSlide&&(this.updateInterval=wo.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(t)}getUpdateIntervalValue(t){return t/ja.MAX_ANIMATION_COUNT}getAnimationValue(t){return t%ja.MAX_ANIMATION_COUNT}handleDataUpdate(t){const e=this.getAnimationValue(t.state);if(e!==t.state){const s=new Di;s.setString(e.toString()),t=new we(e,s,t.extra)}super.processUpdateMessage(t)}update(t){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(t),w.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==ja.ANIMATION_NOT_MOVING&&this.object.setState(ja.ANIMATION_NOT_MOVING,0))}};ja.ANIMATION_NOT_MOVING=0,ja.ANIMATION_MOVING=1,ja.MAX_ANIMATION_COUNT=10;let lT=ja;class p6 extends Oe{getEventTypes(){const t=[he.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new he(he.STATE_RANDOM,this.object))}}class I6 extends Cs{get contextMenu(){return es.RANDOM_TELEPORT}}class T6 extends Oe{getEventTypes(){const t=[Zr.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),t)}update(t){if(super.update(t),this.object&&this.object.model){this.object.model.getValue(A.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new Zr(Zr.RODRE_CURRENT_USER_ID,this.object));const e=this.object.model.getValue(A.FURNITURE_DATA).renterId,s=this.object.model.getValue(A.SESSION_CURRENT_USER_ID);e?parseInt(e)===s?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return Wh.RENTABLESPACE}}class R6 extends Cs{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[q.BACKGROUND_COLOR,Ha.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new Ha(Ha.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.dispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof we&&(t.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const t=new gu;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(0),s=t.getValue(1),r=t.getValue(2),n=t.getValue(3);e>-1&&s>-1&&r>-1&&n>-1&&(this.object.model.setValue(A.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,s),this.object.model.setValue(A.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,r),this.object.model.setValue(A.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,n),this.object.setState(e,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ha(Ha.ROOM_BACKGROUND_COLOR,this.object,e===1,s,r,n)),this._roomColorUpdated=!0)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case lt.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new q(q.BACKGROUND_COLOR,this.object));return}super.mouseEvent(t,e)}}}const Js=class Js extends Oe{constructor(){super(),this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const t=[ts.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this._disableFurnitureSelection&&this.object.model.setValue(A.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof we&&this.processAdDataUpdateMessage(t),t instanceof Aa&&this.processAdUpdate(t)}processAdDataUpdateMessage(t){if(!t)return;const e=new Gl;e.initializeFromRoomObjectModel(this.object.model);const s=parseInt(e.getValue(Js.STATE));!isNaN(s)&&this.object.getState(0)!==s&&this.object.setState(s,0);const r=e.getValue(Js.IMAGEURL_KEY),n=this.object.model.getValue(A.FURNITURE_BRANDING_IMAGE_URL);(!n||n!==r)&&(this.object.model.setValue(A.FURNITURE_BRANDING_IMAGE_URL,r),this.object.model.setValue(A.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const o=e.getValue(Js.CLICKURL_KEY);if(o){const d=this.object.model.getValue(A.FURNITURE_BRANDING_URL);(!d||d!==o)&&this.object.model&&this.object.model.setValue(A.FURNITURE_BRANDING_URL,o)}const l=parseInt(e.getValue(Js.OFFSETX_KEY)),c=parseInt(e.getValue(Js.OFFSETY_KEY)),u=parseInt(e.getValue(Js.OFFSETZ_KEY));isNaN(l)||this.object.model.setValue(A.FURNITURE_BRANDING_OFFSET_X,l),isNaN(c)||this.object.model.setValue(A.FURNITURE_BRANDING_OFFSET_Y,c),isNaN(u)||this.object.model.setValue(A.FURNITURE_BRANDING_OFFSET_Z,u);let h=Js.IMAGEURL_KEY+"="+(r!==null?r:"")+"	";this._hasClickUrl&&(h=h+(Js.CLICKURL_KEY+"="+(o!==null?o:"")+"	")),h=h+(Js.OFFSETX_KEY+"="+l+"	"),h=h+(Js.OFFSETY_KEY+"="+c+"	"),h=h+(Js.OFFSETZ_KEY+"="+u+"	"),this.object.model.setValue(vs.INFOSTAND_EXTRA_PARAM,vs.BRANDING_OPTIONS+h)}processAdUpdate(t){if(!(!t||!this.object))switch(t.type){case Aa.IMAGE_LOADED:this.object.model.setValue(A.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case Aa.IMAGE_LOADING_FAILED:this.object.model.setValue(A.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(t,e){!t||!e||t.type===lt.MOUSE_MOVE||t.type===lt.DOUBLE_CLICK||super.mouseEvent(t,e)}async downloadBackground(){const t=this.object&&this.object.model;if(!t)return;const e=t.getValue(A.FURNITURE_BRANDING_IMAGE_URL),s=t.getValue(A.FURNITURE_BRANDING_IMAGE_STATUS);if(!e||e===""||s===1)return;const r=ae();if(!r)return;if(!r.getTexture(e)&&!await r.downloadAsset(e)){this.processUpdateMessage(new Aa(Aa.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new Aa(Aa.IMAGE_LOADED))}};Js.STATE="state",Js.IMAGEURL_KEY="imageUrl",Js.CLICKURL_KEY="clickUrl",Js.OFFSETX_KEY="offsetX",Js.OFFSETY_KEY="offsetY",Js.OFFSETZ_KEY="offsetZ";let fg=Js;class S6 extends fg{getAdClickUrl(t){return null}}class O6 extends fg{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(t){return t.getValue(A.FURNITURE_BRANDING_URL)}handleAdClick(t,e,s){if(s.indexOf("http")===0){Nn.openWebPage(s);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ts(ts.ROOM_AD_FURNI_CLICK,this.object,"",s))}}class A6 extends Oe{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[q.DIMMER,q.WIDGET_REMOVE_DIMMER,Ll.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new Ll(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new q(q.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.dispose()}processUpdateMessage(t){if(t instanceof we){if(t.data){const e=t.data.getLegacyString();this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(e),super.processUpdateMessage(new we(this.getStateFromDimmerData(e),t.data))}return}super.processUpdateMessage(t)}getStateFromDimmerData(t){if(!t)return 0;const e=t.split(",");return e.length>=5?parseInt(e[0])-1:0}processDimmerData(t){if(!t)return;const e=t.split(",");if(e.length>=5){const s=this.getStateFromDimmerData(t),r=parseInt(e[1]),n=parseInt(e[2]),o=e[3];let l=parseInt(o.substr(1),16),c=parseInt(e[4]);s||(l=16777215,c=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new Ll(this.object,s,r,n,l,c)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.DIMMER,this.object))}update(t){super.update(t)}}const Io=class Io extends Oe{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(t){if(t instanceof we)return this.updateScore(t.state);super.processUpdateMessage(t)}updateScore(t){this._score=t;const e=this.object.getState(0);if(this._score!==e){let s=this._score-e;s<0&&(s=-s),s*Io.UPDATE_INTERVAL>Io.MAX_UPDATE_TIME?this._scoreIncreaser=Io.MAX_UPDATE_TIME/s:this._scoreIncreaser=Io.UPDATE_INTERVAL,this._scoreTimer=zt()}}update(t){super.update(t);const e=this.object.getState(0);if(e!==this._score&&t>=this._scoreTimer+this._scoreIncreaser){const s=t-this._scoreTimer;let r=s/this._scoreIncreaser,n=1;this._score<e&&(n=-1),r>n*(this._score-e)&&(r=n*(this._score-e)),this.object.setState(e+n*r,0),this._scoreTimer=t-(s-r*this._scoreIncreaser)}}};Io.UPDATE_INTERVAL=50,Io.MAX_UPDATE_TIME=3e3;let cT=Io;class N6 extends Oe{processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1){const e=this.object.model.getValue(A.FURNITURE_EXTRAS),s=parseInt(e);this.object.model.setValue(vs.INFOSTAND_EXTRA_PARAM,vs.SONGDISK+s)}}}const Vr=class Vr extends Cs{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const t=[js.ROOM_OBJECT_INITIALIZED,js.ROOM_OBJECT_DISPOSED,js.PLAY_SAMPLE,js.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.soundSample&&(this._sampleId=t.logic.soundSample.id,this._noPitch=t.logic.soundSample.noPitch),this.object.model.setValue(A.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}dispose(){this._state!==Vr.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new js(js.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.dispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof we&&this.updateSoundBlockMessage(t)}updateSoundBlockMessage(t){if(!t)return;const e=this.object&&this.object.model,s=this.object&&this.object.location;!e||!s||(this._state===Vr.STATE_UNINITIALIZED&&e.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new js(js.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==Vr.STATE_UNINITIALIZED&&e.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==s.z&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new js(js.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==Vr.STATE_UNINITIALIZED&&t.state!==this._state&&this.playSoundAt(s.z),this._state=t.state)}playSoundAt(t){if(!this.object)return;const e=this.getPitchForHeight(t);this.object.model.setValue(A.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,e),this.eventDispatcher.dispatchEvent(new js(js.PLAY_SAMPLE,this.object,this._sampleId,e))}getPitchForHeight(t){if(this._noPitch)return 1;let e=t*2;return e>Vr.HIGHEST_SEMITONE&&(e=Math.min(0,Vr.LOWEST_SEMITONE+(e-Vr.HIGHEST_SEMITONE-1))),Math.pow(2,e/12)}};Vr.HIGHEST_SEMITONE=12,Vr.LOWEST_SEMITONE=-12,Vr.STATE_UNINITIALIZED=-1;let uT=Vr;class C6 extends Cs{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[_t.SOUND_MACHINE_START,_t.SOUND_MACHINE_STOP,_t.SOUND_MACHINE_DISPOSE,_t.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this.requestDispose(),super.dispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(A.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(vs.INFOSTAND_EXTRA_PARAM,vs.JUKEBOX),t instanceof we)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new _t(_t.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new _t(_t.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _t(_t.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _t(_t.SOUND_MACHINE_DISPOSE,this.object))}}const nm=class nm extends Oe{getEventTypes(){const t=[q.STICKIE,_t.STICKIE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.updateColor(),this.object&&this.object.model.setValue(A.FURNITURE_IS_STICKIE,"")}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof OS&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new q(q.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const t=this.object.model.getValue(A.FURNITURE_DATA);let e=nm.STICKIE_COLORS.indexOf(t);e<0&&(e=3),this.object.model.setValue(A.FURNITURE_COLOR,e+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _t(_t.STICKIE,this.object))}};nm.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];let hT=nm;class x6 extends Oe{getEventTypes(){const t=[q.TROPHY];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.TROPHY,this.object))}}const To=class To extends Cs{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof we){const e=t.data;if(!e)return;this.updateTotal(e.result)}}updateTotal(t){if(this._total=t,!this._lastUpdate){this.object.model.setValue(A.FURNITURE_VOTE_COUNTER_COUNT,t),this._lastUpdate=zt();return}if(this._total!==this.currentTotal){const e=Math.abs(this._total-this.currentTotal);e*To.UPDATE_INTERVAL>To.MAX_UPDATE_TIME?this._interval=To.MAX_UPDATE_TIME/e:this._interval=To.UPDATE_INTERVAL,this._lastUpdate=zt()}}update(t){if(super.update(t),this.object&&this.currentTotal!==this._total&&t>=this._lastUpdate+this._interval){const e=t-this._lastUpdate;let s=e/this._interval,r=1;this._total<this.currentTotal&&(r=-1),s>r*(this._total-this.currentTotal)&&(s=r*(this._total-this.currentTotal)),this.object.model.setValue(A.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+r*s),this._lastUpdate=t-(e-s*this._interval)}}get currentTotal(){return this.object.model.getValue(A.FURNITURE_VOTE_COUNTER_COUNT)}};To.UPDATE_INTERVAL=33,To.MAX_UPDATE_TIME=1e3;let dT=To;class y6 extends Cs{processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object&&t instanceof we){const e=t.data;e instanceof Hh&&this.object.model.setValue(A.FURNITURE_VOTE_MAJORITY_RESULT,e.result)}}}class M6 extends Cs{mouseEvent(t,e){!t||!e||(t.type===lt.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new he(he.STATE_CHANGE,this.object)),super.mouseEvent(t,e))}}class b6 extends Cs{initialize(t){super.initialize(t);let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(A.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(A.FURNITURE_PLANE_MASK_TYPE,e)}}class D6 extends Oe{getEventTypes(){const t=[q.YOUTUBE,Zr.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),t)}update(t){super.update(t),this.object.model.getValue(A.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new Zr(Zr.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new q(q.YOUTUBE,this.object))}}const am=class am{constructor(){this._id=am.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=Nr.DEFAULT,this._texture=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode="normal",this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._skipMouseHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=Rn.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0}dispose(){this._texture=null,this._width=0,this._height=0}increaseUpdateCounter(){this._updateCounter++}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name!==t&&(this._name=t,this._updateCounter++)}get type(){return this._type}set type(t){this._type=t}get spriteType(){return this._spriteType}set spriteType(t){this._spriteType=t}get texture(){return this._texture}set texture(t){this._texture!==t&&(t&&(this._width=t.width,this._height=t.height),this._texture=t,this._updateCounter++)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX!==t&&(this._offsetX=t,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY!==t&&(this._offsetY=t,this._updateCounter++)}get flipH(){return this._flipH}set flipH(t){this._flipH!==t&&(this._flipH=t,this._updateCounter++)}get flipV(){return this._flipV}set flipV(t){this._flipV!==t&&(this._flipV=t,this._updateCounter++)}get direction(){return this._direction}set direction(t){this._direction=t}get alpha(){return this._alpha}set alpha(t){t=t&255,this._alpha!==t&&(this._alpha=t,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode!==t&&(this._blendMode=t,this._updateCounter++)}get color(){return this._color}set color(t){t=t&16777215,this._color!==t&&(this._color=t,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth!==t&&(this._relativeDepth=t,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){t!==this._varyingDepth&&(this._varyingDepth=t,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(t){this._libraryAssetName=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateCounter++)}get tag(){return this._tag}set tag(t){this._tag!==t&&(this._tag=t,this._updateCounter++)}get posture(){return this._posture}set posture(t){this._posture!==t&&(this._posture=t,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance!==t&&(this._alphaTolerance=t,this._updateCounter++)}get filters(){return this._filters}set filters(t){this._filters=t,this._updateCounter++}get updateCounter(){return this._updateCounter}get skipMouseHandling(){return this._skipMouseHandling}set skipMouseHandling(t){this._skipMouseHandling=t}};am.SPRITE_COUNTER=0;let mg=am;const om=class om{constructor(){this._id=om.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(t){return!1}update(t,e,s,r){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const t=this._sprites[0];t&&t.dispose(),this._sprites.shift()}this._sprites=null}this._object=null,this._asset=null}getSprite(t){return t>=0&&t<this._sprites.length?this._sprites[t]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(t){const e=new mg;return t>=this._sprites.length?this._sprites.push(e):this._sprites.splice(t,0,e),e}createSprites(t){for(;this._sprites.length>t;){const e=this._sprites[this._sprites.length-1];e&&e.dispose(),this._sprites.pop()}for(;this._sprites.length<t;)this._sprites.push(new mg)}get image(){return this.getImage()}getImage(){const t=this.getBoundingRectangle();if(t.width*t.height===0)return null;const e=this.totalSprites,s=[];let r=0;for(;r<e;){const o=this.getSprite(r);o&&o.visible&&o.texture&&s.push(o),r++}s.sort((o,l)=>l.relativeDepth-o.relativeDepth);const n=new $r;for(r=0;r<s.length;){const o=s[r],l=o.texture;if(l){const c=new Ve(l);c.alpha=o.alpha/255,c.tint=o.color,c.x=o.offsetX,c.y=o.offsetY,c.blendMode=o.blendMode,c.filters=o.filters,o.flipH&&(c.scale.x=-1),o.flipV&&(c.scale.y=-1),n.addChild(c)}r++}return me.generateTexture({target:n})}getBoundingRectangle(){const t=this.totalSprites,e=new zo;let s=0;for(;s<t;){const r=this.getSprite(s);if(r&&r.texture&&r.visible){const n=r.flipH?-r.width+r.offsetX:r.offsetX,o=r.flipV?-r.height+r.offsetY:r.offsetY,l=new Qt(n,o);s===0?(e.x=l.x,e.y=l.y,e.width=r.width,e.height=r.height):(l.x<e.x&&(e.x=l.x),l.y<e.y&&(e.y=l.y),l.x+r.width>e.right&&(e.width=l.x+r.width-e.x),l.y+r.height>e.bottom&&(e.height=l.y+r.height-e.y))}s++}return e}get instanceId(){return this._id}get object(){return this._object}set object(t){this._object=t}get asset(){return this._asset}set asset(t){this._asset&&this._asset.removeReference(),this._asset=t,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(t){this._updateObjectCounter=t}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(t){this._updateModelCounter=t}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(t){this._updateSpriteCounter=t}get spriteCount(){return this._sprites.length}};om.VISUALIZATION_COUNTER=0;let Nu=om;class AS{initialize(t){return!0}dispose(){}createAvatarImage(t,e,s=null,r=null,n=null){let o=null;return e>48?o=is().createAvatarImage(t,hr.LARGE,s,r,n):o=is().createAvatarImage(t,hr.SMALL,s,r,n),o}get layerCount(){return 0}}class BL{constructor(t,e,s){this._id=t,this._type=e,this._visualization=s}dispose(){this._visualization=null}update(t,e){}animate(t){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}const rr=class rr extends BL{constructor(){super(...arguments),this._asset=null,this._startTime=zt(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(t,e){if(!t)return;this._scale=e;let s=64,r=0;if(e<48?(this._asset=ae().getTexture("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?r=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?r=6:r=-6,this._offsetY=-38,s=32):(this._asset=ae().getTexture("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?r=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?r=22:r=-30,this._offsetY=-70),this.visualization.posture===St.POSTURE_SIT?this._offsetY+=s/2:this.visualization.posture===St.POSTURE_LAY&&(this._offsetY+=s),this._asset){t.texture=this._asset,t.offsetX=r,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0;const n=this._delta;this.animate(t),this._delta=n}}animate(t){if(!t)return!1;if(this._asset&&(t.texture=this._asset),this._state===rr.STATE_DELAY)return zt()-this._startTime<rr.DELAY_BEFORE_ANIMATION?!1:(this._state=rr.STATE_FADE_IN,t.alpha=0,t.visible=!0,this._delta=0,!0);if(this._state===rr.STATE_FADE_IN)return this._delta+=.1,t.offsetY=this._offsetY,t.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(t.alpha=255,this._delta=0,this._state=rr.STATE_FLOAT),!0;if(this._state===rr.STATE_FLOAT){const e=Math.pow(this._delta,.9);this._delta+=.05;const s=this._scale<48?-30:-40;return t.offsetY=this._offsetY+(this._delta<1?e:1)*s,t.alpha=(1-e)*255,t.alpha<=0&&(t.visible=!1,this._state=rr.STATE_COMPLETE),!0}return!1}};rr.DELAY_BEFORE_ANIMATION=300,rr.STATE_DELAY=0,rr.STATE_FADE_IN=1,rr.STATE_FLOAT=2,rr.STATE_COMPLETE=3;let _T=rr;const Rl=class Rl{static getExpressionAddition(t,e,s){switch(e){case this.BLOW:return new _T(t,this.BLOW,s);default:return new BL(t,e,s)}}};Rl.WAVE=1,Rl.BLOW=2,Rl.LAUGH=3,Rl.CRY=4,Rl.IDLE=5;let gT=Rl;const hi=class hi{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._startTime=zt(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(t){let e="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(e="right"),"avatar_addition_user_idle_"+e+"_"+t+(this._scale<48?"_small":"")}update(t,e){if(!t)return;this._scale=e,this._asset=ae().getTexture(this.getSpriteAssetName(this._state===hi.STATE_FRAME_A?1:2));let s=64,r=0;e<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?r=10:r=-16,this._offsetY=-38,s=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?r=22:r=-30,this._offsetY=-70),this._visualization.posture===St.POSTURE_SIT?this._offsetY+=s/2:this._visualization.posture===St.POSTURE_LAY&&(this._offsetY+=s-.3*s),this._asset&&(t.texture=this._asset,t.offsetX=r,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0)}animate(t){if(!t)return!1;const e=zt();return this._state===hi.STATE_DELAY&&e-this._startTime>=hi.DELAY_BEFORE_ANIMATION&&(this._state=hi.STATE_FRAME_A,this._startTime=e,this._asset=ae().getTexture(this.getSpriteAssetName(1))),this._state===hi.STATE_FRAME_A&&e-this._startTime>=hi.DELAY_PER_FRAME&&(this._state=hi.STATE_FRAME_B,this._startTime=e,this._asset=ae().getTexture(this.getSpriteAssetName(2))),this._state===hi.STATE_FRAME_B&&e-this._startTime>=hi.DELAY_PER_FRAME&&(this._state=hi.STATE_FRAME_A,this._startTime=e,this._asset=ae().getTexture(this.getSpriteAssetName(1))),this._asset?(t.texture=this._asset,t.alpha=255,t.visible=!0):t.visible=!1,!1}get id(){return this._id}};hi.DELAY_BEFORE_ANIMATION=2e3,hi.DELAY_PER_FRAME=2e3,hi.STATE_DELAY=0,hi.STATE_FRAME_A=1,hi.STATE_FRAME_B=2;let fT=hi;const Hn=class Hn{constructor(t){this._id=t,this._asset=null}dispose(){this._asset&&(la().putTexture(this._asset),this._asset=null)}update(t,e){t&&(this._asset||(this._asset=la().getTexture(Hn.WIDTH,Hn.HEIGHT)),t.visible=!0,t.texture=this._asset,t.offsetX=Hn.OFFSET_X,t.offsetY=Hn.OFFSET_Y,t.alphaTolerance=Rn.MATCH_ALL_PIXELS)}animate(t){return!1}get id(){return this._id}};Hn.WIDTH=46,Hn.HEIGHT=60,Hn.OFFSET_X=-23,Hn.OFFSET_Y=-48;let mT=Hn;class v6{constructor(t,e,s){this._id=t,this._visualization=e,this._status=s,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,r=0,n=0;this._asset=ae().getTexture(this._status===Zn.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),e<48?(r=-19,n=-80,s=32):(r=-19,n=-120),this._visualization.posture===St.POSTURE_SIT?n+=s/2:this._visualization.posture===St.POSTURE_LAY&&(n+=e),this._asset&&(t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class P6{constructor(t,e){this._id=t,this._visualization=e,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;let s=64,r=0,n=0;e<48?(this._asset=ae().getTexture("avatar_addition_user_muted_small"),s=32,r=-12,n=-66):(this._asset=ae().getTexture("avatar_addition_user_muted"),r=-15,n=-110),this._visualization.posture===St.POSTURE_SIT?n+=s/2:this._visualization.posture===St.POSTURE_LAY&&(n+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.02):t.visible=!1}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}}class L6{constructor(t,e,s){this._id=t,this._number=e,this._visualization=s,this._asset=null,this._scale=0,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;this._scale=e;let s=64,r=0,n=0;this._number>0?(e<48?(this._asset=ae().getTexture("avatar_addition_number_"+this._number+"_small"),s=32,r=-6,n=-52):(this._asset=ae().getTexture("avatar_addition_number_"+this._number),r=-8,n=-105),this._visualization.posture===St.POSTURE_SIT?n+=s/2:this._visualization.posture===St.POSTURE_LAY&&(n+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.01,t.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):t.visible=!1):t.visible&&(this._numberValueFadeDirection=-1)}animate(t){if(!t)return!1;this._asset&&(t.texture=this._asset);let e=t.alpha,s=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?t.offsetY-=2:t.offsetY-=4;else{let r=4;this._scale<48&&(r=8),this._numberValueMoveCounter%r||(t.offsetY--,s=!0)}}return this._numberValueFadeDirection>0?(e<255&&(e+=32),e>=255&&(e=255,this._numberValueFadeDirection=0),t.alpha=e,!0):this._numberValueFadeDirection<0?(e>=0&&(e-=32),e<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,e=0,t.visible=!1),t.alpha=e,!0):s}get id(){return this._id}}class U6{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,r=0,n=0;e<48?(this._asset=ae().getTexture("avatar_addition_user_typing_small"),r=3,n=-42,s=32):(this._asset=ae().getTexture("avatar_addition_user_typing"),r=14,n=-83),this._visualization.posture===St.POSTURE_SIT?n+=s/2:this._visualization.posture===St.POSTURE_LAY&&(n+=e),this._asset&&(t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}const Tt=class Tt extends Nu{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new Is,this._cachedAvatarEffects=new Is,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(t){return t instanceof AS?(this._data=t,this.createSprites(Tt.INITIAL_RESERVED_SPRITES),super.initialize(t),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(t,e,s,r){if(!this.object||!t||!this._data||e<this._lastUpdate+Tt.UPDATE_TIME_INCREASER)return;this._lastUpdate+=Tt.UPDATE_TIME_INCREASER,this._lastUpdate+Tt.UPDATE_TIME_INCREASER<e&&(this._lastUpdate=e-Tt.UPDATE_TIME_INCREASER);const n=this.object.model,o=t.scale,l=this._effect;let c=!1,u=!1,h=!1,d=!1;const f=this.updateModel(n,o);if(f||o!==this._scale||!this._avatarImage){if(o!==this._scale&&(c=!0,this.updateScale(o)),l!==this._effect&&(u=!0),c||!this._avatarImage||u){if(this._avatarImage=this.createAvatarImage(o,this._effect),!this._avatarImage)return;h=!0;const I=this.getSprite(Tt.AVATAR_LAYER_ID);I&&this._avatarImage&&this._avatarImage.isPlaceholder()?I.alpha=150:I&&(I.alpha=255)}if(!this._avatarImage)return;if(u&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(o),d=this.updateObject(this.object,t,s,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.update(this.getSprite(I++),o)}this._scale=o}else d=this.updateObject(this.object,t,s);if(this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.animate(this.getSprite(I++))&&this.updateSpriteCounter++}const E=d||f||c,m=(this._isAnimating||this._forcedAnimFrames>0)&&s;if(E&&(this._forcedAnimFrames=Tt.ANIMATION_FRAME_UPDATE_INTERVAL),E||m){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||c||f||h)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=Tt.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let I=this._avatarImage.getCanvasOffsets();(!I||I.length<3)&&(I=Tt.DEFAULT_CANVAS_OFFSETS);const p=this.getSprite(Tt.SPRITE_INDEX_AVATAR);if(p){const L=this.object.model.getValue(A.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(A.FIGURE_HIGHLIGHT)===1,M=this._avatarImage.processAsTexture(ai.FULL,L);M&&(p.texture=M,L||(p.filters=[])),p.texture&&(p.offsetX=-1*o/2+I[0]-(p.texture.width-o)/2,p.offsetY=-p.texture.height+o/4+I[1]+this._postureOffset),this._isLaying?this._layInside?p.relativeDepth=-.5:p.relativeDepth=Tt.AVATAR_SPRITE_LAYING_DEPTH+I[2]:p.relativeDepth=Tt.AVATAR_SPRITE_DEFAULT_DEPTH+I[2],this._ownUser?(p.relativeDepth-=Tt.AVATAR_OWN_DEPTH_ADJUST,p.spriteType=Nr.AVATAR_OWN):p.spriteType=Nr.AVATAR}const T=this.getAddition(Tt.TYPING_BUBBLE_ID);T&&(this._isLaying?T.relativeDepth=Tt.AVATAR_SPRITE_LAYING_DEPTH-.01+I[2]:T.relativeDepth=Tt.AVATAR_SPRITE_DEFAULT_DEPTH-.01+I[2]),this._isAnimating=this._avatarImage.isAnimating();let R=Tt.INITIAL_RESERVED_SPRITES;const S=this._avatarImage.getDirection();for(const L of this._avatarImage.getSprites())if(L.id===Tt.AVATAR){const M=this.getSprite(Tt.SPRITE_INDEX_AVATAR);if(M){const P=this._avatarImage.getLayerData(L);let k=L.getDirectionOffsetX(S),G=L.getDirectionOffsetY(S);P&&(k+=P.dx,G+=P.dy),o<48&&(k/=2,G/=2),this._canStandUp||(M.offsetX+=k,M.offsetY+=G)}}else{const M=this.getSprite(R);if(M){M.alphaTolerance=Rn.MATCH_NOTHING,M.visible=!0;const P=this._avatarImage.getLayerData(L);let k=0,G=L.getDirectionOffsetX(S),j=L.getDirectionOffsetY(S);const F=L.getDirectionOffsetZ(S);let U=0;L.hasDirections&&(U=S),P&&(k=P.animationFrame,G+=P.dx,j+=P.dy,U+=P.dd),o<48&&(G/=2,j/=2),U<0?U+=8:U>7&&(U-=8);const K=this._avatarImage.getScale()+"_"+L.member+"_"+U+"_"+k,B=ae().getAsset(K);if(!B)continue;M.texture=B.texture,M.offsetX=B.offsetX-o/2+G,M.offsetY=B.offsetY+j,M.flipH=B.flipH,L.hasStaticY?M.offsetY+=this._verticalOffset*o/(2*Tt.BASE_Y_SCALE):M.offsetY+=this._postureOffset,this._isLaying?M.relativeDepth=Tt.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*F:M.relativeDepth=Tt.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*F,L.ink===33?M.blendMode="add":M.blendMode="normal"}R++}}}createAvatarImage(t,e){let s=null,r="avatarImage"+t.toString();if(e?(r+="-"+e,s=this._cachedAvatarEffects.getValue(r)):s=this._cachedAvatars.getValue(r),!s&&(s=this._data.createAvatarImage(this._figure,t,this._gender,this,this),s))if(!e)this._cachedAvatars.add(r,s);else{if(this._cachedAvatarEffects.length>=Tt.MAX_EFFECT_CACHE){const n=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));n&&n.dispose()}this._cachedAvatarEffects.add(r,s)}return s}updateObject(t,e,s,r=!1){if(!r&&this.updateObjectCounter===t.updateCounter&&this._geometryUpdateCounter===e.updateId)return!1;let n=t.getDirection().x-e.direction.x,o=this._headDirection-e.direction.x;return this._posture==="float"&&(o=n),n=(n%360+360)%360,o=(o%360+360)%360,this._posture==="sit"&&this._canStandUp&&(n-=n%90-45,o-=o%90-45),(n!==this._angle||r)&&(s=!0,this._angle=n,n=n-(135-22.5),n=(n+360)%360,this._avatarImage.setDirectionAngle(ai.FULL,n)),(o!==this._headAngle||r)&&(s=!0,this._headAngle=o,this._headAngle!==this._angle&&(o=o-(135-22.5),o=(o+360)%360,this._avatarImage.setDirectionAngle(ai.HEAD,o))),this._geometryUpdateCounter=e.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(t,e){if(!t||this.updateModelCounter===t.updateCounter)return!1;let s=!1;const r=t.getValue(A.FIGURE_TALK)>0;r!==this._talk&&(this._talk=r,s=!0);const n=t.getValue(A.FIGURE_EXPRESSION);n!==this._expression&&(this._expression=n,s=!0);const o=t.getValue(A.FIGURE_SLEEP)>0;o!==this._sleep&&(this._sleep=o,s=!0);const l=t.getValue(A.FIGURE_BLINK)>0;l!==this._blink&&(this._blink=l,s=!0);const c=t.getValue(A.FIGURE_GESTURE)||0;c!==this._gesture&&(this._gesture=c,s=!0);const u=t.getValue(A.FIGURE_POSTURE);u!==this._posture&&(this._posture=u,s=!0);const h=t.getValue(A.FIGURE_POSTURE_PARAMETER);h!==this._postureParameter&&(this._postureParameter=h,s=!0);const d=t.getValue(A.FIGURE_CAN_STAND_UP);d!==this._canStandUp&&(this._canStandUp=d,s=!0);const f=t.getValue(A.FIGURE_VERTICAL_OFFSET)*Tt.BASE_Y_SCALE;f!==this._verticalOffset&&(this._verticalOffset=f,s=!0);const E=t.getValue(A.FIGURE_DANCE)||0;E!==this._dance&&(this._dance=E,s=!0);const m=t.getValue(A.FIGURE_EFFECT)||0;m!==this._effect&&(this._effect=m,s=!0);const I=t.getValue(A.FIGURE_CARRY_OBJECT)||0;I!==this._carryObject&&(this._carryObject=I,s=!0);const p=t.getValue(A.FIGURE_USE_OBJECT)||0;p!==this._useObject&&(this._useObject=p,s=!0);const T=t.getValue(A.HEAD_DIRECTION);T!==this._headDirection&&(this._headDirection=T,s=!0),this._carryObject>0&&p>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,s=!0):this._useObject!==0&&(this._useObject=0,s=!0);let R=this.getAddition(Tt.FLOATING_IDLE_Z_ID);this._sleep?(R||(R=this.addAddition(new fT(Tt.FLOATING_IDLE_Z_ID,this))),s=!0):R&&this.removeAddition(Tt.FLOATING_IDLE_Z_ID);const S=t.getValue(A.FIGURE_IS_MUTED)>0;let L=this.getAddition(Tt.MUTED_BUBBLE_ID);if(S)L||(L=this.addAddition(new P6(Tt.MUTED_BUBBLE_ID,this))),s=!0;else{L&&(this.removeAddition(Tt.MUTED_BUBBLE_ID),s=!0);const Z=t.getValue(A.FIGURE_IS_TYPING)>0;let Q=this.getAddition(Tt.TYPING_BUBBLE_ID);Z?(Q||(Q=this.addAddition(new U6(Tt.TYPING_BUBBLE_ID,this))),s=!0):Q&&(this.removeAddition(Tt.TYPING_BUBBLE_ID),s=!0)}const M=t.getValue(A.FIGURE_GUIDE_STATUS)||0;M!==Zn.NONE?(this.removeAddition(Tt.GUIDE_BUBBLE_ID),this.addAddition(new v6(Tt.GUIDE_BUBBLE_ID,this,M)),s=!0):this.getAddition(Tt.GUIDE_BUBBLE_ID)&&(this.removeAddition(Tt.GUIDE_BUBBLE_ID),s=!0);const P=t.getValue(A.FIGURE_IS_PLAYING_GAME)>0;let k=this.getAddition(Tt.GAME_CLICK_TARGET_ID);P?(k||(k=this.addAddition(new mT(Tt.GAME_CLICK_TARGET_ID))),s=!0):k&&this.removeAddition(Tt.GAME_CLICK_TARGET_ID);const G=t.getValue(A.FIGURE_NUMBER_VALUE);let j=this.getAddition(Tt.NUMBER_BUBBLE_ID);G>0?(j||(j=this.addAddition(new L6(Tt.NUMBER_BUBBLE_ID,G,this))),s=!0):j&&this.removeAddition(Tt.NUMBER_BUBBLE_ID);let F=this.getAddition(Tt.EXPRESSION_ID);this._expression>0?F||(F=gT.getExpressionAddition(Tt.EXPRESSION_ID,this._expression,this),F&&this.addAddition(F)):F&&this.removeAddition(Tt.EXPRESSION_ID),this.updateScale(e);const U=t.getValue(A.GENDER);U!==this._gender&&(this._gender=U,s=!0),this.updateFigure(t.getValue(A.FIGURE))&&(s=!0);let K=t.getValue(A.FIGURE_SIGN);K===null&&(K=-1),this._sign!==K&&(this._sign=K,s=!0);const B=t.getValue(A.FIGURE_HIGHLIGHT_ENABLE)>0;if(B!==this._highlightEnabled&&(this._highlightEnabled=B,s=!0),this._highlightEnabled){const Z=t.getValue(A.FIGURE_HIGHLIGHT)>0;Z!==this._highlight&&(this._highlight=Z,s=!0)}const J=t.getValue(A.OWN_USER)>0;return J!==this._ownUser&&(this._ownUser=J,s=!0),this.updateModelCounter=t.updateCounter,s}setDirection(t){this._direction!==t&&(this._direction=t,this._needsUpdate=!0)}updateScale(t){t<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=t/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(t){if(!t)return;if(t.initActionAppends(),t.appendAction(St.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(St.GESTURE,St.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(St.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(St.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(St.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(St.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(St.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(St.SLEEP),this._expression>0){const s=St.getExpression(this._expression);if(s!=="")switch(s){case St.DANCE:this._avatarImage.appendAction(St.DANCE,2);break;default:this._avatarImage.appendAction(s);break}}this._effect>0&&this._avatarImage.appendAction(St.EFFECT,this._effect),t.endActionAppends(),this._isAnimating=t.isAnimating();let e=Tt.INITIAL_RESERVED_SPRITES;for(const s of this._avatarImage.getSprites())s.id!==Tt.AVATAR&&e++;if(e!==this.totalSprites&&this.createSprites(e),this._extraSpritesStartIndex=e,this._additions)for(const s of this._additions.values())this.createSprite()}updateFigure(t){return this._figure===t?!1:(this._figure=t,this.clearAvatar(),!0)}resetFigure(t){this.clearAvatar()}resetEffect(t){this.clearAvatar()}clearAvatar(){const t=this.getSprite(Tt.AVATAR_LAYER_ID);t&&(t.texture=Es.EMPTY,t.alpha=255);for(const e of this._cachedAvatars.getValues())e&&e.dispose();for(const e of this._cachedAvatarEffects.getValues())e&&e.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null}getAddition(t){if(!this._additions)return null;const e=this._additions.get(t);return e||null}addAddition(t){if(!this.getAddition(t.id))return this._additions.set(t.id,t),t}removeAddition(t){const e=this.getAddition(t);e&&(this._additions.delete(e.id),e.dispose())}updateShadow(t){this._shadow=null;const e=this.getSprite(Tt.SHADOW_LAYER_ID);if(!e)return;let s=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===Tt.SNOWBOARDING_EFFECT&&(s=!1),s){if(e.visible=!0,!this._shadow||t!==this._scale){let r=0,n=0;t<48?(e.libraryAssetName="sh_std_sd_1_0_0",this._shadow=ae().getAsset(e.libraryAssetName),r=-8,n=this._canStandUp?6:-3):(e.libraryAssetName="h_std_sd_1_0_0",this._shadow=ae().getAsset(e.libraryAssetName),r=-17,n=this._canStandUp?10:-7),this._shadow?(e.texture=this._shadow.texture,e.offsetX=r,e.offsetY=n,e.alpha=50,e.relativeDepth=1):e.visible=!1}}else this._shadow=null,e.visible=!1}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}};Tt.AVATAR="avatar",Tt.FLOATING_IDLE_Z_ID=1,Tt.TYPING_BUBBLE_ID=2,Tt.EXPRESSION_ID=3,Tt.NUMBER_BUBBLE_ID=4,Tt.GAME_CLICK_TARGET_ID=5,Tt.MUTED_BUBBLE_ID=6,Tt.GUIDE_BUBBLE_ID=7,Tt.OWN_USER_ID=4,Tt.UPDATE_TIME_INCREASER=41,Tt.AVATAR_LAYER_ID=0,Tt.SHADOW_LAYER_ID=1,Tt.SNOWBOARDING_EFFECT=97,Tt.INITIAL_RESERVED_SPRITES=2,Tt.ANIMATION_FRAME_UPDATE_INTERVAL=2,Tt.DEFAULT_CANVAS_OFFSETS=[0,0,0],Tt.MAX_EFFECT_CACHE=2,Tt.SPRITE_INDEX_AVATAR=0,Tt.BASE_Y_SCALE=1e3,Tt.AVATAR_SPRITE_DEFAULT_DEPTH=-.01,Tt.AVATAR_OWN_DEPTH_ADJUST=.001,Tt.AVATAR_SPRITE_LAYING_DEPTH=-.409;let ET=Tt;const nr=class nr{static allocate(t,e,s,r,n,o,l=-1,c=0){const u=nr.POOL.length?nr.POOL.pop():new nr;return r<1&&(r=1),n<0&&(n=nr.FRAME_REPEAT_FOREVER),u._id=t,u._x=e||0,u._y=s||0,u._repeats=r,u._frameRepeats=n,u._remainingFrameRepeats=n,u._isLastFrame=o,u._isRecycled=!1,l>=0?(u._activeSequence=l,u._activeSequenceOffset=c):(u._activeSequence=-1,u._activeSequenceOffset=0),u}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?nr.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(t){t<0&&(t=0),this._frameRepeats>0&&t>this._frameRepeats&&(t=this._frameRepeats),this._remainingFrameRepeats=t}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,nr.POOL.length<nr.POOL_SIZE_LIMIT&&nr.POOL.push(this))}};nr.FRAME_REPEAT_FOREVER=-1,nr.SEQUENCE_NOT_DEFINED=-1,nr.POOL_SIZE_LIMIT=3e3,nr.POOL=[];let Fo=nr;class VL{constructor(t,e,s,r,n,o){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=t,this._x=e,this._y=s,this._randomX=r,this._randomY=n,this._repeats=o}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(t){return this._x}getY(t){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class j6 extends VL{constructor(t,e,s,r,n,o,l){super(t,e,s,r,n,l),this._directionalOffsets=o}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(t){return this._directionalOffsets?this._directionalOffsets.getXOffset(t,super.getX(t)):super.getX(t)}getY(t){return this._directionalOffsets?this._directionalOffsets.getYOffset(t,super.getY(t)):super.getY(t)}}class w6{constructor(t,e){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=e,this._loopCount=t<1?1:t}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let t=this._frameIndexes.length-1,e=-1,s=1;for(;t>=0;)this._frameIndexes[t]===e?s++:(e=this._frameIndexes[t],s=1),this._frameRepeats[t]=s,t--}addFrame(t,e,s,r,n,o){let l=1;if(this._frames.length>0){const u=this._frames[this._frames.length-1];u.id===t&&!u.hasDirectionalOffsets()&&u.x===e&&u.y===s&&u.randomX===r&&r===0&&u.randomY===n&&n===0&&(l+=u.repeats,this._frames.pop())}const c=o?new j6(t,e,s,r,n,o,l):new VL(t,e,s,r,n,l);this._frames.push(c),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(t){return!this._frames.length||t<0||t>=this.frameCount?null:this._frames[this._frameIndexes[t%this._frameIndexes.length]]}getFrameIndex(t){return t<0||t>=this.frameCount?-1:(this._isRandom&&(t=Math.round(Math.random()*this._frameIndexes.length),t===this._frameIndexes.length&&t--),t)}getRepeats(t){return t<0||t>=this.frameCount?0:this._frameRepeats[t%this._frameRepeats.length]}}class F6{constructor(t,e,s){this._frameSequences=[],this._frameCount=-1,this._loopCount=t<0?0:t,this._frameRepeat=e<1?1:e,this._isRandom=s}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const t of this._frameSequences)t&&t.dispose();this._frameSequences=[]}}addFrameSequence(t,e){const s=new w6(t,e);return this._frameSequences.push(s),s}calculateLength(){this._frameCount=0;for(const t of this._frameSequences)t&&(this._frameCount+=t.frameCount)}getFrame(t,e){if(this._frameCount<1)return null;if(e=e/this._frameRepeat,!this._isRandom){const n=Math.floor(e/this._frameCount);e=Math.floor(e%this._frameCount);let o=!1,l=null;(this._loopCount>0&&n>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(e=this._frameCount-1,o=!0);let c=0,u=0;for(;u<this._frameSequences.length;){if(l=this._frameSequences[u],l){if(e<c+l.frameCount)break;c+=l.frameCount}u++}return this.getFrameFromSpecificSequence(t,l,u,e-c,o)}const s=Math.trunc(this._frameSequences.length*Math.random()),r=this._frameSequences[s];return r.frameCount<1?null:this.getFrameFromSpecificSequence(t,r,s,0,!1)}getFrameFromSequence(t,e,s,r){if(e<0||e>=this._frameSequences.length)return null;const n=this._frameSequences[e];return n?s>=n.frameCount?this.getFrame(t,r):this.getFrameFromSpecificSequence(t,n,e,s,!1):null}getFrameFromSpecificSequence(t,e,s,r,n){if(!e)return null;const o=e.getFrameIndex(r),l=e.getFrame(o);if(!l)return null;let c=l.getX(t),u=l.getY(t);const h=l.randomX,d=l.randomY;let f=l.repeats,E=!1;h&&(c=Math.trunc(c+h*Math.random())),d&&(u=Math.trunc(u+d*Math.random())),f>1&&(f=e.getRepeats(o));let m=this._frameRepeat*f;return n&&(m=Fo.FRAME_REPEAT_FOREVER),!this._isRandom&&!e.isRandom&&s===this._frameSequences.length-1&&r===e.frameCount-1&&(E=!0),Fo.allocate(l.id,c,u,f,m,E,s,r)}}class HL{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(t,e){const s=this._offsetX.get(t);return s??e}getYOffset(t,e){const s=this._offsetY.get(t);return s??e}setDirection(t,e,s){this._offsetX.set(t,e),this._offsetY.set(t,s)}}const Wn=class Wn{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(t){return Wn.TRANSITION_TO_ANIMATION_OFFSET+t}static getTransitionFromAnimationId(t){return Wn.TRANSITION_FROM_ANIMATION_OFFSET+t}static isTransitionToAnimation(t){return t>=Wn.TRANSITION_TO_ANIMATION_OFFSET&&t<Wn.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(t){return t>=Wn.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const t of this._layers.values())t&&t.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(t){this._immediateChanges=t}isImmediateChange(t){return!(!this._immediateChanges||this._immediateChanges.indexOf(t)===-1)}getStartFrame(t){return this._randomStart?Math.random()*this._frameCount:0}initialize(t){if(t.randomStart&&(this._randomStart=!0),t.layers)for(const e in t.layers){const s=t.layers[e];if(!s)return!1;const r=parseInt(e),n=s.loopCount!==void 0?s.loopCount:1,o=s.frameRepeat!==void 0?s.frameRepeat:1,l=s.random!==void 0&&s.random!==0;if(!this.addLayer(r,n,o,l,s))return!1}return!0}addLayer(t,e,s,r,n){const o=new F6(e,s,r);if(n.frameSequences)for(const c in n.frameSequences){const u=n.frameSequences[c];if(!u)continue;const h=u.loopCount!==void 0?u.loopCount:1,d=u.random!==void 0&&u.random!==0,f=o.addFrameSequence(h,d);if(u.frames)for(const E in u.frames){const m=u.frames[E];if(!m)return o.dispose(),!1;f.addFrame(m.id,m.x||0,m.y||0,m.randomX||0,m.randomY||0,this.readDirectionalOffsets(m))}f.initialize()}o.calculateLength(),this._layers.set(t,o);const l=o.frameCount;return l>this._frameCount&&(this._frameCount=l),!0}readDirectionalOffsets(t){let e=null;if(t&&t.offsets)for(const s in t.offsets){const r=t.offsets[s];r&&(e||(e=new HL),e.setDirection(r.direction,r.x,r.y))}return e}getFrame(t,e,s){const r=this._layers.get(e);return r?r.getFrame(t,s):null}getFrameFromSequence(t,e,s,r,n){const o=this._layers.get(e);return o?o.getFrameFromSequence(t,s,r,n):null}};Wn.TRANSITION_TO_ANIMATION_OFFSET=1e6,Wn.TRANSITION_FROM_ANIMATION_OFFSET=2e6,Wn.DEFAULT_FRAME_NUMBER=0;let Ys=Wn;const Ah=class Ah{constructor(t){this._colors=[],this.createColors(t)}createColors(t){if(t)for(let e=0;e<t;e++)this._colors.push(Ah.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(t){const e=this._colors[t];return e||Ah.DEFAULT_COLOR}setColorLayer(t,e){this._colors[t]&&(this._colors[t]=e)}};Ah.DEFAULT_COLOR=16777215;let Yl=Ah;const ei=class ei{constructor(){this._tag=ei.DEFAULT_TAG,this._blendMode=ei.DEFAULT_BLEND_MODE,this._alpha=ei.DEFAULT_ALPHA,this._ignoreMouse=ei.DEFAULT_IGNORE_MOUSE,this._xOffset=ei.DEFAULT_XOFFSET,this._yOffset=ei.DEFAULT_YOFFSET,this._zOffset=ei.DEFAULT_ZOFFSET}setFromLayer(t){t&&(this._tag=t.tag,this._blendMode=t.blendMode,this._alpha=t.alpha,this._ignoreMouse=t.ignoreMouse,this._xOffset=t.xOffset,this._yOffset=t.yOffset,this._zOffset=t.zOffset)}get tag(){return this._tag}set tag(t){this._tag=t}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(t){this._ignoreMouse=t}get xOffset(){return this._xOffset}set xOffset(t){this._xOffset=t}get yOffset(){return this._yOffset}set yOffset(t){this._yOffset=t}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset=t}};ei.DEFAULT_COUNT=0,ei.DEFAULT_DIRECTION=0,ei.DEFAULT_TAG="",ei.DEFAULT_BLEND_MODE="normal",ei.DEFAULT_ALPHA=255,ei.DEFAULT_IGNORE_MOUSE=!1,ei.DEFAULT_XOFFSET=0,ei.DEFAULT_YOFFSET=0,ei.DEFAULT_ZOFFSET=0;let ve=ei;const OO=class OO{constructor(t){this._layers=[],this.createLayers(t)}createLayers(t){if(t)for(let e=0;e<t;e++)this._layers.push(new ve)}dispose(){this._layers=[]}setFromDirection(t){if(!t)return;const e=this.layerCount;if(e===t.layerCount)for(let s=0;s<e;s++){const r=this.getLayer(s),n=t.getLayer(s);r&&r.setFromLayer(n)}}getLayer(t){const e=this._layers[t];return e||null}getLayerTag(t){const e=this.getLayer(t);return e?e.tag:ve.DEFAULT_TAG}setLayerTag(t,e){const s=this.getLayer(t);s&&(s.tag=e)}getLayerBlendMode(t){const e=this.getLayer(t);return e?e.blendMode:ve.DEFAULT_BLEND_MODE}setLayerBlendMode(t,e){const s=this.getLayer(t);s&&(!e||!e.length||(s.blendMode=e))}getLayerAlpha(t){const e=this.getLayer(t);return e?e.alpha:ve.DEFAULT_ALPHA}setLayerAlpha(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.alpha=e))}getLayerIgnoreMouse(t){const e=this.getLayer(t);return e?e.ignoreMouse:ve.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(t,e){const s=this.getLayer(t);s&&(s.ignoreMouse=e||!1)}getLayerXOffset(t){const e=this.getLayer(t);return e?e.xOffset:ve.DEFAULT_XOFFSET}setLayerXOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.xOffset=e))}getLayerYOffset(t){const e=this.getLayer(t);return e?e.yOffset:ve.DEFAULT_YOFFSET}setLayerYOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.yOffset=e))}getLayerZOffset(t){const e=this.getLayer(t);return e?e.zOffset:ve.DEFAULT_ZOFFSET}setLayerZOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.zOffset=e))}get layerCount(){return this._layers.length}};OO.USE_DEFAULT_DIRECTION=-1;let Do=OO;const Nh=class Nh{constructor(t,e){this._layerCount=t<0?0:t>Nh.MAX_LAYERS?Nh.MAX_LAYERS:t,this._angle=e<1?1:e>360?360:e,this._defaultDirection=new Do(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const t of this._directions.values())t&&t.dispose();for(const t of this._colors)t&&t.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(t){return t?this.setDirectionLayers(this._defaultDirection,t):!1}processDirections(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const r=parseInt(e);if(this._directions.get(r))return!1;const n=new Do(this._layerCount);n.setFromDirection(this._defaultDirection),this.setDirectionLayers(n,s.layers),this._directions.set(r,n),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const r=parseInt(e);if(this._colors[r])return!1;const n=new Yl(this._layerCount);for(const o in s.layers){const l=s.layers[o];if(!l)continue;const c=parseInt(o),u=l.color;n.setColorLayer(c,u)}this._colors[r]=n}return!0}setDirectionLayers(t,e){var s;if(!t||!e)return!1;for(const r in e){const n=e[r];if(!n)continue;const o=parseInt(r);if(o<0||o>=this._layerCount)return!1;n.ink!==void 0&&t.setLayerBlendMode(o,(s=n.ink)==null?void 0:s.toLowerCase()),n.tag!==void 0&&t.setLayerTag(o,n.tag),n.alpha!==void 0&&t.setLayerAlpha(o,n.alpha),n.ignoreMouse!==void 0&&t.setLayerIgnoreMouse(o,n.ignoreMouse),n.x!==void 0&&t.setLayerXOffset(o,n.x),n.y!==void 0&&t.setLayerYOffset(o,n.y),n.z!==void 0&&t.setLayerZOffset(o,n.z/-1e3)}return!0}getValidDirection(t){if(this._directions.get(t))return t;t=(t%360+360)%360;let s=-1,r=-1;for(const n of this._directions.keys()){let o=(n*this._angle-t+360)%360;o>180&&(o=360-o),(o<s||s<0)&&(s=o,r=n)}return r>=0?Math.trunc(r):0}getDirectionData(t){if(t===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let e=this._directions.get(t);return e||(e=this._defaultDirection),this._lastDirection=t,this._lastDirectionData=e,this._lastDirectionData}getLayerTag(t,e){const s=this.getDirectionData(t);return s?s.getLayerTag(e):ve.DEFAULT_TAG}getLayerBlendMode(t,e){const s=this.getDirectionData(t);return s?s.getLayerBlendMode(e):ve.DEFAULT_BLEND_MODE}getLayerAlpha(t,e){const s=this.getDirectionData(t);return s?s.getLayerAlpha(e):ve.DEFAULT_ALPHA}getLayerColor(t,e){const s=this._colors[e];return s?s.getLayerColor(t):Yl.DEFAULT_COLOR}getLayerIgnoreMouse(t,e){const s=this.getDirectionData(t);return s?s.getLayerIgnoreMouse(e):ve.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerXOffset(e):ve.DEFAULT_XOFFSET}getLayerYOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerYOffset(e):ve.DEFAULT_YOFFSET}getLayerZOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerZOffset(e):ve.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}};Nh.MAX_LAYERS=26;let Eg=Nh;class pg extends Eg{constructor(t,e){super(t,e),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const t of this._animations.values())t&&t.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(t){if(!t)return!0;for(const e in t){const s=t[e];if(!s)return!1;let r=parseInt(e.split("_")[0]),n=!1;const o=s.transitionTo,l=s.transitionFrom;o!==void 0&&(r=Ys.getTransitionToAnimationId(o),n=!0),l!==void 0&&(r=Ys.getTransitionFromAnimationId(l),n=!0);const c=this.createAnimationData();if(!c.initialize(s))return c.dispose(),!1;const u=s.immediateChangeFrom;if(u!==void 0){const h=u.split(","),d=[];for(const f of h){const E=parseInt(f);d.indexOf(E)===-1&&d.push(E)}c.setImmediateChanges(d)}this._animations.set(r,c),n||this._animationIds.push(r)}return!0}createAnimationData(){return new Ys}hasAnimation(t){return!!this._animations.get(t)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(t){const e=this.getAnimationCount();return t<0||e<=0?0:this._animationIds[t%e]}isImmediateChange(t,e){const s=this._animations.get(t);return s?s.isImmediateChange(e):!1}getStartFrame(t,e){const s=this._animations.get(t);return s?s.getStartFrame(e):0}getFrame(t,e,s,r){const n=this._animations.get(t);return n?n.getFrame(e,s,r):null}getFrameFromSequence(t,e,s,r,n,o){const l=this._animations.get(t);return l?l.getFrameFromSequence(e,s,r,n,o):null}}class WL{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(t){this._animationOver=t}get frameCounter(){return this._frameCounter}set frameCounter(t){this._frameCounter=t}get animationId(){return this._animationId}set animationId(t){t!==this._animationId&&(this._animationId=t,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(t){this._animationAfterTransitionId=t}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(t){this._layerCount=t,this.resetAnimationFrames()}resetAnimationFrames(t=!0){(t||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let e=0;for(;e<this._layerCount;){if(t||this._frames.length<=e)this._frames[e]=null;else{const s=this._frames[e];s&&(s.recycle(),this._frames[e]=Fo.allocate(s.id,s.x,s.y,s.repeats,0,s.isLastFrame))}this._lastFramePlayed[e]=!1,this._animationPlayed[e]=!1,e++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const t of this._frames)t&&t.recycle()}getFrame(t){return t<0||t>=this._layerCount?null:this._frames[t]}setFrame(t,e){if(t<0||t>=this._layerCount)return;const s=this._frames[t];s&&s.recycle(),this._frames[t]=e}getAnimationPlayed(t){return t<0||t>=this._layerCount?!0:this._animationPlayed[t]}setAnimationPlayed(t,e){t<0||t>=this._layerCount||(this._animationPlayed[t]=e)}getLastFramePlayed(t){return t<0||t>=this._layerCount?!0:this._lastFramePlayed[t]}setLastFramePlayed(t,e){t<0||t>=this._layerCount||(this._lastFramePlayed[t]=e)}}const lm=class lm extends pg{constructor(){super(...arguments),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(t){if(!t||(t.defaultPosture&&t.defaultPosture.length&&(this._defaultPosture=t.defaultPosture),!t.postures))return!1;for(const e of t.postures)this._posturesToAnimations.get(e.id)||(this._defaultPosture===null&&(this._defaultPosture=e.id),this._posturesToAnimations.set(e.id,e.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(t){if(!t)return!1;for(const e of t)this._gesturesToAnimations.get(e.id)||this._gesturesToAnimations.set(e.id,e.animationId);return!0}postureToAnimation(t){return this._posturesToAnimations.get(t)||(t=this._defaultPosture),this._posturesToAnimations.get(t)}getGestureDisabled(t){return t==="ded"}gestureToAnimation(t){return this._gesturesToAnimations.get(t)?this._gesturesToAnimations.get(t):lm.DEFAULT}animationToPosture(t,e){if(t>=0&&t<this._posturesToAnimations.size){const s=this._posturesToAnimations.keys();for(;;){const r=s.next();if(r.done)return null;if(t<=0)return r.value;--t}}return e?this._defaultPosture:null}animationToGesture(t){if(t>=0&&t<this._gesturesToAnimations.size){const e=this._gesturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return null}getGestureForAnimationId(t){for(const e of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(e)===t)return e;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}};lm.DEFAULT=-1;let il=lm;const AO=class AO{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(t){return this.reset(),t?(this._type=t.name,this.defineVisualizations(t.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(t,e,s){return new Eg(e,s)}defineVisualizations(t){if(!t)return!1;for(const e of Object.keys(t)){const s=t[e],r=s.layerCount,n=s.angle;let o=s.size;if(o<1&&(o=1),this._sizeDatas.get(o))return!1;const l=this.createSizeData(o,r,n);if(!l)return!1;for(const c in s){const u=s[c];if(!this.processVisualElement(l,c,u))return l.dispose(),!1}this._sizeDatas.set(o,l),this._sizes.push(o)}return this._sizes.sort(),!0}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"layers":if(!t.processLayers(s))return!1;break;case"directions":if(!t.processDirections(s))return!1;break;case"colors":if(!t.processColors(s))return!1;break}return!0}getValidSize(t){if(t===this._lastSizeScale)return this._lastSize;const e=this.getSizeIndex(t);let s=-1;return e<this._sizes.length&&(s=this._sizes[e]),this._lastSizeScale=t,this._lastSize=s,s}getSizeIndex(t){if(t<=0)return 0;let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]/t<t/this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getSizeData(t){if(t===this._lastSizeDataScale)return this._lastSizeData;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[e]):this._lastSizeData=null,this._lastSizeDataScale=t,this._lastSizeData}getLayerCount(t){const e=this.getSizeData(t);return e?e.layerCount:ve.DEFAULT_COUNT}getValidDirection(t,e){const s=this.getSizeData(t);return s?s.getValidDirection(e):ve.DEFAULT_DIRECTION}getLayerTag(t,e,s){const r=this.getSizeData(t);return r?r.getLayerTag(e,s):ve.DEFAULT_TAG}getLayerBlendMode(t,e,s){const r=this.getSizeData(t);return r?r.getLayerBlendMode(e,s):ve.DEFAULT_BLEND_MODE}getLayerAlpha(t,e,s){const r=this.getSizeData(t);return r?r.getLayerAlpha(e,s):ve.DEFAULT_ALPHA}getLayerColor(t,e,s){const r=this.getSizeData(t);return r?r.getLayerColor(e,s):Yl.DEFAULT_COLOR}getLayerIgnoreMouse(t,e,s){const r=this.getSizeData(t);return r?r.getLayerIgnoreMouse(e,s):ve.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e,s){const r=this.getSizeData(t);return r?r.getLayerXOffset(e,s):ve.DEFAULT_XOFFSET}getLayerYOffset(t,e,s){const r=this.getSizeData(t);return r?r.getLayerYOffset(e,s):ve.DEFAULT_YOFFSET}getLayerZOffset(t,e,s){const r=this.getSizeData(t);return r?r.getLayerZOffset(e,s):ve.DEFAULT_ZOFFSET}get type(){return this._type}};AO.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];let ca=AO;class NS extends ca{createSizeData(t,e,s){return new pg(e,s)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"animations":if(!(t instanceof pg)||!t.defineAnimations(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}hasAnimation(t,e){const s=this.getSizeData(t);return s?s.hasAnimation(e):null}getAnimationCount(t){const e=this.getSizeData(t);return e?e.getAnimationCount():null}getAnimationId(t,e){const s=this.getSizeData(t);return s?s.getAnimationId(e):null}isImmediateChange(t,e,s){const r=this.getSizeData(t);return r?r.isImmediateChange(e,s):null}getStartFrame(t,e,s){const r=this.getSizeData(t);return r?r.getStartFrame(e,s):null}getFrame(t,e,s,r,n){const o=this.getSizeData(t);return o?o.getFrame(e,s,r,n):null}getFrameFromSequence(t,e,s,r,n,o,l){const c=this.getSizeData(t);return c?c.getFrameFromSequence(e,s,r,n,o,l):null}}const Ch=class Ch extends Nu{constructor(){super(),this._filters=[],this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteBlendModes=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0,this._lookThrough=!1}initialize(t){return this.reset(),t instanceof ca?(this._type=t.type,this._data=t,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteBlendModes=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null,this._filters=[]}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteBlendModes=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(t,e){this._cacheDirection===e&&this._cacheScale===t||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteBlendModes=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=e,this._cacheScale=t,this._cacheSize=this.getValidSize(t),this.setLayerCount((this._data&&this._data.getLayerCount(t)||0)+this.getAdditionalLayerCount()))}update(t,e,s,r){if(!t)return;const n=t.scale;let o=!1;this.updateObject(n,t.direction.x)&&(o=!0),this.updateModel(n)&&(o=!0),this._needsLookThroughUpdate&&(o=!0,this._needsLookThroughUpdate=!1);let l=0;r?this._animationNumber=this._animationNumber|this.updateAnimation(n):(l=this.updateAnimation(n)|this._animationNumber,this._animationNumber=0),(o||l!==0)&&(this.updateSprites(n,o,l),this._scale=n,this.updateSpriteCounter++)}updateObject(t,e){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&t===this._scale&&this._lastCameraAngle===e)return!1;let s=this.object.getDirection().x-(e+135);if(s=(s%360+360)%360,this._data){const r=this._data.getValidDirection(t,s);this.setDirection(r)}return this._lastCameraAngle=e,this._scale=t,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(t,this._direction),!0}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;this._selectedColor=e.getValue(A.FURNITURE_COLOR),this._clickUrl=e.getValue(A.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=e.getValue(A.FURNITURE_LIFT_AMOUNT)||0;let s=e.getValue(A.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=e.updateCounter,!0}updateSprites(t,e,s){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),e){let r=this.totalSprites-1;for(;r>=0;)this.updateSprite(t,r),r--}else{let r=0;for(;s>0;)s&&this.updateSprite(t,r),r++,s=s>>1}this._alphaChanged=!1}updateSprite(t,e){const s=this.getSpriteAssetName(t,e),r=this.getSprite(e);if(s&&r){const n=this.getAsset(s,e);if(n){r.visible=!0,r.type=this._type,r.texture=this.getTexture(t,e,n),r.flipH=n.flipH,r.flipV=n.flipV,r.direction=this._direction;let o=0;e!==this._shadowLayerIndex?(r.tag=this.getLayerTag(t,this._direction,e),r.alpha=this.getLayerAlpha(t,this._direction,e),r.color=this.getLayerColor(t,e,this._selectedColor),r.offsetX=n.offsetX+this.getLayerXOffset(t,this._direction,e),r.offsetY=n.offsetY+this.getLayerYOffset(t,this._direction,e),r.blendMode=this.getLayerBlendMode(t,this._direction,e),r.alphaTolerance=this.getLayerIgnoreMouse(t,this._direction,e)?Rn.MATCH_NOTHING:Rn.MATCH_OPAQUE_PIXELS,o=this.getLayerZOffset(t,this._direction,e),o=o-e*.001):(r.offsetX=n.offsetX,r.offsetY=n.offsetY+this.getLayerYOffset(t,this._direction,e),r.alpha=48*this._alphaMultiplier,r.alphaTolerance=Rn.MATCH_NOTHING,o=1),this._lookThrough&&(r.alpha*=.2),r.relativeDepth=o*Ch.DEPTH_MULTIPLIER,r.name=s,r.libraryAssetName=this.getLibraryAssetNameForSprite(n,r),r.posture=this.getPostureForAsset(t,n.source),r.clickHandling=this._clickHandling,r.blendMode!=="add"&&(r.filters=this._filters)}else this.resetSprite(r)}else r&&this.resetSprite(r)}getLibraryAssetNameForSprite(t,e){return t.source}getPostureForAssetFile(t,e){return null}resetSprite(t){t&&(t.texture=null,t.libraryAssetName="",t.posture="",t.tag="",t.offsetX=0,t.offsetY=0,t.flipH=!1,t.flipV=!1,t.relativeDepth=0,t.clickHandling=!1)}getSpriteAssetName(t,e){if(!this._data||e>=ca.LAYER_LETTERS.length)return"";let s=this._assetNames[e],r=this._updatedLayers[e];return(!s||!s.length)&&(s=this.cacheSpriteAssetName(t,e,!0),r=this._cacheSize!==1),r&&(s+=this.getFrameNumber(t,e)),s}cacheSpriteAssetName(t,e,s){this._type;const r=s?this._cacheSize:this.getValidSize(t);let n="";const o=r!==1;if(e!==this._shadowLayerIndex?n=ca.LAYER_LETTERS[e]||"":n="sd",n==="")return null;const l=this._type+(o?"_"+r+"_"+n+"_"+this._direction+"_":"_icon_"+n);return s&&(this._assetNames[e]=l,this._updatedLayers[e]=o),l}getLayerTag(t,e,s){const r=this._spriteTags[s];if(r!==void 0)return r;if(!this._data)return ve.DEFAULT_TAG;const n=this._data.getLayerTag(t,e,s);return this._spriteTags[s]=n,n}getLayerBlendMode(t,e,s){const r=this._spriteBlendModes[s];if(r!==void 0)return r;if(!this._data)return ve.DEFAULT_BLEND_MODE;const n=this._data.getLayerBlendMode(t,e,s);return this._spriteBlendModes[s]=n,n}getLayerAlpha(t,e,s){if(!this._alphaChanged){const n=this._spriteAlphas[s];if(n!==void 0)return n}if(!this._data)return ve.DEFAULT_ALPHA;let r=this._data.getLayerAlpha(t,e,s);return this._alphaMultiplier!==null&&(r=r*this._alphaMultiplier),this._spriteAlphas[s]=r,r}getLayerColor(t,e,s){const r=this._spriteColors[e];if(r!==void 0)return r;if(!this._data)return Yl.DEFAULT_COLOR;const n=this._data.getLayerColor(t,e,s);return this._spriteColors[e]=n,n}getLayerIgnoreMouse(t,e,s){const r=this._spriteMouseCaptures[s];if(r!==void 0)return r;if(!this._data)return ve.DEFAULT_IGNORE_MOUSE;const n=this._data.getLayerIgnoreMouse(t,e,s);return this._spriteMouseCaptures[s]=n,n}getLayerXOffset(t,e,s){const r=this._spriteXOffsets[s];if(r!==void 0)return r;if(!this._data)return ve.DEFAULT_XOFFSET;const n=this._data.getLayerXOffset(t,e,s);return this._spriteXOffsets[s]=n,n}getLayerYOffset(t,e,s){if(s===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(t/2));const r=this._spriteYOffsets[s];if(r!==void 0)return r;if(!this._data)return ve.DEFAULT_YOFFSET;const n=this._data.getLayerYOffset(t,e,s);return this._spriteYOffsets[s]=n,n}getLayerZOffset(t,e,s){const r=this._spriteZOffsets[s];if(r!==void 0)return r;if(!this._data)return ve.DEFAULT_ZOFFSET;const n=this._data.getLayerZOffset(t,e,s);return this._spriteZOffsets[s]=n,n}getValidSize(t){return this._data?this._data.getValidSize(t):t}setLayerCount(t){this._layerCount=t,this._shadowLayerIndex=t-this.getAdditionalLayerCount()}setDirection(t){this._direction!==t&&(this._direction=t)}getAdditionalLayerCount(){return 1}updateAnimation(t){return 0}getFrameNumber(t,e){return 0}getPostureForAsset(t,e){return null}getAsset(t,e=-1){return this.asset?this.asset.getAsset(t):null}getTexture(t,e,s){return(s==null?void 0:s.texture)??null}set lookThrough(t){this._lookThrough!=t&&(this._lookThrough=t,this._needsLookThroughUpdate=!0)}get direction(){return this._direction}get data(){return this._data}};Ch.DEPTH_MULTIPLIER=Math.sqrt(.5),Ch.TYPE=mt.FURNITURE_STATIC;let ga=Ch;const Yc=class Yc extends ga{constructor(){super(...arguments),this._state=-1,this._frameIncrease=1,this._animationData=new WL,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(t){return t instanceof NS?super.initialize(t):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(t){return this.animationId!==Yc.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:Yc.DEFAULT_ANIMATION_ID}updateObject(t,e){if(super.updateObject(t,e)){const s=this.object.getState(0);return s!==this._state&&(this.setAnimation(s),this._state=s,this._animationChangeTime=this.object.model.getValue(A.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(t){if(super.updateModel(t)){if(this.usesAnimationResetting()){const s=this.object.model.getValue(A.FURNITURE_STATE_UPDATE_TIME);s>this._animationChangeTime&&(this._animationChangeTime=s,this.setAnimation(this._state))}const e=this.object.model.getValue(A.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(e)){const s=this.data.getAnimationId(this._animationScale,e);this.setAnimation(s)}return!0}return!1}isPlayingTransition(t,e){return!(!Ys.isTransitionFromAnimation(t.animationId)&&!Ys.isTransitionToAnimation(t.animationId)||e!==t.animationAfterTransitionId||t.animationOver)}getCurrentState(t){const e=t.animationId;return!Ys.isTransitionFromAnimation(e)&&!Ys.isTransitionToAnimation(e)?e:t.animationAfterTransitionId}setAnimation(t){this.data&&this.setSubAnimation(this._animationData,t,this._state>=0)}setSubAnimation(t,e,s=!0){const r=t.animationId;if(s){if(this.isPlayingTransition(t,e))return!1;const n=this.getCurrentState(t);if(e!==n){if(!this.data.isImmediateChange(this._animationScale,e,n)){let o=Ys.getTransitionFromAnimationId(n);this.data.hasAnimation(this._animationScale,o)?(t.animationAfterTransitionId=e,e=o):(o=Ys.getTransitionToAnimationId(e),this.data.hasAnimation(this._animationScale,o)&&(t.animationAfterTransitionId=e,e=o))}}else if(Ys.isTransitionFromAnimation(t.animationId)){const o=Ys.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,o)&&(t.animationAfterTransitionId=e,e=o)}else if(!Ys.isTransitionToAnimation(t.animationId)&&this.usesAnimationResetting()){const o=Ys.getTransitionFromAnimationId(n);if(this.data.hasAnimation(this._animationScale,o))t.animationAfterTransitionId=e,e=o;else{const l=Ys.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,l)&&(t.animationAfterTransitionId=e,e=l)}}}return r!==e?(t.animationId=e,!0):!1}getLastFramePlayed(t){return this._animationData.getLastFramePlayed(t)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(t){if(!this.data)return 0;t!==this._animationScale&&(this._animationScale=t,this._animatedLayerCount=this.data.getLayerCount(t),this.resetAllAnimationFrames());const e=this.updateAnimations(t);return this._directionChanged=!1,e}updateAnimations(t){if(this._animationData.animationOver&&!this._directionChanged)return 0;const e=this.updateFramesForAnimation(this._animationData,t);return this._animationData.animationOver&&(Ys.isTransitionFromAnimation(this._animationData.animationId)||Ys.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),e}updateFramesForAnimation(t,e){if(t.animationOver&&!this._directionChanged)return 0;const s=this.getAnimationId(t);let r=t.frameCounter;r||(r=this.data.getStartFrame(e,s,this._direction)),r+=this.frameIncrease,t.frameCounter=r,t.animationOver=!0;let n=!1,o=this._animatedLayerCount-1,l=0,c=1<<this._animatedLayerCount-1;for(;o>=0;){let u=0;if(n=t.getAnimationPlayed(o),!n||this._directionChanged){let h=t.getLastFramePlayed(o),d=t.getFrame(o);d&&d.isLastFrame&&d.remainingFrameRepeats<=this.frameIncrease&&(h=!0),(this._directionChanged||!d||d.remainingFrameRepeats>=0&&(d.remainingFrameRepeats=d.remainingFrameRepeats-this.frameIncrease)<=0)&&(u=Fo.SEQUENCE_NOT_DEFINED,d&&(u=d.activeSequence),u===Fo.SEQUENCE_NOT_DEFINED?d=this.data.getFrame(e,s,this._direction,o,r):d=this.data.getFrameFromSequence(e,s,this._direction,o,u,d.activeSequenceOffset+d.repeats,r),t.setFrame(o,d),l=l|c),!d||d.remainingFrameRepeats==Fo.FRAME_REPEAT_FOREVER?(h=!0,n=!0):t.animationOver=!1,t.setLastFramePlayed(o,h),t.setAnimationPlayed(o,n)}c=c>>1,o--}return l}getFrameNumber(t,e){const s=this._animationData.getFrame(e);return s?s.id:super.getFrameNumber(t,e)}getLayerXOffset(t,e,s){const r=super.getLayerXOffset(t,e,s),n=this._animationData.getFrame(s);return n?r+n.x:r}getLayerYOffset(t,e,s){const r=super.getLayerYOffset(t,e,s),n=this._animationData.getFrame(s);return n?r+n.y:r}usesAnimationResetting(){return!1}setDirection(t){this._direction!==t&&(super.setDirection(t),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}};Yc.TYPE=mt.FURNITURE_ANIMATED,Yc.DEFAULT_ANIMATION_ID=0;let Ls=Yc;const Hr=class Hr extends ga{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(t,e){return super.updateObject(t,e)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(t){const e=super.updateModel(t);if(e&&(this._offsetX=this.object.model.getValue(A.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(A.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(A.FURNITURE_BRANDING_OFFSET_Z)||0),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return e}checkIfImageChanged(){const t=this.object.model.getValue(A.FURNITURE_BRANDING_IMAGE_URL);return t&&t===this._imageUrl?!1:(this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const e=this.object.model.getValue(A.FURNITURE_BRANDING_IMAGE_URL);if(!e||this._imageUrl&&this._imageUrl===e)return!1;if(this.object.model.getValue(A.FURNITURE_BRANDING_IMAGE_STATUS)===1){let r=null;return r=ae().getTexture(e),r?(this.imageReady(r,e),!0):!1}return!1}imageReady(t,e){if(!t){this._imageUrl=null;return}this._imageUrl=e}checkAndCreateImageForCurrentState(){if(!this._imageUrl)return;const t=ae().getTexture(this._imageUrl);if(!t)return;const e=this.object.getState(0);this.addBackgroundAsset(t,e,0)}addBackgroundAsset(t,e,s){let r=0,n=0,o=!1,l=!1;switch(e){case Hr.STATE_0:r=0,n=0,o=!1,l=!1;break;case Hr.STATE_1:r=-t.width,n=0,o=!0,l=!1;break;case Hr.STATE_2:r=-t.width,n=-t.height,o=!0,l=!0;break;case Hr.STATE_3:r=0,n=-t.height,o=!1,l=!0;break}this.asset.addAsset(`${this._imageUrl}_${s}`,t,!0,r,n,o,l)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===Hr.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(t,e)}`:super.getSpriteAssetName(t,e)}};Hr.BRANDED_IMAGE="branded_image",Hr.STATE_0=0,Hr.STATE_1=1,Hr.STATE_2=2,Hr.STATE_3=3;let cd=Hr;class YL extends cd{getLayerXOffset(t,e,s){return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+this._offsetZ}}const zc=class zc extends Ls{constructor(){super(...arguments),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(t){let e=super.updateModel(t);const s=this.object.model.getValue(A.FURNITURE_BADGE_IMAGE_STATUS),r=this.object.model.getValue(A.FURNITURE_BADGE_ASSET_NAME);if(s===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(s===1&&r!==this._badgeId){this._badgeId=r,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const n=this.object.model.getValue(A.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(n)||(this._badgeVisibleInState=n),e=!0}return e}getSpriteAssetName(t,e){return this.getLayerTag(t,this.direction,e)!==zc.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(t,e):t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(t,e,s){let r=super.getLayerXOffset(t,e,s);if(this.getLayerTag(t,e,s)===zc.BADGE){const n=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(t===64?r+=(40-n.width)/2:r+=(20-n.width)/2)}return r}getLayerYOffset(t,e,s){let r=super.getLayerYOffset(t,e,s);if(this.getLayerTag(t,e,s)===zc.BADGE){const n=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(t===64?r+=(40-n.height)/2:r+=(20-n.height)/2)}return r}};zc.BADGE="BADGE";let pT=zc;const Ro=class Ro extends Ls{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Ro.ANIMATION_ID_ROLL);return}if(t>=0&&t<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Ro.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(Ro.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};Ro.ANIMATION_ID_OFFSET_SLOW1=20,Ro.ANIMATION_ID_OFFSET_SLOW2=9,Ro.ANIMATION_ID_ROLL=-1;let IT=Ro;class G6 extends ga{}const Yn=class Yn extends Ls{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),r=this.object.getState(0);switch(s){case Yn.SECONDS_SPRITE:return Math.floor(r%60%10);case Yn.TEN_SECONDS_SPRITE:return Math.floor(r%60/10);case Yn.MINUTES_SPRITE:return Math.floor(r/60%10);case Yn.TEN_MINUTES_SPRITE:return Math.floor(r/60/10%10);default:return super.getFrameNumber(t,e)}}get animationId(){return 0}};Yn.SECONDS_SPRITE="seconds_sprite",Yn.TEN_SECONDS_SPRITE="ten_seconds_sprite",Yn.MINUTES_SPRITE="minutes_sprite",Yn.TEN_MINUTES_SPRITE="ten_minutes_sprite";let TT=Yn;class k6 extends Nu{}const xh=class xh extends Ls{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(t){this._thumbnailImageNormal=t,this._thumbnailChanged=!0}updateModel(t){const e=super.updateModel(t);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?e:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(t,e){let s=0;for(;s<this.totalSprites;){if(this.getLayerTag(e,this.direction,s)===xh.THUMBNAIL){const r=this.cacheSpriteAssetName(e,s,!1)+this.getFrameNumber(e,s),n=this.getAsset(r,s);if(n){const o=this.generateTransformedThumbnail(t,n),l=this.getThumbnailAssetName(e);this.asset.disposeAsset(l),this.asset.addAsset(l,o,!0,n.offsetX,n.offsetY,!1,!1)}return}s++}}generateTransformedThumbnail(t,e){if(this._hasOutline){const l=new Ve,c=new Ve(Es.WHITE);c.tint=0,c.width=t.width+40,c.height=t.height+40;const u=new Ve(t),h=(c.width-u.width)/2,d=(c.height-u.height)/2;u.position.set(h,d),l.addChild(c,u),t=me.generateTexture(l)}const s=1.1,r=new _r,n=e.width/t.width;switch(this.direction){case 2:r.a=n,r.b=-.5*n,r.c=0,r.d=n*s,r.tx=0,r.ty=.5*n*t.width;break;case 0:case 4:r.a=n,r.b=.5*n,r.c=0,r.d=n*s,r.tx=0,r.ty=0;break;default:r.a=n,r.b=0,r.c=0,r.d=n,r.tx=0,r.ty=0}const o=new Ve(t);return o.setFromMatrix(r),me.generateTexture(o)}getSpriteAssetName(t,e){return this._thumbnailImageNormal&&this.getLayerTag(t,this.direction,e)===xh.THUMBNAIL?this.getThumbnailAssetName(t):super.getSpriteAssetName(t,e)}getThumbnailAssetName(t){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(t,e){return[this._type,t,"thumb",e].join("_")}};xh.THUMBNAIL="THUMBNAIL";let Ig=xh;class zL extends Ig{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(t){if(this.object){const e=this.getThumbnailURL();if(this._cachedUrl!==e)if(this._cachedUrl=e,this._cachedUrl&&this._cachedUrl!==""){const s=new Image;s.src=e,s.crossOrigin="*",s.onload=()=>{const r=Es.from(s);r.source.scaleMode="linear",this.setThumbnailImages(r)}}else this.setThumbnailImages(null)}return super.updateModel(t)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class B6 extends zL{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const t=this.object.model.getValue(A.FURNITURE_DATA);if(!t||t==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let s=JSON.parse(t).w||"";return s=this.buildThumbnailUrl(s),this._url=s,this._url}buildThumbnailUrl(t){return t=t.replace(".png","_small.png"),t.indexOf(".png")===-1&&(t=t+"_small.png"),t}}class eA{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(t,e,s,r,n,o,l,c=!1,u=null,h=!1){this._x=t,this._y=e,this._z=s,this._particleDirection=new w(r.x,r.y,r.z),this._particleDirection.multiply(n),this._lastX=this._x-this._particleDirection.x*o,this._lastY=this._y-this._particleDirection.y*o,this._lastZ=this._z-this._particleDirection.z*o,this._age=0,this._hasMoved=!1,this._lifeTime=l,this._isEmitter=c,this._frames=u,this._fade=h,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}get lastX(){return this._lastX}set lastX(t){this._hasMoved=!0,this._lastX=t}get lastY(){return this._lastY}set lastY(t){this._hasMoved=!0,this._lastY=t}get lastZ(){return this._lastZ}set lastZ(t){this._hasMoved=!0,this._lastZ=t}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(t,e){this._x=t._x*e,this._y=t._y*e,this._z=t._z*e,this._lastX=t._lastX*e,this._lastY=t._lastY*e,this._lastZ=t._lastZ*e,this._hasMoved=t.hasMoved,this._particleDirection=t._particleDirection,this._age=t._age,this._lifeTime=t._lifeTime,this._isEmitter=t._isEmitter,this._fade=t._fade,this._fadeTime=t._fadeTime,this._alphaMultiplier=t._alphaMultiplier}}const So=class So extends eA{constructor(t="",e=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=t,this._roomObjectSpriteId=e,this._particleConfigurations=[]}dispose(){for(const t of this._particles)t.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(t,e,s,r,n,o,l,c,u,h){this._maxNumberOfParticles=t,this._particlesPerFrame=e,this._force=s,this._emitterDirection=r,this._emitterDirection.normalize(),this._gravity=n,this._airFriction=o,this._explosionShape=l,this._fuseTime=u,this._energy=c,this._burstPulse=h,this.reset()}reset(){for(const t of this._particles)t.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(t,e){super.copy(t,e),this._force=t._force,this._emitterDirection=t._emitterDirection,this._gravity=t._gravity,this._airFriction=t._airFriction,this._explosionShape=t._explosionShape,this._fuseTime=t._fuseTime,this._energy=t._energy,this._burstPulse=t._burstPulse,this._timeStep=t._timeStep,this._hasIgnited=t._hasIgnited}configureParticle(t,e,s,r){const n={};n.lifeTime=t,n.isEmitter=e,n.frames=s,n.fade=r,this._particleConfigurations.push(n)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(t,e=null){e||(e=new w);const s=new w,r=this.getRandomParticleConfiguration();let n=0;for(;n<this._particlesPerFrame;){switch(this._explosionShape){case So.CONE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=-(Math.random()+1),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case So.PLANE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=0,s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case So.SPHERE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=this.randomBoolean(.5)?Math.random():-Math.random(),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break}s.normalize();const o=new eA;let l=0,c=!1,u=!1,h=[];r?(l=Math.floor(Math.random()*r.lifeTime+10),c=r.isEmitter,h=r.frames,u=r.fade):(l=Math.trunc(Math.floor(Math.random()*20+10)),c=!1,h=[]),o.init(t.x,t.y,t.z,s,this._energy,this._timeStep,l,c,h,u),this._particles.push(o),this._emittedParticles++,n++}}getRandomParticleConfiguration(){const t=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[t]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const e=this.x,s=this.y,r=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=e,this.lastY=s,this.lastZ=r}const t=[];for(const e of this._particles){e.update();const s=e.x,r=e.y,n=e.z;e.x=(2-this._airFriction)*e.x-(1-this._airFriction)*e.lastX,e.y=(2-this._airFriction)*e.y-(1-this._airFriction)*e.lastY+this._gravity*this._timeStep*this._timeStep,e.z=(2-this._airFriction)*e.z-(1-this._airFriction)*e.lastZ,e.lastX=s,e.lastY=r,e.lastZ=n,(e.y>10||!e.isAlive)&&t.push(e)}for(const e of t)e.isEmitter,this._particles.splice(this._particles.indexOf(e),1),e.dispose()}satisfyConstraints(){}accumulateForces(){for(const t of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(t){return Math.random()<t}get roomObjectSpriteId(){return this._roomObjectSpriteId}};So.CONE="cone",So.PLANE="plane",So.SPHERE="sphere";let RT=So;class V6{constructor(t){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new Is,this._visualization=t,this._blackOverlayAlphaTransform=new XE,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new XE,this._identityMatrix=new _r,this._translationMatrix=new _r}dispose(){for(const t of this._emitters.getValues())t.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(t){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(t),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(t,e,s){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===s?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(t){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==t:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const t=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const e=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const s of this._currentEmitter.particles){const r=this._centerX+(s.x-s.z)*t/10*this._scaleMultiplier,n=this._centerY-e+(s.y+(s.x+s.z)/2)*t/10*this._scaleMultiplier,o=s.getAsset();if(o&&o.texture)if(s.fade&&s.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(r+o.offsetX,n+o.offsetY);const l=new Ve(o.texture);this._particleColorTransform.alpha=s.alphaMultiplier,l.filters=[this._particleColorTransform],me.writeToTexture(l,this._canvasTexture,!1,this._translationMatrix)}else{const l=new Qt(r+o.offsetX,n+o.offsetY),c=new Ve(o.texture);c.x=l.x,c.y=l.y,me.writeToTexture(c,this._canvasTexture,!1)}else{const l=new Ve(Es.WHITE);l.tint=16777215,l.x=r-1,l.y=n-1,l.width=2,l.height=2,me.writeToTexture(l,this._canvasTexture,!1)}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(t){this._size=t.size,this._canvasId=t.canvasId!==void 0?t.canvasId:-1,this._offsetY=t.offsetY!==void 0?t.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=t.blend!==void 0?t.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const e=t.bgColor!==void 0?t.bgColor:"0";if(this._bgColor=parseInt(e,16)||0,!(!t.emitters||!t.emitters.length))for(const s of t.emitters){const r=s.id,n=s.name,o=s.spriteId,l=new RT(n,o);this._emitters.add(r,l);const c=s.maxNumParticles,u=s.particlesPerFrame,h=s.burstPulse!==void 0?s.burstPulse:1,d=s.fuseTime,f=s.simulation.force,E=s.simulation.direction,m=s.simulation.gravity,I=s.simulation.airFriction,p=s.simulation.shape,T=s.simulation.energy;for(const R of s.particles){const S=R.lifeTime,L=R.isEmitter||!1,M=R.fade||!1,P=[];for(const k of R.frames)P.push(this._visualization.asset.getAsset(k));l.configureParticle(S,L,P,M)}l.setup(c,u,f,new w(0,E,0),m,I,p,T,d,h)}}copyStateFrom(t){let e=0;t._emitters&&t._currentEmitter&&(e=t._emitters.getKey(t._emitters.getValues().indexOf(t._currentEmitter))),this.setAnimation(e),this._currentEmitter&&this._currentEmitter.copyStateFrom(t._currentEmitter,t._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new Ve(Es.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?me.writeToTexture(this._emptySprite,this._canvasTexture,!0):this._canvasTexture=me.createRenderTexture(this._roomSprite.width,this._roomSprite.height)}}class KL extends Ls{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const t of this._particleSystems.getValues())t.dispose();this._particleSystems=null}}updateObject(t,e){if(super.updateObject(t,e)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(t):Lt.log("ERROR Particle systems could not be read!",this.object.type);else if(t!==this._scale||this._particleSystems.getValue(t)!==this._currentParticleSystem){const s=this._particleSystems.getValue(t);if(!s)return!1;s.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=s}return!0}return!1}updateSprites(t,e,s){super.updateSprites(t,e,s),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(t){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(t)}setAnimation(t){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(t),super.setAnimation(t)}getLayerYOffset(t,e,s){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(s)?this._currentParticleSystem.getLayerYOffset(t,e,s):super.getLayerYOffset(t,e,s)}readDefinition(){if(!this.object||!this.object.model)return!1;const t=this.object.model.getValue(A.FURNITURE_FIREWORKS_DATA);if(!t||!t.length)return!1;this._particleSystems=new Is;for(const e of t){const s=e.size,r=new V6(this);r.parseData(e),this._particleSystems.add(s,r)}return!0}}const Oo=class Oo extends KL{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(t,e,s,r){this.updatePresentWrap(),super.update(t,e,s,r)}updatePresentWrap(){if(!this.object)return;const t=1e3,e=this.object.model.getValue(A.FURNITURE_EXTRAS),s=parseInt(e),r=Math.floor(s/t),n=s%t;this._packetType=r>Oo.MAX_PACKET_TYPE_VALUE?0:r,this._ribbonType=n>Oo.MAX_RIBBON_TYPE_VALUE?0:n}getFrameNumber(t,e){if(this._lastAnimationId===Oo.PRESENT_DEFAULT_STATE){if(e<=1)return this._packetType;if(e===2)return this._ribbonType}return super.getFrameNumber(t,e)}getSpriteAssetName(t,e){const s=this.getValidSize(t);let r=this._type,n="";e<this.spriteCount-1?n=String.fromCharCode(97+e):n="sd";const o=this.getFrameNumber(t,e);return r=r+("_"+s+"_"+n+"_"+this.direction),r=r+("_"+o),r}setAnimation(t){this._lastAnimationId=t,super.setAnimation(t)}};Oo.PRESENT_DEFAULT_STATE=0,Oo.MAX_PACKET_TYPE_VALUE=9,Oo.MAX_RIBBON_TYPE_VALUE=11;let ST=Oo;class H6 extends ga{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(t,e,s,r){this.updatePresentWrap(),super.update(t,e,s,r)}updatePresentWrap(){if(!this.object)return;const t=this.object.model.getValue(A.FURNITURE_EXTRAS),e=1e3,s=parseInt(t);this._packetType=Math.floor(s/e),this._ribbonType=s%e}getFrameNumber(t,e){return e<=1?this._packetType:this._ribbonType}getSpriteAssetName(t,e){const s=this.getValidSize(t);let r=this._type,n="";e<this.spriteCount-1?n=String.fromCharCode(97+e):n="sd";const o=this.getFrameNumber(t,e);return r=r+("_"+s+"_"+n+"_"+this.direction),r=r+("_"+o),r}}const Gi=class Gi extends Ls{constructor(){super(),this._color1=Gi.DEFAULT_COLOR_1,this._color2=Gi.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(t){const e=super.updateModel(t);if(this._badgeAssetNameNormalScale===""){const n=this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&(this._badgeAssetNameNormalScale=n,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const s=this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||Gi.DEFAULT_COLOR_1;const r=this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=r||Gi.DEFAULT_COLOR_2,e}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case Gi.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Gi.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===Gi.BADGE?t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(t,e)}getLibraryAssetNameForSprite(t,e){return e.tag===Gi.BADGE?"%group.badge.url%"+e.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(t,e)}};Gi.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",Gi.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",Gi.BADGE="BADGE",Gi.DEFAULT_COLOR_1=15658734,Gi.DEFAULT_COLOR_2=4934475;let OT=Gi;const on=class on extends Ig{updateModel(t){const e=super.updateModel(t);if(!this.hasThumbnailImage){const n=this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&n.length&&this.setThumbnailImages(this.getBitmapAsset(n))}const s=this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||on.DEFAULT_COLOR_1;const r=this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=r||on.DEFAULT_COLOR_2,e}generateTransformedThumbnail(t,e){const r=new _r,n=e.width/t.width;switch(this.direction){case 2:r.a=n,r.b=-.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=.5*n*t.width;break;case 0:case 4:r.a=n,r.b=.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=0;break;default:r.a=n,r.b=0,r.c=0,r.d=n,r.tx=0,r.ty=0}const o=new Ve(t);return o.setFromMatrix(r),o.position.set(0),me.generateTexture(o)}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case on.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case on.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getLibraryAssetNameForSprite(t,e){return e.tag===on.THUMBNAIL&&this.object&&this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(t,e)}getBitmapAsset(t){const e=this.asset.getAsset(t);return!e||!e.texture?null:e.texture}};on.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",on.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",on.DEFAULT_COLOR_1=15658734,on.DEFAULT_COLOR_2=4934475;let AT=on;const ln=class ln extends Ls{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(ln.ANIMATION_ID_START_ROLL),this._stateQueue.push(ln.ANIMATION_ID_ROLL);return}if(t>0&&t<=ln.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(ln.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(ln.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};ln.ANIMATION_ID_OFFSET_SLOW1=10,ln.ANIMATION_ID_OFFSET_SLOW2=20,ln.ANIMATION_ID_START_ROLL=31,ln.ANIMATION_ID_ROLL=32;let NT=ln;class W6 extends YL{constructor(){super(...arguments),this._needsTransform=!0}generateTransformedImage(t,e){const r=new _r,n=e.width/t.width;switch(this.direction){case 2:r.a=n,r.b=-.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=.5*n*t.width;break;case 0:case 4:r.a=n,r.b=.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=0;break;default:r.a=n,r.b=0,r.c=0,r.d=n,r.tx=0,r.ty=0}const o=new Ve(t),l=me.createAndWriteRenderTexture(e.width+r.tx,e.height+r.ty,o,r);this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,l,!0,o.x,o.y,e.flipH,e.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===cd.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&this.generateTransformedImage(ae().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(t,e))),`${this._imageUrl}_${this.getFrameNumber(t,e)}`):super.getSpriteAssetName(t,e)}}class XL extends ca{constructor(){super(),this._avatarData=new AS}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(t,e,s=null,r=null,n=null){return this._avatarData.createAvatarImage(t,e,s,r,n)}}const Kc=class Kc extends ga{constructor(){super(...arguments),this._mannequinScale=-1,this._figure=null,this._gender=null,this._avatarImage=null,this._avatarWidth=90,this._avatarHeight=130,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(t){return t instanceof XL?super.initialize(t):!1}dispose(){this._disposed||(this._disposed=!0,this._avatarImage&&(this._avatarImage.dispose(),this._avatarImage=null),super.dispose())}updateObject(t,e){const s=super.updateObject(t,e);return s&&this._mannequinScale!==t&&(this._mannequinScale=t,this.updateAvatar()),s}updateModel(t){let e=super.updateModel(t);if(e){const s=this.object.model.getValue(A.FURNITURE_MANNEQUIN_FIGURE)||null;s&&(this._figure=`${s}.${this._placeHolderFigure}`,this._gender=this.object.model.getValue(A.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return e=e||this._needsUpdate,this._needsUpdate=!1,e}updateAvatar(){this._avatarImage&&(this._avatarImage.dispose(),this._avatarImage=null),this._avatarImage=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this)}resetFigure(t){this.updateAvatar(),this._needsUpdate=!0}getLayerXOffset(t,e,s){return this.getLayerTag(t,e,s)===Kc.AVATAR_IMAGE_SPRITE_TAG&&this._avatarImage?-this._avatarWidth/3:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this.getLayerTag(t,e,s)===Kc.AVATAR_IMAGE_SPRITE_TAG&&this._avatarImage?-this._avatarHeight/3:super.getLayerYOffset(t,e,s)}getTexture(t,e,s){return this.getLayerTag(t,this.direction,e)===Kc.AVATAR_IMAGE_SPRITE_TAG&&this._avatarImage?(this._avatarImage.setDirection(ai.FULL,this.direction),this._avatarImage.processAsTexture(ai.FULL,!1)):super.getTexture(t,e,s)}get disposed(){return this._disposed}get data(){return this._data}};Kc.AVATAR_IMAGE_SPRITE_TAG="avatar_image";let CT=Kc;const pr=class pr extends Ls{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(t){this._animSpeedIndex||this.initItems(t);let e=this.getSprite(2);return e&&(this._animOffsetIndex[0]=this.getNewPoint(t,0)),e=this.getSprite(3),e&&(this._animOffsetIndex[1]=this.getNewPoint(t,1)),super.updateAnimation(t)}getNewPoint(t,e){let s=0,r=this._animPhaseIndex[e],n=this._animDirectionIndex[e];const o=this._animSpeedIndex[e],l=this._animFactorIndex[e];let c=1;t==32?(s=pr.AREA_DIAMETER_SMALL,c=.5):s=pr.AREA_DIAMETER_LARGE;const u=r+n*o;Math.abs(u)>=s&&(n>0?r=r-(u-s):r=r+(-s-u),n=-n,this._animDirectionIndex[e]=n);const h=(s-Math.abs(r))*l;let d=n*Math.sin(Math.abs(r/4))*h;return n>0?d=d-h:d=d+h,r=r+n*o*c,this._animPhaseIndex[e]=r,Math.trunc(d)==0&&(this._animFactorIndex[e]=this.getRandomAmplitudeFactor()),new Qt(r,d)}initItems(t){let e;t===32?e=pr.AREA_DIAMETER_SMALL:e=pr.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*e*1.5),this._animPhaseIndex.push(Math.random()*e*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(pr.ANIM_SPEED_FAST),this._animSpeedIndex.push(pr.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].y:super.getLayerYOffset(t,e,s)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}};pr.UPDATE_INTERVAL=2,pr.AREA_DIAMETER_SMALL=15,pr.AREA_DIAMETER_LARGE=31,pr.ANIM_SPEED_FAST=2,pr.ANIM_SPEED_SLOW=1;let xT=pr;const cm=class cm{constructor(t,e,s,r,n,o){this._name=t,this._index=e,this._radius=s,this._arcSpeed=r*Math.PI*2/360,this._arcOffset=n*Math.PI*2/360,this._height=o,this._position=0,this._positionVector=new w(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(t,e,s){this._position=this._position+this._arcSpeed/cm.SYSTEM_TEMPO,t[this._index]=this.getPositionVector(e,s);for(const r of this._children)r.update(t,this._positionVector,s)}getPositionVector(t,e){const s=this._radius*Math.cos(this._position+this._arcOffset),r=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(s-r)*(e/2),this._positionVector.y=(r+s)*(e/2)*.5-this._height*(e/2),this._positionVector.z=-Math.trunc(4*(s+r)-.7),t&&this._positionVector.add(t),this._positionVector}addChild(t){this._children.indexOf(t)>=0||this._children.push(t)}hasChild(t){return!!this.getChild(t)}getChild(t){for(const e of this._children){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}get name(){return this._name}};cm.SYSTEM_TEMPO=30;let yT=cm;class Y6 extends Ls{constructor(){super(),this._offsetArray=[],this._rootPosition=new w}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(t){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const e of this._planetIndex)e.update(this._offsetArray,this._rootPosition,t);return super.updateAnimation(t)}return 0}getLayerXOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].y:super.getLayerYOffset(t,e,s)}getLayerZOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].z:super.getLayerZOffset(t,e,s)}processPlanets(){if(!this.object||!this.object.model)return;const t=this.object.model.getValue(A.FURNITURE_PLANETSYSTEM_DATA);if(!t)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const e of t)this.getSprite(e.id)&&this.addPlanet(e.name,e.id,e.parent,e.radius||0,e.arcSpeed||0,e.arcOffset||0,e.height||0);return!0}addPlanet(t,e,s,r,n,o,l){if(!this._planetIndex)return;const c=new yT(t,e,r,n,o,l),u=this.getPlanet(s);u?u.addChild(c):(this._planetIndex.push(c),this._planetNameIndex.push(t))}getPlanet(t){for(const e of this._planetIndex){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}}class z6 extends Ls{}const wa=class wa extends Ls{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(t){return t===wa.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(wa.ANIMATION_ID_NORMAL),this._animationCounter=wa.ANIMATION_DURATION),super.setAnimation(t)}updateAnimation(t){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}usesAnimationResetting(){return!0}};wa.ANIMATION_ID_ROLL=3,wa.ANIMATION_ID_ROLL_ONCE=2,wa.ANIMATION_ID_NORMAL=1,wa.ANIMATION_DURATION=15;let MT=wa;class K6 extends Ls{usesAnimationResetting(){return!0}}class X6 extends cd{imageReady(t,e){super.imageReady(t,e),t&&this.setImageOffset(t.width,t.height)}setImageOffset(t,e){const s=new HL;s.setDirection(1,0,-e),s.setDirection(3,0,0),s.setDirection(5,-t,0),s.setDirection(7,-t,-e),s.setDirection(4,-t/2,-e/2),this._imageOffset=s}getLayerXOffset(t,e,s){if(this._imageOffset){const r=this._imageOffset.getXOffset(e,0);if(r!==void 0)return r+this._offsetX}return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){if(this._imageOffset){const r=this._imageOffset.getYOffset(e,0);if(r!==void 0)return r+this._offsetY}return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+-this._offsetZ}getLayerIgnoreMouse(t,e,s){return!0}}const zn=class zn extends Ls{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),r=this.object.getState(0);switch(s){case zn.ONES_SPRITE:return Math.floor(r%10);case zn.TENS_SPRITE:return Math.floor(r/10%10);case zn.HUNDREDS_SPRITE:return Math.floor(r/100%10);case zn.THOUSANDS_SPRITE:return Math.floor(r/1e3%10);default:return super.getFrameNumber(t,e)}}};zn.ONES_SPRITE="ones_sprite",zn.TENS_SPRITE="tens_sprite",zn.HUNDREDS_SPRITE="hundreds_sprite",zn.THOUSANDS_SPRITE="thousands_sprite";let bT=zn;class q6 extends Ls{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(t){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(A.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(t)}}class Q6 extends ga{getLayerColor(t,e,s){return this._data?this._data.getLayerColor(t,e,s):Yl.DEFAULT_COLOR}}const di=class di extends Ls{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(di.ANIMATION_ID_OFF)}setAnimation(t){if(t===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(di.ANIMATION_ID_START_ROLL),this._stateQueue.push(di.ANIMATION_ID_ROLL);return}if(t>0&&t<=di.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(di.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(di.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(di.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(di.ANIMATION_ID_OFFSET_SLOW2+t)),this._stateQueue.push(di.ANIMATION_ID_OFF);return}super.setAnimation(di.ANIMATION_ID_OFF)}}updateAnimation(t){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};di.ANIMATION_ID_OFFSET_SLOW1=20,di.ANIMATION_ID_OFFSET_SLOW2=10,di.ANIMATION_ID_START_ROLL=31,di.ANIMATION_ID_ROLL=32,di.ANIMATION_ID_OFF=30;let DT=di;const Ir=class Ir extends Ls{updateObject(t,e){return super.updateObject(t,e),!0}getFrameNumber(t,e){const s=this.object.model.getValue(A.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(t,this.direction,e)){case Ir.ONES_SPRITE:return s%10;case Ir.TENS_SPRITE:return s/10%10;case Ir.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){if(this.object.model.getValue(A.FURNITURE_VOTE_COUNTER_COUNT)===Ir.HIDE_COUNTER_SCORE)switch(this.getLayerTag(t,e,s)){case Ir.ONES_SPRITE:case Ir.TENS_SPRITE:case Ir.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};Ir.ONES_SPRITE="ones_sprite",Ir.TENS_SPRITE="tens_sprite",Ir.HUNDREDS_SPRITE="hundreds_sprite",Ir.HIDE_COUNTER_SCORE=-1;let vT=Ir;const ki=class ki extends Ls{getFrameNumber(t,e){const s=this.object.model.getValue(A.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(t,this.direction,e)){case ki.ONES_SPRITE:return s%10;case ki.TENS_SPRITE:return s/10%10;case ki.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){const r=this.object.model.getValue(A.FURNITURE_VOTE_MAJORITY_RESULT);if(ki.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||r===ki.HIDE_RESULTS_VALUE)switch(this.getLayerTag(t,e,s)){case ki.ONES_SPRITE:case ki.TENS_SPRITE:case ki.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};ki.ONES_SPRITE="ones_sprite",ki.TENS_SPRITE="tens_sprite",ki.HUNDREDS_SPRITE="hundreds_sprite",ki.HIDE_RESULTS_STATES=[-1,1],ki.HIDE_RESULTS_VALUE=-1;let PT=ki;class J6 extends Ls{}const um=class um extends zL{getThumbnailURL(){if(!this.object)return null;const t=this.object.model.getValue(A.FURNITURE_DATA);return t&&t[um.THUMBNAIL_URL]||null}};um.THUMBNAIL_URL="THUMBNAIL_URL";let LT=um;class Z6{constructor(t){this._sprite=new Ve(t),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(t){if(!this._sprite||this._amount===t)return null;const e=new $r;e.addChild(this._sprite);const s=new g0({text:"+"+t,style:new f0({fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"})});return s.anchor.x=.5,s.x=this._sprite.width/2,s.y=19,e.addChild(s),this._texture?me.writeToTexture(e,this._texture,!0):this._texture=me.generateTexture(e),this._texture}get amount(){return this._amount}set amount(t){this._amount=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}}class qL extends NS{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(t,e,s){return t>1?new il(e,s):new pg(e,s)}defineVisualizations(t){return this._isAllowedToTurnHead=!0,super.defineVisualizations(t)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"postures":if(!(t instanceof il)||!t.processPostures(s))return!1;break;case"gestures":if(!(t instanceof il)||!t.processGestures(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}postureToAnimation(t,e){const s=this.getSizeData(t);return s?s.postureToAnimation(e):il.DEFAULT}getGestureDisabled(t,e){const s=this.getSizeData(t);return s?s.getGestureDisabled(e):!1}gestureToAnimation(t,e){const s=this.getSizeData(t);return s?s.gestureToAnimation(e):il.DEFAULT}animationToPosture(t,e,s){const r=this.getSizeData(t);return r?r.animationToPosture(e,s):null}animationToGesture(t,e){const s=this.getSizeData(t);return s?s.animationToGesture(e):null}getGestureForAnimationId(t,e){const s=this.getSizeData(t);return s?s.getGestureForAnimationId(e):null}totalPostures(t){const e=this.getSizeData(t);return e?e.totalPostures:0}totalGestures(t){const e=this.getSizeData(t);return e?e.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}const Qe=class Qe extends Ls{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<Qe.ANIMATION_INDEX_COUNT;)this._animationStates.push(new WL)}initialize(t){if(!(t instanceof qL))return!1;const e=ae().getTexture(Qe.PET_EXPERIENCE_BUBBLE);return e&&(this._experienceData=new Z6(e)),super.initialize(t)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const t=this._animationStates[0];t&&t.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(t){return t.animationId}update(t,e,s,r){super.update(t,e,s,r),this.updateExperienceBubble(e)}updateExperienceBubble(t){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const e=t-this._experienceTimestamp;e<Qe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(e/Qe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const s=this.getSprite(this.totalSprites-1);if(s){if(this._experienceData.alpha>0){const r=this._experienceData.renderBubble(this._experience);if(r){s.texture=r,s.offsetX=-20,s.offsetY=-80,s.alpha=this._experienceData.alpha,s.visible=!0,s.relativeDepth=-.2;return}}s.texture=null,s.visible=!1}}}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;const s=e.getValue(A.FIGURE_POSTURE),r=e.getValue(A.FIGURE_GESTURE);this.setPostureAndGesture(s,r);let n=e.getValue(A.FURNITURE_ALPHA_MULTIPLIER)||null;(n===null||isNaN(n))&&(n=1),this._alphaMultiplier!==n&&(this._alphaMultiplier=n,this._alphaChanged=!0),this._isSleeping=e.getValue(A.FIGURE_SLEEP)>0;const o=e.getValue(A.HEAD_DIRECTION);!isNaN(o)&&this.data.isAllowedToTurnHead?this._headDirection=o:this._headDirection=this.object.getDirection().x,this._experience=e.getValue(A.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=e.getValue(A.FIGURE_EXPERIENCE_TIMESTAMP);const l=e.getValue(A.PET_PALETTE_INDEX),c=e.getValue(A.PET_CUSTOM_LAYER_IDS),u=e.getValue(A.PET_CUSTOM_PARTS_IDS),h=e.getValue(A.PET_CUSTOM_PALETTE_IDS),d=e.getValue(A.PET_IS_RIDING),f=e.getValue(A.PET_HEAD_ONLY),E=e.getValue(A.PET_COLOR);return l!==this._paletteIndex&&(this._paletteIndex=l,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=c||[],this._customPartIds=u||[],this._customPaletteIds=h||[],this._isRiding=!isNaN(d)&&d>0,this._headOnly=!isNaN(f)&&f>0,!isNaN(E)&&this._color!==E&&(this._color=E),this.updateModelCounter=e.updateCounter,!0}updateAnimation(t){if(this.object){const e=this.object.getDirection().x;e!==this._previousAnimationDirection&&(this._previousAnimationDirection=e,this.resetAllAnimationFrames())}return super.updateAnimation(t)}setPostureAndGesture(t,e){this.data&&(t!==this._posture&&(this._posture=t,this.setAnimationForIndex(Qe.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,t))),this.data.getGestureDisabled(this._scale,t)&&(e=null),e!==this._gesture&&(this._gesture=e,this.setAnimationForIndex(Qe.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,e))))}getAnimationStateData(t){return t>=0&&t<this._animationStates.length?this._animationStates[t]:null}setAnimationForIndex(t,e){const s=this.getAnimationStateData(t);s&&this.setSubAnimation(s,e)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let t=this._animationStates.length-1;for(;t>=0;){const e=this._animationStates[t];e&&e.setLayerCount(this.animatedLayerCount),t--}}updateAnimations(t){if(this._animationOver)return 0;let e=!0,s=0,r=0;for(;r<this._animationStates.length;){const n=this._animationStates[r];if(n&&!n.animationOver){const o=this.updateFramesForAnimation(n,t);s=s|o,n.animationOver?(Ys.isTransitionFromAnimation(n.animationId)||Ys.isTransitionToAnimation(n.animationId))&&(this.setAnimationForIndex(r,n.animationAfterTransitionId),e=!1):e=!1}r++}return this._animationOver=e,s}getSpriteAssetName(t,e){if(this._headOnly&&this.isNonHeadSprite(e)||this._isRiding&&this._parser3(e))return null;const s=this.totalSprites;if(e<s-Qe.ADDITIONAL_SPRITE_COUNT){const r=this.getValidSize(t);if(e<s-(1+Qe.ADDITIONAL_SPRITE_COUNT)){if(e>=ca.LAYER_LETTERS.length)return null;const n=ca.LAYER_LETTERS[e];return r===1?this._type+"_icon_"+n:this._type+"_"+r+"_"+n+"_"+this.getDirection(t,e)+"_"+this.getFrameNumber(r,e)}return this._type+"_"+r+"_sd_"+this.getDirection(t,e)+"_0"}return null}getLayerColor(t,e,s){return e<this.totalSprites-Qe.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(t,e,s){let r=super.getLayerXOffset(t,e,s),n=this._animationStates.length-1;for(;n>=0;){const o=this._animationStates[n];if(o){const l=o.getFrame(s);l&&(r+=l.x)}n--}return r}getLayerYOffset(t,e,s){let r=super.getLayerYOffset(t,e,s),n=this._animationStates.length-1;for(;n>=0;){const o=this._animationStates[n];if(o){const l=o.getFrame(s);l&&(r+=l.y)}n--}return r}getLayerZOffset(t,e,s){return this.data?this.data.getLayerZOffset(t,this.getDirection(t,s),s):ve.DEFAULT_ZOFFSET}getDirection(t,e){return this.isHeadSprite(e)?this.data.getValidDirection(t,this._headDirection):this._direction}getFrameNumber(t,e){let s=this._animationStates.length-1;for(;s>=0;){const r=this._animationStates[s];if(r){const n=r.getFrame(e);if(n)return n.id}s--}return super.getFrameNumber(t,e)}isHeadSprite(t){if(this._headSprites[t]===void 0){const e=this.data.getLayerTag(this._scale,Do.USE_DEFAULT_DIRECTION,t)===Qe.HEAD,s=this.data.getLayerTag(this._scale,Do.USE_DEFAULT_DIRECTION,t)===Qe.HAIR;e||s?this._headSprites[t]=!0:this._headSprites[t]=!1}return this._headSprites[t]}isNonHeadSprite(t){if(this._nonHeadSprites[t]===void 0)if(t<this.totalSprites-(1+Qe.ADDITIONAL_SPRITE_COUNT)){const e=this.data.getLayerTag(this._scale,Do.USE_DEFAULT_DIRECTION,t);e&&e.length>0&&e!==Qe.HEAD&&e!==Qe.HAIR?this._nonHeadSprites[t]=!0:this._nonHeadSprites[t]=!1}else this._nonHeadSprites[t]=!0;return this._nonHeadSprites[t]}_parser3(t){return this._saddleSprites[t]===void 0&&(this.data.getLayerTag(this._scale,Do.USE_DEFAULT_DIRECTION,t)===Qe.SADDLE?this._saddleSprites[t]=!0:this._saddleSprites[t]=!1),this._saddleSprites[t]}getAsset(t,e=-1){if(!this.asset)return null;const s=this._customLayerIds.indexOf(e);let r=this._paletteName,n=-1,o=-1;return s>-1&&(n=this._customPartIds[s],o=this._customPaletteIds[s],r=o>-1?o.toString():this._paletteName),!isNaN(n)&&n>-1&&(t=t+"_"+n),this.asset.getAssetWithPalette(t,r)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+Qe.ADDITIONAL_SPRITE_COUNT}setLayerCount(t){super.setLayerCount(t),this._headSprites=[]}getPostureForAsset(t,e){const s=e.split("_");let r=s.length,n=0;for(;n<s.length;){if(s[n]==="64"||s[n]==="32"){r=n+3;break}n++}let o=null;if(r<s.length){let l=s[r];l=l.split("@")[0],o=this.data.animationToPosture(t,parseInt(l)/100,!1),o||(o=this.data.getGestureForAnimationId(t,parseInt(l)/100))}return o}get data(){return this._data}};Qe.TYPE=mt.PET_ANIMATED,Qe.HEAD="head",Qe.SADDLE="saddle",Qe.HAIR="hair",Qe.ADDITIONAL_SPRITE_COUNT=1,Qe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3,Qe.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble",Qe.POSTURE_ANIMATION_INDEX=0,Qe.GESTURE_ANIMATION_INDEX=1,Qe.ANIMATION_INDEX_COUNT=2;let UT=Qe;class $6{constructor(t,e){this._width=t,this._height=e,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let s=t*e;for(;s>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),s--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}getTileHeight(t,e){return this.validPosition(t,e)?this._heights[e*this._width+t]:0}setTileHeight(t,e,s){this.validPosition(t,e)&&(this._heights[e*this._width+t]=s)}setStackingBlocked(t,e,s){this.validPosition(t,e)&&(this._isNotStackable[e*this._width+t]=s)}setIsRoomTile(t,e,s){this.validPosition(t,e)&&(this._isRoomTile[e*this._width+t]=s)}validateLocation(t,e,s,r,n,o,l,c,u,h=-1){let d=0,f=0;if(!this.validPosition(t,e)||!this.validPosition(t+s-1,e+r-1))return!1;(n<0||n>=this._width)&&(n=0),(o<0||o>=this._height)&&(o=0),l=Math.min(l,this._width-n),c=Math.min(c,this._height-o),h===-1&&(h=this.getTileHeight(t,e));let E=e;for(;E<e+r;){for(d=t;d<t+s;){if(d<n||d>=n+l||E<o||E>=o+c){if(f=E*this._width+d,u){if(!this._isRoomTile[f])return!1}else if(this._isNotStackable[f]||!this._isRoomTile[f]||Math.abs(this._heights[f]-h)>.01)return!1}d++}E++}return!0}get width(){return this._width}get height(){return this._height}}const Tr=class Tr{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(t){this._scale=t}dispose(){this.reset(),this._isDisposed=!0}initialize(t,e,s){if(t<=this._width&&e<=this._height){this._width=t,this._height=e,this._floorHeight=s;return}this.reset();let r=0;for(;r<e;){const n=[];this._heightMap.push(n);let o=0;for(;o<t;)n.push(0),o++;r++}this._width=t,this._height=e,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(t,e,s){if(t<0||t>=this._width||e<0||e>=this._height)return!1;const r=this._heightMap[e];return r?(r[t]=s,!0):!1}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return 0;const s=this._heightMap[e];return s?s[t]:0}getLocation(t,e,s,r,n){if(t==0&&e==0){t=this._width,e=this._height;const h=Math.round(this.scale/10);if(n==Tr.R){let d=this._width-1;for(;d>=0;){let f=1;for(;f<this._height;){if(this.getHeight(d,f)<=this._floorHeight){f-1<e&&(t=d,e=f-1);break}f++}d--}r=r+(this.scale/4-h/2),s=s+this.scale/2}else{let d=this._height-1;for(;d>=0;){let f=1;for(;f<this._width;){if(this.getHeight(f,d)<=this._floorHeight){f-1<t&&(t=f-1,e=d);break}f++}d--}r=r+(this.scale/4-h/2),s=s-h}}let o=t,l=e,c=this.getHeight(t,e);return n==Tr.R?(o=o+(s/(this._scale/2)-.5),l=l+.5,c=c-(r-s/2)/(this._scale/2)):(l=l+((this._scale/2-s)/(this._scale/2)-.5),o=o+.5,c=c-(r-(this._scale/2-s)/2)/(this._scale/2)),new w(o,l,c)}getLocationOldFormat(t,e,s){let r,n,o=0,l=0;n=Math.ceil(t),o=n-t;let c,u,h,d=0;for(r=0;r<this._width;){if(n>=0&&n<this._height){if(this.getHeight(r,n)<=this._floorHeight){c=r-1,u=n,l=r,s=Tr.L;break}if(this.getHeight(r,n+1)<=this._floorHeight){c=r,u=n,l=u-t,s=Tr.R;break}}n++,r++}const f=this.scale/2*o;let E=-l*this.scale/2;return E=E+-e*18/32*this.scale/2,d=this.getHeight(c,u),h=d*this.scale/2+E,s==Tr.R?h=h+o*this.scale/4:h=h+(1-o)*this.scale/4,this.getLocation(c,u,f,h,s)}getOldLocation(t,e){if(t==null)return null;let s=0,r=0,n=0,o=0,l="",c=0;if(e==90)s=Math.floor(t.x-.5),r=Math.floor(t.y+.5),c=this.getHeight(s,r),n=this._scale/2-(t.y-r+.5)*(this._scale/2),o=(c-t.z)*(this._scale/2)+(this._scale/2-n)/2,l=Tr.L;else if(e==180)s=Math.floor(t.x+.5),r=Math.floor(t.y-.5),c=this.getHeight(s,r),n=(t.x+.5-s)*(this._scale/2),o=(c-t.z)*(this._scale/2)+n/2,l=Tr.R;else return null;return[s,r,n,o,l]}getOldLocationString(t,e){const s=this.getOldLocation(t,e);if(s==null)return null;const r=Math.trunc(s[0]),n=Math.trunc(s[1]),o=Math.trunc(s[2]),l=Math.trunc(s[3]),c=s[4];return":w="+r+","+n+" l="+o+","+l+" "+c}getDirection(t){return t==Tr.R?180:90}getFloorAltitude(t,e){const s=this.getHeight(t,e),r=s+1;return s+(Math.trunc(this.getHeight(t-1,e-1))==r||Math.trunc(this.getHeight(t,e-1))==r||Math.trunc(this.getHeight(t+1,e-1))==r||Math.trunc(this.getHeight(t-1,e))==r||Math.trunc(this.getHeight(t+1,e))==r||Math.trunc(this.getHeight(t-1,e+1))==r||Math.trunc(this.getHeight(t,e+1))==r||Math.trunc(this.getHeight(t+1,e+1))==r?.5:0)}isRoomTile(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._heightMap[e][t]>=0}};Tr.DEFAULT_SCALE=32,Tr.L="l",Tr.R="r";let ud=Tr;const Me=class Me{constructor(t){this._roomEngine=null,this._state=Me.NOT_ACTIVE,this._tileXInit=0,this._tileYInit=0,this._tileXEnd=0,this._tileYEnd=0,this._highlightRootX=0,this._highlightRootY=0,this._highlightWidth=0,this._highlightHeight=0,this._highlightType=Me.HIGHLIGHT_BRIGHTEN,this._roomEngine=t,X().addEventListener(Ot.ADDED,n=>{if(this._state===Me.NOT_ACTIVE||n.roomId!==this._roomEngine.activeRoomId||n.category!==10&&n.category!==20)return;const o=this._roomEngine.getRoomObject(n.roomId,n.objectId,n.category);o.visualization instanceof ga&&(o.visualization.lookThrough=!0)});const e=new Fu;e.matrix=[1.5,0,0,0,0,1.5,0,0,0,0,1.5,0,0,0,0,1,0,.0784,.0784,0];const s=new Fu;s.matrix=[1.05,0,0,0,0,1.3,0,0,0,0,1.8,0,0,0,0,1,0,.0314,.0784,0];const r=new Fu;r.matrix=[.55,0,0,0,0,.55,0,0,0,0,.55,0,0,0,0,1,-.0392,-.0392,-.0392,0],Me.HIGHLIGHT_FILTERS[Me.HIGHLIGHT_DARKEN]=r,Me.HIGHLIGHT_FILTERS[Me.HIGHLIGHT_BRIGHTEN]=e,Me.HIGHLIGHT_FILTERS[Me.HIGHLIGHT_BLUE]=s}getAllFurniture(){return this._roomEngine.getRoomObjects(this._roomEngine.activeRoomId,20).concat(this._roomEngine.getRoomObjects(this._roomEngine.activeRoomId,10))}startSelecting(){this._state===Me.NOT_SELECTING_AREA&&(this.clearHighlightSilent(),this._state=Me.AWAITING_MOUSE_DOWN,this._roomEngine.moveBlocked=!0)}handleTileMouseEvent(t){let e=this._state===Me.AWAITING_MOUSE_DOWN&&t.type==Ut.MOUSE_DOWN;if(t.shiftKey&&this._state===Me.NOT_SELECTING_AREA&&t.type==Ut.MOUSE_DOWN&&(this.startSelecting(),e=!0),e){this._state=Me.SELECTING,this._tileXInit=t.tileXAsInt,this._tileYInit=t.tileYAsInt,this._tileXEnd=t.tileXAsInt,this._tileYEnd=t.tileYAsInt,this.setHighlight(this._tileXInit,this._tileYInit,1,1);return}if(this._state===Me.SELECTING&&t.type===Ut.MOUSE_MOVE&&(t.tileXAsInt!==this._tileXEnd||t.tileYAsInt!==this._tileYEnd)){let s=0,r=0,n=0,o=0;this._tileXEnd=t.tileXAsInt,this._tileYEnd=t.tileYAsInt,this._tileXEnd>this._tileXInit?(s=this._tileXInit,n=this._tileXEnd-this._tileXInit+1):(s=this._tileXEnd,n=this._tileXInit-this._tileXEnd+1),this._tileYEnd>this._tileYInit?(r=this._tileYInit,o=this._tileYEnd-this._tileYInit+1):(r=this._tileYEnd,o=this._tileYInit-this._tileYEnd+1),this.setHighlight(s,r,n,o)}}finishSelecting(){return this._state!==Me.SELECTING?!1:(this._state=Me.NOT_SELECTING_AREA,this._roomEngine.moveBlocked=!1,this._callback&&this._callback(this._highlightRootX,this._highlightRootY,this._highlightWidth,this._highlightHeight),!0)}clearHighlightSilent(){var e;const t=this._roomEngine.getRoomObject(this._roomEngine.activeRoomId,-1,0);t&&((e=t.visualization)==null||e.clearHighlightArea())}clearHighlight(){this._state!==Me.NOT_ACTIVE&&(this.clearHighlightSilent(),this._state=Me.NOT_SELECTING_AREA,this._roomEngine.moveBlocked=!1,this._callback&&this._callback(0,0,0,0))}setHighlight(t,e,s,r){var o;if(this._state===Me.NOT_ACTIVE)return;this._highlightRootX=t,this._highlightRootY=e,this._highlightWidth=s,this._highlightHeight=r;const n=this._roomEngine.getRoomObject(this._roomEngine.activeRoomId,-1,0);n&&((o=n.visualization)==null||o.initializeHighlightArea(t,e,s,r,Me.HIGHLIGHT_FILTERS[this._highlightType]))}activate(t,e){if(this._state!==Me.NOT_ACTIVE)return!1;this._callback=t,this._highlightType=e;for(const s of this.getAllFurniture()){const r=s.visualization;r&&(r.lookThrough=!0)}return this._state=Me.NOT_SELECTING_AREA,!0}deactivate(){if(this._state!==Me.NOT_ACTIVE){this._callback=null;for(const t of this.getAllFurniture()){const e=t.visualization;e&&(e.lookThrough=!1)}this.clearHighlight(),this._state=Me.NOT_ACTIVE}}get areaSelectionState(){return this._state}};Me.NOT_ACTIVE=0,Me.NOT_SELECTING_AREA=1,Me.AWAITING_MOUSE_DOWN=2,Me.SELECTING=3,Me.HIGHLIGHT_DARKEN="highlight_darken",Me.HIGHLIGHT_BRIGHTEN="highlight_brighten",Me.HIGHLIGHT_BLUE="highlight_blue",Me.HIGHLIGHT_FILTERS={};let zu=Me;const hm=class hm{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new w}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(t){this._targetId=t}get targetCategory(){return this._targetCategory}set targetCategory(t){this._targetCategory=t}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(t){this._targetObjectLoc.assign(t)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(t){this._limitedLocX=t}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(t){this._limitedLocY=t}get centeredLocX(){return this._centeredLocX}set centeredLocX(t){this._centeredLocX=t}get centeredLocY(){return this._centeredLocY}set centeredLocY(t){this._centeredLocY=t}get screenWd(){return this._screenWd}set screenWd(t){this._screenWd=t}get screenHt(){return this._screenHt}set screenHt(t){this._screenHt=t}get scale(){return this._scale}set scale(t){this._scale!=t&&(this._scale=t,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(t){this._roomWd=t}get roomHt(){return this._roomHt}set roomHt(t){this._roomHt=t}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(t){this._geometryUpdateId=t}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(t){let e;this._targetLoc==null&&(this._targetLoc=new w),(this._targetLoc.x!=t.x||this._targetLoc.y!=t.y||this._targetLoc.z!=t.z)&&(this._targetLoc.assign(t),e=w.dif(this._targetLoc,this._currentLoc),this._moveDistance=e.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(t){this._currentLoc==null&&(this._currentLoc=new w,this._currentLoc.assign(t))}resetLocation(t){this._currentLoc==null&&(this._currentLoc=new w),this._currentLoc.assign(t)}update(t,e){let s,r,n,o,l;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}s=w.dif(this._targetLoc,this._currentLoc),s.length>this._moveDistance&&(this._moveDistance=s.length),s.length<=e?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(r=Math.sin(Math.PI*s.length/this._moveDistance),n=e*.5,o=this._moveDistance/hm.MOVE_SPEED_DENOMINATOR,l=n+(o-n)*r,this._maintainPreviousMoveSpeed&&(l<this._previousMoveSpeed?(l=this._previousMoveSpeed,l>s.length&&(l=s.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=l,s.divide(s.length),s.multiply(l),this._currentLoc=w.sum(this._currentLoc,s))}}reset(){this._geometryUpdateId=-1}activateFollowing(t){this._followDuration=t}};hm.MOVE_SPEED_DENOMINATOR=12;let jT=hm;class tX{constructor(t,e){this._roomId=t,this._data=e,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(t){this._floorType=t}get wallType(){return this._wallType}set wallType(t){this._wallType=t}get landscapeType(){return this._landscapeType}set landscapeType(t){this._landscapeType=t}}const qt=class qt{static init(t,e){qt._currentDelta=0,qt._startDelayMs=t,qt._effectDurationMs=e,qt._initializationTimeMs=zt(),qt._state=qt.STATE_START_DELAY}static turnVisualizationOn(){if(qt._state===qt.STATE_NOT_INITIALIZED||qt._state===qt.STATE_OVER)return;const t=zt()-qt._initializationTimeMs;if(t>qt._startDelayMs+qt._effectDurationMs){qt._state=qt.STATE_OVER;return}if(qt._visualizationOn=!0,t<qt._startDelayMs){qt._state=qt.STATE_START_DELAY;return}qt._state=qt.STATE_RUNNING,qt._currentDelta=(t-qt._startDelayMs)/qt._effectDurationMs}static turnVisualizationOff(){qt._visualizationOn=!1}static isVisualizationOn(){return qt._visualizationOn&&qt.isRunning()}static isRunning(){return qt._state===qt.STATE_START_DELAY||qt._state===qt.STATE_RUNNING}static getDelta(t=0,e=1){return Math.min(Math.max(qt._currentDelta,t),e)}static get totalRunningTime(){return qt._startDelayMs+qt._effectDurationMs}};qt.STATE_NOT_INITIALIZED=0,qt.STATE_START_DELAY=1,qt.STATE_RUNNING=2,qt.STATE_OVER=3,qt._state=qt.STATE_NOT_INITIALIZED,qt._visualizationOn=!1,qt._currentDelta=0,qt._initializationTimeMs=0,qt._startDelayMs=20*1e3,qt._effectDurationMs=2e3;let Cr=qt;class pE{constructor(t,e,s,r,n,o,l,c=NaN,u=-1,h=0,d=0,f="",E=!0,m=!0,I=-1){this._id=t,this._typeId=e,this._type=s,this._state=o,this._data=l,this._extra=c,this._expiryTime=u,this._usagePolicy=h,this._ownerId=d,this._ownerName=f,this._synchronized=E,this._realRoomObject=m,this._sizeZ=I,this._location=new w,this._direction=new w,this._location.assign(r),this._direction.assign(n)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}const Kn=class Kn{constructor(t,e,s,r=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=t,this._x=new w,this._y=new w,this._z=new w,this._directionAxis=new w,this._location=new w,this._direction=new w,this._depth=new w,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new w(s.x,s.y,s.z),this.direction=new w(e.x,e.y,e.z),r!=null?this.setDepthVector(r):this.setDepthVector(e),this._displacements=new Map}static getIntersectionVector(t,e,s,r){const n=w.dotProduct(e,r);if(Math.abs(n)<1e-5)return null;const o=w.dif(t,s),l=-w.dotProduct(r,o)/n;return w.sum(t,w.product(e,l))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(t){t<=1&&(t=1),t=t*Math.sqrt(.5),t!=this._scale&&(this._scale=t,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(t){if(t==null)return;this._loc==null&&(this._loc=new w);const e=this._loc.x,s=this._loc.y,r=this._loc.z;this._loc.assign(t),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=e||this._loc.y!=s||this._loc.z!=r)&&this._updateId++}get direction(){return this._direction}set direction(t){let e,s,r,n,o;if(t==null)return;this._dir==null&&(this._dir=new w);const l=this._dir.x,c=this._dir.y,u=this._dir.z;this._dir.assign(t),this._direction.assign(t),(this._dir.x!=l||this._dir.y!=c||this._dir.z!=u)&&this._updateId++;const h=new w(0,1,0),d=new w(0,0,1),f=new w(1,0,0),E=t.x/180*Math.PI,m=t.y/180*Math.PI,I=t.z/180*Math.PI,p=Math.cos(E),T=Math.sin(E),R=w.sum(w.product(h,p),w.product(f,-T)),S=new w(d.x,d.y,d.z),L=w.sum(w.product(h,T),w.product(f,p)),M=Math.cos(m),P=Math.sin(m),k=new w(R.x,R.y,R.z),G=w.sum(w.product(S,M),w.product(L,P)),j=w.sum(w.product(S,-P),w.product(L,M));I!=0?(e=Math.cos(I),s=Math.sin(I),r=w.sum(w.product(k,e),w.product(G,s)),n=w.sum(w.product(k,-s),w.product(G,e)),o=new w(j.x,j.y,j.z),this._x.assign(r),this._y.assign(n),this._z.assign(o),this._directionAxis.assign(this._z)):(this._x.assign(k),this._y.assign(G),this._z.assign(j),this._directionAxis.assign(this._z))}set x_scale(t){this._x_scale!=t*this._x_scale_internal&&(this._x_scale=t*this._x_scale_internal,this._updateId++)}set y_scale(t){this._y_scale!=t*this._y_scale_internal&&(this._y_scale=t*this._y_scale_internal,this._updateId++)}set z_scale(t){this._z_scale!=t*this._z_scale_internal&&(this._z_scale=t*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(t,e){let s,r;t==null||e==null||this._displacements!=null&&(s=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.delete(s),r=new w,r.assign(e),this._displacements.set(s,r),this._updateId++)}getDisplacenent(t){let e;return this._displacements!=null?(e=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.get(e)):null}setDepthVector(t){let e,s,r;const n=new w(0,1,0),o=new w(0,0,1),l=new w(1,0,0),c=t.x/180*Math.PI,u=t.y/180*Math.PI,h=t.z/180*Math.PI,d=Math.cos(c),f=Math.sin(c),E=w.sum(w.product(n,d),w.product(l,-f)),m=new w(o.x,o.y,o.z),I=w.sum(w.product(n,f),w.product(l,d)),p=Math.cos(u),T=Math.sin(u),R=new w(E.x,E.y,E.z),S=w.sum(w.product(m,p),w.product(I,T)),L=w.sum(w.product(m,-T),w.product(I,p));h!=0?(e=Math.cos(h),s=Math.sin(h),w.sum(w.product(R,e),w.product(S,s)),w.sum(w.product(R,-s),w.product(S,e)),r=new w(L.x,L.y,L.z),this._depth.assign(r)):this._depth.assign(L),this._updateId++}adjustLocation(t,e){if(t==null||this._z==null)return;const s=w.product(this._z,-e),r=new w(t.x+s.x,t.y+s.y,t.z+s.z);this.location=r}getCoordinatePosition(t){if(t==null)return null;const e=w.scalarProjection(t,this._x),s=w.scalarProjection(t,this._y),r=w.scalarProjection(t,this._z);return new w(e,s,r)}getScreenPosition(t){let e=w.dif(t,this._loc);e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale;let s=w.scalarProjection(e,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let r=w.scalarProjection(e,this._x),n=-w.scalarProjection(e,this._y);r=r*this._scale,n=n*this._scale;const o=this.getDisplacenent(t);return o!=null&&(e=w.dif(t,this._loc),e.add(o),e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale,s=w.scalarProjection(e,this._depth)),e.x=r,e.y=n,e.z=s,e}getScreenPoint(t){const e=this.getScreenPosition(t);return e==null?null:new Qt(e.x,e.y)}getPlanePosition(t,e,s,r){let n,o;const l=t.x/this._scale,c=-t.y/this._scale,u=w.product(this._x,l);u.add(w.product(this._y,c));const h=new w(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);h.add(u);const d=this._z,f=new w(e.x*this._x_scale,e.y*this._y_scale,e.z*this._z_scale),E=new w(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),m=new w(r.x*this._x_scale,r.y*this._y_scale,r.z*this._z_scale),I=w.crossProduct(E,m),p=new w;return p.assign(Kn.getIntersectionVector(h,d,f,I)),p!=null?(p.subtract(f),n=w.scalarProjection(p,s)/E.length*s.length,o=w.scalarProjection(p,r)/m.length*r.length,new Qt(n,o)):null}performZoom(){this.isZoomedIn()?this.scale=Kn.SCALE_ZOOMED_OUT:this.scale=Kn.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==Kn.SCALE_ZOOMED_IN}performZoomOut(){this.scale=Kn.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=Kn.SCALE_ZOOMED_IN}};Kn.SCALE_ZOOMED_IN=64,Kn.SCALE_ZOOMED_OUT=32;let Ho=Kn;class eX{constructor(t,e){this._tileObjectMap=new Map;let s=0;for(;s<e;)this._tileObjectMap.set(s,new Map),s++;this._width=t,this._height=e}clear(){for(const t of this._tileObjectMap.values())t&&t.clear();this._tileObjectMap.clear()}populate(t){this.clear();for(const e of t)this.addRoomObject(e)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(t,e){if(t>=0&&t<this._width&&e>=0&&e<this._height){const s=this._tileObjectMap.get(e);if(s)return s.get(t)}return null}setObjectInTile(t,e,s){if(!s.isReady){Lt.log("Assigning non initialized object to tile object map!");return}if(t>=0&&t<this._width&&e>=0&&e<this._height){const r=this._tileObjectMap.get(e);r&&r.set(t,s)}}addRoomObject(t){if(!t||!t.model||!t.isReady)return;const e=t.getLocation(),s=t.getDirection();if(!e||!s)return;let r=t.model.getValue(A.FURNITURE_SIZE_X),n=t.model.getValue(A.FURNITURE_SIZE_Y);r<1&&(r=1),n<1&&(n=1);const o=Math.trunc(s.x+45)%360/90;(o===1||o===3)&&([r,n]=[n,r]);let l=e.y;for(;l<e.y+n;){let c=e.x;for(;c<e.x+r;){const u=this.getObjectIntTile(c,l);(!u||u!==t&&u.getLocation().z<=e.z)&&this.setObjectInTile(c,l,t),c++}l++}}}class sX{constructor(t){this._roomId=t,this._modelName=null,this._legacyGeometry=new ud,this._tileObjectMap=null,this._roomCamera=new jT,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(t){this._modelName=t}setSelectedObject(t){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=t}setPlacedObject(t){this._placedObject&&this._placedObject.dispose(),this._placedObject=t}setFurnitureStackingHeightMap(t){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=t,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new eX(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(t){t&&(this._floorStack.delete(t.id),this._floorStack.set(t.id,t))}removePendingFunitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getPendingFurnitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const t=this._floorStack.keys();return this.getPendingFurnitureFloor(t.next().value)}addPendingFurnitureWall(t){t&&(this._wallStack.delete(t.id),this._wallStack.set(t.id,t))}removePendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getPendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const t=this._wallStack.keys();return this.getPendingFurnitureWall(t.next().value)}addButtonMouseCursorOwner(t){return this._mouseButtonCursorOwners.indexOf(t)===-1?(this._mouseButtonCursorOwners.push(t),!0):!1}removeButtonMouseCursorOwner(t){const e=this._mouseButtonCursorOwners.indexOf(t);return e>-1?(this._mouseButtonCursorOwners.splice(e,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class iX{constructor(t,e){this._object=t,this._groupBadge=e}get object(){return this._object}get groupBadge(){return this._groupBadge}}const Wr=class Wr{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=zt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=zt()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}};Wr.STATE_NOT_INITIALIZED=0,Wr.STATE_START_DELAY=1,Wr.STATE_RUNNING=2,Wr.STATE_OVER=3,Wr._SafeStr_448=0,Wr._SafeStr_4512=!1,Wr._SafeStr_4513=0,Wr._SafeStr_4514=0,Wr._SafeStr_4515=2e4,Wr._SafeStr_4516=5e3;let hd=Wr;const cn=class cn{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=zt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=zt()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}};cn.STATE_NOT_INITIALIZED=0,cn.STATE_START_DELAY=1,cn.STATE_RUNNING=2,cn.STATE_OVER=3,cn._SafeStr_448=0,cn._SafeStr_4512=!1,cn._SafeStr_4514=0,cn._SafeStr_4515=2e4,cn._SafeStr_4516=5e3;let Cu=cn;class IE{constructor(t,e,s,r,n,o=0,l=null,c=null,u=-1,h=-1,d=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=t,this._category=e,this._operation=s,this._loc=new w,this._loc.assign(r),this._dir=new w,this._dir.assign(n),this._typeId=o,this._instanceData=l,this._stuffData=c,this._state=u,this._animFrame=h,this._posture=d}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}class rX{constructor(t,e,s){this._type=t,this._leftSideLoc=e,this._rightSideLoc=s}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class nX{constructor(t,e,s,r){this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=r}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}var bs;let aX=(bs=class{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(t=1){bs._randomizer||(bs._randomizer=new bs),bs._randomizer.seed=t}static setModulus(t=16777216){bs._randomizer||(bs._randomizer=new bs),bs._randomizer.modulus=t}static getValues(t,e,s){return bs._randomizer||(bs._randomizer=new bs),bs._randomizer.getRandomValues(t,e,s)}static getArray(t,e){return bs._randomizer||(bs._randomizer=new bs),bs._randomizer.getRandomArray(t,e)}set seed(t){this._seed=t}set modulus(t){t<1&&(t=1),this._modulus=t}dispose(){}getRandomValues(t,e,s){const r=[];let n=0;for(;n<t;)r.push(this.iterateScaled(e,s-e)),n++;return r}getRandomArray(t,e){if(t>e||e>1e3)return null;const s=[];let r=0;for(;r<=e;)s.push(r),r++;const n=[];let o=0;for(;o<t;){const l=this.iterateScaled(0,s.length-1);n.push(s[l]),s.splice(l,1),o++}return n}iterate(){let t=FN(Math.trunc(this._multiplier*this._seed)+this._increment);return t<0&&(t=-t),t=t%this._modulus,this._seed=t,t}iterateScaled(t,e){let s=this.iterate();return e<1?t:(s=Math.trunc(t+s/this._modulus*e),s)}},bs.DEFAULT_SEED=1,bs.DEFAULT_MODULUS=16777216,bs._randomizer=null,bs);const ge=class ge{constructor(t,e,s,r,n,o,l,c,u=0,h=0,d=0,f=0){if(this._disposed=!1,this._origin=new w,this._location=new w,this._leftSide=new w,this._rightSide=new w,this._normal=null,this._secondaryNormals=[],this._isVisible=!1,this._offset=new Qt,this._relativeDepth=0,this._color=0,this._maskManager=null,this._id=null,this._cornerA=new w,this._cornerB=new w,this._cornerC=new w,this._cornerD=new w,this._width=0,this._height=0,this._hasTexture=!0,this._canBeVisible=!0,this._geometryUpdateId=-1,this._extraDepth=0,this._isHighlighter=!1,this._bitmapMasks=[],this._rectangleMasks=[],this._maskChanged=!1,this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._planeSprite=null,this._planeTexture=null,this._maskFilter=null,this._randomSeed=c,this._origin.assign(t),this._location.assign(e),this._leftSide.assign(s),this._rightSide.assign(r),this._normal=w.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),l!=null)for(const E of l){if(!E)continue;const m=new w;m.assign(E),this._secondaryNormals.push(m)}this._type=n,this._textureOffsetX=u,this._textureOffsetY=h,this._textureMaxX=d,this._textureMaxY=f,this._useMask=o,this._uniqueId=++ge._uniqueIdCounter}dispose(){this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._planeSprite&&this._planeSprite.destroy(),this._planeTexture&&(la().putTexture(this._planeTexture),this._planeTexture=null),this._disposed=!0}update(t,e,s=!1){if(!t||this._disposed||(this._geometryUpdateId!==t.updateId&&(this._geometryUpdateId=t.updateId,s=!0),(!s||!this._canBeVisible)&&!this.visible))return!1;if(s){let r=0;if(r=w.cosAngle(t.directionAxis,this.normal),r>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let n=0;for(;n<this._secondaryNormals.length;){if(r=w.cosAngle(t.directionAxis,this._secondaryNormals[n]),r>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;n++}this.updateCorners(t);let o=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-t.getScreenPosition(this._origin).z;switch(this._type){case ge.TYPE_FLOOR:o=o-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8;break;case ge.TYPE_LANDSCAPE:o=o+.02;break}this._relativeDepth=o,this._isVisible=!0,aX.setSeed(this._randomSeed);let l=this._leftSide.length*t.scale,c=this._rightSide.length*t.scale;t.getCoordinatePosition(this._normal);const h=((f,E)=>{var G,j,F,U,K,B,J,Z,Q,ut,Bt;const m=E===ge.TYPE_FLOOR?"floorData":E===ge.TYPE_WALL?"wallData":"landscapeData",I=ae().getCollection("room"),p=(j=(G=I==null?void 0:I.data)==null?void 0:G.roomVisualization)==null?void 0:j[m],T=(F=p==null?void 0:p.planes)==null?void 0:F.find(te=>te.id===f),R=m==="landscapeData"?(U=T==null?void 0:T.animatedVisualization)==null?void 0:U[0]:(K=T==null?void 0:T.visualizations)==null?void 0:K[0],S=(B=R==null?void 0:R.allLayers)==null?void 0:B[0],L=S==null?void 0:S.materialId,M=S==null?void 0:S.color,P=(ut=(Q=(Z=(J=p==null?void 0:p.textures)==null?void 0:J.find(te=>te.id===L))==null?void 0:Z.bitmaps)==null?void 0:Q[0])==null?void 0:ut.assetName;return{texture:(Bt=ae().getAsset(P))==null?void 0:Bt.texture,color:M}})(this._id,this._type),d=this._hasTexture?h.texture??Es.WHITE:Es.WHITE;switch(this._type){case ge.TYPE_FLOOR:{const f=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,0,0)),E=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,c/ge.PLANE_GEOMETRY.scale,0)),m=ge.PLANE_GEOMETRY.getScreenPoint(new w(l/ge.PLANE_GEOMETRY.scale,0,0));let I=0,p=0;if(f&&E&&m){l=Math.round(Math.abs(f.x-m.x)),c=Math.round(Math.abs(f.x-E.x));const T=f.x-ge.PLANE_GEOMETRY.getScreenPoint(new w(1,0,0)).x;I=this._textureOffsetX*Math.trunc(Math.abs(T)),p=this._textureOffsetY*Math.trunc(Math.abs(T))}if(I!==0||p!==0){for(;I<0;)I+=d.width;for(;p<0;)p+=d.height}this._planeSprite=new kd({texture:d,width:l,height:c,tint:h.color,tilePosition:{x:I%d.width+this._textureOffsetX*d.width,y:p%d.height+this._textureOffsetY*d.height}});break}case ge.TYPE_WALL:{const f=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,0,0)),E=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,0,c/ge.PLANE_GEOMETRY.scale)),m=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,l/ge.PLANE_GEOMETRY.scale,0));f&&E&&m&&(l=Math.round(Math.abs(f.x-m.x)),c=Math.round(Math.abs(f.y-E.y))),this._planeSprite=new kd({texture:d,width:l,height:c,tint:h.color,tilePosition:{x:this._textureOffsetX*d.width,y:this._textureOffsetY*d.height}});break}case ge.TYPE_LANDSCAPE:{const f=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,0,0)),E=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,0,1)),m=ge.PLANE_GEOMETRY.getScreenPoint(new w(0,1,0));f&&E&&m&&(l=Math.round(Math.abs((f.x-m.x)*l/ge.PLANE_GEOMETRY.scale)),c=Math.round(Math.abs((f.y-E.y)*c/ge.PLANE_GEOMETRY.scale))),Math.trunc(this._textureMaxX*Math.abs(f.x-m.x)),Math.trunc(this._textureMaxY*Math.abs(f.y-E.y));const I=Math.trunc(this._textureOffsetX*Math.abs(f.x-m.x)),p=Math.trunc(this._textureOffsetY*Math.abs(f.y-E.y));this._planeSprite=new kd({texture:d,width:l,height:c,tilePosition:{x:I,y:p},tint:ge.LANDSCAPE_COLOR});break}default:this._planeSprite=new kd({texture:Es.WHITE,width:l,height:c})}this._planeSprite.allowChildren=!0}return(s||this._maskChanged)&&(this.updateMask(this._planeSprite,t),s=!0),this._planeTexture&&(this._planeTexture.width!==this._width||this._planeTexture.height!==this._height)&&(la().putTexture(this._planeTexture),this._planeTexture=null),this._planeTexture||(this._planeTexture=la().getTexture(this._width,this._height)),this._planeTexture.source.label=`room_plane_${this._uniqueId.toString()}`,s&&Mr().render({target:this._planeTexture,container:this._planeSprite,transform:this.getMatrixForDimensions(this._planeSprite.width,this._planeSprite.height),clear:!0}),!0}updateCorners(t){this._cornerA.assign(t.getScreenPosition(this._location)),this._cornerB.assign(t.getScreenPosition(w.sum(this._location,this._rightSide))),this._cornerC.assign(t.getScreenPosition(w.sum(w.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(t.getScreenPosition(w.sum(this._location,this._leftSide))),this._offset=t.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const e=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),s=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-e,r=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),n=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-r;this._offset.x=this._offset.x-e,this._cornerA.x=this._cornerA.x-e,this._cornerB.x=this._cornerB.x-e,this._cornerC.x=this._cornerC.x-e,this._cornerD.x=this._cornerD.x-e,this._offset.y=this._offset.y-r,this._cornerA.y=this._cornerA.y-r,this._cornerB.y=this._cornerB.y-r,this._cornerC.y=this._cornerC.y-r,this._cornerD.y=this._cornerD.y-r,this._width=s,this._height=n}getMatrixForDimensions(t,e){let s=this._cornerD.x-this._cornerC.x,r=this._cornerD.y-this._cornerC.y,n=this._cornerB.x-this._cornerC.x,o=this._cornerB.y-this._cornerC.y;(this._type===ge.TYPE_WALL||this._type===ge.TYPE_LANDSCAPE)&&(Math.abs(n-t)<=1&&(n=t),Math.abs(o-t)<=1&&(o=t),Math.abs(s-e)<=1&&(s=e),Math.abs(r-e)<=1&&(r=e));const l=n/t,c=o/t,u=s/e,h=r/e,d=new _r(l,c,u,h);return d.translate(this._cornerC.x,this._cornerC.y),d}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(t,e,s){if(!this._useMask)return!1;for(const n of this._bitmapMasks)if(n&&n.type===t&&n.leftSideLoc===e&&n.rightSideLoc===s)return!1;const r=new rX(t,e,s);return this._bitmapMasks.push(r),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(t,e,s,r){if(this._useMask){for(const n of this._rectangleMasks)if(n&&n.leftSideLoc===t&&n.rightSideLoc===e&&n.leftSideLength===s&&n.rightSideLength===r)return!1;return this._rectangleMasks.push(new nX(t,e,s,r)),this._maskChanged=!0,!0}return!1}updateMask(t,e){var c;if((c=t.children)!=null&&c.length&&t.removeChildren(),!t||!e||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length||!this._maskManager)return!1;const s=e.getCoordinatePosition(this._normal);let r=null,n=0,o=0,l=0;for(;l<this._bitmapMasks.length;){const u=this._bitmapMasks[l];u&&(r=u.type,n=t.width-t.width*u.leftSideLoc/this._leftSide.length,o=t.height-t.height*u.rightSideLoc/this._rightSide.length,this._maskManager.addMaskToContainer(t,r,e.scale,s,n,o)),l++}for(l=0;l<this._rectangleMasks.length;){const u=this._rectangleMasks[l];if(u){n=t.width-t.width*u.leftSideLoc/this._leftSide.length,o=t.height-t.height*u.rightSideLoc/this._rightSide.length;const h=t.width*u.leftSideLength/this._leftSide.length,d=t.height*u.rightSideLength/this._rightSide.length,f=new Ve(Es.WHITE);f.tint=0,f.width=h,f.height=d,f.position.set(Math.trunc(n-h),Math.trunc(o-d)),t.addChild(f)}l++}return this._maskChanged=!1,this._maskFilter||(this._maskFilter=new sp({})),t.filters||(t.filters=[this._maskFilter]),!0}get canBeVisible(){return this._canBeVisible}set canBeVisible(t){t!==this._canBeVisible&&(this._canBeVisible=t)}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth+this._extraDepth}set extraDepth(t){this._extraDepth=t}get color(){return this._color}set color(t){this._color=t}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}set id(t){t!==this._id&&(this._id=t)}set maskManager(t){this._maskManager=t}get uniqueId(){return this._uniqueId}get planeTexture(){return this._planeTexture}set hasTexture(t){this._hasTexture=t}get isHighlighter(){return this._isHighlighter}set isHighlighter(t){this._isHighlighter=t}};ge.HORIZONTAL_ANGLE_DEFAULT=45,ge.VERTICAL_ANGLE_DEFAULT=30,ge.PLANE_GEOMETRY=new Ho(64,new w(ge.HORIZONTAL_ANGLE_DEFAULT,ge.VERTICAL_ANGLE_DEFAULT),new w(-10,0,0)),ge.LANDSCAPE_COLOR=33520,ge.TYPE_UNDEFINED=0,ge.TYPE_WALL=1,ge.TYPE_FLOOR=2,ge.TYPE_LANDSCAPE=3,ge._uniqueIdCounter=1;let Ge=ge;const dm=class dm{constructor(t,e=-1,s=1,r=-1,n=1){this._normalMinX=e,this._normalMaxX=s,this._normalMinY=r,this._normalMaxY=n,this._asset=t}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}};dm.MIN_NORMAL_COORDINATE_VALUE=-1,dm.MAX_NORMAL_COORDINATE_VALUE=1;let wT=dm;const _m=class _m{constructor(){this._bitmaps=[]}dispose(){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}addBitmap(t,e=-1,s=1,r=-1,n=1){this._bitmaps.push(new wT(t,e,s,r,n))}getAsset(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e.asset;return null}};_m.MIN_NORMAL_COORDINATE_VALUE=-1,_m.MAX_NORMAL_COORDINATE_VALUE=1;let Dl=_m;class oX{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const t of this._maskVisualizations.values())t&&t.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(t){if(this._maskVisualizations.get(t))return null;const s=new Dl;return this._maskVisualizations.set(t,s),this._sizes.push(t),this._sizes.sort(),s}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getMaskVisualization(t){if(t===this._lastSize)return this._lastMaskVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[e]):this._lastMaskVisualization=null,this._lastSize=t,this._lastMaskVisualization}getGraphicAsset(t,e){const s=this.getMaskVisualization(t);return s?s.getAsset(e):null}getAssetName(t){return this._assetNames&&this._assetNames.get(t)||null}setAssetName(t,e){this._assetNames&&this._assetNames.set(t,e)}}class lX{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}}initialize(t){this._data=t}initializeAssetCollection(t){this.data&&(this._assetCollection=t,this.parseMasks(this.data,t))}parseMasks(t,e){if(!(!t||!e)&&t.masks&&t.masks.length){let s=0;for(;s<t.masks.length;){const r=t.masks[s];if(r){const n=r.id;if(this._masks.get(n))continue;const l=new oX;if(r.visualizations&&r.visualizations.length){let c=0;for(;c<r.visualizations.length;){const u=r.visualizations[c];if(u){const h=u.size,d=l.createMaskVisualization(h);if(d){const f=this.parseMaskBitmaps(u.bitmaps,d,e);l.setAssetName(h,f)}}c++}}this._masks.set(n,l)}s++}}}parseMaskBitmaps(t,e,s){if(!t||!t.length)return null;let r=null;for(const n of t){if(!n)continue;const o=n.assetName,l=s.getAsset(o);if(!l)continue;let c=Dl.MIN_NORMAL_COORDINATE_VALUE,u=Dl.MAX_NORMAL_COORDINATE_VALUE,h=Dl.MIN_NORMAL_COORDINATE_VALUE,d=Dl.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(c=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(h=n.normalMinY),n.normalMaxY!==void 0&&(d=n.normalMaxY),l.flipH||(r=o),e.addBitmap(l,c,u,h,d)}return r}addMaskToContainer(t,e,s,r,n,o){const l=this._masks.get(e);if(!l)return!0;const c=l.getGraphicAsset(s,r);if(!c)return!0;const u=c.texture;if(!u)return!0;const h=new Qt(n+c.offsetX,o+c.offsetY),d=new _r;let f=1,E=1,m=0,I=0,p=h.x+m,T=h.y+I;c.flipH&&(f=-1,m=u.width,p=h.x+m-u.width),c.flipV&&(E=-1,I=u.height,T=h.y+I-u.height),d.scale(f,E),d.translate(p,T);const R=new Ve(u);return R.setFromMatrix(d),t.addChild(R),!0}writeMaskToTexture(t,e,s,r,n,o){const l=this._masks.get(e);if(!l)return!0;const c=l.getGraphicAsset(s,r);if(!c)return!0;const u=c.texture;if(!u)return!0;const h=new Qt(n+c.offsetX,o+c.offsetY),d=new _r;let f=1,E=1,m=0,I=0,p=h.x+m,T=h.y+I;return c.flipH&&(f=-1,m=u.width,p=h.x+m-u.width),c.flipV&&(E=-1,I=u.height,T=h.y+I-u.height),d.scale(f,E),d.translate(p,T),Mr().render({target:t,container:new Ve(u),clear:!1,transform:d}),!0}getMask(t){return!this._masks||!this._masks.size?null:this._masks.get(t)||null}}class QL{constructor(){this._maskManager=new lX,this._initialized=!1}initialize(t){if(!t.roomVisualization)return!1;const e=t.roomVisualization.maskData;return e&&this._maskManager.initialize(e),!0}dispose(){this._maskManager&&(this._maskManager.dispose(),this._maskManager=null)}setGraphicAssetCollection(t){this._initialized||(this._maskManager.initializeAssetCollection(t),this._initialized=!0)}clearCache(){}get maskManager(){return this._maskManager}}const us=class us extends Nu{constructor(){super(),this._data=null,this._roomPlaneParser=new Bs,this._roomPlaneBitmapMaskParser=new SL,this._geometryUpdateId=-1,this._boundingRectangle=null,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=16777215,this._greenColor=16777215,this._blueColor=16777215,this._wallType=null,this._floorType=null,this._landscapeType=null,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._highlightAreaX=0,this._highlightAreaY=0,this._highlightAreaWidth=0,this._highlightAreaHeight=0,this._highlightFilter=null,this._highlightPlaneOffsets=[],this._typeVisibility[Ge.TYPE_UNDEFINED]=!1,this._typeVisibility[Ge.TYPE_FLOOR]=!0,this._typeVisibility[Ge.TYPE_WALL]=!0,this._typeVisibility[Ge.TYPE_LANDSCAPE]=!0}initialize(t){return t instanceof QL?(this._data=t,super.initialize(t),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._highlightPlaneOffsets=[],this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null)}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(t,e,s,r){if(!this.object||!t)return;const n=this.updateGeometry(t),o=this.object.model;let l=n;if(this.updateThickness(o)&&(l=!0),this.updateHole(o)&&(l=!0),this.initializeRoomPlanes(),this.updateMasks(o)&&(l=!0),this.updatePlaneTexturesAndVisibilities(o)&&(l=!0),this.updatePlanes(t,n,e,l)&&(l=!0),l){let c=0;for(;c<this._visiblePlanes.length;){const u=this._visiblePlaneSpriteNumbers[c],h=this.getSprite(u),d=this._visiblePlanes[c];if(h&&d&&d.type!==Ge.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let f=d.color;const E=(f&255)*this._redColor/255,m=(f>>8&255)*this._greenColor/255,I=(f>>16&255)*this._blueColor/255;f=(f>>24<<24)+(I<<16)+(m<<8)+E,h.color=f}else h.color=d.color;c++}}this.updateSpriteCounter++,this.updateModelCounter=o.updateCounter}updateGeometry(t){if(!t||this._geometryUpdateId===t.updateId)return!1;this._geometryUpdateId=t.updateId,this._boundingRectangle=null;const e=t.direction;return e&&(e.x!==this._directionX||e.y!==this._directionY||e.z!==this._directionZ||t.scale!==this._roomScale)?(this._directionX=e.x,this._directionY=e.y,this._directionZ=e.z,this._roomScale=t.scale,!0):!1}updateThickness(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(A.ROOM_FLOOR_THICKNESS),s=t.getValue(A.ROOM_WALL_THICKNESS);return!isNaN(e)&&!isNaN(s)&&(e!==this._floorThickness||s!==this._wallThickness)?(this._floorThickness=e,this._wallThickness=s,this.clearPlanes(),!0):!1}updateHole(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(A.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(e)&&e!==this._holeUpdateTime?(this._holeUpdateTime=e,this.clearPlanes(),!0):!1}updatePlaneTexturesAndVisibilities(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(A.ROOM_FLOOR_TYPE),s=t.getValue(A.ROOM_WALL_TYPE),r=t.getValue(A.ROOM_LANDSCAPE_TYPE),n=t.getValue(A.ROOM_FLOOR_VISIBILITY)===1,o=t.getValue(A.ROOM_WALL_VISIBILITY)===1,l=t.getValue(A.ROOM_LANDSCAPE_VISIBILITY)===1;let c=!1;return c=this.updatePlaneTypes(e,s,r),c=this.updatePlaneVisibility(n,o,l)?!0:c,c}updateMasks(t){if(this.updateModelCounter===t.updateCounter)return!1;let e=!1;const s=t.getValue(A.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this.updatePlaneMasks(s),this._maskData=s,e=!0);const r=t.getValue(A.ROOM_BACKGROUND_COLOR);r!==this._color&&(this._color=r,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,e=!0);const n=t.getValue(A.ROOM_COLORIZE_BG_ONLY)||!1;return n!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=n,e=!0),e}clearPlanes(){if(this._planes){for(;this._planes.length;){const t=this._planes[0];t&&t.dispose(),this._planes.shift()}this._planes=[],this._highlightPlaneOffsets=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness),this._roomPlaneParser.clearHighlightArea();const t=this.object.model.getValue(A.ROOM_MAP_DATA);this._roomPlaneParser.initializeFromMapData(t)&&(this._roomPlaneParser.initializeHighlightArea(this._highlightAreaX,this._highlightAreaY,this._highlightAreaWidth,this._highlightAreaHeight),this.createPlanesAndSprites())}createPlanesAndSprites(t=0){const e=this.getLandscapeWidth(),s=this.getLandscapeHeight();let r=0,n=this.object.model.getValue(A.ROOM_RANDOM_SEED),o=t;for(;o<this._roomPlaneParser.planeCount;){this._highlightPlaneOffsets[o]=-1;const l=this._roomPlaneParser.getPlaneLocation(o),c=this._roomPlaneParser.getPlaneLeftSide(o),u=this._roomPlaneParser.getPlaneRightSide(o),h=this._roomPlaneParser.getPlaneSecondaryNormals(o),d=this._roomPlaneParser.getPlaneType(o);let f=null;if(l&&c&&u){const E=w.crossProduct(c,u);if(n=FN(Math.trunc(n*7613+517)>>>0),f=null,d===Ss.PLANE_FLOOR){const m=l.x+c.x+.5,I=l.y+u.y+.5,p=Math.trunc(m)-m,T=Math.trunc(I)-I;f=new Ge(this.object.getLocation(),l,c,u,Ge.TYPE_FLOOR,!0,h,n,-p,-T),f.color=E.z!==0?us.FLOOR_COLOR:E.x!==0?us.FLOOR_COLOR_RIGHT:us.FLOOR_COLOR_LEFT}else d===Ss.PLANE_WALL?(f=new Ge(this.object.getLocation(),l,c,u,Ge.TYPE_WALL,!0,h,n),(c.length<1||u.length<1)&&(f.hasTexture=!1),f.color=E.x===0&&E.y===0?us.WALL_COLOR_BORDER:E.y>0?us.WALL_COLOR_TOP:E.y===0?us.WALL_COLOR_SIDE:us.WALL_COLOR_BOTTOM):d===Ss.PLANE_LANDSCAPE&&(f=new Ge(this.object.getLocation(),l,c,u,Ge.TYPE_LANDSCAPE,!0,h,n,r,0,e,s),(c.length<1||u.length<1)&&(f.hasTexture=!1),f.color=E.y>0?us.LANDSCAPE_COLOR_TOP:E.y===0?us.LANDSCAPE_COLOR_SIDE:us.LANDSCAPE_COLOR_BOTTOM,r=r+c.length);if(f){f.maskManager=this._data.maskManager;let m=0;for(;m<this._roomPlaneParser.getPlaneMaskCount(o);){const I=this._roomPlaneParser.getPlaneMaskLeftSideLoc(o,m),p=this._roomPlaneParser.getPlaneMaskRightSideLoc(o,m),T=this._roomPlaneParser.getPlaneMaskLeftSideLength(o,m),R=this._roomPlaneParser.getPlaneMaskRightSideLength(o,m);f.addRectangleMask(I,p,T,R),m++}this._highlightPlaneOffsets[o]=this._planes.length,this._planes.push(f)}}else return;o++}this._isPlaneSet=!0,this.defineSprites()}initializeHighlightArea(t,e,s,r,n){this.clearHighlightArea(),this._highlightAreaX=t,this._highlightAreaY=e,this._highlightAreaWidth=s,this._highlightAreaHeight=r,this._highlightFilter=n,this._roomPlaneParser.initializeHighlightArea(t,e,s,r),this.createPlanesAndSprites(this._planes.length),this.reset()}clearHighlightArea(){this._highlightAreaX=0,this._highlightAreaY=0,this._highlightAreaWidth=0,this._highlightAreaHeight=0;const t=this._roomPlaneParser.clearHighlightArea();let e=0,s=this._roomPlaneParser.planeCount;for(;s<this._roomPlaneParser.planeCount+t;)this._highlightPlaneOffsets[s]!==-1&&(e=e+1,this._highlightPlaneOffsets[s]=-1),s=s+1;this._planes=this._planes.slice(0,this._planes.length-e),this.createSprites(this._planes.length),this.reset()}defineSprites(){this.createSprites(this._planes.length);let t=0;for(;t<this._planes.length;){const e=this._planes[t],s=this.getSprite(t);e&&s&&e.leftSide&&e.rightSide&&(e.type===Ge.TYPE_WALL&&(e.leftSide.length<1||e.rightSide.length<1)?s.alphaTolerance=Rn.MATCH_NOTHING:s.alphaTolerance=Rn.MATCH_OPAQUE_PIXELS,e.type===Ge.TYPE_WALL?s.tag="plane.wall@"+(t+1):e.type===Ge.TYPE_FLOOR?s.tag="plane.floor@"+(t+1):s.tag="plane@"+(t+1),s.spriteType=Nr.ROOM_PLANE,this._roomPlaneParser.isPlaneTemporaryHighlighter(t)?(this._highlightFilter&&(s.filters=[this._highlightFilter]),s.skipMouseHandling=!0,e.extraDepth=-100,e.isHighlighter=!0):(s.filters=[],s.skipMouseHandling=!1,e.extraDepth=0,e.isHighlighter=!1)),t++}}getLandscapeWidth(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===Ss.PLANE_LANDSCAPE){const r=this._roomPlaneParser.getPlaneLeftSide(e);t+=r.length}e++}return t}getLandscapeHeight(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===Ss.PLANE_LANDSCAPE){const r=this._roomPlaneParser.getPlaneRightSide(e);r.length>t&&(t=r.length)}e++}return t>5&&(t=5),t}updatePlaneTypes(t,e,s){if(t!==this._floorType?this._floorType=t:t=null,e!==this._wallType?this._wallType=e:e=null,s!==this._landscapeType?this._landscapeType=s:s=null,!t&&!e&&!s)return!1;let r=0;for(;r<this._planes.length;){const n=this._planes[r];n&&(n.type===Ge.TYPE_FLOOR&&t?n.id=t:n.type===Ge.TYPE_WALL&&e?n.id=e:n.type===Ge.TYPE_LANDSCAPE&&s&&(n.id=s)),r++}return!0}updatePlaneVisibility(t,e,s){return t===this._typeVisibility[Ge.TYPE_FLOOR]&&e===this._typeVisibility[Ge.TYPE_WALL]&&s===this._typeVisibility[Ge.TYPE_LANDSCAPE]?!1:(this._typeVisibility[Ge.TYPE_FLOOR]=t,this._typeVisibility[Ge.TYPE_WALL]=e,this._typeVisibility[Ge.TYPE_LANDSCAPE]=s,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updatePlanes(t,e,s,r=!1){if(!t||!this.object)return!1;this._assetUpdateCounter++,e&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const n=this._visiblePlanes.length>0;let o=this._visiblePlanes;this._visiblePlanes.length||(o=this._planes);let l=0,c=!1,u=0;for(;u<o.length;){let h=u;n&&(h=this._visiblePlaneSpriteNumbers[u]);const d=this.getSprite(h);if(d){const f=o[u];f?(d.id=f.uniqueId,f.update(t,s,r)&&(f.visible&&(l=f.relativeDepth+this.floorRelativeDepth+h/1e3,f.type!==Ge.TYPE_FLOOR&&(l=f.relativeDepth+this.wallRelativeDepth+h/1e3,(f.leftSide.length<1||f.rightSide.length<1)&&(l=l+us.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(d,t,f,`plane ${h} ${t.scale}`,l)),c=!0),d.visible!=(f.visible&&this._typeVisibility[f.type])&&(d.visible=!d.visible,c=!0),d.visible&&(n||(this._visiblePlanes.push(f),this._visiblePlaneSpriteNumbers.push(u)))):(d.id=0,d.visible&&(d.visible=!1,c=!0))}u++}return c}updatePlaneMasks(t){if(!t)return;this._roomPlaneBitmapMaskParser.initialize(t);const e=[],s=[];let r=!1,n=0;for(;n<this._planes.length;){const o=this._planes[n];o&&(o.resetBitmapMasks(),o.type===Ge.TYPE_LANDSCAPE&&e.push(n)),n++}for(const o of this._roomPlaneBitmapMaskParser.masks.values()){const l=this._roomPlaneBitmapMaskParser.getMaskType(o),c=this._roomPlaneBitmapMaskParser.getMaskLocation(o),u=this._roomPlaneBitmapMaskParser.getMaskCategory(o);if(c){let h=0;for(;h<this._planes.length;){const d=this._planes[h];if((d.type===Ge.TYPE_WALL||d.type===Ge.TYPE_LANDSCAPE)&&d&&d.location&&d.normal){const f=w.dif(c,d.location);if(Math.abs(w.scalarProjection(f,d.normal))<.01&&d.leftSide&&d.rightSide){const m=w.scalarProjection(f,d.leftSide),I=w.scalarProjection(f,d.rightSide);d.type===Ge.TYPE_WALL||d.type===Ge.TYPE_LANDSCAPE&&u===Hl.HOLE?d.addBitmapMask(l,m,I):d.type===Ge.TYPE_LANDSCAPE&&(d.canBeVisible||(r=!0),d.canBeVisible=!0,s.push(h))}}h++}}}for(n=0;n<e.length;){const o=e[n];if(s.indexOf(o)<0){const l=this._planes[o];l.canBeVisible=!1,r=!0}n++}r&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(t,e,s,r,n){const o=s.offset;t.offsetX=-o.x,t.offsetY=-o.y,t.relativeDepth=n,t.color=s.color,t.texture=s.planeTexture??Es.EMPTY,t.name=r+"_"+this._assetUpdateCounter}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new zo(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const t=[];for(const e of this._visiblePlanes)t.push(e);return t}get floorRelativeDepth(){return us.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return us.ROOM_DEPTH_OFFSET+.5}};us.FLOOR_COLOR=16777215,us.FLOOR_COLOR_LEFT=14540253,us.FLOOR_COLOR_RIGHT=12303291,us.WALL_COLOR_TOP=16777215,us.WALL_COLOR_SIDE=13421772,us.WALL_COLOR_BOTTOM=10066329,us.WALL_COLOR_BORDER=10066329,us.LANDSCAPE_COLOR_TOP=16777215,us.LANDSCAPE_COLOR_SIDE=13421772,us.LANDSCAPE_COLOR_BOTTOM=10066329,us.ROOM_DEPTH_OFFSET=1e3;let FT=us;class cX extends Ls{constructor(){super(),this._tileHeight=0}getLayerYOffset(t,e,s){return s===1?(this._tileHeight=this.object.model.getValue(A.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(t,e,s)}}class uX{constructor(){this._events=X(),this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(t){const e=this.getLogicType(t);if(!e)return null;const s=new e;if(!s)return null;if(s.eventDispatcher=this._events,!this._cachedEvents.get(t)){this._cachedEvents.set(t,!0);const r=s.getEventTypes();for(const n of r)n&&this.registerEventType(n)}return s}registerEventType(t){if(!this._registeredEvents.get(t)){this._registeredEvents.set(t,!0);for(const e of this._functions)e&&this._events.addEventListener(t,e)}}registerEventFunction(t){if(t&&!(this._functions.indexOf(t)>=0)){this._functions.push(t);for(const e of this._registeredEvents.keys())e&&this._events.addEventListener(e,t)}}removeEventFunction(t){if(!t)return;const e=this._functions.indexOf(t);if(e!==-1){this._functions.splice(e,1);for(const s of this._registeredEvents.keys())s&&this._events.removeEventListener(s,t)}}getLogicType(t){if(!t)return null;let e=null;switch(t){case xt.ROOM:e=wK;break;case xt.TILE_CURSOR:e=sT;break;case xt.SELECTION_ARROW:e=FK;break;case xt.USER:case xt.BOT:case xt.RENTABLE_BOT:e=eT;break;case xt.PET:e=jK;break;case xt.FURNITURE_BASIC:e=Oe;break;case xt.FURNITURE_BADGE_DISPLAY:e=kL;break;case xt.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:e=kK;break;case xt.FURNITURE_COUNTER_CLOCK:e=VK;break;case xt.FURNITURE_CRACKABLE:e=HK;break;case xt.FURNITURE_CREDIT:e=YK;break;case xt.FURNITURE_CUSTOM_STACK_HEIGHT:e=KK;break;case xt.FURNITURE_DICE:e=XK;break;case xt.FURNITURE_EDITABLE_INTERNAL_LINK:e=QK;break;case xt.FURNITURE_EDITABLE_ROOM_LINK:e=JK;break;case xt.FURNITURE_EXTERNAL_IMAGE_WALLITEM:e=$K;break;case xt.FURNITURE_FIREWORKS:e=t6;break;case xt.FURNITURE_FLOOR_HOLE:e=rT;break;case xt.FURNITURE_GUILD_CUSTOMIZED:e=gg;break;case xt.FURNITURE_HIGH_SCORE:e=nT;break;case xt.FURNITURE_HOCKEY_SCORE:e=i6;break;case xt.FURNITURE_ES:e=n6;break;case xt.FURNITURE_MANNEQUIN:e=aT;break;case xt.FURNITURE_MULTIHEIGHT:e=u6;break;case xt.FURNITURE_MULTISTATE:e=Cs;break;case xt.FURNITURE_ONE_WAY_DOOR:e=_6;break;case xt.FURNITURE_PET_CUSTOMIZATION:e=g6;break;case xt.FURNITURE_PRESENT:e=oT;break;case xt.FURNITURE_PURCHASABLE_CLOTHING:e=E6;break;case xt.FURNITURE_PUSHABLE:e=lT;break;case xt.FURNITURE_BACKGROUND_COLOR:e=R6;break;case xt.FURNITURE_BG:e=S6;break;case xt.FURNITURE_BB:e=O6;break;case xt.FURNITURE_ROOMDIMMER:e=A6;break;case xt.FURNITURE_SCORE:e=cT;break;case xt.FURNITURE_SOUNDBLOCK:e=uT;break;case xt.FURNITURE_STICKIE:e=hT;break;case xt.FURNITURE_TROPHY:e=x6;break;case xt.FURNITURE_VOTE_COUNTER:e=dT;break;case xt.FURNITURE_VOTE_MAJORITY:e=y6;break;case xt.FURNITURE_WINDOW:e=b6;break;case xt.FURNITURE_LOVELOCK:e=l6;break;case xt.FURNITURE_YOUTUBE:e=D6;break;case xt.FURNITURE_CRAFTING_GIZMO:e=WK;break;case xt.FURNITURE_RENTABLE_SPACE:e=T6;break;case xt.FURNITURE_EFFECTBOX:e=ZK;break;case xt.FURNITURE_MONSTERPLANT_SEED:e=c6;break;case xt.FURNITURE_MYSTERYBOX:e=h6;break;case xt.FURNITURE_MYSTERYTROPHY:e=d6;break;case xt.FURNITURE_RANDOM_TELEPORT:e=I6;break;case xt.FURNITURE_CLOTHING_CHANGE:e=BK;break;case xt.FURNITURE_CUCKOO_CLOCK:e=zK;break;case xt.FURNITURE_ECOTRON_BOX:e=qK;break;case xt.FURNITURE_GROUP_FORUM_TERMINAL:e=e6;break;case xt.FURNITURE_HWEEN_LOVELOCK:e=r6;break;case xt.FURNITURE_INTERNAL_LINK:e=a6;break;case xt.FURNITURE_JUKEBOX:e=o6;break;case xt.FURNITURE_PLACEHOLDER:e=f6;break;case xt.FURNITURE_PLANET_SYSTEM:e=m6;break;case xt.FURNITURE_RANDOMSTATE:e=p6;break;case xt.FURNITURE_SONG_DISK:e=N6;break;case xt.FURNITURE_SOUND_MACHINE:e=C6;break;case xt.FURNITURE_WELCOME_GIFT:e=M6;break;case xt.FURNITURE_ACHIEVEMENT_RESOLUTION:e=iT;break;case xt.FURNITURE_HABBOWHEEL:e=s6;break;case xt.FURNITURE_AREA_HIDE:e=GK;break;default:e=Oe;break}return e||(Lt.warn("Unknown Logic",t),null)}get events(){return this._events}}const hX=new uX,GT=()=>hX,gm=class gm{constructor(){this._visualizationDatas=new Map}getVisualization(t){const e=this.getVisualizationType(t);return e?new e:null}getVisualizationType(t){if(!t)return null;let e=null;switch(t){case mt.ROOM:e=FT;break;case mt.TILE_CURSOR:e=cX;break;case mt.USER:case mt.BOT:case mt.RENTABLE_BOT:e=ET;break;case mt.PET_ANIMATED:e=UT;break;case mt.FURNITURE_STATIC:e=ga;break;case mt.FURNITURE_ANIMATED:e=Ls;break;case mt.FURNITURE_RESETTING_ANIMATED:e=K6;break;case mt.FURNITURE_BADGE_DISPLAY:e=pT;break;case mt.FURNITURE_BG:e=X6;break;case mt.FURNITURE_BB:e=YL;break;case mt.FURNITURE_ISOMETRIC_BB:e=W6;break;case mt.FURNITURE_BOTTLE:e=IT;break;case mt.FURNITURE_BUILDER_PLACEHOLDER:e=G6;break;case mt.FURNITURE_COUNTER_CLOCK:e=TT;break;case mt.FURNITURE_CUBOID:e=k6;break;case mt.FURNITURE_EXTERNAL_IMAGE:e=B6;break;case mt.FURNITURE_FIREWORKS:e=KL;break;case mt.FURNITURE_GIFT_WRAPPED_FIREWORKS:e=ST;break;case mt.FURNITURE_GIFT_WRAPPED:e=H6;break;case mt.FURNITURE_GUILD_CUSTOMIZED:e=OT;break;case mt.FURNITURE_GUILD_ISOMETRIC_BADGE:e=AT;break;case mt.FURNITURE_HABBOWHEEL:e=NT;break;case mt.FURNITURE_MANNEQUIN:e=CT;break;case mt.FURNITURE_PARTY_BEAMER:e=xT;break;case mt.FURNITURE_PLANET_SYSTEM:e=Y6;break;case mt.FURNITURE_POSTER:e=z6;break;case mt.FURNITURE_QUEUE_TILE:e=MT;break;case mt.FURNITURE_SCORE_BOARD:e=bT;break;case mt.FURNITURE_SOUNDBLOCK:e=q6;break;case mt.FURNITURE_STICKIE:e=Q6;break;case mt.FURNITURE_VAL_RANDOMIZER:e=DT;break;case mt.FURNITURE_VOTE_COUNTER:e=vT;break;case mt.FURNITURE_VOTE_MAJORITY:e=PT;break;case mt.FURNITURE_WATER_AREA:e=J6;break;case mt.FURNITURE_YOUTUBE:e=LT;break}return e||(Lt.log("Unknown Visualization",t),null)}getVisualizationData(t,e,s){const r=this._visualizationDatas.get(t);if(r)return r;let n=null;switch(e){case mt.FURNITURE_STATIC:case mt.FURNITURE_GIFT_WRAPPED:case mt.FURNITURE_BB:case mt.FURNITURE_ISOMETRIC_BB:case mt.FURNITURE_BG:case mt.FURNITURE_STICKIE:case mt.FURNITURE_BUILDER_PLACEHOLDER:n=new ca;break;case mt.FURNITURE_ANIMATED:case mt.FURNITURE_RESETTING_ANIMATED:case mt.FURNITURE_POSTER:case mt.FURNITURE_HABBOWHEEL:case mt.FURNITURE_VAL_RANDOMIZER:case mt.FURNITURE_BOTTLE:case mt.FURNITURE_PLANET_SYSTEM:case mt.FURNITURE_QUEUE_TILE:case mt.FURNITURE_PARTY_BEAMER:case mt.FURNITURE_COUNTER_CLOCK:case mt.FURNITURE_WATER_AREA:case mt.FURNITURE_SCORE_BOARD:case mt.FURNITURE_FIREWORKS:case mt.FURNITURE_GIFT_WRAPPED_FIREWORKS:case mt.FURNITURE_GUILD_CUSTOMIZED:case mt.FURNITURE_GUILD_ISOMETRIC_BADGE:case mt.FURNITURE_VOTE_COUNTER:case mt.FURNITURE_VOTE_MAJORITY:case mt.FURNITURE_SOUNDBLOCK:case mt.FURNITURE_BADGE_DISPLAY:case mt.FURNITURE_EXTERNAL_IMAGE:case mt.FURNITURE_YOUTUBE:case mt.TILE_CURSOR:n=new NS;break;case mt.FURNITURE_MANNEQUIN:n=new XL;break;case mt.ROOM:n=new QL;break;case mt.USER:case mt.BOT:case mt.RENTABLE_BOT:n=new AS;break;case mt.PET_ANIMATED:n=new qL;break}return n?n.initialize(s)?(gm.CACHING_ENABLED&&this._visualizationDatas.set(t,n),n):(n.dispose(),null):null}};gm.CACHING_ENABLED=!0;let kT=gm;const dX=new kT,Bd=()=>dX;class _X{constructor(t,e){this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new RL,this._id=t,this._container=e}dispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(t){if(t!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=t,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const e of this._managers.values()){if(!e)continue;const s=e.objects;if(s.length)for(const r of s.getValues())r&&this._renderer.addObject(r)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(t){const e=this._managers.get(t);return e||null}getManagerOrCreate(t){let e=this.getManager(t);return e||(e=this._container.createRoomObjectManager(t),e?(this._managers.set(t,e),e):null)}getTotalObjectsForManager(t){const e=this.getManager(t);return e?e.totalObjects:0}getRoomObject(t,e){const s=this.getManager(e);if(!s)return null;const r=s.getObject(t);return r||null}getRoomObjectsForCategory(t){const e=this.getManager(t);return e?e.objects.getValues():[]}getRoomObjectByIndex(t,e){const s=this.getManager(e);if(!s)return null;const r=s.getObjectByIndex(t);return r||null}createRoomObject(t,e,s,r){const n=this.getManagerOrCreate(r);if(!n)return null;const o=n.createObject(t,e,s);return o?(this._renderer&&this._renderer.addObject(o),o):null}createRoomObjectAndInitalize(t,e,s){return this._container?this._container.createRoomObjectAndInitalize(this._id,t,e,s):null}removeRoomObject(t,e){const s=this.getManager(e);if(!s)return;const r=s.getObject(t);r&&(r.tearDown(),this._renderer&&this._renderer.removeObject(r),s.removeObject(t))}removeAllManagers(){for(const t of this._managers.values())if(t){if(this._renderer){const e=t.objects;if(e.length)for(const s of e.getValues())s&&this._renderer.removeObject(s)}t.dispose()}this._managers.clear()}addUpdateCategory(t){this._updateCategories.indexOf(t)>=0||this._updateCategories.push(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);e!==-1&&this._updateCategories.splice(e,1)}update(t,e=!1){for(const s of this._updateCategories){const r=this.getManager(s);if(!r)continue;const n=r.objects;if(n.length)for(const o of n.getValues()){if(!o)continue;const l=o.logic;l&&l.update(t)}}this._renderer&&this._renderer.update(t,e)}hasUninitializedObjects(){for(const t of this._managers.values())if(t){for(const e of t.objects.getValues())if(e&&!e.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}class gX{constructor(){this._objects=new Is,this._objectsPerType=new Is}dispose(){this.removeAllObjects()}getObject(t){const e=this._objects.getValue(t);return e||null}getObjectByIndex(t){const e=this._objects.getWithIndex(t);return e||null}createObject(t,e,s){const r=new tT(t,e,s);return this.addObject(t,s,r)}addObject(t,e,s){if(this._objects.getValue(t))return s.dispose(),null;this._objects.add(t,s);const r=this.getTypeMap(e);return r&&r.add(t,s),s}removeObject(t){const e=this._objects.remove(t);if(e){const s=this.getTypeMap(e.type);s&&s.remove(e.id),e.dispose()}}removeAllObjects(){let t=0;for(;t<this._objects.length;){const e=this._objects.getWithIndex(t);e&&e.dispose(),t++}for(this._objects.reset(),t=0;t<this._objectsPerType.length;){const e=this._objectsPerType.getWithIndex(t);e&&e.dispose(),t++}this._objectsPerType.reset()}getTypeMap(t,e=!0){let s=this._objectsPerType.getValue(t);return!s&&e&&(s=new Is,this._objectsPerType.add(t,s)),s}get objects(){return this._objects}get totalObjects(){return this._objects.length}}class fX{constructor(){this._rooms=new Map,this._updateCategories=[],this._pendingContentTypes=[],this._skipContentProcessing=!1}async init(t){this._listener=t;const e=s=>{if(!Sr())return;const r=s.contentType;this._pendingContentTypes.indexOf(r)>=0||this._pendingContentTypes.push(r)};X().addEventListener(Ya.RCLE_SUCCESS,e),X().addEventListener(Ya.RCLE_FAILURE,e),X().addEventListener(Ya.RCLE_CANCEL,e)}getRoomInstance(t){const e=this._rooms.get(t);return e||null}createRoomInstance(t){if(this._rooms.get(t))return null;const e=new _X(t,this);if(this._rooms.set(e.id,e),this._updateCategories.length)for(const s of this._updateCategories)e.addUpdateCategory(s);return e}removeRoomInstance(t){const e=this._rooms.get(t);return e?(this._rooms.delete(t),e.dispose(),!0):!1}createRoomObjectAndInitalize(t,e,s,r){const n=this.getRoomInstance(t);if(!n)return null;let o=s,l=s,c=s,u=null,h=!1;if(Sr().isLoaderType(s)){if(u=Sr().getCollection(s),!u&&(h=!0,Sr().downloadAsset(s),c=Sr().getPlaceholderName(s),u=Sr().getCollection(c),!u))return null;o=u.data.visualizationType,l=u.data.logicType}const d=n.createRoomObject(e,1,s,r);if(!d)return null;const f=Bd().getVisualization(o);if(!f)return n.removeRoomObject(e,r),null;f.asset=u;const E=Bd().getVisualizationData(c,o,u&&u.data||null);if(!E||!f.initialize(E))return n.removeRoomObject(e,r),null;d.setVisualization(f);const m=GT().getLogic(l);return d.setLogic(m),m&&m.initialize(u&&u.data||null),h||(d.isReady=!0),Sr().setRoomObjectRoomId(d,t),d}reinitializeRoomObjectsByType(t){if(!t||!Sr())return;const e=Sr().getCollection(t);if(!e)return;const s=e.data.visualizationType,r=e.data.logicType,n=Bd().getVisualizationData(t,s,e.data);for(const o of this._rooms.values())if(o){for(const[l,c]of o.managers.entries())if(c)for(const u of c.objects.getValues()){if(!u||u.type!==t)continue;const h=Bd().getVisualization(s);if(h)if(h.asset=e,!n||!h.initialize(n))c.removeObject(u.id);else{u.setVisualization(h);const d=GT().getLogic(r);u.setLogic(d),d&&d.initialize(e.data),u.isReady=!0,this._listener&&this._listener.objectInitialized(o.id,u.id,l)}else c.removeObject(u.id)}}}addUpdateCategory(t){if(!(this._updateCategories.indexOf(t)>=0)&&(this._updateCategories.push(t),!!this._rooms.size))for(const s of this._rooms.values())s&&s.addUpdateCategory(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);if(e!==-1&&(this._updateCategories.splice(e,1),!!this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(t)}processPendingContentTypes(t){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const e=this._pendingContentTypes.shift();if(!Sr().getCollection(e)){this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!1),Lt.log("Invalid Collection",e);continue}this.reinitializeRoomObjectsByType(e),this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!0)}}update(t,e=!1){if(this.processPendingContentTypes(t),!!this._rooms.size)for(const s of this._rooms.values())s&&s.update(t,e)}createRoomObjectManager(t){return new gX}get rooms(){return this._rooms}}const mX=new fX,EX=()=>mX,Xn=class Xn{};Xn.ROOM_MIN_X="room_min_x",Xn.ROOM_MAX_X="room_max_x",Xn.ROOM_MIN_Y="room_min_y",Xn.ROOM_MAX_Y="room_max_y",Xn.ROOM_IS_PUBLIC="room_is_public",Xn.ROOM_Z_SCALE="room_z_scale",Xn.AD_DISPLAY_DELAY="ad_display_delay",Xn.IS_PLAYING_GAME="is_playing_game";let ks=Xn;class pX{constructor(){this._connection=null,this._roomEngine=null,this._planeParser=new Bs,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}async init(){this._connection=it().connection,this._roomEngine=rt(),this._connection.addMessageEvent(new Su(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new Ru(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new RI(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new J_(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new II(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new TI(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new $_(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new Z_(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new rI(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new iI(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new oI(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new hI(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new dI(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new _I(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new gI(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new fI(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new mI(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new EI(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new pI(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new lI(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new cI(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new uI(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new nI(this.onAreaHideMessageEvent.bind(this))),this._connection.addMessageEvent(new ig(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new OI(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new rg(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new AI(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new NI(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new CI(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new ng(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new xI(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new ag(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new yI(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new XR(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new eg(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new sg(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new SI(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new tg(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new dM(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new fM(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new aI(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new $R(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new kR(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new FR(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new GR(this.onGuideSessionErrorMessageEvent.bind(this)))}setRoomId(t){this._currentRoomId!==0&&this._roomEngine&&this._roomEngine.destroyRoom(this._currentRoomId),this._currentRoomId=t,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(t){if(!(t instanceof Su)||!t.connection)return;const e=t.getParser();e&&(this._ownUserId=e.userInfo.userId)}onRoomReadyMessageEvent(t){const e=t.getParser();if(this._currentRoomId!==e.roomId&&this.setRoomId(e.roomId),this._roomEngine&&this._roomEngine.setRoomInstanceModelName(e.roomId,e.name),this._initialConnection){t.connection.send(new aP),this._initialConnection=!1;return}t.connection.send(new XI)}onRoomPaintEvent(t){if(!(t instanceof RI))return;const e=t.getParser();if(!e)return;const s=e.floorType,r=e.wallType,n=e.landscapeType;this._roomEngine&&this._roomEngine.updateRoomInstancePlaneType(this._currentRoomId,s,r,n)}onRoomModelEvent(t){if(!(t instanceof J_)||!t.connection||!this._roomEngine)return;const e=t.getParser();if(!e)return;const s=this._roomEngine.getLegacyWallGeometry(this._currentRoomId);if(!s)return;this._planeParser.reset();const r=e.width,n=e.height;this._planeParser.initializeTileMap(r,n);let o=null;this._latestEntryTileEvent&&(o=this._latestEntryTileEvent.getParser());let l=-1,c=-1,u=0,h=0,d=0;for(;d<n;){let m=0;for(;m<r;){const I=e.getHeight(m,d);(d>0&&d<n-1||m>0&&m<r-1)&&I!=Bs.TILE_BLOCKED&&(o==null||m==o.x&&d==o.y)&&(e.getHeight(m,d-1)==Bs.TILE_BLOCKED&&e.getHeight(m-1,d)==Bs.TILE_BLOCKED&&e.getHeight(m,d+1)==Bs.TILE_BLOCKED&&(l=m+.5,c=d,u=I,h=90),e.getHeight(m,d-1)==Bs.TILE_BLOCKED&&e.getHeight(m-1,d)==Bs.TILE_BLOCKED&&e.getHeight(m+1,d)==Bs.TILE_BLOCKED&&(l=m,c=d+.5,u=I,h=180)),this._planeParser.setTileHeight(m,d,I),m++}d++}this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),u),this._planeParser.initializeFromTileData(e.wallHeight),this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),u+this._planeParser.wallHeight),s.scale=ud.DEFAULT_SCALE,s.initialize(r,n,this._planeParser.floorHeight);let f=e.height-1;for(;f>=0;){let m=e.width-1;for(;m>=0;)s.setHeight(m,f,this._planeParser.getTileHeight(m,f)),m--;f--}const E=this._planeParser.getMapData();E.doors.push({x:l,y:c,z:u,dir:h}),this._roomEngine.createRoomInstance(this._currentRoomId,E)}onRoomHeightMapEvent(t){if(!(t instanceof II)||!t.connection||!this._roomEngine)return;const e=t.getParser();if(!e)return;const s=e.width,r=e.height,n=new $6(s,r);let o=0;for(;o<r;){let l=0;for(;l<s;)n.setTileHeight(l,o,e.getTileHeight(l,o)),n.setStackingBlocked(l,o,e.getStackingBlocked(l,o)),n.setIsRoomTile(l,o,e.isRoomTile(l,o)),l++;o++}this._roomEngine.setFurnitureStackingHeightMap(this._currentRoomId,n)}onRoomHeightMapUpdateEvent(t){if(!(t instanceof TI)||!t.connection||!this._roomEngine)return;const e=t.getParser();if(!e)return;const s=this._roomEngine.getFurnitureStackingHeightMap(this._currentRoomId);if(s){for(;e.next();)s.setTileHeight(e.x,e.y,e.tileHeight()),s.setStackingBlocked(e.x,e.y,e.isStackingBlocked()),s.setIsRoomTile(e.x,e.y,e.isRoomTile());this._roomEngine.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(t){if(!(t instanceof $_))return;const e=t.getParser();if(!e)return;const s=!e.hideWalls,r=!0,n=e.thicknessWall,o=e.thicknessFloor;this._roomEngine&&(this._roomEngine.updateRoomInstancePlaneVisibility(this._currentRoomId,s,r),this._roomEngine.updateRoomInstancePlaneThickness(this._currentRoomId,n,o))}onRoomDoorEvent(t){t instanceof Z_&&(this._latestEntryTileEvent=t)}onRoomRollingEvent(t){if(!(t instanceof rI)||!t.connection||!this._roomEngine)return;const e=t.getParser();this._roomEngine.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,1,null),this._roomEngine.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,2,null);const s=e.itemsRolling;if(s&&s.length)for(const n of s)n&&this._roomEngine.rollRoomObjectFloor(this._currentRoomId,n.id,n.location,n.targetLocation);const r=e.unitRolling;if(r){this._roomEngine.updateRoomObjectUserLocation(this._currentRoomId,r.id,r.location,r.targetLocation);const n=this._roomEngine.getRoomObjectUser(this._currentRoomId,r.id);if(n&&n.type!==Ue.MONSTER_PLANT){let o="std";switch(r.movementType){case Va.MOVE:o="mv";break;case Va.SLIDE:o="std";break}this._roomEngine.updateRoomObjectUserPosture(this._currentRoomId,r.id,o)}}}onObjectsDataUpdateEvent(t){if(!(t instanceof iI)||!t.connection||!this._roomEngine)return;const e=t.getParser();if(e)for(const s of e.objects)this._roomEngine.updateRoomObjectFloor(this._currentRoomId,s.id,null,null,s.state,s.data)}onFurnitureAliasesEvent(t){!(t instanceof oI)||!t.connection||!this._roomEngine||(t.getParser().aliases,this._connection.send(new XI))}onFurnitureFloorAddEvent(t){if(!(t instanceof hI)||!t.connection||!this._roomEngine)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureFloor(this._currentRoomId,e)}onFurnitureFloorEvent(t){if(!(t instanceof dI)||!t.connection||!this._roomEngine)return;const e=t.getParser();if(!e)return;const s=e.items.length;let r=0;for(;r<s;){const n=e.items[r];n&&this.addRoomObjectFurnitureFloor(this._currentRoomId,n),r++}}onFurnitureFloorRemoveEvent(t){if(!(t instanceof _I)||!t.connection||!this._roomEngine)return;const e=t.getParser();e&&(e.delay>0?setTimeout(()=>{this._roomEngine.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0)},e.delay):this._roomEngine.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0))}onFurnitureFloorUpdateEvent(t){if(!(t instanceof gI)||!t.connection||!this._roomEngine)return;const e=t.getParser().item;if(!e)return;const s=new w(e.x,e.y,e.z),r=new w(e.direction);this._roomEngine.updateRoomObjectFloor(this._currentRoomId,e.itemId,s,r,e.data.state,e.data,e.extra),this._roomEngine.updateRoomObjectFloorHeight(this._currentRoomId,e.itemId,e.stackHeight),this._roomEngine.updateRoomObjectFloorExpiration(this._currentRoomId,e.itemId,e.expires)}onFurnitureWallAddEvent(t){if(!(t instanceof fI)||!t.connection||!this._roomEngine)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureWall(this._currentRoomId,e)}onFurnitureWallEvent(t){if(!(t instanceof mI)||!t.connection||!this._roomEngine)return;const e=t.getParser();if(!e)return;const s=e.items.length;let r=0;for(;r<s;){const n=e.items[r];n&&this.addRoomObjectFurnitureWall(this._currentRoomId,n),r++}}onFurnitureWallRemoveEvent(t){if(!(t instanceof EI)||!t.connection||!this._roomEngine)return;const e=t.getParser();e&&this._roomEngine.removeRoomObjectWall(this._currentRoomId,e.itemId,e.userId)}onFurnitureWallUpdateEvent(t){if(!(t instanceof pI)||!t.connection||!this._roomEngine)return;const e=this._roomEngine.getLegacyWallGeometry(this._currentRoomId);if(!e)return;const s=t.getParser().item;if(!s)return;const r=e.getLocation(s.width,s.height,s.localX,s.localY,s.direction),n=new w(e.getDirection(s.direction));this._roomEngine.updateRoomObjectWall(this._currentRoomId,s.itemId,r,n,s.state,s.stuffData),this._roomEngine.updateRoomObjectWallExpiration(this._currentRoomId,s.itemId,s.secondsToExpiration)}onFurnitureDataEvent(t){if(!(t instanceof lI)||!t.connection||!this._roomEngine)return;const e=t.getParser();this._roomEngine.updateRoomObjectFloor(this._currentRoomId,e.furnitureId,null,null,e.objectData.state,e.objectData)}onItemDataUpdateMessageEvent(t){if(!(t instanceof cI)||!t.connection||!this._roomEngine)return;const e=t.getParser();this._roomEngine.updateRoomObjectWallItemData(this._currentRoomId,e.furnitureId,e.data)}onOneWayDoorStatusMessageEvent(t){if(!(t instanceof uI)||!t.connection||!this._roomEngine)return;const e=t.getParser();this._roomEngine.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.state,new Di)}onAreaHideMessageEvent(t){if(!(t instanceof nI)||!t.connection||!this._roomEngine)return;const s=t.getParser().areaData;this._roomEngine.updateAreaHide(this._currentRoomId,s.furniId,s.on,s.rootX,s.rootY,s.width,s.length,s.invert)}onDiceValueMessageEvent(t){if(!(t instanceof aI)||!t.connection||!this._roomEngine)return;const e=t.getParser();this._roomEngine.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.value,new Di)}onRoomUnitDanceEvent(t){!(t instanceof ig)||!t.connection||!this._roomEngine||this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,A.FIGURE_DANCE,t.getParser().danceId)}onRoomUnitEffectEvent(t){!(t instanceof OI)||!t.connection||!this._roomEngine||this._roomEngine.updateRoomObjectUserEffect(this._currentRoomId,t.getParser().unitId,t.getParser().effectId,t.getParser().delay)}onRoomUnitEvent(t){if(!(t instanceof rg)||!t.connection||!this._roomEngine)return;const e=t.getParser().users;if(!(!e||!e.length)){for(const s of e){if(!s)continue;const r=new w(s.x,s.y,s.z),n=new w(s.dir);this._roomEngine.addRoomObjectUser(this._currentRoomId,s.roomIndex,r,n,s.dir,s.userType,s.figure),s.webID===this._ownUserId&&(this._roomEngine.setRoomSessionOwnUser(this._currentRoomId,s.roomIndex),this._roomEngine.updateRoomObjectUserOwn(this._currentRoomId,s.roomIndex)),this._roomEngine.updateRoomObjectUserFigure(this._currentRoomId,s.roomIndex,s.figure,s.sex,s.subType,s.isRiding),Ue.getTypeString(s.userType)===Ue.PET&&this._roomEngine.getPetTypeId(s.figure)===Ds.MONSTERPLANT&&this._roomEngine.updateRoomObjectUserPosture(this._currentRoomId,s.roomIndex,s.petPosture),this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,s.roomIndex,A.FIGURE_IS_MUTED,tt().isUserIgnored(s.name)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(t){!(t instanceof AI)||!t.connection||!this._roomEngine||this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,A.FIGURE_EXPRESSION,t.getParser().expression)}onRoomUnitHandItemEvent(t){!(t instanceof NI)||!t.connection||!this._roomEngine||this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,A.FIGURE_CARRY_OBJECT,t.getParser().handId)}onRoomUnitIdleEvent(t){!(t instanceof CI)||!t.connection||!this._roomEngine||this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,A.FIGURE_SLEEP,t.getParser().isIdle?1:0)}onRoomUnitInfoEvent(t){!(t instanceof ng)||!t.connection||!this._roomEngine||this._roomEngine.updateRoomObjectUserFigure(this._currentRoomId,t.getParser().unitId,t.getParser().figure,t.getParser().gender)}onRoomUnitNumberEvent(t){if(!(t instanceof xI)||!t.connection||!this._roomEngine)return;const e=t.getParser();e&&this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,e.unitId,A.FIGURE_NUMBER_VALUE,e.value)}onRoomUnitRemoveEvent(t){!(t instanceof ag)||!t.connection||!this._roomEngine||(this._roomEngine.removeRoomObjectUser(this._currentRoomId,t.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(t){if(!(t instanceof yI)||!t.connection||!this._roomEngine)return;const e=t.getParser().statuses;if(!e||!e.length)return;const s=this._roomEngine.getRoomInstance(this._currentRoomId);if(!s)return;const r=s.model.getValue(ks.ROOM_Z_SCALE)||1;for(const n of e){if(!n)continue;let o=n.height;o&&(o=o/r);const l=new w(n.x,n.y,n.z+o),c=new w(n.direction);let u=null;n.didMove&&(u=new w(n.targetX,n.targetY,n.targetZ)),this._roomEngine.updateRoomObjectUserLocation(this._currentRoomId,n.id,l,u,n.canStandUp,o,c,n.headDirection),this._roomEngine.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,null);let h=!0,d=!1,f=A.STD,E="";if(n.actions&&n.actions.length){for(const m of n.actions)if(m)switch(m.action){case"flatctrl":this._roomEngine.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,m.value);break;case"sign":n.actions.length===1&&(h=!1),this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,n.id,A.FIGURE_SIGN,parseInt(m.value));break;case"gst":n.actions.length===1&&(h=!1),this._roomEngine.updateRoomObjectUserPetGesture(this._currentRoomId,n.id,m.value);break;case"wav":case"mv":d=!0,f=m.action,E=m.value;break;case"trd":break;default:d=!0,f=m.action,E=m.value;break}}d?this._roomEngine.updateRoomObjectUserPosture(this._currentRoomId,n.id,f,E):h&&this._roomEngine.updateRoomObjectUserPosture(this._currentRoomId,n.id,A.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(t){if(!t.connection||!this._roomEngine)return;const e=t.getParser();e&&(this._roomEngine.updateRoomObjectUserGesture(this._currentRoomId,e.roomIndex,e.gesture),this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,A.FIGURE_TALK,e.message.length/10))}onRoomUnitTypingEvent(t){!(t instanceof SI)||!t.connection||!this._roomEngine||this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,A.FIGURE_IS_TYPING,t.getParser().isTyping?1:0)}onPetFigureUpdateEvent(t){if(!(t instanceof tg)||!t.connection||!this._roomEngine)return;const e=t.getParser();e&&this._roomEngine.updateRoomObjectUserFigure(this._currentRoomId,e.roomIndex,e.figureData.figuredata,"","",e.isRiding)}onPetExperienceEvent(t){const e=t.getParser();e&&this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,A.FIGURE_GAINED_EXPERIENCE,e.gainedExperience)}onYouArePlayingGameEvent(t){if(!t)return;const e=t.getParser();e&&this._roomEngine.setRoomEngineGameMode(this._currentRoomId,e.isPlaying)}addRoomObjectFurnitureFloor(t,e){if(!e||!this._roomEngine)return;const s=new w(e.x,e.y,e.z),r=new w(e.direction);e.spriteName?this._roomEngine.addFurnitureFloorByTypeName(t,e.itemId,e.spriteName,s,r,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight):this._roomEngine.addFurnitureFloor(t,e.itemId,e.spriteId,s,r,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight)}addRoomObjectFurnitureWall(t,e){if(!e||!this._roomEngine)return;const s=this._roomEngine.getLegacyWallGeometry(t);if(!s)return;let r=null;e.isOldFormat||(r=s.getLocation(e.width,e.height,e.localX,e.localY,e.direction));const n=new w(s.getDirection(e.direction));this._roomEngine.addFurnitureWall(t,e.itemId,e.spriteId,r,n,e.state,e.stuffData,e.secondsToExpiration,e.usagePolicy,e.userId,e.username)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=Yi().getSession(this._currentRoomId);if(!s)return;const r=s.userDataManager.getUserDataByName(e.name);if(r)switch(e.result){case 1:case 2:this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,A.FIGURE_IS_MUTED,1);return;case 3:this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,A.FIGURE_IS_MUTED,0);return}}onGuideSessionStartedMessageEvent(t){const e=t.getParser();this._guideId=e.guideUserId,this._requesterId=e.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(t){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(t){this.removeGuideMarker()}updateGuideMarker(){const t=tt().userId;this.setUserGuideStatus(this._guideId,this._requesterId===t?Zn.GUIDE:Zn.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===t?Zn.REQUESTER:Zn.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,Zn.NONE),this.setUserGuideStatus(this._requesterId,Zn.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(t,e){const s=Yi().getSession(this._currentRoomId);if(!s)return;const r=s.userDataManager.getDataByType(t,Pe.USER);r&&this._roomEngine.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,A.FIGURE_GUIDE_STATUS,e)}get currentRoomId(){return this._currentRoomId}}const IX=new pX,TE=()=>IX;class sA{constructor(){this.id=0,this.data=null,this.image=null}async getImage(){return this.image?this.image:this.data?await me.generateImage(this.data):null}}class TX{constructor(t){this._roomEngine=t,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,X().addEventListener(Ot.ADDED,e=>this.onRoomEngineObjectEvent(e))}onRoomEngineObjectEvent(t){let e=this.getSelectedRoomObjectData(t.roomId);if(e&&e.operation===Gt.OBJECT_PLACE&&e.id===t.objectId){const s=this._roomEngine.getRoomObject(t.roomId,e.id,e.category);if(s&&s.model&&e.category===Y.FLOOR){const r=s.model.getValue(A.FURNITURE_ALLOWED_DIRECTIONS);if(r&&r.length){const n=new w(r[0]);if(s.setDirection(n),this.updateSelectedObjectData(t.roomId,e.id,e.category,e.loc,n,e.operation,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture),e=this.getSelectedRoomObjectData(t.roomId),!e)return}}this.setFurnitureAlphaMultiplier(s,.5)}}processRoomCanvasMouseEvent(t,e,s){if(!t||!e||Cr.isRunning())return;const r=e.type;let n=this._roomEngine.getRoomObjectCategoryForType(r);if(n!==Y.ROOM&&(!this._roomEngine.isPlayingGame()||n!==Y.UNIT)&&(n=Y.MINIMUM),this.getMouseEventId(n,t.type)===t.eventId){if(t.type===lt.MOUSE_CLICK||t.type===lt.DOUBLE_CLICK||t.type===lt.MOUSE_DOWN||t.type===lt.MOUSE_UP||t.type===lt.MOUSE_MOVE)return}else t.eventId&&this.setMouseEventId(n,t.type,t.eventId);e.mouseHandler&&e.mouseHandler.mouseEvent(t,s)}processRoomObjectPlacement(t,e,s,r,n,o=null,l=null,c=-1,u=-1,h=null){this._objectPlacementSource=t;const d=new w(-100,-100),f=new w(0);return this.setSelectedRoomObjectData(e,s,r,d,f,Gt.OBJECT_PLACE,n,o,l,c,u,h),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(n,r,!1,o,l,c,u,h),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(t){return this.resetSelectedObjectData(t),!0}getMouseEventId(t,e){const s=this._eventIds.get(t);return s&&s.get(e)||null}setMouseEventId(t,e,s){let r=this._eventIds.get(t);r||(r=new Map,this._eventIds.set(t,r)),r.delete(e),r.set(e,s)}handleRoomObjectEvent(t,e){if(t){if(t instanceof Ut){this.handleRoomObjectMouseEvent(t,e);return}switch(t.type){case he.STATE_CHANGE:case he.STATE_RANDOM:this.onRoomObjectStateChangedEvent(t,e);return;case Ll.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(t,e);return;case Mi.POSITION_CHANGED:case Mi.OBJECT_REMOVED:this.handleSelectedObjectRemove(t,e);return;case q.OPEN_WIDGET:case q.CLOSE_WIDGET:case q.OPEN_FURNI_CONTEXT_MENU:case q.CLOSE_FURNI_CONTEXT_MENU:case q.PLACEHOLDER:case q.CREDITFURNI:case q.STACK_HEIGHT:case q.EXTERNAL_IMAGE:case q.STICKIE:case q.PRESENT:case q.TROPHY:case q.TEASER:case q.ECOTRONBOX:case q.DIMMER:case q.WIDGET_REMOVE_DIMMER:case q.CLOTHING_CHANGE:case q.JUKEBOX_PLAYLIST_EDITOR:case q.MANNEQUIN:case q.PET_PRODUCT_MENU:case q.GUILD_FURNI_CONTEXT_MENU:case q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case q.BACKGROUND_COLOR:case q.AREA_HIDE:case q.MYSTERYBOX_OPEN_DIALOG:case q.EFFECTBOX_OPEN_DIALOG:case q.MYSTERYTROPHY_OPEN_DIALOG:case q.ACHIEVEMENT_RESOLUTION_OPEN:case q.ACHIEVEMENT_RESOLUTION_ENGRAVING:case q.ACHIEVEMENT_RESOLUTION_FAILED:case q.FRIEND_FURNITURE_CONFIRM:case q.FRIEND_FURNITURE_ENGRAVING:case q.BADGE_DISPLAY_ENGRAVING:case q.HIGH_SCORE_DISPLAY:case q.HIDE_HIGH_SCORE_DISPLAY:case q.INERNAL_LINK:case q.ROOM_LINK:case q.YOUTUBE:this.onRoomObjectWidgetRequestEvent(t,e);return;case _t.DICE_ACTIVATE:case _t.DICE_OFF:case _t.USE_HABBOWHEEL:case _t.STICKIE:case _t.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(t,e);return;case _t.SOUND_MACHINE_INIT:case _t.SOUND_MACHINE_START:case _t.SOUND_MACHINE_STOP:case _t.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(t,e);return;case _t.JUKEBOX_INIT:case _t.JUKEBOX_START:case _t.JUKEBOX_MACHINE_STOP:case _t.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(t,e);return;case Oi.ADD_HOLE:case Oi.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(t,e);return;case ts.ROOM_AD_FURNI_CLICK:case ts.ROOM_AD_FURNI_DOUBLE_CLICK:case ts.ROOM_AD_TOOLTIP_SHOW:case ts.ROOM_AD_TOOLTIP_HIDE:case ts.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(t,e);return;case Sn.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(t,e);return;case _t.MOUSE_ARROW:case _t.MOUSE_BUTTON:this.handleMousePointer(t,e);return;case za.PLAY_SOUND:case za.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(t,e);return;case js.ROOM_OBJECT_INITIALIZED:case js.ROOM_OBJECT_DISPOSED:case js.PLAY_SAMPLE:case js.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(t,e);return;case Ha.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(t,e);return;case Zr.RODRE_CURRENT_USER_ID:case Zr.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(t,e);return;default:Lt.warn("Unhandled Event",t.constructor.name,"Object ID",t.object.id);return}}}handleRoomObjectMouseEvent(t,e){if(!(!t||!t.type))switch(t instanceof bn&&this._roomEngine.areaSelectionManager.handleTileMouseEvent(t),t.type){case Ut.CLICK:this.handleRoomObjectMouseClickEvent(t,e);return;case Ut.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(t,e);return;case Ut.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(t,e);return;case Ut.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(t,e);return;case Ut.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(t,e);return;case Ut.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(t,e);return;case Ut.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(t,e);return}}clickRoomObject(t){if(!t||t.altKey||t.ctrlKey||t.shiftKey)return;const e=t.objectId,s=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(s);if(r===Y.FLOOR){it().connection.send(new WI(e,r));return}if(r===Y.WALL){it().connection.send(new WI(-Math.abs(e),r));return}}handleRoomObjectMouseClickEvent(t,e){if(!t)return;this.clickRoomObject(t);let s=Gt.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(e);r&&(s=r.operation);let n=!1,o=!1;this.whereYouClickIsWhereYouGo()&&(!s||s===Gt.OBJECT_UNDEFINED)&&(n=this.handleMoveTargetFurni(e,t));const l=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Gt.OBJECT_MOVE:l===Y.ROOM?r&&this.modifyRoomObject(e,r.id,r.category,Gt.OBJECT_MOVE_TO):l===Y.UNIT&&(r&&t.objectType===Ue.MONSTER_PLANT&&this.modifyRoomObject(e,r.id,r.category,Gt.OBJECT_MOVE_TO),t.eventId&&this.setMouseEventId(Y.ROOM,lt.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,l)),o=!0,t.objectId!==-1&&this.setSelectedObject(e,t.objectId,l);break;case Gt.OBJECT_PLACE:if(l===Y.ROOM)this.placeObject(e,t instanceof bn,t instanceof cc);else if(l===Y.UNIT)switch(t.objectType){case Ue.MONSTER_PLANT:case Ue.RENTABLE_BOT:this.placeObject(e,t instanceof bn,t instanceof cc);break;default:t.eventId&&this.setMouseEventId(Y.ROOM,lt.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,l);break}break;case Gt.OBJECT_UNDEFINED:l===Y.ROOM?!n&&t instanceof bn&&this.handleClickOnTile(e,t):(!this._roomEngine.isAreaSelectionMode()||l===Y.UNIT?this.setSelectedObject(e,t.objectId,l):(this.deselectObject(e),X().dispatchEvent(new Ot(Ot.DESELECTED,e,-1,Y.MINIMUM))),o=!1,l===Y.UNIT?(t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===Ue.RENTABLE_BOT?this.modifyRoomObject(e,t.objectId,l,Gt.OBJECT_PICKUP_BOT):t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===Ue.MONSTER_PLANT?this.modifyRoomObject(e,t.objectId,l,Gt.OBJECT_PICKUP_PET):!t.ctrlKey&&!t.altKey&&t.shiftKey&&t.objectType===Ue.MONSTER_PLANT&&this.modifyRoomObject(e,t.objectId,l,Gt.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?o=!0:n=!0):(l===Y.FLOOR||l===Y.WALL)&&(t.altKey||t.ctrlKey||t.shiftKey)&&(!t.ctrlKey&&!t.altKey&&t.shiftKey?l===Y.FLOOR&&X()&&X().dispatchEvent(new Ot(Ot.REQUEST_ROTATE,e,t.objectId,l)):t.ctrlKey&&!t.altKey&&!t.shiftKey&&this.modifyRoomObject(e,t.objectId,l,Gt.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?o=!0:n=!0),t.eventId&&(n&&this.setMouseEventId(Y.ROOM,lt.MOUSE_CLICK,t.eventId),o&&this.setMouseEventId(Y.MINIMUM,lt.MOUSE_CLICK,t.eventId)));break}if(l===Y.ROOM){const c=this.getMouseEventId(Y.MINIMUM,lt.MOUSE_CLICK),u=this.getMouseEventId(Y.UNIT,lt.MOUSE_CLICK);c!==t.eventId&&u!==t.eventId&&!o&&(this.deselectObject(e),X()&&X().dispatchEvent(new Ot(Ot.DESELECTED,e,-1,Y.MINIMUM)),this.setSelectedAvatar(e,0,!1))}}handleRoomObjectMouseDoubleClickEvent(t,e){const s=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);X()&&X().dispatchEvent(new Ot(Ot.DOUBLE_CLICK,e,s,n))}handleRoomObjectMouseMoveEvent(t,e){if(!t)return;let s=Gt.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(e);r&&(s=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(this._roomEngine){const o=this._roomEngine.getRoomObjectCursor(e);if(o&&o.logic){let l=null;t instanceof bn?l=this.handleMouseOverTile(t,e):t.object&&t.object.id!==-1?this.whereYouClickIsWhereYouGo()&&(l=this.handleMouseOverObject(n,e,t)):l=new uc(null,0,!1,t.eventId),o.processUpdateMessage(l)}}switch(s){case Gt.OBJECT_MOVE:n===Y.ROOM&&this.handleObjectMove(t,e);return;case Gt.OBJECT_PLACE:n===Y.ROOM&&this.handleObjectPlace(t,e);return}}handleRoomObjectMouseDownEvent(t,e){if(!t)return;let s=Gt.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(e);r&&(s=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Gt.OBJECT_UNDEFINED:(n===Y.FLOOR||n===Y.WALL||t.objectType===Ue.MONSTER_PLANT)&&(t.altKey&&!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&X()&&X().dispatchEvent(new Ot(Ot.REQUEST_MOVE,e,t.objectId,n));return}}handleRoomObjectMouseDownLongEvent(t,e){if(!t)return;let s=Gt.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(e);r&&(s=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Gt.OBJECT_UNDEFINED:(n===Y.FLOOR||n===Y.WALL||t.objectType===Ue.MONSTER_PLANT)&&(!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&X()&&X().dispatchEvent(new Ot(Ot.REQUEST_MANIPULATION,e,t.objectId,n));return}}handleRoomObjectMouseEnterEvent(t,e){const s=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);X()&&X().dispatchEvent(new Ot(Ot.MOUSE_ENTER,e,s,n))}handleRoomObjectMouseLeaveEvent(t,e){const s=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);if(n!==Y.ROOM&&n===Y.UNIT){const o=this._roomEngine.getRoomObjectCursor(e);o&&o.processUpdateMessage(new we(0,null))}X()&&X().dispatchEvent(new Ot(Ot.MOUSE_LEAVE,e,s,n))}onRoomObjectStateChangedEvent(t,e){if(t)switch(t.type){case he.STATE_CHANGE:this.changeObjectState(e,t.object.id,t.object.type,t.state,!1);return;case he.STATE_RANDOM:this.changeObjectState(e,t.object.id,t.object.type,t.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(t,e){if(t)switch(t.type){case Ll.DIMMER_STATE:X().dispatchEvent(new N_(e,t.state,t.presetId,t.effectId,t.color,t.brightness));return}}handleSelectedObjectRemove(t,e){if(!(!t||!this._roomEngine))switch(t.type){case Mi.POSITION_CHANGED:{const s=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r),o=this._roomEngine.getRoomObject(e,s,n),l=this._roomEngine.getRoomObjectSelectionArrow(e);if(o&&l&&l.logic){const c=o.getLocation();l.logic.processUpdateMessage(new Vs(c,null))}return}case Mi.OBJECT_REMOVED:this.setSelectedAvatar(e,0,!1);return}}onRoomObjectWidgetRequestEvent(t,e){if(!t||!this._roomEngine)return;const s=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);if(!pn.isRoomPreviewerId(e))switch(t.type){case q.OPEN_WIDGET:X().dispatchEvent(new ot(ot.OPEN_WIDGET,e,s,n,t.object.logic.widget));return;case q.CLOSE_WIDGET:X().dispatchEvent(new ot(ot.CLOSE_WIDGET,e,s,n,t.object.logic.widget));return;case q.OPEN_FURNI_CONTEXT_MENU:X().dispatchEvent(new ot(ot.OPEN_FURNI_CONTEXT_MENU,e,s,n,t.object.logic.contextMenu));return;case q.CLOSE_FURNI_CONTEXT_MENU:X().dispatchEvent(new ot(ot.CLOSE_FURNI_CONTEXT_MENU,e,s,n));return;case q.PLACEHOLDER:X().dispatchEvent(new ot(ot.REQUEST_PLACEHOLDER,e,s,n));return;case q.CREDITFURNI:X().dispatchEvent(new ot(ot.REQUEST_CREDITFURNI,e,s,n));return;case q.STACK_HEIGHT:X().dispatchEvent(new ot(ot.REQUEST_STACK_HEIGHT,e,s,n));return;case q.EXTERNAL_IMAGE:X().dispatchEvent(new ot(ot.REQUEST_EXTERNAL_IMAGE,e,s,n));return;case q.STICKIE:X().dispatchEvent(new ot(ot.REQUEST_STICKIE,e,s,n));return;case q.PRESENT:X().dispatchEvent(new ot(ot.REQUEST_PRESENT,e,s,n));return;case q.TROPHY:X().dispatchEvent(new ot(ot.REQUEST_TROPHY,e,s,n));return;case q.TEASER:X().dispatchEvent(new ot(ot.REQUEST_TEASER,e,s,n));return;case q.ECOTRONBOX:X().dispatchEvent(new ot(ot.REQUEST_ECOTRONBOX,e,s,n));return;case q.DIMMER:X().dispatchEvent(new ot(ot.REQUEST_DIMMER,e,s,n));return;case q.WIDGET_REMOVE_DIMMER:X().dispatchEvent(new ot(ot.REMOVE_DIMMER,e,s,n));return;case q.CLOTHING_CHANGE:X().dispatchEvent(new ot(ot.REQUEST_CLOTHING_CHANGE,e,s,n));return;case q.JUKEBOX_PLAYLIST_EDITOR:X().dispatchEvent(new ot(ot.REQUEST_PLAYLIST_EDITOR,e,s,n));return;case q.MANNEQUIN:X().dispatchEvent(new ot(ot.REQUEST_MANNEQUIN,e,s,n));return;case q.PET_PRODUCT_MENU:X().dispatchEvent(new pu(pu.USE_PRODUCT_FROM_ROOM,e,s,n));return;case q.GUILD_FURNI_CONTEXT_MENU:it().connection.send(new oP(t.objectId,t.object.model.getValue(A.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:X().dispatchEvent(new ot(ot.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,e,s,n));return;case q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:X().dispatchEvent(new ot(ot.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,e,s,n));return;case q.BACKGROUND_COLOR:X().dispatchEvent(new ot(ot.REQUEST_BACKGROUND_COLOR,e,s,n));return;case q.AREA_HIDE:X().dispatchEvent(new ot(ot.REQUEST_AREA_HIDE,e,s,n));return;case q.MYSTERYBOX_OPEN_DIALOG:X().dispatchEvent(new ot(ot.REQUEST_MYSTERYBOX_OPEN_DIALOG,e,s,n));return;case q.EFFECTBOX_OPEN_DIALOG:X().dispatchEvent(new ot(ot.REQUEST_EFFECTBOX_OPEN_DIALOG,e,s,n));return;case q.MYSTERYTROPHY_OPEN_DIALOG:X().dispatchEvent(new ot(ot.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,e,s,n));return;case q.ACHIEVEMENT_RESOLUTION_OPEN:it().connection.send(new Yb(t.objectId,0));return;case q.ACHIEVEMENT_RESOLUTION_ENGRAVING:X().dispatchEvent(new ot(ot.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,e,s,n));return;case q.ACHIEVEMENT_RESOLUTION_FAILED:X().dispatchEvent(new ot(ot.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,e,s,n));return;case q.FRIEND_FURNITURE_CONFIRM:X().dispatchEvent(new ot(ot.REQUEST_FRIEND_FURNITURE_CONFIRM,e,s,n));return;case q.FRIEND_FURNITURE_ENGRAVING:X().dispatchEvent(new ot(ot.REQUEST_FRIEND_FURNITURE_ENGRAVING,e,s,n));return;case q.BADGE_DISPLAY_ENGRAVING:X().dispatchEvent(new ot(ot.REQUEST_BADGE_DISPLAY_ENGRAVING,e,s,n));return;case q.HIGH_SCORE_DISPLAY:X().dispatchEvent(new ot(ot.REQUEST_HIGH_SCORE_DISPLAY,e,s,n));return;case q.HIDE_HIGH_SCORE_DISPLAY:X().dispatchEvent(new ot(ot.REQUEST_HIDE_HIGH_SCORE_DISPLAY,e,s,n));return;case q.INERNAL_LINK:X().dispatchEvent(new ot(ot.REQUEST_INTERNAL_LINK,e,s,n));return;case q.ROOM_LINK:X().dispatchEvent(new ot(ot.REQUEST_ROOM_LINK,e,s,n));return;case q.YOUTUBE:X().dispatchEvent(new ot(ot.REQUEST_YOUTUBE,e,s,n));return}}onRoomObjectFurnitureActionEvent(t,e){t&&this.useObject(e,t.object.id,t.object.type,t.type)}handleObjectSoundMachineEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),r=this.getSelectedRoomObjectData(e);if(!(r&&r.category===s&&r.id===t.objectId&&r.operation===Gt.OBJECT_PLACE))switch(t.type){case _t.SOUND_MACHINE_INIT:X().dispatchEvent(new ds(ds.SOUND_MACHINE_INIT,e,t.objectId,s));return;case _t.SOUND_MACHINE_START:X().dispatchEvent(new ds(ds.SOUND_MACHINE_SWITCHED_ON,e,t.objectId,s));return;case _t.SOUND_MACHINE_STOP:X().dispatchEvent(new ds(ds.SOUND_MACHINE_SWITCHED_OFF,e,t.objectId,s));return;case _t.SOUND_MACHINE_DISPOSE:X().dispatchEvent(new ds(ds.SOUND_MACHINE_DISPOSE,e,t.objectId,s));return}}handleObjectJukeboxEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),r=this.getSelectedRoomObjectData(e);if(!(r&&r.category===s&&r.id===t.objectId&&r.operation===Gt.OBJECT_PLACE))switch(t.type){case _t.JUKEBOX_INIT:X().dispatchEvent(new ds(ds.JUKEBOX_INIT,e,t.objectId,s));return;case _t.JUKEBOX_START:X().dispatchEvent(new ds(ds.JUKEBOX_SWITCHED_ON,e,t.objectId,s));return;case _t.JUKEBOX_MACHINE_STOP:X().dispatchEvent(new ds(ds.JUKEBOX_SWITCHED_OFF,e,t.objectId,s));return;case _t.JUKEBOX_DISPOSE:X().dispatchEvent(new ds(ds.JUKEBOX_DISPOSE,e,t.objectId,s));return}}onRoomObjectFloorHoleEvent(t,e){if(t)switch(t.type){case Oi.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(e,t.objectId);return;case Oi.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(e,t.objectId);return}}onRoomObjectRoomAdEvent(t,e){if(!t)return;let s=null;switch(t.type){case ts.ROOM_AD_FURNI_CLICK:X().dispatchEvent(t),t.clickUrl&&t.clickUrl.length>0&&ht(t.clickUrl),s=na.FURNI_CLICK;break;case ts.ROOM_AD_FURNI_DOUBLE_CLICK:if(t.clickUrl&&t.clickUrl.length>0){const r="CATALOG_PAGE";t.clickUrl.indexOf(r)===0&&ht(t.clickUrl.substr(r.length))}s=na.FURNI_DOUBLE_CLICK;break;case ts.ROOM_AD_TOOLTIP_SHOW:s=na.TOOLTIP_SHOW;break;case ts.ROOM_AD_TOOLTIP_HIDE:s=na.TOOLTIP_HIDE;break}s&&X().dispatchEvent(new Ot(s,e,t.objectId,this._roomEngine.getRoomObjectCategoryForType(t.objectType)))}onRoomObjectBadgeAssetEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case Sn.LOAD_BADGE:{const s=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);this._roomEngine.loadRoomObjectBadgeImage(e,s,n,t.badgeId,t.groupBadge);return}}}handleMousePointer(t,e){t&&this._roomEngine.updateMousePointer(t.type,t.objectId,t.objectType)}handleRoomObjectPlaySoundEvent(t,e){const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case za.PLAY_SOUND:X().dispatchEvent(new dc(dc.PLAY_SOUND,e,t.objectId,s,t.soundId,t.pitch));return;case za.PLAY_SOUND_AT_PITCH:X().dispatchEvent(new dc(dc.PLAY_SOUND_AT_PITCH,e,t.objectId,s,t.soundId,t.pitch));return}}handleRoomObjectSamplePlaybackEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case js.ROOM_OBJECT_INITIALIZED:X().dispatchEvent(new zr(zr.ROOM_OBJECT_INITIALIZED,e,t.objectId,s,t.sampleId,t.pitch));break;case js.ROOM_OBJECT_DISPOSED:X().dispatchEvent(new zr(zr.ROOM_OBJECT_DISPOSED,e,t.objectId,s,t.sampleId,t.pitch));break;case js.PLAY_SAMPLE:X().dispatchEvent(new zr(zr.PLAY_SAMPLE,e,t.objectId,s,t.sampleId,t.pitch));break;case js.CHANGE_PITCH:X().dispatchEvent(new zr(zr.CHANGE_PITCH,e,t.objectId,s,t.sampleId,t.pitch));break}}onHSLColorEnableEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case Ha.ROOM_BACKGROUND_COLOR:X().dispatchEvent(new qh(qh.ROOM_BACKGROUND_COLOR,e,t.enable,t.hue,t.saturation,t.lightness));return}}onRoomObjectDataRequestEvent(t,e){if(!(!t||!this._roomEngine||!t.object))switch(t.type){case Zr.RODRE_CURRENT_USER_ID:t.object.model.setValue(A.SESSION_CURRENT_USER_ID,tt().userId);return;case Zr.RODRE_URL_PREFIX:t.object.model.setValue(A.SESSION_URL_PREFIX,jt().getValue("url.prefix"));return}}handleClickOnTile(t,e){if(!this._roomEngine||this._roomEngine.isDecorating)return;const s=Yi().getSession(t);!s||s.isSpectator||this._roomEngine.moveBlocked||this.sendWalkUpdate(e.tileXAsInt,e.tileYAsInt)}handleObjectMove(t,e){if(!t||!this._roomEngine||!X())return;const r=this.getSelectedRoomObjectData(e);if(!r)return;const n=this._roomEngine.getRoomObject(e,r.id,r.category);if(!n)return;let o=!0;if(r.category===Y.FLOOR||r.category===Y.UNIT){const l=this._roomEngine.getFurnitureStackingHeightMap(e);t instanceof bn&&this.handleFurnitureMove(n,r,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),l)||(this.handleFurnitureMove(n,r,r.loc.x,r.loc.y,l),o=!1)}else if(r.category===Y.WALL){if(o=!1,t instanceof cc){const l=t.wallLocation,c=t.wallWidth,u=t.wallHeight,h=t.x,d=t.y,f=t.direction;this.handleWallItemMove(n,r,l,c,u,h,d,f)&&(o=!0)}o||(n.setLocation(r.loc),n.setDirection(r.dir)),this._roomEngine.updateRoomObjectMask(e,r.id,o)}o?(this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(n,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(t,e){if(!t||!this._roomEngine||!X())return;let r=this.getSelectedRoomObjectData(e);if(!r)return;let n=this._roomEngine.getRoomObject(e,r.id,r.category);if(!n){if(t instanceof bn){if(r.category===Y.FLOOR)this._roomEngine.addFurnitureFloor(e,r.id,r.typeId,r.loc,r.dir,0,r.stuffData,parseFloat(r.instanceData),-1,0,0,"",!1);else if(r.category===Y.UNIT){this._roomEngine.addRoomObjectUser(e,r.id,new w,new w(180),180,r.typeId,r.instanceData);const o=this._roomEngine.getRoomObject(e,r.id,r.category);o&&r.posture&&o.model.setValue(A.FIGURE_POSTURE,r.posture)}}else t instanceof cc&&r.category===Y.WALL&&this._roomEngine.addFurnitureWall(e,r.id,r.typeId,r.loc,r.dir,0,r.instanceData,0);if(n=this._roomEngine.getRoomObject(e,r.id,r.category),n&&r.category===Y.FLOOR){const o=n.model.getValue(A.FURNITURE_ALLOWED_DIRECTIONS);if(o&&o.length){const l=new w(o[0]);if(n.setDirection(l),this.updateSelectedObjectData(e,r.id,r.category,r.loc,l,r.operation,r.typeId,r.instanceData,r.stuffData,r.state,r.animFrame,r.posture),r=this.getSelectedRoomObjectData(e),!r)return}}this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(n){let o=!0;const l=this._roomEngine.getFurnitureStackingHeightMap(e);if(r.category===Y.FLOOR)t instanceof bn&&this.handleFurnitureMove(n,r,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),l)||(this._roomEngine.removeRoomObjectFloor(e,r.id),o=!1);else if(r.category===Y.WALL){if(o=!1,t instanceof cc){const c=t.wallLocation,u=t.wallWidth,h=t.wallHeight,d=t.x,f=t.y,E=t.direction;this.handleWallItemMove(n,r,c,u,h,d,f,E)&&(o=!0)}o||this._roomEngine.removeRoomObjectWall(e,r.id),this._roomEngine.updateRoomObjectMask(e,r.id,o)}else r.category===Y.UNIT&&(t instanceof bn&&this.handleUserPlace(n,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),this._roomEngine.getLegacyWallGeometry(e))||(this._roomEngine.removeRoomObjectUser(e,r.id),o=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!o)}}handleFurnitureMove(t,e,s,r,n){if(!t||!e)return!1;const o=new w;o.assign(t.getDirection()),t.setDirection(e.dir);const l=new w(s,r,0),c=new w;c.assign(t.getDirection());let u=this.validateFurnitureLocation(t,l,e.loc,e.dir,n);return u||(c.x=this.getValidRoomObjectDirection(t,!0),t.setDirection(c),u=this.validateFurnitureLocation(t,l,e.loc,e.dir,n)),u?(t.setLocation(u),c&&t.setDirection(c),!0):(t.setDirection(o),!1)}handleWallItemMove(t,e,s,r,n,o,l,c){if(!t||!e)return!1;const u=new w(c),h=this.validateWallItemLocation(t,s,r,n,o,l,e);return h?(t.setLocation(h),t.setDirection(u),!0):!1}validateFurnitureLocation(t,e,s,r,n){if(!t||!t.model||!e)return null;let o=null;const l=t.getDirection();if(!l||!s||!r)return null;if(e.x===s.x&&e.y===s.y&&l.x===r.x)return o=new w,o.assign(s),o;let c=t.model.getValue(A.FURNITURE_SIZE_X),u=t.model.getValue(A.FURNITURE_SIZE_Y);c<1&&(c=1),u<1&&(u=1);const h=s.x,d=s.y;let f=c,E=u,m=0,I=Math.trunc(Math.trunc(l.x+45)%360/90);if((I===1||I===3)&&(m=c,c=u,u=m),I=Math.trunc(Math.trunc(r.x+45)%360/90),(I===1||I===3)&&(m=f,f=E,E=m),n&&e){const p=t.model.getValue(A.FURNITURE_ALWAYS_STACKABLE)===1;return n.validateLocation(e.x,e.y,c,u,h,d,f,E,p)?new w(e.x,e.y,n.getTileHeight(e.x,e.y)):null}return null}validateWallItemLocation(t,e,s,r,n,o,l){if(t==null||t.model==null||e==null||s==null||r==null||l==null)return null;const c=t.model.getValue(A.FURNITURE_SIZE_X),u=t.model.getValue(A.FURNITURE_SIZE_Z),h=t.model.getValue(A.FURNITURE_CENTER_Z);if((n<c/2||n>s.length-c/2||o<h||o>r.length-(u-h))&&(n<c/2&&n<=s.length-c/2?n=c/2:n>=c/2&&n>s.length-c/2&&(n=s.length-c/2),o<h&&o<=r.length-(u-h)?o=h:o>=h&&o>r.length-(u-h)&&(o=r.length-(u-h))),n<c/2||n>s.length-c/2||o<h||o>r.length-(u-h))return null;let d=w.sum(w.product(s,n/s.length),w.product(r,o/r.length));return d=w.sum(e,d),d}changeObjectState(t,e,s,r,n){const o=this._roomEngine.getRoomObjectCategoryForType(s);this.changeRoomObjectState(t,e,o,r,n)}useObject(t,e,s,r){if(!(!this._roomEngine||!it().connection))switch(r){case _t.DICE_ACTIVATE:it().connection.send(new hP(e));return;case _t.DICE_OFF:it().connection.send(new dP(e));return;case _t.USE_HABBOWHEEL:it().connection.send(new uP(e));return;case _t.STICKIE:it().connection.send(new qv(e));return;case _t.ENTER_ONEWAYDOOR:it().connection.send(new gP(e));return}}changeRoomObjectState(t,e,s,r,n){return!this._roomEngine||!it().connection||(s===Y.FLOOR?n?it().connection.send(new fP(e,r)):it().connection.send(new Au(e,r)):s===Y.WALL&&it().connection.send(new mP(e,r))),!0}sendWalkUpdate(t,e){!this._roomEngine||!it().connection||it().connection.send(new BP(t,e))}handleMouseOverObject(t,e,s){if(t!==Y.FLOOR)return null;const r=this._roomEngine.getRoomObject(e,s.objectId,Y.FLOOR);if(!r)return null;const n=this.getActiveSurfaceLocation(r,s);if(!n||!this._roomEngine.getFurnitureStackingHeightMap(e))return null;const l=n.x,c=n.y,u=n.z;return new uc(new w(l,c,r.getLocation().z),u,!0,s.eventId)}handleMoveTargetFurni(t,e){const s=this._roomEngine.getRoomObject(t,e.objectId,Y.FLOOR),r=this.getActiveSurfaceLocation(s,e);return r&&!this._roomEngine.moveBlocked?(this.sendWalkUpdate(r.x,r.y),!0):!1}getActiveSurfaceLocation(t,e){if(!t||!e)return null;const s=tt().getFloorItemDataByName(t.type);if(!s||!s.canStandOn&&!s.canSitOn&&!s.canLayOn)return null;const r=t.model;if(!r)return null;const n=t.getLocation(),o=t.getDirection();let l=r.getValue(A.FURNITURE_SIZE_X),c=r.getValue(A.FURNITURE_SIZE_Y);const u=r.getValue(A.FURNITURE_SIZE_Z);(o.x===90||o.x===270)&&([l,c]=[c,l]),l<1&&(l=1),c<1&&(c=1);const h=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!h)return null;const d=h.geometry.scale,f=s.canSitOn?.5:0,E=(d/2+e.spriteOffsetX+e.localX)/(d/4),m=(e.spriteOffsetY+e.localY+(u-f)*d/2)/(d/4),I=(E+2*m)/4,p=(E-2*m)/4,T=Math.floor(n.x+I),R=Math.floor(n.y-p+1);let S=!1;(T<n.x||T>=n.x+l||R<n.y||R>=n.y+c)&&(S=!0);const L=s.canSitOn?u-.5:u;return S?null:new w(T,R,L)}handleMouseOverTile(t,e){if(this.whereYouClickIsWhereYouGo())return new uc(new w(t.tileXAsInt,t.tileYAsInt,t.tileZAsInt),0,!0,t.eventId);const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.visualization){const r=t.tileXAsInt,n=t.tileYAsInt,o=t.tileZAsInt;if(this._roomEngine.getRoomInstance(e)){const c=this._roomEngine.getRoomTileObjectMap(e);if(c){const u=c.getObjectIntTile(r,n),h=this._roomEngine.getFurnitureStackingHeightMap(e);if(h){if(u&&u.model&&u.model.getValue(A.FURNITURE_IS_VARIABLE_HEIGHT)>0){const d=h.getTileHeight(r,n),f=this._roomEngine.getLegacyWallGeometry(e).getHeight(r,n);return new uc(new w(r,n,o),d-f,!0,t.eventId)}return new uc(new w(r,n,o),0,!0,t.eventId)}}}}return null}placeObject(t,e,s){const r=this.getSelectedRoomObjectData(t);if(!r)return;let n=null,o=r.id;const l=r.category;let c=0,u=0,h=0,d=0,f="";if(this._roomEngine&&it().connection&&(n=this._roomEngine.getRoomObject(t,o,l),n)){const E=n.getLocation();if(d=n.getDirection().x,l===Y.FLOOR||l===Y.UNIT)c=E.x,u=E.y,h=E.z;else if(l===Y.WALL){c=E.x,u=E.y,h=E.z;const m=this._roomEngine.getLegacyWallGeometry(t);m&&(f=m.getOldLocationString(E,d))}d=(d/45%8+8)%8,o<0&&l===Y.UNIT&&(o=o*-1),this._objectPlacementSource!==Vo.CATALOG&&(l===Y.UNIT?r.typeId===Pe.PET?it().connection.send(new Jv(o,Math.trunc(c),Math.trunc(u))):r.typeId===Pe.RENTABLE_BOT&&it().connection.send(new zv(o,Math.trunc(c),Math.trunc(u))):n.model.getValue(A.FURNITURE_IS_STICKIE)!==void 0?it().connection.send(new cP(o,f)):it().connection.send(new hS(o,l,f,Math.trunc(c),Math.trunc(u),d)))}if(this._roomEngine.setPlacedRoomObjectData(t,new IE(r.id,r.category,null,r.dir,null)),this.resetSelectedObjectData(t),this._roomEngine&&X()){const E=n&&n.id===r.id;X().dispatchEvent(new up(Ot.PLACED,t,o,l,f,c,u,h,d,E,e,s,r.instanceData))}}modifyRoomObject(t,e,s,r){if(!this._roomEngine)return!1;const n=this._roomEngine.getRoomObject(t,e,s);if(!n)return!1;let o=!0;switch(r){case Gt.OBJECT_ROTATE_POSITIVE:case Gt.OBJECT_ROTATE_NEGATIVE:if(it().connection){let l=0;r==Gt.OBJECT_ROTATE_NEGATIVE?l=this.getValidRoomObjectDirection(n,!1):l=this.getValidRoomObjectDirection(n,!0);const c=n.getLocation().x,u=n.getLocation().y;if(this.isValidLocation(n,new w(l),this._roomEngine.getFurnitureStackingHeightMap(t)))if(l=Math.trunc(l/45),n.type===Ue.MONSTER_PLANT){const h=Yi().getSession(t);if(h){const d=h.userDataManager.getUserDataByIndex(e);d&&it().connection.send(new YI(d.webID,Math.trunc(c),Math.trunc(u),l))}}else it().connection.send(new zI(e,c,u,l))}break;case Gt.OBJECT_EJECT:case Gt.OBJECT_PICKUP:it().connection&&it().connection.send(new lP(s,e));break;case Gt.OBJECT_PICKUP_PET:if(it().connection){const l=Yi().getSession(t);if(l){const c=l.userDataManager.getUserDataByIndex(e);l.pickupPet(c.webID)}}break;case Gt.OBJECT_PICKUP_BOT:if(it().connection){const l=Yi().getSession(t);if(l){const c=l.userDataManager.getUserDataByIndex(e);l.pickupBot(c.webID)}}break;case Gt.OBJECT_MOVE:o=!1,this.setFurnitureAlphaMultiplier(n,.5),this.setSelectedRoomObjectData(t,n.id,s,n.getLocation(),n.getDirection(),r),this._roomEngine.setObjectMoverIconSprite(n.id,s,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case Gt.OBJECT_MOVE_TO:{const l=this.getSelectedRoomObjectData(t);if(this.updateSelectedObjectData(t,l.id,l.category,l.loc,l.dir,Gt.OBJECT_MOVE_TO,l.typeId,l.instanceData,l.stuffData,l.state,l.animFrame,l.posture),this.setFurnitureAlphaMultiplier(n,1),this._roomEngine.removeObjectMoverIconSprite(),it().connection){if(s===Y.FLOOR){const c=n.getDirection().x%360,u=n.getLocation(),h=c/45;it().connection.send(new zI(e,u.x,u.y,h))}else if(s===Y.WALL){const c=n.getDirection().x%360,u=this._roomEngine.getLegacyWallGeometry(t);if(u){const h=u.getOldLocationString(n.getLocation(),c);h&&it().connection.send(new SP(e,h))}}else if(s===Y.UNIT){const c=n.getDirection().x%360,u=n.getLocation(),h=c/45;parseInt(n.model.getValue(A.RACE));const d=Yi().getSession(t);if(d){const f=d.userDataManager.getUserDataByIndex(e);f&&it().connection.send(new YI(f.webID,u.x,u.y,h))}}}break}}return o&&this.resetSelectedObjectData(t),!0}modifyRoomObjectDataWithMap(t,e,s,r,n){if(!this._roomEngine||!this._roomEngine.getRoomObject(t,e,s))return!1;switch(r){case Gt.OBJECT_SAVE_STUFF_DATA:it().connection&&it().connection.send(new uS(e,n));break}return!0}modifyWallItemData(t,e,s,r){return!this._roomEngine||!it().connection?!1:(it().connection.send(new eP(e,s,r)),!0)}deleteWallItem(t,e){return!this._roomEngine||!it().connection?!1:(it().connection.send(new $v(e)),!0)}getValidRoomObjectDirection(t,e){if(!t||!t.model)return 0;let s=0,r=0,n=[];t.type===Ue.MONSTER_PLANT?n=t.model.getValue(A.PET_ALLOWED_DIRECTIONS):n=t.model.getValue(A.FURNITURE_ALLOWED_DIRECTIONS);let o=t.getDirection().x;if(n&&n.length){if(s=n.indexOf(o),s<0){for(s=0,r=0;r<n.length&&!(o<=n[r]);)s++,r++;s=s%n.length}e?s=(s+1)%n.length:s=(s-1+n.length)%n.length,o=n[s]}return o}isValidLocation(t,e,s){if(!t||!t.model||!e)return!1;const r=t.getDirection(),n=t.getLocation();if(!r||!n)return!1;if(r.x%180===e.x%180)return!0;let o=t.model.getValue(A.FURNITURE_SIZE_X),l=t.model.getValue(A.FURNITURE_SIZE_Y);o<1&&(o=1),l<1&&(l=1);let c=o,u=l,h=Math.trunc(Math.trunc(e.x+45)%360/90);if((h===1||h===3)&&([o,l]=[l,o]),h=Math.trunc(Math.trunc(r.x+45)%360/90),(h===1||h===3)&&([c,u]=[u,c]),s&&n){const d=t.model.getValue(A.FURNITURE_ALWAYS_STACKABLE)===1;if(s.validateLocation(n.x,n.y,o,l,n.x,n.y,c,u,d,n.z))return!0}return!1}placeObjectOnUser(t,e,s){const r=this.getSelectedRoomObjectData(t);!r||!this._roomEngine.getRoomObject(t,e,s)||!this._roomEngine||!X()||X().dispatchEvent(new _j(Ot.PLACED_ON_USER,t,e,s,r.id,r.category))}setSelectedObject(t,e,s){if(!(!this._roomEngine||!X()))switch(s){case Y.UNIT:case Y.FLOOR:case Y.WALL:if(s===Y.UNIT)this.deselectObject(t),this.setSelectedAvatar(t,e,!0);else if(this.setSelectedAvatar(t,0,!1),e!==this._selectedObjectId){this.deselectObject(t);const n=this._roomEngine.getRoomObject(t,e,s);n&&n.logic&&(n.logic.processUpdateMessage(new ld(!0)),this._selectedObjectId=e,this._selectedObjectCategory=s)}X().dispatchEvent(new Ot(Ot.SELECTED,t,e,s));return}}deselectObject(t){if(this._selectedObjectId===-1)return;const e=this._roomEngine.getRoomObject(t,this._selectedObjectId,this._selectedObjectCategory);e&&e.logic&&(e.logic.processUpdateMessage(new ld(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=Y.MINIMUM)}setSelectedAvatar(t,e,s){if(!this._roomEngine)return;const r=Y.UNIT,n=this._roomEngine.getRoomObject(t,this._selectedAvatarId,r);n&&n.logic&&(n.logic.processUpdateMessage(new ug(!1)),this._selectedAvatarId=-1);let o=!1;if(s){const c=this._roomEngine.getRoomObject(t,e,r);if(c&&c.logic){c.logic.processUpdateMessage(new ug(!0)),o=!0,this._selectedAvatarId=e;const u=c.getLocation();u&&it().connection.send(new FP(~~u.x,~~u.y))}}const l=this._roomEngine.getRoomObjectSelectionArrow(t);l&&l.logic&&(o&&!this._roomEngine.isPlayingGame()?l.logic.processUpdateMessage(new qa(qa.ENABLED)):l.logic.processUpdateMessage(new qa(qa.DISABLED)))}resetSelectedObjectData(t){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const e=this.getSelectedRoomObjectData(t);if(e){if(e.operation===Gt.OBJECT_MOVE||e.operation===Gt.OBJECT_MOVE_TO){const s=this._roomEngine.getRoomObject(t,e.id,e.category);s&&e.operation!==Gt.OBJECT_MOVE_TO&&(s.setLocation(e.loc),s.setDirection(e.dir)),this.setFurnitureAlphaMultiplier(s,1),e.category===Y.WALL&&this._roomEngine.updateRoomObjectMask(t,e.id,!0),this.updateSelectedObjectData(t,e.id,e.category,e.loc,e.dir,Gt.OBJECT_MOVE,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture)}else if(e.operation===Gt.OBJECT_PLACE){const s=e.id;switch(e.category){case Y.FLOOR:this._roomEngine.removeRoomObjectFloor(t,s);break;case Y.WALL:this._roomEngine.removeRoomObjectWall(t,s);break;case Y.UNIT:this._roomEngine.removeRoomObjectUser(t,s);break}}this._roomEngine.setSelectedRoomObjectData(t,null)}}getSelectedRoomObjectData(t){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(t):null}setFurnitureAlphaMultiplier(t,e){!t||!t.model||t.model.setValue(A.FURNITURE_ALPHA_MULTIPLIER,e)}decorateModeMove(t){return this._roomEngine.isDecorating&&!(t.ctrlKey||t.shiftKey)}cancelRoomObjectPlacement(t){return this.resetSelectedObjectData(t),!0}setSelectedRoomObjectData(t,e,s,r,n,o,l=0,c=null,u=null,h=-1,d=-1,f=null){if(this.resetSelectedObjectData(t),!this._roomEngine)return;const E=new IE(e,s,o,r,n,l,c,u,h,d,f);this._roomEngine.setSelectedRoomObjectData(t,E)}updateSelectedObjectData(t,e,s,r,n,o,l=0,c=null,u=null,h=-1,d=-1,f=null){if(!this._roomEngine)return null;const E=new IE(e,s,o,r,n,l,c,u,h,d,f);this._roomEngine.setSelectedRoomObjectData(t,E)}handleUserPlace(t,e,s,r){return r.isRoomTile(e,s)?(t.setLocation(new w(e,s,r.getHeight(e,s))),!0):!1}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}whereYouClickIsWhereYouGo(){return this._roomEngine.whereYouClickIsWhereYouGo()}}class RX{constructor(t){this._roomObjectVariableAccurateZ=t||"",this._location=new w,this._screenLocation=new w,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(t,e){if(!t||!e)return null;let s=!1;const r=t.getLocation();if((e.updateId!==this._geometryUpdateId||t.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=t.updateCounter,(e.updateId!==this._geometryUpdateId||r.x!==this._location.x||r.y!==this._location.y||r.z!==this._location.z)&&(this._geometryUpdateId=e.updateId,this._location.assign(r),s=!0)),this._locationChanged=s,this._locationChanged){const n=e.getScreenPosition(r);if(!n)return null;const o=t.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(o)||o===0){const l=new w(Math.round(r.x),Math.round(r.y),r.z);if(l.x!==r.x||l.y!==r.y){const c=e.getScreenPosition(l);this._screenLocation.assign(n),c&&(this._screenLocation.z=c.z)}else this._screenLocation.assign(n)}else this._screenLocation.assign(n);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class SX{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}dispose(){this.setSpriteCount(0)}addSprite(t){this._sprites.push(t)}getSprite(t){return this._sprites[t]}needsUpdate(t,e){return t===this._updateId1&&e===this._updateId2?!1:(this._updateId1=t,this._updateId2=e,!0)}setSpriteCount(t){var e;if(t<this._sprites.length){let s=t;for(;s<this._sprites.length;)(e=this._sprites[s])==null||e.dispose(),s++;this._sprites.splice(t,this._sprites.length-t)}this._isEmpty=!this._sprites.length}get sprites(){return this._sprites}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}}class OX{constructor(t){this._location=new RX(t),this._sprites=new SX}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get location(){return this._location}get sprites(){return this._sprites}}const yh=class yh{constructor(t){this._data=new Map,this._roomObjectVariableAccurateZ=t}dispose(){if(this._data){for(const[t,e]of this._data.entries())e&&(this._data.delete(t),e.dispose());this._data=null}}getObjectCache(t){let e=this._data.get(t);return e||(e=new OX(this._roomObjectVariableAccurateZ),this._data.set(t,e)),e}removeObjectCache(t){const e=this._data.get(t);e&&(this._data.delete(t),e.dispose())}getSortableSpriteList(){const t=[];for(const e of this._data.values()){if(!e)continue;const s=e.sprites&&e.sprites.sprites;if(!(!s||!s.length)){for(const r of s)if(r&&r.sprite.spriteType!==Nr.ROOM_PLANE&&r.sprite.name!==""){const n=new Q0;n.objectId=e.objectId,n.x=r.x,n.y=r.y,n.z=r.z,n.name=r.sprite.name||"",n.flipH=r.sprite.flipH,n.alpha=r.sprite.alpha,n.color=r.sprite.color.toString(),n.blendMode=r.sprite.blendMode.toString(),n.width=r.sprite.width,n.height=r.sprite.height,n.type=r.sprite.type,n.posture=r.sprite.posture;const o=this.isSkewedSprite(r.sprite);o&&(n.skew=r.sprite.direction%4===0?-.5:.5),(o||r.name.indexOf("%image.library.url%")>=0||r.name.indexOf("%group.badge.url%")>=0)&&n.width<=yh.MAX_SIZE_FOR_AVG_COLOR&&n.height<=yh.MAX_SIZE_FOR_AVG_COLOR&&r.sprite.name.indexOf("external_image_wallitem")===0&&(n.frame=!0),t.push(n)}}}return!t||!t.length?null:t}isSkewedSprite(t){return t.type?t.type.indexOf("external_image_wallitem")===0&&t.tag==="THUMBNAIL"||t.type.indexOf("guild_forum")===0&&t.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const t=[];for(const e of this._data.values())for(const s of e.sprites.sprites)s.sprite.spriteType===Nr.ROOM_PLANE&&t.push(s);return t}};yh.MAX_SIZE_FOR_AVG_COLOR=200;let BT=yh;const AX=4;class CS extends Ve{constructor(){super(...arguments),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=Rn.MATCH_OPAQUE_PIXELS,this._varyingDepth=!1,this._clickHandling=!1,this._skipMouseHandling=!1,this._updateId1=-1,this._updateId2=-1}needsUpdate(t,e){return this._updateId1===t&&this._updateId2===e?!1:(this._updateId1=t,this._updateId2=e,!0)}setTexture(t){t||(t=Es.EMPTY),t!==this.texture&&(t===Es.EMPTY&&(this._updateId1=-1,this._updateId2=-1),this.texture=t)}containsPoint(t){if(!t||this.alphaTolerance>255||!this.texture||this.texture===Es.EMPTY||(t=new Qt(t.x*this.scale.x,t.y*this.scale.y),!super.containsPoint(t)))return!1;const e=this.texture,s=this.texture.source;if((!s||!s.hitMap)&&!CS.generateHitMapForTextureSource(s))return!1;const r=s.hitMap;if(!r)return!1;let n=t.x+e.frame.x,o=t.y+e.frame.y;this.texture.trim&&(n-=e.trim.x,o-=e.trim.y),n=Math.round(n)*s.resolution,o=Math.round(o)*s.resolution;const l=(n+o*s.width)*4;return r[l+3]>=this.alphaTolerance}static generateHitMapForTextureSource(t){var o;if(!t)return!1;const e=Mr(),s=Math.max(Math.round(t.width*t.resolution),1),r=Math.max(Math.round(t.height*t.resolution),1);let n=null;if(e instanceof m0)n=((o=me.getPixels(new Es(t)))==null?void 0:o.pixels)??null;else if(e.type===E0.WEBGL){n=new Uint8ClampedArray(AX*s*r);const l=e.renderTarget.getRenderTarget(t),c=e.renderTarget.getGpuRenderTarget(l),u=e.gl;u.bindFramebuffer(u.FRAMEBUFFER,c.resolveTargetFramebuffer),u.readPixels(0,0,s,r,u.RGBA,u.UNSIGNED_BYTE,n)}return n?(t.hitMap=n,!0):!1}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get tag(){return this._tag}set tag(t){this._tag=t}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance=t}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){this._varyingDepth=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}get skipMouseHandling(){return this._skipMouseHandling}set skipMouseHandling(t){this._skipMouseHandling=t}}class NX{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get spriteTag(){return this._spriteTag}set spriteTag(t){this._spriteTag=t}}const fm=class fm{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-fm.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(t){this._name=t}get sprite(){return this._sprite}set sprite(t){this._sprite=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}};fm.Z_INFINITY=1e8;let VT=fm;class CX{constructor(t,e,s,r,n){this._id=t,this._container=e,this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new Qt,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._mouseListener=null,this._geometry=new Ho(n,new w(-135,30,0),new w(11,11,5),new w(-135,.5,0)),this._animationFPS=jt().getValue("system.fps.animation",24),this._objectCache=new BT(this._container.roomObjectVariableAccurateZ),this.setupCanvas(),this.initialize(s,r)}setupCanvas(){if(this._master||(this._master=new $r),this._master.cullableChildren=!1,!this._display){const t=new $r;t.isRenderGroup=!1,t.cullableChildren=!1,this._master.addChild(t),this._display=t}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const t of this._spritePool)this.cleanSprite(t,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(t,e){if(t=t<1?1:t,e=e<1?1:e,this._usesMask&&(this._mask?(this._mask.width=t,this._mask.height=e):(this._mask=new Ve(Es.WHITE),this._mask.tint=16711680,this._mask.width=t,this._mask.height=e,this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master)if(this._master.filterArea){const s=this._master.filterArea;s.width=t,s.height=e}else this._master.filterArea=new zo(0,0,t,e);this._width=t,this._height=e}setMask(t){t&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!t&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(t,e=null,s=null){!this._master||!this._display||(e||(e=new Qt(this._width/2,this._height/2)),s||(s=e),e=this._display.toLocal(e),this._scale=t,this.screenOffsetX=s.x-e.x*this._scale,this.screenOffsetY=s.y-e.y*this._scale)}render(t,e=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=Ti().deltaTime,this._totalTimeRunning===this._renderTimestamp||(t===-1&&(t=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(e=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),e=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),e=!0),this.doMagic();const s=Math.round(this._totalTimeRunning/(60/this._animationFPS));let r=!1;s!==this._lastFrame&&(this._lastFrame=s,r=!0);let n=0;const o=this._container.objects;if(o.size)for(const c of o.values())c&&(n=n+this.renderObject(c,c.instanceId.toString(),t,e,r,n));this._sortableSprites.sort((c,u)=>u.z-c.z),n<this._sortableSprites.length&&this._sortableSprites.splice(n);let l=0;for(;l<n;){const c=this._sortableSprites[l];c&&c.sprite&&this.renderSprite(l,c),l++}this.cleanSprites(n),(e||r)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(t){this._objectCache.removeObjectCache(t)}renderObject(t,e,s,r,n,o){if(!t)return 0;const l=t.visualization;if(!l)return this.removeFromCache(e),0;const c=this.getCacheItem(e);c.objectId=t.instanceId;const u=c.location,h=c.sprites,d=u.updateLocation(t,this._geometry);if(!d)return this.removeFromCache(e),0;if(n&&l.update(this._geometry,s,!h.isEmpty||r,this._skipObjectUpdate&&this._runningSlow),u.locationChanged&&(r=!0),!h.needsUpdate(l.instanceId,l.updateSpriteCounter)&&!r)return h.spriteCount;let f=d.x,E=d.y,m=d.z;f>0?m=m+f*12e-8:m=m+-f*12e-8,f=f+Math.trunc(this._width/2),E=E+Math.trunc(this._height/2);let I=0;for(const p of l.sprites.values()){if(!p||!p.visible)continue;const T=p.texture,R=T&&T.source;if(!T||!R)continue;const S=f+p.offsetX+this._screenOffsetX,L=E+p.offsetY+this._screenOffsetY;if(p.flipH){const P=f+-(T.width+-p.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(P,L,T.width,T.height))continue}else if(p.flipV){const P=E+-(T.height+-p.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(S,P,T.width,T.height))continue}else if(!this.isSpriteVisible(S,L,T.width,T.height))continue;let M=h.getSprite(I);M||(M=new VT,h.addSprite(M),this._sortableSprites.push(M),M.name=e),M.sprite=p,(p.spriteType===Nr.AVATAR||p.spriteType===Nr.AVATAR_OWN)&&(M.sprite.libraryAssetName="avatar_"+t.id),M.x=S-this._screenOffsetX,M.y=L-this._screenOffsetY,M.z=m+p.relativeDepth+37e-12*o,I++,o++}return h.setSpriteCount(I),this._canvasUpdated=!0,I}getExtendedSprite(t){if(t<0||t>=this._spriteCount)return null;const e=this._display.getChildAt(t);return e||null}getExtendedSpriteIdentifier(t){return t?t.label:""}renderSprite(t,e){if(t>=this._spriteCount)return this.createAndAddSprite(e),!0;if(!e)return!1;const s=e.sprite,r=this.getExtendedSprite(t);if(!s||!r)return!1;if(r.varyingDepth!==s.varyingDepth)return r.varyingDepth&&!s.varyingDepth?(this._display.removeChildAt(t),this._spritePool.push(r),this.renderSprite(t,e)):(this.createAndAddSprite(e,t),!0);if(r.needsUpdate(s.id,s.updateCounter)||Cr.isVisualizationOn()){r.tag=s.tag,r.alphaTolerance=s.alphaTolerance,r.label=e.name,r.varyingDepth=s.varyingDepth,r.clickHandling=s.clickHandling,r.skipMouseHandling=s.skipMouseHandling,r.filters=s.filters;const n=s.alpha/255;r.alpha!==n&&(r.alpha=n),r.tint!==s.color&&(r.tint=s.color),r.blendMode!==s.blendMode&&(r.blendMode=s.blendMode),r.texture!==s.texture&&r.setTexture(s.texture),s.flipH?r.scale.x!==-1&&(r.scale.x=-1):r.scale.x!==1&&(r.scale.x=1),s.flipV?r.scale.y!==-1&&(r.scale.y=-1):r.scale.y!==1&&(r.scale.y=1),this.updateEnterRoomEffect(r,s)}return r.x!==e.x&&(r.x=e.x),r.y!==e.y&&(r.y=e.y),r.offsetX=s.offsetX,r.offsetY=s.offsetY,!0}createAndAddSprite(t,e=-1){const s=t.sprite;if(!s)return;let r=null;this._spritePool.length>0&&(r=this._spritePool.pop());let n=!1;r||(r=new CS({texture:s.texture}),n=!0),r.children.length&&r.removeChildren(),r.tag=s.tag,r.alphaTolerance=s.alphaTolerance,r.alpha=s.alpha/255,r.tint=s.color,r.x=t.x,r.y=t.y,r.offsetX=s.offsetX,r.offsetY=s.offsetY,r.label=s.name,r.varyingDepth=s.varyingDepth,r.clickHandling=s.clickHandling,r.skipMouseHandling=s.skipMouseHandling,r.blendMode=s.blendMode,r.filters=s.filters,n||r.setTexture(s.texture),s.flipH&&(r.scale.x=-1),s.flipV&&(r.scale.y=-1),this.updateEnterRoomEffect(r,s),e<0||e>=this._spriteCount?(this._display.addChild(r),this._spriteCount++):this._display.addChildAt(r,e),this._activeSpriteCount++}cleanSprites(t,e=!1){if(this._display){if(t<0&&(t=0),t<this._activeSpriteCount||!this._activeSpriteCount){let s=this._spriteCount-1;for(;s>=t;)this.cleanSprite(this.getExtendedSprite(s),e),s--}this._activeSpriteCount=t}}updateEnterRoomEffect(t,e){if(!(!Cr.isVisualizationOn()||!e))switch(e.spriteType){case Nr.AVATAR_OWN:return;case Nr.ROOM_PLANE:t.alpha=Cr.getDelta(.9);return;case Nr.AVATAR:t.alpha=Cr.getDelta(.5);return;default:t.alpha=Cr.getDelta(.1)}}cleanSprite(t,e){t&&(e?(t.parent&&t.parent.removeChild(t),t.destroy({children:!0})):t.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(t){this._mouseListener=t}getCacheItem(t){return this._objectCache.getObjectCache(t)}isSpriteVisible(t,e,s,r){return!!(this._noSpriteVisibilityChecking||(t=(t-this._screenOffsetX)*this._scale+this._screenOffsetX,e=(e-this._screenOffsetY)*this._scale+this._screenOffsetY,s=s*this._scale,r=r*this._scale,t<this._width&&t+s>=0&&e<this._height&&e+r>=0&&!this._usesExclusionRectangles))}handleMouseEvent(t,e,s,r,n,o,l){return t=t-this._screenOffsetX,e=e-this._screenOffsetY,this._mouseLocation.x=t/this._scale,this._mouseLocation.y=e/this._scale,this._mouseCheckCount>0&&s==lt.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(t/this._scale),Math.trunc(e/this._scale),s,r,n,o,l),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(t,e,s,r=!1,n=!1,o=!1,l=!1){const c=[];let u=!1,h=null,d=this._activeSpriteCount-1;for(;d>=0;){const m=this.getExtendedSprite(d);if(m&&m.containsPoint(new Qt(t-m.x,e-m.y))&&!m.skipMouseHandling&&!(m.clickHandling&&(s===lt.MOUSE_CLICK||s===lt.DOUBLE_CLICK))){const I=this.getExtendedSpriteIdentifier(m);if(c.indexOf(I)===-1){const p=m.tag;let T=this._mouseActiveObjects.get(I);T&&T.spriteTag!==p&&(h=this.createMouseEvent(0,0,0,0,lt.ROLL_OUT,T.spriteTag,r,n,o,l),this.bufferMouseEvent(h,I)),s===lt.MOUSE_MOVE&&(!T||T.spriteTag!==p)?h=this.createMouseEvent(t,e,t-m.x,e-m.y,lt.ROLL_OVER,p,r,n,o,l):(h=this.createMouseEvent(t,e,t-m.x,e-m.y,s,p,r,n,o,l),h.spriteOffsetX=m.offsetX,h.spriteOffsetY=m.offsetY),T||(T=new NX,T.objectId=I,this._mouseActiveObjects.set(I,T)),T.spriteTag=p,(s!==lt.MOUSE_MOVE||t!==this._mouseOldX||e!==this._mouseOldY)&&this.bufferMouseEvent(h,I),c.push(I)}u=!0}d--}const f=[];for(const m of this._mouseActiveObjects.keys())m&&f.push(m);let E=0;for(;E<f.length;){const m=f[E];c.indexOf(m)>=0&&(f[E]=null),E++}for(E=0;E<f.length;){const m=f[E];if(m!==null){const I=this._mouseActiveObjects.get(m);I&&this._mouseActiveObjects.delete(m);const p=this.createMouseEvent(0,0,0,0,lt.ROLL_OUT,I.spriteTag,r,n,o,l);this.bufferMouseEvent(p,m)}E++}return this.processMouseEvents(),this._mouseOldX=t,this._mouseOldY=e,u}createMouseEvent(t,e,s,r,n,o,l,c,u,h){const d=t-this._width/2,f=e-this._height/2,E=`canvas_${this._id}`;return new gj(n,E+"_"+this._eventId,E,o,d,f,s,r,c,l,u,h)}bufferMouseEvent(t,e){!t||!this._eventCache||(this._eventCache.delete(e),this._eventCache.set(e,t))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[t,e]of this._eventCache.entries()){if(!this._eventCache)return;if(!e)continue;const s=this._container.getRoomObject(parseInt(t));if(s)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(e,s,this._geometry);else{const r=s.mouseHandler;r&&r.mouseEvent(e,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const t=this._scale,e=this._screenOffsetX,s=this._screenOffsetY;this.setScale(1),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const r=this._display.getBounds(),n=me.createAndWriteRenderTexture(this._display.width,this._display.height,this._display,new _r(1,0,0,1,-r.x,-r.y));return this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(t),this._screenOffsetX=e,this._screenOffsetY=s,n}doMagic(){const t=this.geometry;if(this._rotation!==0){let e=this._effectDirection;t.direction=new w(e.x+this._rotation,e.y,e.z),e=t.direction,t.setDepthVector(new w(e.x,e.y,5));const s=new w;s.assign(this._rotationOrigin),s.x=s.x+this._rotationRodLength*Math.cos((e.x+180)/180*Math.PI)*Math.cos(e.y/180*Math.PI),s.y=s.y+this._rotationRodLength*Math.sin((e.x+180)/180*Math.PI)*Math.cos(e.y/180*Math.PI),s.z=s.z+this._rotationRodLength*Math.sin(e.y/180*Math.PI),t.location=s,this._effectLocation=new w,this._effectLocation.assign(s),this._effectDirection=new w,this._effectDirection.assign(t.direction)}if(Cu.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!Cu.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),hd.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const e=this._effectDirection,s=w.sum(e,new w(Math.sin(this._SafeStr_795*5/180*Math.PI)*2,Math.sin(this._SafeStr_795/180*Math.PI)*5,Math.sin(this._SafeStr_795*10/180*Math.PI)*2));t.direction=s}else this._SafeStr_795=0,t.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const t=this.geometry.direction;this._effectDirection=new w(t.x,t.y,t.z)}}changeRotation(){if(this._SafeStr_4507)return;const t=this.geometry;if(t){if(this._rotation===0){const e=t.location,s=t.directionAxis;this._effectLocation=new w,this._effectLocation.assign(e),this._effectDirection=new w,this._effectDirection.assign(t.direction);const r=Ho.getIntersectionVector(e,s,new w(0,0,0),new w(0,0,1));r!==null&&(this._rotationOrigin=new w(r.x,r.y,r.z),this._rotationRodLength=w.dif(r,e).length,this._rotation=1);return}this._rotation=0,t.location=this._effectLocation,t.direction=this._effectDirection,t.setDepthVector(new w(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const t=this.geometry,e=(t.direction.x-90)/180*Math.PI;t.location=w.sum(t.location,new w(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const t=this.geometry,e=(t.direction.x+90)/180*Math.PI;t.location=w.sum(t.location,new w(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const t=this.geometry,e=t.direction.x/180*Math.PI;t.location=w.sum(t.location,new w(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const t=this.geometry,e=(t.direction.x+180)/180*Math.PI;t.location=w.sum(t.location,new w(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(t){t=Math.trunc(t),this._mouseLocation.x=this._mouseLocation.x-(t-this._screenOffsetX),this._screenOffsetX=t}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(t){t=Math.trunc(t),this._mouseLocation.y=this._mouseLocation.y-(t-this._screenOffsetY),this._screenOffsetY=t}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(t){this._canvasUpdated=t}}class xX{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[t,e]of this._canvases.entries())this._canvases.delete(t),e&&e.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(t){return t?t.instanceId:-1}getRoomObject(t){return this._objects.get(t)}addObject(t){t&&this._objects.set(this.getInstanceId(t),t)}removeObject(t){const e=this.getInstanceId(t);this._objects.delete(e);for(const s of this._canvases.values()){if(!s)continue;s.removeFromCache(e.toString())}}render(t,e=!1){if(!(!this._canvases||!this._canvases.size))for(const s of this._canvases.values())s&&s.render(t,e)}update(t,e=!1){if(!(!this._canvases||!this._canvases.size)){this.render(t,e);for(const s of this._canvases.values())s&&s.update()}}getCanvas(t){const e=this._canvases.get(t);return e||null}createCanvas(t,e,s,r){const n=this._canvases.get(t);if(n)return n.initialize(e,s),n.geometry&&(n.geometry.scale=r),n;const o=this.createSpriteCanvas(t,e,s,r);if(o)return this._canvases.set(t,o),o}createSpriteCanvas(t,e,s,r){return new CX(t,this,e,s,r)}removeCanvas(t){const e=this._canvases.get(t);e&&(this._canvases.delete(t),e.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(t){this._roomObjectVariableAccurateZ=t}}const ne=class ne{constructor(){this._roomContentLoader=Sr(),this._roomSessionManager=Yi(),this._sessionDataManager=tt(),this._roomManager=EX(),this._roomObjectEventHandler=new TX(this),this._imageObjectIdBank=new jO(1e3),this._imageCallbacks=new Map,this._thumbnailObjectIdBank=new jO(1e3),this._thumbnailCallbacks=new Map,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._moveBlocked=!1,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._roomDatas=new Map,this._roomInstanceDatas=new Map,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._badgeListenerObjects=new Map,this._areaSelectionManager=new zu(this)}async init(){GT().registerEventFunction(t=>this.processRoomObjectEvent(t)),X().addEventListener(yt.STARTED,t=>this.onRoomSessionEvent(t)),X().addEventListener(yt.ENDED,t=>this.onRoomSessionEvent(t)),await TE().init(),await this._roomContentLoader.init(),await this._roomManager.init(this);for(const t of this._roomDatas.values())t&&this.createRoomInstance(t.roomId,t.data);this._roomContentLoader.setIconListener(this),this._roomManager.addUpdateCategory(Y.FLOOR),this._roomManager.addUpdateCategory(Y.WALL),this._roomManager.addUpdateCategory(Y.UNIT),this._roomManager.addUpdateCategory(Y.CURSOR),this._roomManager.addUpdateCategory(Y.ROOM)}onRoomSessionEvent(t){if(t instanceof yt)switch(t.type){case yt.STARTED:TE().setRoomId(t.session.roomId);return;case yt.ENDED:TE().clearRoomId(),this.removeRoomInstance(t.session.roomId);return}}setActiveRoomId(t){this._activeRoomId=t}destroyRoom(t){this.removeRoomInstance(t)}getRoomInstance(t){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(t))||null}removeRoomInstance(t){this.getRoomInstance(t)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(t));const s=this._roomInstanceDatas.get(t);s&&(this._roomInstanceDatas.delete(s.roomId),s.dispose()),X().dispatchEvent(new Ne(Ne.DISPOSED,t))}createRoomInstance(t,e){let s="111",r="201",n="1";if(!e){Lt.warn("Room property messages");return}const o=this._roomDatas.get(t);o&&(this._roomDatas.delete(t),o.floorType&&(s=o.floorType),o.wallType&&(r=o.wallType),o.landscapeType&&(n=o.landscapeType)),this.setupRoomInstance(t,e,s,r,n,this.getRoomInstanceModelName(t))&&(this._roomAllowsDragging=!0,X().dispatchEvent(new Ne(Ne.INITIALIZED,t)))}setupRoomInstance(t,e,s,r,n,o){if(!this._roomManager)return;const l=this._roomManager.createRoomInstance(this.getRoomId(t));if(!l)return null;const c=Y.ROOM,u=l.createRoomObjectAndInitalize(ne.ROOM_OBJECT_ID,ne.ROOM_OBJECT_TYPE,c);if(l.model.setValue(ks.ROOM_IS_PUBLIC,0),l.model.setValue(ks.ROOM_Z_SCALE,1),e&&e.dimensions){const f=e.dimensions.minX,E=e.dimensions.maxX,m=e.dimensions.minY,I=e.dimensions.maxY;l.model.setValue(ks.ROOM_MIN_X,f),l.model.setValue(ks.ROOM_MAX_X,E),l.model.setValue(ks.ROOM_MIN_Y,m),l.model.setValue(ks.ROOM_MAX_Y,I);const p=Math.trunc(f*423+E*671+m*913+I*7509);u&&u.model&&u.model.setValue(A.ROOM_RANDOM_SEED,p)}const h=u&&u.logic||null;if(h&&(h.initialize(e),s&&(h.processUpdateMessage(new ii(ii.ROOM_FLOOR_UPDATE,s)),l.model.setValue(A.ROOM_FLOOR_TYPE,s)),r&&(h.processUpdateMessage(new ii(ii.ROOM_WALL_UPDATE,r)),l.model.setValue(A.ROOM_WALL_TYPE,r)),n&&(h.processUpdateMessage(new ii(ii.ROOM_LANDSCAPE_UPDATE,n)),l.model.setValue(A.ROOM_LANDSCAPE_TYPE,n))),e&&e.doors.length){let d=0;for(;d<e.doors.length;){const f=e.doors[d];if(f){const E=f.x,m=f.y,I=f.z,p=f.dir,T=Ai.DOOR,R="door_"+d,S=new w(E,m,I);h.processUpdateMessage(new Ai(Ai.ADD_MASK,R,T,S,Ai.HOLE)),(p===90||p===180)&&(p===90&&(l.model.setValue(A.ROOM_DOOR_X,E-.5),l.model.setValue(A.ROOM_DOOR_Y,m)),p===180&&(l.model.setValue(A.ROOM_DOOR_X,E),l.model.setValue(A.ROOM_DOOR_Y,m-.5)),l.model.setValue(A.ROOM_DOOR_Z,I),l.model.setValue(A.ROOM_DOOR_DIR,p))}d++}}return l.createRoomObjectAndInitalize(ne.CURSOR_OBJECT_ID,ne.CURSOR_OBJECT_TYPE,Y.CURSOR),jt().getValue("enable.avatar.arrow",!1)&&l.createRoomObjectAndInitalize(ne.ARROW_OBJECT_ID,ne.ARROW_OBJECT_TYPE,Y.CURSOR),l}getRoomInstanceDisplay(t,e,s,r,n){const o=this.getRoomInstance(t);if(!o)return null;let l=o.renderer;if(!l&&(l=new xX,!l))return null;l.roomObjectVariableAccurateZ=A.OBJECT_ACCURATE_Z_VALUE,o.setRenderer(l);const c=l.createCanvas(e,s,r,n);if(!c)return null;if(c.setMouseListener(this._roomObjectEventHandler),c.geometry){c.geometry.z_scale=o.model.getValue(ks.ROOM_Z_SCALE);const u=o.model.getValue(A.ROOM_DOOR_X),h=o.model.getValue(A.ROOM_DOOR_Y),d=o.model.getValue(A.ROOM_DOOR_Z),f=o.model.getValue(A.ROOM_DOOR_DIR),E=new w(u,h,d);let m=null;f===90&&(m=new w(-2e3,0,0)),f===180&&(m=new w(0,-2e3,0)),c.geometry.setDisplacement(E,m);const I=c.master;if(I){const p=new $r;p.label=ne.OVERLAY,I.addChild(p)}}return c.master}setRoomInstanceRenderingCanvasMask(t,e,s){const r=this.getRoomInstanceRenderingCanvas(t,e);r&&r.setMask(s)}setRoomInstanceRenderingCanvasScale(t,e,s,r=null,n=null,o=!1,l=!1){const c=this.getRoomInstanceRenderingCanvas(t,e);c&&(c.setScale(s,r,n,o,l),X().dispatchEvent(new Ne(Ne.ROOM_ZOOMED,t)))}getRoomInstanceRenderingCanvas(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const r=s.renderer;if(!r)return null;e===-1&&(e=this._activeRoomActiveCanvas);const n=r.getCanvas(e);return n||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(t,e=-1){e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new Qt(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(t,e,s){const r=this.getRoomInstanceRenderingCanvas(t,e);if(!r||!s)return!1;const n=~~s.x,o=~~s.y;if(!(r.screenOffsetX===n&&r.screenOffsetY===o))return X().dispatchEvent(new A_(t,-(r.screenOffsetX-n),-(r.screenOffsetY-o))),r.screenOffsetX=n,r.screenOffsetY=o,!0}getRoomInstanceRenderingCanvasScale(t=-1e3,e=-1){t===-1e3&&(t=this._activeRoomId),e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(t,e,s,r){const n=this.getRoomInstanceRenderingCanvas(t,e);n&&n.initialize(s,r)}getRoomInstanceGeometry(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const r=s.renderer;if(!r)return null;e===-1&&(e=this._activeRoomActiveCanvas);const n=r.getCanvas(e);return n?n.geometry:null}getRoomInstanceVariable(t,e){const s=this.getRoomInstance(t);return s&&s.model&&s.model.getValue(e)||null}updateRoomInstancePlaneVisibility(t,e,s=!0){const r=this.getRoomOwnObject(t);return r?(r.processUpdateMessage(new Xa(Xa.WALL_VISIBILITY,e)),r.processUpdateMessage(new Xa(Xa.FLOOR_VISIBILITY,s)),!0):!1}updateRoomInstancePlaneThickness(t,e,s){const r=this.getRoomOwnObject(t);return r?(r.processUpdateMessage(new Ka(Ka.WALL_THICKNESS,e)),r.processUpdateMessage(new Ka(Ka.FLOOR_THICKNESS,s)),!0):!1}updateRoomInstancePlaneType(t,e=null,s=null,r=null,n=!1){const o=this.getRoomOwnObject(t),l=this.getRoomInstance(t);if(!o){let c=this._roomDatas.get(t);return c||(c=new tX(t,null),this._roomDatas.set(t,c)),e&&(c.floorType=e),s&&(c.wallType=s),r&&(c.landscapeType=r),!0}return e&&(l&&!n&&l.model.setValue(A.ROOM_FLOOR_TYPE,e),o.processUpdateMessage(new ii(ii.ROOM_FLOOR_UPDATE,e))),s&&(l&&!n&&l.model.setValue(A.ROOM_WALL_TYPE,s),o.processUpdateMessage(new ii(ii.ROOM_WALL_UPDATE,s))),r&&(l&&!n&&l.model.setValue(A.ROOM_LANDSCAPE_TYPE,r),o.processUpdateMessage(new ii(ii.ROOM_LANDSCAPE_UPDATE,r))),!0}updateAreaHide(t,e,s,r,n,o,l,c){const u=this.getRoomOwnObject(t);if(!u||!u.logic)return!1;X().dispatchEvent(new cp(t,e,Y.FLOOR,s)),s?u.logic.processUpdateMessage(new Or(Or.ADD,e,r,n,o,l,c)):u.logic.processUpdateMessage(new Or(Or.REMOVE,e))}updateObjectRoomColor(t,e,s,r){const n=this.getRoomOwnObject(t);if(!n||!n.logic)return!1;const o=new od(od.BACKGROUND_COLOR,e,s,r);return n.logic.processUpdateMessage(o),X().dispatchEvent(new O_(t,e,s,r)),!0}addRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t),r=this.getRoomObjectFloor(t,e);if(s&&s.logic&&r&&r.model){const n=r.getLocation(),o=r.model.getValue(A.FURNITURE_SIZE_X),l=r.model.getValue(A.FURNITURE_SIZE_Y);s.processUpdateMessage(new Or(Or.ADD,e,n.x,n.y,o,l))}}removeRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t);s&&s.processUpdateMessage(new Or(Or.REMOVE,e))}setRoomEngineGameMode(t,e){const s=this.getRoomInstance(t);if(!s)return;const r=e?1:0;s.model.setValue(ks.IS_PLAYING_GAME,r),r===0?X().dispatchEvent(new Ne(Ne.NORMAL_MODE,t)):X().dispatchEvent(new Ne(Ne.GAME_MODE,t))}isRoomIdPlayingGame(t){const e=this.getRoomInstance(t);return e?e.model.getValue(ks.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}update(t){if(!this._roomManager)return;const e=t.lastTime,s=!1;Cr.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(e,s),this.updateRoomCameras(e),this._mouseCursorUpdate&&this.setPointer(),Cr.turnVisualizationOff()}setPointer(){this._mouseCursorUpdate=!1;const t=this.getRoomInstanceData(this._activeRoomId);t&&t.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const t=new Date().valueOf(),e=5;for(const s of this._roomInstanceDatas.values()){if(!s)continue;let r=null,n=0,o=!1;for(;r=s.getNextPendingFurnitureFloor();)if(o=this.addObjectFurnitureFromData(s.roomId,r.id,r),!(++n%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(r=s.getNextPendingFurnitureWall());)if(o=this.addObjectWallItemFromData(s.roomId,r.id,r),!(++n%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(o&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(s.roomId)).hasUninitializedObjects()||this.objectsInitialized(s.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}addObjectFurnitureFromData(t,e,s){if(!s){const c=this.getRoomInstanceData(t);if(c&&(s=c.getPendingFurnitureFloor(e)),!s)return!1}let r=s.type;r||(r=this.getFurnitureFloorName(s.typeId));const n=this.createRoomObjectFloor(t,e,r);if(!n)return!1;const o=n.model;if(o&&(o.setValue(A.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),o.setValue(A.FURNITURE_TYPE_ID,s.typeId),o.setValue(A.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),o.setValue(A.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),o.setValue(A.FURNITURE_EXPIRY_TIME,s.expiryTime),o.setValue(A.FURNITURE_EXPIRTY_TIMESTAMP,zt()),o.setValue(A.FURNITURE_USAGE_POLICY,s.usagePolicy),o.setValue(A.FURNITURE_OWNER_ID,s.ownerId),o.setValue(A.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectFloor(t,e,s.location,s.direction,s.state,s.data,s.extra)||s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(t,e,s.sizeZ))return!1;X()&&X().dispatchEvent(new Ot(Ot.ADDED,t,e,Y.FLOOR));const l=this.getPlacedRoomObjectData(t);return l&&l.id===e&&l.category===Y.FLOOR&&this.selectRoomObject(t,e,Y.FLOOR),n.isReady&&s.synchronized&&this.addObjectToTileMap(t,n),!0}addObjectWallItemFromData(t,e,s){if(!s){const u=this.getRoomInstanceData(t);if(u&&(s=u.getPendingFurnitureWall(e)),!s)return!1}let r="";s.data&&(r=s.data.getLegacyString());let n=this.getFurnitureWallName(s.typeId,r);n||(n="");const o=this.createRoomObjectWall(t,e,n);if(!o)return!1;const l=o.model;if(l&&(l.setValue(A.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),l.setValue(A.FURNITURE_TYPE_ID,s.typeId),l.setValue(A.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),l.setValue(A.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),l.setValue(A.OBJECT_ACCURATE_Z_VALUE,1),l.setValue(A.FURNITURE_EXPIRY_TIME,s.expiryTime),l.setValue(A.FURNITURE_EXPIRTY_TIMESTAMP,zt()),l.setValue(A.FURNITURE_USAGE_POLICY,s.usagePolicy),l.setValue(A.FURNITURE_OWNER_ID,s.ownerId),l.setValue(A.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectWall(t,e,s.location,s.direction,s.state,r))return!1;X()&&X().dispatchEvent(new Ot(Ot.ADDED,t,e,Y.WALL));const c=this.getPlacedRoomObjectData(t);return c&&Math.abs(c.id)===e&&c.category===Y.WALL&&this.selectRoomObject(t,e,Y.WALL),!0}setRoomSessionOwnUser(t,e){const s=this._roomSessionManager.getSession(t);s&&s.setOwnRoomIndex(e);const r=this.getRoomCamera(t);r&&(r.targetId=e,r.targetCategory=Y.UNIT,r.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(t){for(const e of this._roomInstanceDatas.values()){if(!e)continue;const s=e.roomCamera;if(!s)continue;let r=null;const n=this.getRoomObject(e.roomId,s.targetId,s.targetCategory);n&&(r=n.getLocation()),r&&(e.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(e.roomId,1,r,t)}if(this._activeRoomWasDragged){const e=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);e&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new Qt(e.screenOffsetX+this._activeRoomDragX,e.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(t,e,s,r){const n=this.getRoomInstanceRenderingCanvas(t,e),o=this.getRoomInstanceData(t);if(!n||!o||n.scale!==1)return;const l=n.geometry,c=o.roomCamera,u=this.getRoomInstance(t);if(!l||!c||!u)return;const h=this.getRoomCanvasRectangle(t,e);if(!h)return;let d=Math.floor(s.z)+1;const f=Math.round(h.width),E=Math.round(h.height),m=this.getCanvasBoundingRectangle(e);if(m&&(m.right<0||m.bottom<0||m.left>=f||m.top>=E)&&c.reset(),c.screenWd!==f||c.screenHt!==E||c.scale!==l.scale||c.geometryUpdateId!==l.updateId||!w.isEqual(s,c.targetObjectLoc)||c.isMoving){c.targetObjectLoc=s;const I=new w;I.assign(s),I.x=Math.round(I.x),I.y=Math.round(I.y);const p=u.model.getValue(ks.ROOM_MIN_X)-.5,T=u.model.getValue(ks.ROOM_MIN_Y)-.5,R=u.model.getValue(ks.ROOM_MAX_X)+.5,S=u.model.getValue(ks.ROOM_MAX_Y)+.5,L=Math.round((p+R)/2),M=Math.round((T+S)/2),P=2;let k=new Qt(I.x-L,I.y-M);const G=l.scale/Math.sqrt(2),j=G/2,F=new _r;F.rotate(-(l.direction.x+90)/180*Math.PI),k=F.apply(k),k.y=k.y*(j/G);const U=h.width/2/G-1,K=h.height/2/j-1;let B=0,J=0,Z=0,Q=0,ut=l.getScreenPoint(new w(L,M,P));if(!ut)return;if(ut.x=ut.x+Math.round(h.width/2),ut.y=ut.y+Math.round(h.height/2),m)if(m.x+=-n.screenOffsetX,m.y+=-n.screenOffsetY,m.width>1&&m.height>1)B=(m.left-ut.x-l.scale*.25)/G,Z=(m.right-ut.x+l.scale*.25)/G,J=(m.top-ut.y-l.scale*.5)/j,Q=(m.bottom-ut.y+l.scale*.5)/j;else{l.adjustLocation(new w(-30,-30),25);return}else{l.adjustLocation(new w(0,0),25);return}let Bt=!1,te=!1,de=!1,He=!1;Math.round((Z-B)*G)<h.width?(d=2,k.x=(Z+B)/2,de=!0):(k.x>Z-U&&(k.x=Z-U,Bt=!0),k.x<B+U&&(k.x=B+U,Bt=!0)),Math.round((Q-J)*j)<h.height?(d=2,k.y=(Q+J)/2,He=!0):(k.y>Q-K&&(k.y=Q-K,te=!0),k.y<J+K&&(k.y=J+K,te=!0),te&&(k.y=k.y/(j/G))),F.invert(),k=F.apply(k),k.x=k.x+L,k.y=k.y+M;let vt=.35,Vt=.2,xs=.2;const ie=10,Ft=10;if(xs*f>100&&(xs=100/f),vt*E>150&&(vt=150/E),Vt*E>150&&(Vt=150/E),c.limitedLocationX&&c.screenWd==f&&c.screenHt==E&&(xs=0),c.limitedLocationY&&c.screenWd==f&&c.screenHt==E&&(vt=0,Vt=0),h.width=h.width*(1-xs*2),h.height=h.height*(1-(vt+Vt)),h.width<ie&&(h.width=ie),h.height<Ft&&(h.height=Ft),vt+Vt>0?(h.x+=-h.width/2,h.y+=-h.height*(Vt/(vt+Vt))):(h.x+=-h.width/2,h.y+=-h.height/2),ut=l.getScreenPoint(I),!ut)return;if(ut){ut.x=ut.x+n.screenOffsetX,ut.y=ut.y+n.screenOffsetY,I.z=d,I.x=Math.round(k.x*2)/2,I.y=Math.round(k.y*2)/2,c.location||(l.location=I,this.useOffsetScrolling?c.initializeLocation(new w(0,0,0)):c.initializeLocation(I));const De=l.getScreenPoint(I),Rs=new w(0,0,0);De&&(Rs.x=De.x,Rs.y=De.y),(ut.x<h.left||ut.x>h.right)&&!c.centeredLocX||(ut.y<h.top||ut.y>h.bottom)&&!c.centeredLocY||de&&!c.centeredLocX&&c.screenWd!=f||He&&!c.centeredLocY&&c.screenHt!=E||c.roomWd!=m.width||c.roomHt!=m.height||c.screenWd!=f||c.screenHt!=E?(c.limitedLocationX=Bt,c.limitedLocationY=te,this.useOffsetScrolling?c.target=Rs:c.target=I):(Bt||(c.limitedLocationX=!1),te||(c.limitedLocationY=!1))}c.centeredLocX=de,c.centeredLocY=He,c.screenWd=f,c.screenHt=E,c.scale=l.scale,c.geometryUpdateId=l.updateId,c.roomWd=m.width,c.roomHt=m.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?c.update(r,8):c.update(r,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new Qt(-c.location.x,-c.location.y)):l.adjustLocation(c.location,25)}else c.limitedLocationX=!1,c.limitedLocationY=!1,c.centeredLocX=!1,c.centeredLocY=!1}getRoomCanvasRectangle(t,e){const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new zo(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(t,e,s,r){const n=this.getRoomInstanceGeometry(t,r);if(!n)return null;const o=this.getRoomObject(t,e,s);if(!o)return null;const l=o.visualization;if(!l)return null;const c=l.getBoundingRectangle(),u=this.getRoomInstanceRenderingCanvas(t,r),h=u?u.scale:1,d=n.getScreenPoint(o.getLocation());return!d||(d.x=Math.round(d.x),d.y=Math.round(d.y),c.x=c.x*h,c.y=c.y*h,c.width=c.width*h,c.height=c.height*h,d.x=d.x*h,d.y=d.y*h,c.x+=d.x,c.y+=d.y,!u)?null:(c.x+=Math.round(u.width/2)+u.screenOffsetX,c.y+=Math.round(u.height/2)+u.screenOffsetY,c)}getCanvasBoundingRectangle(t){return this.getRoomObjectBoundingRectangle(this._activeRoomId,ne.ROOM_OBJECT_ID,Y.ROOM,t)}getFurnitureFloorName(t){return this._roomContentLoader.getFurnitureFloorNameForTypeId(t)}getFurnitureWallName(t,e=null){return this._roomContentLoader.getFurnitureWallNameForTypeId(t,e)}getFurnitureFloorColorIndex(t){return this._roomContentLoader.getFurnitureFloorColorIndex(t)}getFurnitureWallColorIndex(t){return this._roomContentLoader.getFurnitureWallColorIndex(t)}getRoomInstanceData(t){const e=this._roomInstanceDatas.get(t);if(e)return e;const s=new sX(t);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(t){const e=this.getRoomInstanceData(t);return e?e.modelName:null}setRoomInstanceModelName(t,e){const s=this.getRoomInstanceData(t);s&&s.setModelName(e)}getRoomTileObjectMap(t){const e=this.getRoomInstanceData(t);return e?e.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(t){const e=this.getRoomInstanceData(t);return e?e.roomCamera:null}getSelectedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.selectedObject:null}setSelectedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setSelectedObject(e),e&&s.setPlacedObject(null)}getPlacedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.placedObject:null}setPlacedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setPlacedObject(e)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(t){const e=this.getRoomInstanceData(t);return e?e.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setFurnitureStackingHeightMap(e)}getLegacyWallGeometry(t){const e=this.getRoomInstanceData(t);return e?e.legacyGeometry:null}createRoomObjectAndInitialize(t,e,s,r){const n=this.getRoomInstance(t);return n?n.createRoomObjectAndInitalize(e,s,r):null}getTotalObjectsForManager(t,e){const s=this.getRoomInstance(t);return s?s.getTotalObjectsForManager(e):0}getRoomObject(t,e,s){let r=this.getRoomId(t);return t===0&&(r=ne.TEMPORARY_ROOM),this.getObject(r,e,s)}getObject(t,e,s){let r=null;if(this._roomManager&&(r=this._roomManager.getRoomInstance(t)),!r)return null;let n=r.getRoomObject(e,s);if(!n)switch(s){case Y.FLOOR:this.addObjectFurnitureFromData(this.getRoomIdFromString(t),e,null),n=r.getRoomObject(e,s);break;case Y.WALL:this.addObjectWallItemFromData(this.getRoomIdFromString(t),e,null),n=r.getRoomObject(e,s);break}return n}getRoomObjectByIndex(t,e,s){const r=this.getRoomInstance(t);return r?r.getRoomObjectByIndex(e,s):null}getRoomObjectCategoryForType(t){return this._roomContentLoader.getCategoryForType(t)}getRoomObjectCursor(t){return this.getObject(this.getRoomId(t),ne.CURSOR_OBJECT_ID,Y.CURSOR)}getRoomObjectSelectionArrow(t){return this.getObject(this.getRoomId(t),ne.ARROW_OBJECT_ID,Y.CURSOR)}getRoomOwnObject(t){return this.getObject(this.getRoomId(t),ne.ROOM_OBJECT_ID,Y.ROOM)}getRoomObjectUser(t,e){return this.getObject(this.getRoomId(t),e,Y.UNIT)}removeRoomObjectUser(t,e){return this.removeRoomObject(t,e,Y.UNIT)}createRoomObjectUser(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,Y.UNIT)}getRoomObjectFloor(t,e){return this.getObject(this.getRoomId(t),e,Y.FLOOR)}createRoomObjectFloor(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,Y.FLOOR)}removeRoomObjectFloor(t,e,s=-1,r=!1){const n=this.getRoomInstanceData(t);if(n&&n.removePendingFunitureFloor(e),this._sessionDataManager.userId===s&&!R_.isBuilderClubId(e)){const o=this.getRoomObject(t,e,Y.FLOOR);if(o){const l=this.getRoomObjectScreenLocation(t,e,Y.FLOOR,this._activeRoomActiveCanvas);if(l&&!(o.model.getValue(A.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const u=o.model.getValue(A.FURNITURE_TYPE_ID),h=o.model.getValue(A.FURNITURE_EXTRAS),d=o.model.getValue(A.FURNITURE_DATA_FORMAT),f=ra.getData(d),E=this.getFurnitureFloorIcon(u,null,h,f).data;E&&(async()=>{const m=await me.generateImage(E),I=new Kh(m,l.x,l.y);I.iconName=f_.INVENTORY,X().dispatchEvent(I)})()}}}this.removeRoomObject(t,e,Y.FLOOR),this.setMouseDefault(t,Y.FLOOR,e),r&&this.refreshTileObjectMap(t,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(t,e){return this.getObject(this.getRoomId(t),e,Y.WALL)}removeRoomObjectWall(t,e,s=-1){if(this._sessionDataManager.userId===s&&!R_.isBuilderClubId(e)){const r=this.getRoomObject(t,e,Y.WALL);if(r&&r.type.indexOf("post_it")===-1&&r.type.indexOf("external_image_wallitem")===-1){const n=this.getRoomObjectScreenLocation(t,e,Y.WALL,this._activeRoomActiveCanvas);if(n){const o=r.model.getValue(A.FURNITURE_TYPE_ID),l=r.model.getValue(A.FURNITURE_DATA),c=this.getFurnitureWallIcon(o,null,l).data;c&&(async()=>{const u=await me.generateImage(c);if(X()){const h=new Kh(u,n.x,n.y);h.iconName=f_.INVENTORY,X().dispatchEvent(h)}})()}}}this.removeRoomObject(t,e,Y.WALL),this.updateRoomObjectMask(t,e,!1),this.setMouseDefault(t,Y.WALL,e)}createRoomObjectWall(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,Y.WALL)}removeRoomObject(t,e,s){const r=this.getRoomInstance(t);if(!r)return null;r.removeRoomObject(e,s),X()&&X().dispatchEvent(new Ot(Ot.REMOVED,t,e,s))}addFurnitureFloor(t,e,s,r,n,o,l,c=NaN,u=-1,h=0,d=0,f="",E=!0,m=!0,I=-1){const p=this.getRoomInstanceData(t);if(!p)return!1;const T=new pE(e,s,null,r,n,o,l,c,u,h,d,f,E,m,I);return p.addPendingFurnitureFloor(T),!0}addFurnitureFloorByTypeName(t,e,s,r,n,o,l,c=NaN,u=-1,h=0,d=0,f="",E=!0,m=!0,I=-1){const p=this.getRoomInstanceData(t);if(!p)return!1;const T=new pE(e,0,s,r,n,o,l,c,u,h,d,f,E,m,I);return p.addPendingFurnitureFloor(T),!0}addFurnitureWall(t,e,s,r,n,o,l,c=-1,u=0,h=0,d="",f=!0){const E=this.getRoomInstanceData(t);if(!E)return!1;const m=new Di;m.setString(l);const I=new pE(e,s,null,r,n,o,m,NaN,c,u,h,d,!0,f);return E.addPendingFurnitureWall(I),!0}updateRoomObjectFloor(t,e,s,r,n,o,l=null){const c=this.getRoomObjectFloor(t,e);return c?(c.processUpdateMessage(new Vs(s,r)),c.processUpdateMessage(new we(n,o,l)),!0):!1}updateRoomObjectWall(t,e,s,r,n,o=null){const l=this.getRoomObjectWall(t,e);if(!l||!l.logic)return!1;const c=new Vs(s,r),u=new Di,h=new we(n,u);return u.setString(o),l.logic.processUpdateMessage(c),l.logic.processUpdateMessage(h),this.updateRoomObjectMask(t,e),!0}updateRoomObjectWallItemData(t,e,s){const r=this.getRoomObjectWall(t,e);return!r||!r.logic?!1:(r.logic.processUpdateMessage(new OS(s)),!0)}updateRoomObjectFloorHeight(t,e,s){const r=this.getRoomObjectFloor(t,e);return r?(r.processUpdateMessage(new FL(null,null,s)),!0):!1}updateRoomObjectFloorExpiration(t,e,s){const r=this.getRoomObjectFloor(t,e);return r?(r.model.setValue(A.FURNITURE_EXPIRY_TIME,s),r.model.setValue(A.FURNITURE_EXPIRTY_TIMESTAMP,zt()),!0):!1}updateRoomObjectWallExpiration(t,e,s){const r=this.getRoomObjectWall(t,e);return r?(r.model.setValue(A.FURNITURE_EXPIRY_TIME,s),r.model.setValue(A.FURNITURE_EXPIRTY_TIMESTAMP,zt()),!0):!1}updateRoomObjectMask(t,e,s=!0){const r=Y.WALL+"_"+e,n=this.getRoomObjectWall(t,e);let o=null;if(n&&n.model){if(n.model.getValue(A.FURNITURE_USES_PLANE_MASK)>0){const c=n.model.getValue(A.FURNITURE_PLANE_MASK_TYPE),u=n.getLocation();s?o=new Ai(Ai.ADD_MASK,r,c,u):o=new Ai(Ai.REMOVE_MASK,r)}}else o=new Ai(Ai.REMOVE_MASK,r);const l=this.getRoomOwnObject(t);l&&l.logic&&o&&l.logic.processUpdateMessage(o)}rollRoomObjectFloor(t,e,s,r){const n=this.getRoomObjectFloor(t,e);n&&n.processUpdateMessage(new jo(s,r,null,!!r))}updateRoomObjectWallLocation(t,e,s){const r=this.getRoomObjectWall(t,e);return r?(r.logic&&r.logic.processUpdateMessage(new jo(s,null,null)),this.updateRoomObjectMask(t,e),!0):!1}addRoomObjectUser(t,e,s,r,n,o,l){if(this.getRoomObjectUser(t,e))return!1;let u=Ue.getTypeString(o);u===Ue.PET&&(u=this.getPetType(l));const h=this.createRoomObjectUser(t,e,u);return h?(h.processUpdateMessage(new hg(this.fixedUserLocation(t,s),null,r,n,!1,0)),l&&h.processUpdateMessage(new cg(l)),X()&&X().dispatchEvent(new Ot(Ot.ADDED,t,e,Y.UNIT)),!0):!1}updateRoomObjectUserLocation(t,e,s,r,n=!1,o=0,l=null,c=NaN){const u=this.getRoomObjectUser(t,e);if(!u)return!1;s||(s=u.getLocation()),l||(l=u.getDirection()),isNaN(c)&&(c=u.model.getValue(A.HEAD_DIRECTION)),u.processUpdateMessage(new hg(this.fixedUserLocation(t,s),this.fixedUserLocation(t,r),l,c,n,o));const h=this._roomSessionManager.getSession(t);return h&&h.ownRoomIndex===e&&X().dispatchEvent(new Iu(Iu.ROAME_MOVE_TO,r)),!0}fixedUserLocation(t,e){if(!e)return null;const s=this.getFurnitureStackingHeightMap(t),r=this.getLegacyWallGeometry(t);if(!s||!r)return e;let n=e.z;const o=s.getTileHeight(e.x,e.y),l=r.getHeight(e.x,e.y);return Math.abs(n-o)<.1&&Math.abs(o-l)<.1&&(n=r.getFloorAltitude(e.x,e.y)),new w(e.x,e.y,n)}updateRoomObjectUserAction(t,e,s,r,n=null){const o=this.getRoomObjectUser(t,e);if(!o)return!1;let l=null;switch(s){case A.FIGURE_TALK:l=new TS(r);break;case A.FIGURE_SLEEP:l=new SS(r===1);break;case A.FIGURE_IS_TYPING:l=new jL(r===1);break;case A.FIGURE_IS_MUTED:l=new bL(r===1);break;case A.FIGURE_CARRY_OBJECT:l=new OL(r,n);break;case A.FIGURE_USE_OBJECT:l=new wL(r);break;case A.FIGURE_DANCE:l=new AL(r);break;case A.FIGURE_GAINED_EXPERIENCE:l=new CL(r);break;case A.FIGURE_NUMBER_VALUE:l=new PL(r);break;case A.FIGURE_SIGN:l=new UL(r);break;case A.FIGURE_EXPRESSION:l=new xL(r);break;case A.FIGURE_IS_PLAYING_GAME:l=new LL(r===1);break;case A.FIGURE_GUIDE_STATUS:l=new UK(r);break}return l?(o.processUpdateMessage(l),!0):!1}updateRoomObjectUserFigure(t,e,s,r=null,n=null,o=!1){const l=this.getRoomObjectUser(t,e);return l?(l.processUpdateMessage(new cg(s,r,n,o)),!0):!1}updateRoomObjectUserFlatControl(t,e,s){const r=this.getRoomObjectUser(t,e);return r?(r.processUpdateMessage(new yL(parseInt(s))),!0):!1}updateRoomObjectUserEffect(t,e,s,r=0){const n=this.getRoomObjectUser(t,e);return n?(n.processUpdateMessage(new NL(s,r)),!0):!1}updateRoomObjectUserGesture(t,e,s){const r=this.getRoomObjectUser(t,e);return r?(r.processUpdateMessage(new ML(s)),!0):!1}updateRoomObjectUserPetGesture(t,e,s){const r=this.getRoomObjectUser(t,e);return r?(r.processUpdateMessage(new vL(s)),!0):!1}updateRoomObjectUserPosture(t,e,s,r=null){const n=this.getRoomObjectUser(t,e);return n?(n.processUpdateMessage(new RS(s,r)),!0):!1}updateRoomObjectUserOwn(t,e){const s=this.getRoomObjectUser(t,e);s&&s.processUpdateMessage(new DL)}useRoomObject(t,e){const s=this.getRoomObject(this._activeRoomId,t,e);if(s){const r=s.logic;if(r)return r.useObject(),!0}return!1}objectInitialized(t,e,s){const r=this.getRoomIdFromString(t);s===Y.WALL&&this.updateRoomObjectMask(r,e);const n=this.getRoomObject(r,e,s);if(n&&n.model&&n.logic){const o=n.model.getValue(A.FURNITURE_DATA_FORMAT);if(!isNaN(o)){const l=ra.getData(o);l.initializeFromRoomObjectModel(n.model),n.processUpdateMessage(new we(n.getState(0),l))}X().dispatchEvent(new Ot(Ot.CONTENT_UPDATED,r,e,s))}t!==ne.TEMPORARY_ROOM&&this.addObjectToTileMap(r,n)}changeObjectModelData(t,e,s,r,n){const o=this.getObject(this.getRoomId(t),e,s);if(!o||!o.logic)return!1;const l=new GL(r,n);return o.processUpdateMessage(l),!0}changeObjectState(t,e,s){const r=this.getObject(this.getRoomId(t),e,s);if(!r||!r.model)return;let n=r.model.getValue(A.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(n)?n=1:n=n+1,r.model.setValue(A.FURNITURE_AUTOMATIC_STATE_INDEX,n);const o=r.model.getValue(A.FURNITURE_DATA_FORMAT),l=ra.getData(o);l.initializeFromRoomObjectModel(r.model),r.logic&&r.logic.processUpdateMessage(new we(n,l))}loadRoomObjectBadgeImage(t,e,s,r,n=!0){let o=null;if(t===0){const c=this._roomManager.getRoomInstance(ne.TEMPORARY_ROOM);c&&(o=c.getRoomObject(e,s))}else o=this.getRoomObjectFloor(t,e);if(!o||!o.logic)return;let l=n?this._sessionDataManager.loadGroupBadgeImage(r):this._sessionDataManager.loadBadgeImage(r);if(l)this.putBadgeInObjectAssets(o,r,n);else{if(l="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),!this._badgeListenerObjects.size){const u=h=>{const d=this._badgeListenerObjects&&this._badgeListenerObjects.get(h.badgeId);if(d){for(const f of d){if(!f)continue;this.putBadgeInObjectAssets(f.object,h.badgeId,f.groupBadge);const E=f.groupBadge?this._sessionDataManager.loadGroupBadgeImage(h.badgeId):this._sessionDataManager.loadBadgeImage(h.badgeId);f.object&&f.object.logic&&f.object.logic.processUpdateMessage(new Wl(h.badgeId,E))}this._badgeListenerObjects.delete(h.badgeId),this._badgeListenerObjects.size||X().removeEventListener(Za.IMAGE_READY,u)}};X().addEventListener(Za.IMAGE_READY,u)}let c=this._badgeListenerObjects.get(r);c||(c=[]),c.push(new iX(o,n)),this._badgeListenerObjects.set(r,c)}o.logic.processUpdateMessage(new Wl(r,l))}putBadgeInObjectAssets(t,e,s=!1){const r=s?this._sessionDataManager.loadGroupBadgeImage(e):this._sessionDataManager.loadBadgeImage(e),n=s?this._sessionDataManager.getGroupBadgeImage(e):this._sessionDataManager.getBadgeImage(e);n&&this._roomContentLoader.addAssetToCollection(t.type,r,n,!1)}dispatchMouseEvent(t,e,s,r,n,o,l,c){const u=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t);if(!u)return;const h=this.getRenderingCanvasOverlay(u),d=this.getOverlayIconSprite(h,ne.OBJECT_ICON_SPRITE);if(d){const f=d.getLocalBounds();d.x=e-f.width/2,d.y=s-f.height/2}if(r===lt.MOUSE_CLICK&&this._areaSelectionManager.finishSelecting())this._areaSelectionManager.finishSelecting();else if(!this.handleRoomDragging(u,e,s,r,n,o,l)&&!u.handleMouseEvent(e,s,r,n,o,l,c)){let f=null;r===lt.MOUSE_CLICK?(X().dispatchEvent(new Ot(Ot.DESELECTED,this._activeRoomId,-1,Y.MINIMUM)),f=Ut.CLICK):r===lt.MOUSE_MOVE?f=Ut.MOUSE_MOVE:r===lt.MOUSE_DOWN?f=Ut.MOUSE_DOWN:r===lt.MOUSE_DOWN_LONG?f=Ut.MOUSE_DOWN_LONG:r===lt.MOUSE_UP&&(f=Ut.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new Ut(f,this.getRoomObject(this._activeRoomId,ne.ROOM_OBJECT_ID,Y.ROOM),null,n),this._activeRoomId)}this._activeRoomActiveCanvas=t,this._activeRoomActiveCanvasMouseX=e,this._activeRoomActiveCanvasMouseY=s}handleRoomDragging(t,e,s,r,n,o,l){if(this.isPlayingGame())return!1;if(this._areaSelectionManager.areaSelectionState===zu.SELECTING)return this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,!1;let c=e-this._activeRoomActiveCanvasMouseX,u=s-this._activeRoomActiveCanvasMouseY;if(r===lt.MOUSE_DOWN)!n&&!o&&!l&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(r===lt.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const h=this.getRoomInstanceData(this._activeRoomId);if(h){const d=h.roomCamera;d&&(this.useOffsetScrolling&&(d.isMoving||(d.centeredLocX=!1,d.centeredLocY=!1),d.resetLocation(new w(-t.screenOffsetX,-t.screenOffsetY))),this._roomDraggingAlwaysCenters&&d.reset())}}}else if(r===lt.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(c=e-this._activeRoomDragStartX,u=s-this._activeRoomDragStartY,(c<=-ne.DRAG_THRESHOLD||c>=ne.DRAG_THRESHOLD||u<=-ne.DRAG_THRESHOLD||u>=ne.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),c=0,u=0),(c!=0||u!=0)&&(this._activeRoomDragX+=c,this._activeRoomDragY+=u,this._activeRoomWasDragged=!0));else if((r===lt.MOUSE_CLICK||r===lt.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(t,e,s){const r=this.getRoomObjectCategoryForType(s);switch(t){case _t.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,r,e);return;default:this.setMouseDefault(this._activeRoomId,r,e);return}}setMouseButton(t,e,s){const r=this._roomSessionManager.getSession(t);if(r&&(e!==Y.FLOOR&&e!==Y.WALL||r.controllerLevel>=Ce.GUEST)){const n=this.getRoomInstanceData(t);n&&n.addButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(t,e,s){const r=this.getRoomInstanceData(t);r&&r.removeButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(t,e,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,t,e,s)}modifyRoomObjectDataWithMap(t,e,s,r){if(!this._roomObjectEventHandler)return!1;e===Y.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,t,e,s,r)}modifyRoomObjectData(t,e,s,r){if(!this._roomObjectEventHandler)return!1;e===Y.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,t,s,r)}processRoomObjectEvent(t){if(!this._roomObjectEventHandler)return;const e=this.getRoomObjectRoomId(t.object);if(!e)return;const s=this.getRoomIdFromString(e);this._roomObjectEventHandler.handleRoomObjectEvent(t,s)}processRoomObjectPlacement(t,e,s,r,n=null,o=null,l=-1,c=-1,u=null){const h=this.getRoomInstance(this._activeRoomId);return!h||h.model.getValue(ks.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler?!1:this._roomObjectEventHandler.processRoomObjectPlacement(t,this._activeRoomId,e,s,r,n,o,l,c,u)}getRoomObjectScreenLocation(t,e,s,r=-1){r==-1&&(r=this._activeRoomActiveCanvas);const n=this.getRoomInstanceGeometry(t,r);if(!n)return null;const o=this.getRoomObject(t,e,s);if(!o)return null;const l=n.getScreenPoint(o.getLocation());if(!l)return null;const c=this.getRoomInstanceRenderingCanvas(t,r);return c?(l.x=l.x*c.scale,l.y=l.y*c.scale,l.x+=c.width/2+c.screenOffsetX,l.y+=c.height/2+c.screenOffsetY,l.x=Math.round(l.x),l.y=Math.round(l.y),l):null}selectRoomObject(t,e,s){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(t,e,s)}setSelectedAvatar(t,e){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(t,e,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(t,e,s,r=1){if(!t||!s)return;let n=this.getOverlayIconSprite(t,e);return n?null:(n=new Ve(s),n.label=e,n.scale.set(r),t.addChild(n),n)}onRoomContentLoaded(t,e,s){if(t===-1)return;this._thumbnailObjectIdBank.freeNumber(t-1);const r=this._thumbnailCallbacks.get(e);if(r){this._thumbnailCallbacks.delete(e);const n=this._roomContentLoader.getImage(e);if(n)for(const o of r)o&&o.imageReady(t,null,n)}}setObjectMoverIconSprite(t,e,s,r=null,n=null,o=-1,l=-1,c=null){let u=null,h=0,d=null;const f=1;if(s)d=this.getRoomObjectImage(this._activeRoomId,t,e,new w,1,null);else if(e===Y.FLOOR?(u=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),h=this._roomContentLoader.getFurnitureFloorColorIndex(t)):e===Y.WALL&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(t,r),h=this._roomContentLoader.getFurnitureWallColorIndex(t)),e===Y.UNIT)if(u=Ue.getTypeString(t),u==="pet"){u=this.getPetType(r);const p=new da(r);d=this.getRoomObjectPetImage(p.typeId,p.paletteId,p.color,new w(180),64,null,!0,0,p.customParts,c)}else d=this.getGenericRoomObjectImage(u,r,new w(180),64,null,0,null,n,o,l,c);else d=this.getGenericRoomObjectImage(u,h.toString(),new w,1,null,0,r,n,o,l,c);if(!d||!d.data)return;const E=this.getActiveRoomInstanceRenderingCanvas();if(!E)return;const m=this.getRenderingCanvasOverlay(E);this.removeOverlayIconSprite(m,ne.OBJECT_ICON_SPRITE);const I=this.addOverlayIconSprite(m,ne.OBJECT_ICON_SPRITE,d.data,f);I&&(I.x=this._activeRoomActiveCanvasMouseX-d.data.width/2,I.y=this._activeRoomActiveCanvasMouseY-d.data.height/2)}getRoomObjectImage(t,e,s,r,n,o,l=0){if(!this._roomManager)return null;let c=-1,u=null,h=null,d="",f=null;const E=this.getRoomId(t),m=this._roomManager.getRoomInstance(E);if(m){const I=m.getRoomObject(e,s);if(I&&I.model)switch(c=I.id,u=I.type,s){case Y.FLOOR:case Y.WALL:{d=I.model.getValue(A.FURNITURE_COLOR).toString(),f=I.model.getValue(A.FURNITURE_EXTRAS);const p=I.model.getValue(A.FURNITURE_DATA_FORMAT);p!==Di.FORMAT_KEY&&(h=ra.getData(p),h.initializeFromRoomObjectModel(I.model));break}case Y.UNIT:d=I.model.getValue(A.FIGURE);break}}return this.getGenericRoomObjectImage(u,d,r,n,o,l,f,h,-1,-1,null,c)}getFurnitureFloorIconUrl(t){const e=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),s=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString();return this._roomContentLoader.getAssetIconUrl(e,s)}getFurnitureFloorIcon(t,e,s=null,r=null){return this.getFurnitureFloorImage(t,new w,1,e,0,s,-1,-1,r)}getFurnitureWallIconUrl(t,e=null){const s=this._roomContentLoader.getFurnitureWallNameForTypeId(t,e),r=this._roomContentLoader.getFurnitureWallColorIndex(t).toString();return this._roomContentLoader.getAssetIconUrl(s,r)}getFurnitureWallIcon(t,e,s=null){return this.getFurnitureWallImage(t,new w,1,e,0,s)}getFurnitureFloorImage(t,e,s,r,n=0,o=null,l=-1,c=-1,u=null){const h=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),d=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString();return s===1&&r?this.getGenericRoomObjectThumbnail(h,d,r,o,u):this.getGenericRoomObjectImage(h,d,e,s,r,n,o,u,l,c)}getFurnitureWallImage(t,e,s,r,n=0,o=null,l=-1,c=-1){const u=this._roomContentLoader.getFurnitureWallNameForTypeId(t),h=this._roomContentLoader.getFurnitureWallColorIndex(t).toString();return s===1&&r?this.getGenericRoomObjectThumbnail(u,h,r,o,null):this.getGenericRoomObjectImage(u,h,e,s,r,n,o,null,l,c)}getRoomObjectPetImage(t,e,s,r,n,o,l=!1,c=0,u=null,h=null){let d=null,f=t+" "+e+" "+s.toString(16);if(l&&(f=f+" head"),u){f=f+(" "+u.length);for(const E of u)f=f+(" "+E.layerId+" "+E.partId+" "+E.paletteId)}return d=this._roomContentLoader.getPetNameForType(t),this.getGenericRoomObjectImage(d,f,r,n,o,c,null,null,-1,-1,h)}getGenericRoomObjectImage(t,e,s,r,n,o=0,l=null,c=null,u=-1,h=-1,d=null,f=-1){if(!this._roomManager)return null;const E=new sA;if(E.id=-1,!t)return E;let m=this._roomManager.getRoomInstance(ne.TEMPORARY_ROOM);if(!m&&(m=this._roomManager.createRoomInstance(ne.TEMPORARY_ROOM),!m))return E;let I=this._imageObjectIdBank.reserveNumber();const p=this.getRoomObjectCategoryForType(t);if(I<0)return E;I++;const T=m.createRoomObjectAndInitalize(I,t,p);if(!T||!T.model||!T.logic)return E;const R=T.model;switch(p){case Y.FLOOR:case Y.WALL:R.setValue(A.FURNITURE_COLOR,parseInt(e)),R.setValue(A.FURNITURE_EXTRAS,l);break;case Y.UNIT:if(t===Ue.USER||t===Ue.BOT||t===Ue.RENTABLE_BOT||t===Ue.PET)R.setValue(A.FIGURE,e);else{const P=new da(e);R.setValue(A.PET_PALETTE_INDEX,P.paletteId),R.setValue(A.PET_COLOR,P.color),P.headOnly&&R.setValue(A.PET_HEAD_ONLY,1),P.hasCustomParts&&(R.setValue(A.PET_CUSTOM_LAYER_IDS,P.customLayerIds),R.setValue(A.PET_CUSTOM_PARTS_IDS,P.customPartIds),R.setValue(A.PET_CUSTOM_PALETTE_IDS,P.customPaletteIds)),d&&R.setValue(A.FIGURE_POSTURE,d)}break}T.setDirection(s);const S=T.visualization;if(!S)return m.removeRoomObject(I,p),E;(u>-1||c)&&(c&&c.getLegacyString()!==""?T.logic.processUpdateMessage(new we(parseInt(c.getLegacyString()),c)):T.logic.processUpdateMessage(new we(u,c)));const L=new Ho(r,new w(-135,30,0),new w(11,11,5));if(S.update(L,0,!0,!1),h>0){let P=0;for(;P<h;)S.update(L,0,!0,!1),P++}const M=S.getImage();if(E.data=M,E.id=I,!this.isRoomContentTypeLoaded(t)&&n){let P=this._imageCallbacks.get(I.toString());P||(P=[],this._imageCallbacks.set(I.toString(),P)),P.push(n),R.setValue(A.IMAGE_QUERY_SCALE,r)}else m.removeRoomObject(I,p),this._imageObjectIdBank.freeNumber(I-1),E.id=0;return L.dispose(),E}getGenericRoomObjectThumbnail(t,e,s,r=null,n=null){if(!this._roomManager)return null;const o=new sA;if(o.id=-1,!t)return o;let l=this._roomManager.getRoomInstance(ne.TEMPORARY_ROOM);if(!l&&(l=this._roomManager.createRoomInstance(ne.TEMPORARY_ROOM),!l))return o;let c=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(t),c<0)return o;c++,o.id=c,o.data=null,o.image=null;const u=[t,e].join("_"),h=this._roomContentLoader.getImage(u);if(!h&&s){let d=this._thumbnailCallbacks.get(u);d||(d=[],this._thumbnailCallbacks.set(u,d),this._roomContentLoader.downloadImage(c,t,e,null)),d.push(s)}else h&&(o.image=h),this._thumbnailObjectIdBank.freeNumber(c-1),o.id=0;return o}initalizeTemporaryObjectsByType(t,e){const s=this._roomManager.getRoomInstance(ne.TEMPORARY_ROOM);if(!s)return;const r=this._roomContentLoader.getCategoryForType(t),n=s.getManager(r);let o=null,l=0;if(n&&n.objects.length){for(const c of n.objects.getValues())if(c&&c.model&&c.type===t){const u=c.id,h=c.visualization;let d=null;if(h){const E=c.model.getValue(A.IMAGE_QUERY_SCALE);o&&l!==E&&(o.dispose(),o=null),o||(l=E,o=new Ho(E,new w(-135,30,0),new w(11,11,5))),h.update(o,0,!0,!1),d=h.image}s.removeRoomObject(u,r),this._imageObjectIdBank.freeNumber(u-1);const f=this._imageCallbacks.get(u.toString());if(f){this._imageCallbacks.delete(u.toString());for(const E of f)E&&(d?E.imageReady(u,d):E.imageFailed(u))}}}o&&o.dispose()}setObjectMoverIconSpriteVisible(t){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const s=this.getRenderingCanvasOverlay(e),r=this.getOverlayIconSprite(s,ne.OBJECT_ICON_SPRITE);r&&(r.visible=t)}removeObjectMoverIconSprite(){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const e=this.getRenderingCanvasOverlay(t);this.removeOverlayIconSprite(e,ne.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(t){if(!t)return null;const e=t.master;return e?e.getChildByName(ne.OVERLAY)??null:null}removeOverlayIconSprite(t,e){if(!t)return!1;let s=t.children.length-1;for(;s>=0;){const r=t.getChildAt(s);if(r&&r.label===e){if(t.removeChildAt(s),r.children.length){const n=r.getChildAt(0);n.parent.removeChild(n),n.destroy()}return!0}s--}return!1}getOverlayIconSprite(t,e){if(!t)return null;let s=t.children.length-1;for(;s>=0;){const r=t.getChildAt(s);if(r&&r.label===e)return r;s--}return null}getRoomObjects(t,e){const s=this.getRoomId(t),r=this._roomManager.getRoomInstance(s);return r?r.getRoomObjectsForCategory(e):[]}addObjectToTileMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.addRoomObject(e)}refreshTileObjectMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.populate(this.getRoomObjects(t,Y.FLOOR))}createTextureFromRoom(t,e=-1,s=null){let r=null;e>-1?r=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e):r=this.getActiveRoomInstanceRenderingCanvas();let n=null;return s?n=me.generateTexture({target:r.master,frame:s}):n=r.getDisplayAsTexture(),n}async saveTextureAsScreenshot(t,e=!1){let s=null;e?s=new DI:s=new og,await s.assignBitmap(t),it().connection.send(s)}saveBase64AsScreenshot(t,e=!1){let s=null;e?s=new DI:s=new og,s.assignBase64(t),it().connection.send(s)}objectsInitialized(t){const e=this.getRoomIdFromString(t);X().dispatchEvent(new Ne(Ne.OBJECTS_INITIALIZED,e))}getRoomId(t){return t.toString()}getRoomIdFromString(t){if(!t)return-1;const e=t.split("_");return e.length<=0?-1:parseInt(e[0])||0}getRoomObjectRoomId(t){return!t||!t.model?null:t.model.getValue(A.OBJECT_ROOM_ID)}getRoomObjectAdUrl(t){return this._roomContentLoader.getRoomObjectAdUrl(t)}getPetTypeId(t){let e=-1;if(t){const s=t.split(" ");s.length>1&&(e=parseInt(s[0]))}return e}getPetType(t){if(!t)return null;const e=t.split(" ");if(e.length>1){const s=parseInt(e[0]);return this._roomContentLoader.getPetNameForType(s)}return null}isRoomContentTypeLoaded(t){return this._roomContentLoader.getCollection(t)!==null}getPetColorResult(t,e){return this._roomContentLoader.getPetColorResult(t,e)}getPetColorResultsForTag(t,e){return this._roomContentLoader.getPetColorResultsForTag(t,e)}deleteRoomObject(t,e){return!this._roomObjectEventHandler||e!==Y.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,t)}get roomManager(){return this._roomManager}set roomManager(t){this._roomManager=t}get areaSelectionManager(){return this._areaSelectionManager}get objectEventHandler(){return this._roomObjectEventHandler}get activeRoomId(){return this._activeRoomId}get isDecorating(){const t=this._roomSessionManager.getSession(this._activeRoomId);return t&&t.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(t,e){return this._roomManager==null?0:this._roomManager.getRoomInstance(t.toString()).getRoomObjectsForCategory(e).length}get moveBlocked(){return this._moveBlocked}set moveBlocked(t){this._moveBlocked=t}isAreaSelectionMode(){return this._areaSelectionManager.areaSelectionState!==zu.NOT_ACTIVE}whereYouClickIsWhereYouGo(){return!this.isAreaSelectionMode()}};ne.ROOM_OBJECT_ID=-1,ne.ROOM_OBJECT_TYPE="room",ne.CURSOR_OBJECT_ID=-2,ne.CURSOR_OBJECT_TYPE="tile_cursor",ne.ARROW_OBJECT_ID=-3,ne.ARROW_OBJECT_TYPE="selection_arrow",ne.OVERLAY="overlay",ne.OBJECT_ICON_SPRITE="object_icon_sprite",ne.DRAG_THRESHOLD=15,ne.TEMPORARY_ROOM="temporary_room";let Tg=ne;const yX=new Tg,rt=()=>yX,gt=class gt{constructor(t,e=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=0,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=t,this._planeParser=new Bs,this._previewRoomId=pn.makeRoomPreviewerId(e),this._addViewOffset=new Qt(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&X()&&(X().addEventListener(Ot.ADDED,this.onRoomObjectAdded),X().addEventListener(Ot.CONTENT_UPDATED,this.onRoomObjectAdded),X().addEventListener(Ne.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&X()&&(X().removeEventListener(Ot.ADDED,this.onRoomObjectAdded),X().removeEventListener(Ot.CONTENT_UPDATED,this.onRoomObjectAdded),X().removeEventListener(Ne.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const e=new Bs;e.initializeTileMap(9,9);let s=1;for(;s<8;){let r=1;for(;r<8;)e.setTileHeight(r,s,0),r++;s++}e.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,e.getMapData()),e.dispose()}}reset(t){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,gt.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,gt.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,gt.PREVIEW_OBJECT_ID),t||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=Y.MINIMUM}updatePreviewModel(t,e,s=!0){const r=new V_;r.flush(),r.parseModel(t,e,s);const n=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!n)return;this._planeParser.reset();const o=r.width,l=r.height;this._planeParser.initializeTileMap(o,l);const c=null;let u=-1,h=-1,d=0,f=0,E=0;for(;E<l;){let T=0;for(;T<o;){const R=r.getHeight(T,E);(E>0&&E<l-1||T>0&&T<o-1)&&R!=Bs.TILE_BLOCKED&&c==null&&(r.getHeight(T,E-1)==Bs.TILE_BLOCKED&&r.getHeight(T-1,E)==Bs.TILE_BLOCKED&&r.getHeight(T,E+1)==Bs.TILE_BLOCKED&&(u=T+.5,h=E,d=R,f=90),r.getHeight(T,E-1)==Bs.TILE_BLOCKED&&r.getHeight(T-1,E)==Bs.TILE_BLOCKED&&r.getHeight(T+1,E)==Bs.TILE_BLOCKED&&(u=T,h=E+.5,d=R,f=180)),this._planeParser.setTileHeight(T,E,R),T++}E++}this._planeParser.setTileHeight(Math.floor(u),Math.floor(h),d),this._planeParser.initializeFromTileData(r.wallHeight),this._planeParser.setTileHeight(Math.floor(u),Math.floor(h),d+this._planeParser.wallHeight),n.scale=ud.DEFAULT_SCALE,n.initialize(o,l,this._planeParser.floorHeight);let m=r.height-1;for(;m>=0;){let T=r.width-1;for(;T>=0;)n.setHeight(T,m,this._planeParser.getTileHeight(T,m)),T--;m--}const I=this._planeParser.getMapData();I.doors.push({x:u,y:h,z:d,dir:f});const p=this.getRoomPreviewOwnRoomObject();p&&p.processUpdateMessage(new dg(I))}addFurnitureIntoRoom(t,e,s=null,r=null){if(s||(s=new Di),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=Y.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,gt.PREVIEW_OBJECT_ID,t,new w(gt.PREVIEW_OBJECT_LOCATION_X,gt.PREVIEW_OBJECT_LOCATION_Y,0),e,0,s,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=zt(),this._automaticStateChange=!0;const n=this._roomEngine.getRoomObject(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return n&&r&&n.model.setValue(A.FURNITURE_EXTRAS,r),this.updatePreviewRoomView(),gt.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(t,e,s){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===Y.WALL&&this._currentPreviewObjectType===t&&this._currentPreviewObjectData===s)return gt.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=Y.WALL,this._currentPreviewObjectData=s,this._roomEngine.addFurnitureWall(this._previewRoomId,gt.PREVIEW_OBJECT_ID,t,new w(.5,2.3,1.8),e,0,s,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=zt(),this._automaticStateChange=!0,this.updatePreviewRoomView(),gt.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(t,e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=Y.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,gt.PREVIEW_OBJECT_ID,new w(gt.PREVIEW_OBJECT_LOCATION_X,gt.PREVIEW_OBJECT_LOCATION_Y,0),new w(90,0,0),135,Ue.getTypeNumber(Ue.USER),t)&&(this._previousAutomaticStateChangeTime=zt(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(e),this.updateUserPosture("std")),this.updatePreviewRoomView(),gt.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=Y.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,gt.PREVIEW_OBJECT_ID,new w(gt.PREVIEW_OBJECT_LOCATION_X,gt.PREVIEW_OBJECT_LOCATION_Y,0),new w(90,0,0),90,Ue.getTypeNumber(Ue.PET),t)&&(this._previousAutomaticStateChangeTime=zt(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),gt.PREVIEW_OBJECT_ID):-1}updateUserPosture(t,e=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,gt.PREVIEW_OBJECT_ID,t,e)}updateUserGesture(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,gt.PREVIEW_OBJECT_ID,t)}updateUserEffect(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,gt.PREVIEW_OBJECT_ID,t)}updateObjectUserFigure(t,e=null,s=null,r=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,gt.PREVIEW_OBJECT_ID,t,e,s,r):!1}updateObjectUserAction(t,e,s=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,gt.PREVIEW_OBJECT_ID,t,e,s)}updateObjectStuffData(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,gt.PREVIEW_OBJECT_ID,null,null,t.state,t)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==Y.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!t)return;const e=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(t,!0);switch(this._currentPreviewObjectCategory){case Y.FLOOR:{const s=new w(gt.PREVIEW_OBJECT_LOCATION_X,gt.PREVIEW_OBJECT_LOCATION_Y),r=new w(e,e,e);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,gt.PREVIEW_OBJECT_ID,s,r,null,null);return}case Y.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const t=zt();t>this._previousAutomaticStateChangeTime+gt.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=t,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(t,e){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,gt.PREVIEW_CANVAS_ID,t,e,this._currentPreviewScale);if(s&&this._backgroundColor!==null){let n=this._backgroundSprite;n||(n=new Ve(Es.WHITE),s.addChildAt(n,0)),n.width=t,n.height=e,n.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,gt.PREVIEW_CANVAS_ID,!0);const r=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,gt.PREVIEW_CANVAS_ID);return r&&r.adjustLocation(new w(gt.PREVIEW_OBJECT_LOCATION_X,gt.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,s}return null}modifyRoomCanvas(t,e){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,this._backgroundSprite&&(this._backgroundSprite.width=t,this._backgroundSprite.height=e),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,gt.PREVIEW_CANVAS_ID,t,e))}set addViewOffset(t){this._addViewOffset=t}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(t=null){t||(t=new Qt(0,0));const e=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,gt.PREVIEW_CANVAS_ID);if(e&&t)if(e.x+=-(this._currentPreviewCanvasWidth>>1),e.y+=-(this._currentPreviewCanvasHeight>>1),e.x+=-t.x,e.y+=-t.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=e;else{const s=this._currentPreviewRectangle.clone().enlarge(e);(s.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||s.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=s)}}validatePreviewSize(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;if(this.isRoomEngineReady){const e=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,gt.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+gt.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+gt.ALLOWED_IMAGE_CUT)?gt.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,gt.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,gt.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=gt.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,t.x=t.x>>1,t.y=t.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):e.isZoomedIn()&&(e.performZoomOut(),this._currentPreviewScale=gt.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(gt.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,gt.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,gt.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=gt.SCALE_NORMAL):e.isZoomedIn()||(e.performZoomIn(),this._currentPreviewScale=gt.SCALE_NORMAL))}return t}zoomIn(){this.isRoomEngineReady&&(gt.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,gt.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,gt.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=gt.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(gt.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,gt.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,gt.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=gt.SCALE_SMALL}updateAvatarDirection(t,e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,gt.PREVIEW_OBJECT_ID,new w(gt.PREVIEW_OBJECT_LOCATION_X,gt.PREVIEW_OBJECT_LOCATION_Y,0),new w(gt.PREVIEW_OBJECT_LOCATION_X,gt.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new w(t*45,0,0),e*45)}updateObjectRoom(t=null,e=null,s=null,r=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,t,e,s,r):!1}updateRoomWallsAndFloorVisibility(t,e=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,t,e)}getCanvasOffset(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;let e=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const r=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;r>10?s=s+Math.min(15,r-10):this._currentPreviewObjectCategory!==Y.UNIT?s=s+(5-Math.max(0,r/2)):s=s-(5-Math.min(0,r/2)),s=s+this._addViewOffset.y,e=e+this._addViewOffset.x;const n=e-t.x,o=s-t.y;if(n!==0||o!==0){const l=Math.sqrt(n*n+o*o);return l>10&&(e=t.x+n*10/l,s=t.y+o*10/l),new Qt(e,s)}return null}updatePreviewRoomView(t=!1){if(!(this._disableUpdate&&!t)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let e=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,gt.PREVIEW_CANVAS_ID);if(e&&(this.updatePreviewObjectBoundingRectangle(e),this._currentPreviewRectangle)){const s=this._currentPreviewScale;e=this.validatePreviewSize(e);const r=this.getCanvasOffset(e);r&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,gt.PREVIEW_CANVAS_ID,r),this._currentPreviewScale!==s&&(this._currentPreviewRectangle=null)}}}onRoomInitializedonRoomInitialized(t){if(t)switch(t.type){case Ne.INITIALIZED:t.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(t){if(t.roomId===this._previewRoomId&&t.objectId===gt.PREVIEW_OBJECT_ID&&t.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const e=this._roomEngine.getRoomObject(t.roomId,t.objectId,t.category);if(e&&e.model&&t.category===Y.WALL){const s=e.model.getValue(A.FURNITURE_SIZE_Z),r=e.model.getValue(A.FURNITURE_CENTER_Z);(s!==null||r!==null)&&this._roomEngine.updateRoomObjectWallLocation(t.roomId,t.objectId,new w(.5,2.3,(3.6-s)/2+r))}}}getRenderingCanvas(){const t=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,gt.PREVIEW_CANVAS_ID);return t||null}getGenericRoomObjectImage(t,e,s,r,n,o=0,l=null,c=null,u=-1,h=-1,d=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(t,e,s,r,n,o,l,c,u,h,d):null}getRoomObjectImage(t,e,s,r=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,t,e,s,r):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t&&t.visualization)return t.visualization.getImage()}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,gt.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t)return t}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,Tg.ROOM_OBJECT_ID,Y.ROOM);if(t)return t}return null}get isRoomEngineReady(){return!0}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}};gt.SCALE_NORMAL=64,gt.SCALE_SMALL=32,gt.PREVIEW_COUNTER=0,gt.PREVIEW_CANVAS_ID=1,gt.PREVIEW_OBJECT_ID=1,gt.PREVIEW_OBJECT_LOCATION_X=2,gt.PREVIEW_OBJECT_LOCATION_Y=2,gt.ALLOWED_IMAGE_CUT=.25,gt.AUTOMATIC_STATE_CHANGE_INTERVAL=2500,gt.ZOOM_ENABLED=!0;let xu=gt;class JL{constructor(t,e,s,r,n=""){this.id=t,this.length=e,this.name=s,this.creator=r,this.songData=n,this._jukeboxDiskId=-1}get diskId(){return this._jukeboxDiskId}set diskId(t){this._jukeboxDiskId=t}}class MX{constructor(t,e,s,r,n){this._songId=t,this._startPos=e,this._playLength=s,this._fadeInSeconds=r,this._fadeOutSeconds=n,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}class bX{constructor(t){this._id=t,this._items=[]}addChannelItem(t){this._items.push(t)}get items(){return this._items}}class DX{constructor(t,e){this._id=t,this._length=e}get id(){return this._id}get length(){return this._length}}class HT{constructor(t){this._channels=[],this._metaData=new Map;let e=[];const s=t.split(":"),r=s[s.length-1];if(r.indexOf("meta")>-1){const n=r.split(";");for(const o of n){const l=o.split(",");this._metaData.set(l[0],l[1])}e=s.slice(0,s.length-1)}else e=s;for(let n=0;n<e.length/2;n++)if(e[n*2].length>0){const o=parseInt(e[n*2]),l=e[n*2+1].split(";"),c=new bX(o);for(const u of l){const h=u.split(",");if(h.length!==2)return;c.addChannelItem(new DX(parseInt(h[0]),parseInt(h[1])))}this._channels.push(c)}}get channels(){return this._channels}getSampleIds(){const t=[];for(const e of this._channels)for(const s of e.items)t.indexOf(s.id)===-1&&t.push(s.id);return t}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const t=this._metaData.get("t");return t?parseInt(t):null}}const Sl=class Sl{};Sl.PRIORITY_ROOM_PLAYLIST=0,Sl.PRIORITY_USER_PLAYLIST=1,Sl.PRIORITY_SONG_PLAY=2,Sl.PRIORITY_PURCHASE_PREVIEW=3,Sl.PRIORITY_COUNT=4;let ri=Sl;class vX{constructor(){this._isPlaying=!1,this._currentSongId=-1,this._missingSongInfo=[],this._playPosition=-1,this._disposed=!1,this._messageEvents=[],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents=[new LM(this.onNowPlayingMessageEvent.bind(this)),new PM(this.onJukeboxSongDisksMessageEvent.bind(this)),new vM(this.onJukeboxPlayListFullMessageEvent.bind(this))],this._messageEvents.forEach(t=>it().registerMessageEvent(t)),X().addEventListener(Bl.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}dispose(){this._disposed||(this.stopPlaying(),X().removeEventListener(Bl.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(t=>it().removeMessageEvent(t)),this._disposed=!0)}onNowPlayingMessageEvent(t){const e=t.getParser();this._isPlaying=e.currentSongId!==-1,e.currentSongId>=0?(Os().musicController.playSong(e.currentSongId,ri.PRIORITY_ROOM_PLAYLIST,e.syncCount/1e3,0,1,1),this._currentSongId=e.currentSongId):this.stopPlaying(),e.nextSongId>=0&&Os().musicController.addSongInfoRequest(e.nextSongId),this._playPosition=e.currentPosition,X().dispatchEvent(new aa(aa.NPE_SONG_CHANGED,ri.PRIORITY_ROOM_PLAYLIST,e.currentSongId,e.currentPosition))}onJukeboxSongDisksMessageEvent(t){const e=t.getParser();this._entries=[];for(let s=0;s<e.songDisks.length;s++){const r=e.songDisks.getWithIndex(s),n=e.songDisks.getKey(s);let o=Os().musicController.getSongInfo(r);o||(o=new JL(r,-1,null,null,null),this._missingSongInfo.indexOf(r)<0&&(this._missingSongInfo.push(r),Os().musicController.requestSongInfoWithoutSamples(r))),o.diskId=n,this._entries.push(o)}this._missingSongInfo.length||X().dispatchEvent(new $n($n.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(t){X().dispatchEvent(new $n($n.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(t){for(let s=0;s<this.length;s++){const r=this._entries[s];if(r.id===t.id){const n=r.diskId,o=Os().musicController.getSongInfo(t.id);o&&(o.diskId=n,this._entries[s]=o);break}}const e=this._missingSongInfo.indexOf(t.id);e>=0&&this._missingSongInfo.splice(e,1),this._missingSongInfo.length||X().dispatchEvent(new $n($n.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){Os().musicController.stop(this.priority),this._currentSongId=-1,this._playPosition=-1,this._isPlaying=!1}getEntry(t){return t<0||t>=this._entries.length?null:this._entries[t]}requestPlayList(){it().connection.send(new XP)}get priority(){return ri.PRIORITY_ROOM_PLAYLIST}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get currentSongId(){return this._currentSongId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}}class PX{constructor(t){this._sampleUrl=t,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}async play(t,e,s=0,r=-1){this.reset(),this._currentSong=new HT(t),this._startPos=Math.trunc(s),this._playLength=r,this._currentPos=this._startPos,this._currentSongId=e,await this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),rc.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,rc.Howler.stop()}resume(){this._isPlaying=!0}stop(){const t=this._currentSongId;this.reset(),X().dispatchEvent(new Tu(Tu.TRAX_SONG_COMPLETE,t))}setVolume(t){rc.Howler.volume(t)}getVolume(){return rc.Howler.volume()}async getSample(t){let e=this._cache.get(t);return e||(e=await this.loadSong(t)),Promise.resolve(e)}async preload(){if(this._sequence=[],!!this._currentSong){for(const t of this._currentSong.channels){const e=[];for(const s of t.items){const r=await this.getSample(s.id),n=Math.ceil(s.length*2/Math.ceil(r.duration()));for(let o=0;o<n;o++)for(let l=0;l<Math.ceil(r.duration());l++)e.push({sampleId:s.id,offset:l})}this._sequence.push(e)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(t=>t.length)))}}async preloadSamplesForSong(t){const e=new HT(t);await Promise.all(e.getSampleIds().map(s=>this.getSample(s)))}async loadSong(t){return new Promise((e,s)=>{const r=new rc.Howl({src:[this._sampleUrl.replace("%sample%",t.toString())],preload:!0});r.once("load",()=>{this._cache.set(t,r),e(r)}),r.once("loaderror",()=>{Lt.error("failed to load sample "+t),s("failed to load sample "+t)})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(t){if(!(!this._currentSong||!this._sequence)&&rc.Howler._audioUnlocked)for(const e of this._sequence){const s=e[t];if(!s||s.sampleId===-1||s.sampleId===0)continue;const r=this._cache.get(s.sampleId);r&&(s.offset===0?r.play():r.playing()||(r.seek(s.offset),r.play()))}}}const Ol=class Ol{constructor(){this._timerInstance=1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songDiskInventory=new Is,this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._songIdPlaying=1,this._previousNotifiedSongId=-1,this._previousNotificationTime=-1,this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){it().registerMessageEvent(new jM(this.onTraxSongInfoMessageEvent.bind(this))),it().registerMessageEvent(new wM(this.onSongDiskInventoryMessage.bind(this))),this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new PX(jt().getValue("external.samples.url")),X().addEventListener(ds.JUKEBOX_INIT,this.onJukeboxInit),X().addEventListener(ds.JUKEBOX_DISPOSE,this.onJukeboxDispose),X().addEventListener(ds.SOUND_MACHINE_INIT,this.onSoundMachineInit),X().addEventListener(ds.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),X().addEventListener(Tu.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(t){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongDiskInventorySongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}getSongInfo(t){const e=this.getSongDataEntry(t);return e||this.requestSongInfoWithoutSamples(t),e}getSongIdPlayingAtPriority(t){return t!==this._priorityPlaying?-1:this._songIdPlaying}stop(t){const e=t===this._priorityPlaying,s=this.getTopRequestPriority()===t;e?(this.resetSongStartRequest(t),this.stopSongAtPriority(t)):(this.resetSongStartRequest(t),s&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(t){this.requestSong(t,!0)}requestSongInfoWithoutSamples(t){this.requestSong(t,!1)}requestUserSongDisks(){it().connection.send(new ZP)}updateVolume(t){this._musicPlayer.setVolume(t)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),X().removeEventListener(ds.JUKEBOX_INIT,this.onJukeboxInit),X().removeEventListener(ds.JUKEBOX_DISPOSE,this.onJukeboxDispose),X().removeEventListener(ds.SOUND_MACHINE_INIT,this.onSoundMachineInit),X().removeEventListener(ds.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),X().removeEventListener(Tu.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let t,e,s=[];for(let r=0;r<this._songRequestsPerPriority.length;r++)if(this._songRequestsPerPriority[r]&&(t=this._songRequestsPerPriority[r],e=this._availableSongs.get(t.songId),e)){const n=e.songData;if(n.length>0){const o=new HT(n);s=s.concat(o.getSampleIds())}}return s}onSongLoaded(t){const e=this.getTopRequestPriority();if(e>=0){const s=this.getSongIdRequestedAtPriority(e);t===s&&this.playSongObject(e,t)}}samplesUnloaded(t){throw new Error("Method not implemented.")}onTraxSongComplete(t){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===t.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const e=this._priorityPlaying;this.playSongWithHighestPriority(),e>=ri.PRIORITY_SONG_PLAY&&X().dispatchEvent(new aa(aa.NPW_USER_STOP_SONG,e,t.id,-1))}}onTraxSongInfoMessageEvent(t){const e=t.getParser();for(const s of e.songs){const r=!!this.getSongDataEntry(s.id);if(this.areSamplesRequested(s.id),!r){const n=new JL(s.id,s.length,s.name,s.creator,s.data);this._availableSongs.set(s.id,n);const o=this.getTopRequestPriority(),l=this.getSongIdRequestedAtPriority(o);for(s.id===l&&this.playSongObject(o,l),X().dispatchEvent(new Bl(Bl.SIR_TRAX_SONG_INFO_RECEIVED,s.id));this._diskInventoryMissingData.indexOf(s.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(s.id),1),this._diskInventoryMissingData.length===0&&X().dispatchEvent(new yl(yl.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(t){const e=t.getParser();this._songDiskInventory.reset();for(let s=0;s<e.songDiskCount;s++){const r=e.getDiskId(s),n=e.getSongId(s);this._songDiskInventory.add(r,n),this._availableSongs.get(n)||(this._diskInventoryMissingData.push(n),this.requestSongInfoWithoutSamples(n))}this._diskInventoryMissingData.length===0&&X().dispatchEvent(new yl(yl.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(it().connection.send(new JP(...this._songRequestList)),this._songRequestList=[])}requestSong(t,e){this._requestedSongs.get(t)===void 0&&(this._requestedSongs.set(t,e),this._songRequestList.push(t))}areSamplesRequested(t){return this._requestedSongs.get(t)?this._requestedSongs.get(t):!1}processSongEntryForPlaying(t,e=!0){return this.getSongDataEntry(t)?!0:(this.addSongInfoRequest(t),!1)}playSong(t,e,s=0,r=0,n=.5,o=.5){return!this.addSongStartRequest(e,t,s,r,n,o)||!this.processSongEntryForPlaying(t)?!1:(e>=this._priorityPlaying&&this.playSongObject(e,t),!0)}playSongObject(t,e){if(e===-1||t<0||t>=ri.PRIORITY_COUNT)return!1;let s=!1;this.stopSongAtPriority(this._priorityPlaying)&&(s=!0);const r=this.getSongDataEntry(e);if(!r)return!1;if(s)return!0;this._musicPlayer.setVolume(Os().traxVolume);let n=Ol.SKIP_POSITION_SET,o=0;const l=this.getSongStartRequest(t);return l&&(n=l.startPos,o=l.playLength,l.fadeInSeconds,l.fadeOutSeconds),n>=r.length/1e3?!1:(n<=Ol.SKIP_POSITION_SET&&(n=0),n=Math.trunc(n),this._priorityPlaying=t,this._requestNumberPlaying=this.getSongRequestCountAtPriority(t),this._songIdPlaying=e,this._priorityPlaying<=Ol.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(r),this._musicPlayer.preloadSamplesForSong(r.songData).then(()=>this._musicPlayer.play(r.songData,r.id,n,o)),t>ri.PRIORITY_ROOM_PLAYLIST&&X().dispatchEvent(new aa(aa.NPE_USER_PLAY_SONG,t,r.id,-1)),!0)}notifySongPlaying(t){const s=Date.now();t.length>=8e3&&(this._previousNotifiedSongId!=t.id||s>this._previousNotificationTime+8e3)&&(X().dispatchEvent(new w_(t.name,t.creator)),this._previousNotifiedSongId=t.id,this._previousNotificationTime=s)}addSongStartRequest(t,e,s,r,n,o){if(t<0||t>=ri.PRIORITY_COUNT)return!1;const l=new MX(e,s,r,n,o);return this._songRequestsPerPriority[t]=l,this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1,!0}getSongDataEntry(t){let e;return this._availableSongs&&(e=this._availableSongs.get(t)),e}getSongStartRequest(t){return this._songRequestsPerPriority[t]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(t){return t<0||t>=ri.PRIORITY_COUNT||!this._songRequestsPerPriority[t]?-1:this._songRequestsPerPriority[t].songId}getSongRequestCountAtPriority(t){return t<0||t>=ri.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[t]}playSongWithHighestPriority(){let t;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let s=this.getTopRequestPriority();for(;s>=0;){if(t=this.getSongIdRequestedAtPriority(s),t>=0&&this.playSongObject(s,t))return;s--}}resetSongStartRequest(t){t>=0&&t<ri.PRIORITY_COUNT&&(this._songRequestsPerPriority[t]=void 0)}reRequestSongAtPriority(t){this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1}stopSongAtPriority(t){if(t===this._priorityPlaying&&this._priorityPlaying>=0){const e=this.getSongIdPlayingAtPriority(t);if(e>=0)return this.getSongDataEntry(e),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(t){this.disposeRoomPlaylist()}onSoundMachineDispose(t){this.disposeRoomPlaylist()}onJukeboxInit(t){this.disposeRoomPlaylist(),this._roomItemPlaylist=new vX,this._roomItemPlaylist.init(),it().connection.send(new qP)}onJukeboxDispose(t){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}};Ol.SKIP_POSITION_SET=-1,Ol.MAXIMUM_NOTIFY_PRIORITY=ri.PRIORITY_ROOM_PLAYLIST;let WT=Ol;class LX{constructor(){this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._internalSamples=new Is,this._furniSamples=new Is,this._furnitureBeingPlayed=new Is,this._musicController=new WT}async init(){this._musicController.init(),X().addEventListener(zr.PLAY_SAMPLE,t=>this.onEvent(t)),X().addEventListener(Ot.REMOVED,t=>this.onEvent(t)),X().addEventListener(Ne.DISPOSED,t=>this.onEvent(t)),X().addEventListener(mu.SETTINGS_UPDATED,t=>this.onEvent(t)),X().addEventListener(Eu.PLAY_SOUND,t=>this.onEvent(t))}onEvent(t){var e;switch(t.type){case zr.PLAY_SAMPLE:{const s=t;this.playFurniSample(s.objectId,s.sampleId,s.pitch);return}case Ot.REMOVED:{const s=t;this.stopFurniSample(s.objectId);return}case Ne.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(s=>{this.stopFurniSample(s)});return}case mu.SETTINGS_UPDATED:{const s=t,r=s.volumeFurni!==this._volumeFurni,n=s.volumeTrax!==this._volumeTrax;this._volumeSystem=s.volumeSystem/100,this._volumeFurni=s.volumeFurni/100,this._volumeTrax=s.volumeTrax/100,r&&this.updateFurniSamplesVolume(this._volumeFurni),n&&((e=this._musicController)==null||e.updateVolume(this._volumeTrax));return}case Eu.PLAY_SOUND:{const s=t;this.playInternalSample(s.sampleCode);return}}}playSample(t,e,s=1){t.volume=e,t.currentTime=0;try{t.play()}catch(r){Lt.error(r)}}playInternalSample(t){let e=this._internalSamples.getValue(t);if(!e){const s=jt().getValue("sounds.url");e=new Audio(s.replace("%sample%",t)),this._internalSamples.add(t,e)}this.playSample(e,this._volumeSystem)}playFurniSample(t,e,s){let r=this._furniSamples.getValue(e);if(!r){const n=jt().getValue("external.samples.url");r=new Audio(n.replace("%sample%",e.toString())),this._furniSamples.add(e,r)}this._furnitureBeingPlayed.hasKey(t)||this._furnitureBeingPlayed.add(t,e),r.onended=n=>this.stopFurniSample(t),r.onpause=n=>this.stopFurniSample(t),r.onerror=n=>this.stopFurniSample(t),this.playSample(r,this._volumeFurni,s)}stopInternalSample(t){const e=this._internalSamples.getValue(t);if(e)try{e.pause()}catch(s){Lt.error(s)}}stopFurniSample(t){const e=this._furnitureBeingPlayed.getValue(t);if(!e)return;const s=this._furniSamples.getValue(e);if(this._furnitureBeingPlayed.remove(t),!!s)try{s.pause()}catch(r){Lt.error(r)}}updateInternalSamplesVolume(t){this._internalSamples.getValues().forEach(e=>{e.volume=t})}updateFurniSamplesVolume(t){this._furniSamples.getValues().forEach(e=>{e.volume=t})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}}const UX=new LX,Os=()=>UX;window.NitroDevTools={roomEngine:()=>rt(),textureCache:()=>Mr().texture.managedTextures,texturePool:()=>la().textures,textureGC:()=>Mr().textureGC};class jX extends bN{}class wX extends XE{}class FX extends $r{}class xS extends zo{}class dd extends Ve{}class GX extends Es{}p0.defaultOptions.hello=!0;I0.defaultOptions.scaleMode=window.devicePixelRatio%1?"linear":"nearest";T0.set(R0);const kX=()=>fu.RENDERER_VERSION,ZL=()=>"2.2.0";function ct(a,t=null){return jt().getValue(a,t)}const Jl=a=>{!a||!a.length||(a.startsWith("http")?Nn.openWebPage(a):ht(a))},H=a=>it().connection.send(a);let RE=!1,Vd=0,Hd=0;const Wd=(a,t=1)=>{const e=a.clientX,s=a.clientY;let r=a.type;switch(r===lt.MOUSE_CLICK&&(Vd&&(Hd=1,Vd>=Date.now()-300&&Hd++),Vd=Date.now(),Hd===2&&(RE||(r=lt.DOUBLE_CLICK),Hd=0,Vd=null)),r){case lt.MOUSE_CLICK:break;case lt.DOUBLE_CLICK:break;case lt.MOUSE_MOVE:RE=!0;break;case lt.MOUSE_DOWN:RE=!1;break;case lt.MOUSE_UP:break;case lt.RIGHT_CLICK:break;default:return}rt().dispatchMouseEvent(t,e,s,r,a.altKey,a.ctrlKey||a.metaKey,a.shiftKey,!1)};let SE=!1,Yd=0,zd=0;const Kd=(a,t=1,e=!1,s=!1,r=!1,n=!1)=>{let o=0,l=0;a.touches[0]?(o=a.touches[0].clientX,l=a.touches[0].clientY):a.changedTouches[0]&&(o=a.changedTouches[0].clientX,l=a.changedTouches[0].clientY);let c=a.type;switch(e&&(c=Vi.TOUCH_LONG),(c===lt.MOUSE_CLICK||c===Vi.TOUCH_END)&&(c=lt.MOUSE_CLICK,Yd&&(zd=1,Yd>=Date.now()-300&&zd++),Yd=Date.now(),zd===2&&(SE||(c=lt.DOUBLE_CLICK),zd=0,Yd=null)),c){case lt.MOUSE_CLICK:break;case lt.DOUBLE_CLICK:break;case Vi.TOUCH_START:c=lt.MOUSE_DOWN,SE=!1;break;case Vi.TOUCH_MOVE:c=lt.MOUSE_MOVE,SE=!0;break;case Vi.TOUCH_END:c=lt.MOUSE_UP;break;case Vi.TOUCH_LONG:c=lt.MOUSE_DOWN_LONG;break;default:return}c===Vi.TOUCH_START&&rt().dispatchMouseEvent(t,o,l,c,s,r,n,!1),rt().dispatchMouseEvent(t,o,l,c,s,r,n,!1)};function Ei(a){if(!a||!a.model)return!1;const t=tt().userId,e=a.model.getValue(A.FURNITURE_OWNER_ID);return t===e}function _d(a,t,e){return a?a.isRoomOwner||a.controllerLevel>=Ce.GUEST||tt().isModerator||Ei(rt().getRoomObject(a.roomId,t,e)):!1}function vl(a,t=null){Yi().createSession(a,t)}function BX(){const a=Zl();return a?a.model.getValue(A.FIGURE_CAN_STAND_UP):St.POSTURE_STAND}function OE(){const a=Zl();if(!a)return!1;const e=a.model.getValue(A.FIGURE_EFFECT);return!(e===29||e===30||e===185)}function pi(){return ct("hc.disabled",!1)?Pi.VIP:tt().clubLevel}const Fa=class Fa{};Fa.OKAY=0,Fa.MISSING_OFFER=1,Fa.FURNI_LIMIT_REACHED=2,Fa.NOT_IN_ROOM=3,Fa.NOT_ROOM_OWNER=4,Fa.GUILD_ROOM=5,Fa.VISITORS_IN_ROOM=6;let Na=Fa;class VX{constructor(t,e,s){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=e,this._parent=s,this._localization=t.localization,this._pageId=t.pageId,this._pageName=t.pageName,this._iconId=t.icon,this._children=[],this._offerIds=t.offerIds,this._isVisible=t.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(t){t&&this._children.push(t)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const mm=class mm{constructor(t,e,s,r,n,o=-1){this._pageId=t,this._layoutCode=e,this._localization=s,this._offers=r,this._acceptSeasonCurrencyAsCredits=n;for(const l of r)l.page=this;o===-1?this._mode=mm.MODE_NORMAL:this._mode=o}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};mm.MODE_NORMAL=0;let Rg=mm;const fs=class fs{};fs.DUCKET_INFO="ducket_info",fs.CREDITS="credits",fs.AVATAR_EFFECTS="avatar_effects",fs.HC_MEMBERSHIP="hc_membership",fs.CLUB_GIFTS="club_gifts",fs.LIMITED_SOLD="limited_sold",fs.PET_ACCESSORIES="pet_accessories",fs.TRAX_SONGS="trax_songs",fs.NEW_ADDITIONS="new_additions",fs.QUEST_SHELL="quest_shell",fs.QUEST_SNOWFLAKES="quest_snowflakes",fs.VAL_QUESTS="val_quests",fs.GUILD_CUSTOM_FURNI="guild_custom_furni",fs.GIFT_SHOP="gift_shop",fs.HORSE_STYLES="horse_styles",fs.HORSE_SHOE="horse_shoe",fs.SET_EASTER="set_easter",fs.ECOTRON_TRANSFORM="ecotron_transform",fs.LOYALTY_INFO="loyalty_info",fs.ROOM_BUNDLES="room_bundles",fs.ROOM_BUNDLES_MOBILE="room_bundles_mobile",fs.HABBO_CLUB_DESKTOP="habbo_club_desktop",fs.MOBILE_SUBSCRIPTIONS="mobile_subscriptions";let Sg=fs;class HX{constructor(t,e){this.breed=t,this.palettes=e}}const Ga=class Ga{};Ga.NONE=0,Ga.CONFIRM=1,Ga.PURCHASE=2,Ga.NO_CREDITS=3,Ga.NO_POINTS=4,Ga.SOLD_OUT=5,Ga.FAILED=6;let $e=Ga;const Em=class Em{};Em.NORMAL="NORMAL",Em.BUILDER="BUILDERS_CLUB";let Xr=Em;const WX=a=>"",YX=a=>"",iA=(a,t)=>{const e=a.get(t),s=[];if(e&&e.length)for(const r of e)r.isVisible&&s.push(r);return s},$L=(a,t,e,s)=>{if(e.isVisible&&e.pageId>0){let r=!1;const n=[e.pageName,e.localization].join(" ").toLowerCase().replace(/ /gi,"");if(n.indexOf(a)>-1&&(s.push(e),r=!0),!r){for(const o of t)if(n.indexOf(o)>=0){s.push(e);break}}}for(const r of e.children)$L(a,t,r,s)};function zX(a){if(!a.length)return 0;let t=a.length-1;for(;t>=0&&!isNaN(parseInt(a.charAt(t)));)t--;return t>0?parseInt(a.substring(t+1)):-1}function KX(a,t){switch(a){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const e=[];for(const s of t){const r=rt().getPetColorResult(a,s.paletteId);r&&(r.primaryColor===r.secondaryColor?e.push([r.primaryColor]):e.push([r.primaryColor,r.secondaryColor]))}return e}}}const qn=class qn{};qn.WALL="i",qn.FLOOR="s",qn.EFFECT="e",qn.HABBO_CLUB="h",qn.BADGE="b",qn.GAME_TOKEN="GAME_TOKEN",qn.PET="p",qn.ROBOT="r";let kt=qn;const pm=class pm{constructor(t,e,s,r,n,o,l=!1,c=0,u=0){this._productType=t.toLowerCase(),this._productClassId=e,this._extraParam=s,this._productCount=r,this._productData=n,this._furnitureData=o,this._isUniqueLimitedItem=l,this._uniqueLimitedItemSeriesSize=c,this._uniqueLimitedItemsLeft=u}static stripAddonProducts(t){return t.length===1?t:t.filter(e=>e.productType!==kt.BADGE&&e.productType!==kt.EFFECT&&e.productClassId!==pm.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(t=null,e=null){switch(this._productType){case kt.FLOOR:return rt().getFurnitureFloorIconUrl(this.productClassId);case kt.WALL:{if(t&&this._furnitureData){let s="";switch(this._furnitureData.className){case"floor":s=["th",this._furnitureData.className,t.product.extraParam].join("_");break;case"wallpaper":s=["th","wall",t.product.extraParam].join("_");break;case"landscape":s=["th",this._furnitureData.className,(t.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(s!=="")return`${ct("catalog.asset.url")}/${s}.png`}return rt().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case kt.EFFECT:return WX(this.productClassId);case kt.HABBO_CLUB:return YX(this.productClassId);case kt.BADGE:return tt().getBadgeUrl(this._extraParam);case kt.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(t){this._extraParam=t}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(t){this._uniqueLimitedItemsLeft=t}};pm.EFFECT_CLASSID_NINJA_DISAPPEAR=108;let Go=pm;const Ws=class Ws{constructor(t,e,s,r,n,o,l,c,u,h){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=t,this._localizationId=e,this._isRentOffer=s,this._priceInCredits=r,this._priceInActivityPoints=n,this._activityPointType=o,this._giftable=l,this._clubLevel=c,this._products=u,this._bundlePurchaseAllowed=h,this.setPricingModelForProducts(),this.setPricingType();for(const d of u)if(d.productType===kt.BADGE){this._badgeCode=d.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(t){this._page=t}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const t=Go.stripAddonProducts(this._products);return t.length?t[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const t=cu(this._localizationId);return t?t.name:g(this._localizationId)}get localizationDescription(){const t=cu(this._localizationId);return t?t.description:g(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const t=Go.stripAddonProducts(this._products);t.length===1?t[0].productCount===1?this._pricingModel=Ws.PRICING_MODEL_SINGLE:this._pricingModel=Ws.PRICING_MODEL_MULTI:t.length>1?this._pricingModel=Ws.PRICING_MODEL_BUNDLE:this._pricingModel=Ws.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Ws.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Ws.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Ws.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Ws.PRICE_TYPE_NONE}clone(){const t=[],e=cu(this.localizationId);for(const r of this._products){const n=YT(r.productClassId,r.productType);t.push(new Go(r.productType,r.productClassId,r.extraParam,r.productCount,e,n))}const s=new Ws(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,t,this.bundlePurchaseAllowed);return s.page=this.page,s}};Ws.PRICING_MODEL_UNKNOWN="pricing_model_unknown",Ws.PRICING_MODEL_SINGLE="pricing_model_single",Ws.PRICING_MODEL_MULTI="pricing_model_multi",Ws.PRICING_MODEL_BUNDLE="pricing_model_bundle",Ws.PRICING_MODEL_FURNITURE="pricing_model_furniture",Ws.PRICE_TYPE_NONE="price_type_none",Ws.PRICE_TYPE_CREDITS="price_type_credits",Ws.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints",Ws.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";let ni=Ws;class XX{constructor(t){this._furniData=t,this._product=new Go(this._furniData.type,this._furniData.id,this._furniData.customParams,1,cu(this._furniData.className),this._furniData)}activate(){H(new Ib(this._furniData.rentOfferId>-1?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(t){this._page=t}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return ni.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const qX=(a,t,e=null)=>{let s=null;switch(a.toLocaleLowerCase()){case kt.FLOOR:s=rt().getFurnitureFloorIconUrl(t);break;case kt.WALL:s=rt().getFurnitureWallIconUrl(t,e);break}return s};class QX{constructor(t){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=t.isEnabled,this._price=t.price,this._boxTypes=t.boxTypes,this._ribbonTypes=t.ribbonTypes,this._stuffTypes=t.giftWrappers,this._defaultStuffTypes=t.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}const Im=class Im{constructor(t,e,s,r,n,o,l,c,u=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=r,this._stuffData=n,this._price=o,this._status=l,this._averagePrice=c,this._offerCount=u}get offerId(){return this._offerId}set offerId(t){this._offerId=t}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(t){this._price=t}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(t){this._image=t}get imageCallback(){return this._imageCallback}set imageCallback(t){this._imageCallback=t}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(t){this._timeLeftMinutes=t}get offerCount(){return this._offerCount}set offerCount(t){this._offerCount=t}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}};Im.TYPE_FLOOR=1,Im.TYPE_WALL=2;let gd=Im;const Xc=class Xc{};Xc.ONGOING=1,Xc.ONGOING_OWN=1,Xc.SOLD=2,Xc.EXPIRED=3;let fd=Xc;const Mh=class Mh{};Mh.BY_ACTIVITY=1,Mh.BY_VALUE=2,Mh.ADVANCED=3;let gi=Mh;class tU{constructor(t,e){this._images=t,this._texts=e}getText(t){let e=this._texts[t]||"";return e&&e.length&&(e=e.replace(/\r\n|\r|\n/g,"<br />")),e}getImage(t){const e=this._images[t]||"";if(!e||!e.length)return null;let s=ct("catalog.asset.image.url");return s=s.replace("%name%",e),s}}class JX{constructor(t,e,s,r,n,o,l,c){this.roomId=t,this.objectId=e,this.category=s,this.wallLocation=r,this.x=n,this.y=o,this.direction=l,this.offer=c}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const un=class un{constructor(){this._requestType=un.REQUEST_TYPE_NONE}resetRequest(){this._requestType=un.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(t){this._requestType=un.REQUEST_TYPE_ID,this._requestById=t}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(t){this._requestType=un.REQUEST_TYPE_OFFER,this._requestedByOfferId=t}get requestByName(){return this._requestByName}set requestByName(t){this._requestType=un.REQUEST_TYPE_NAME,this._requestByName=t}};un.REQUEST_TYPE_NONE=0,un.REQUEST_TYPE_ID=1,un.REQUEST_TYPE_OFFER=2,un.REQUEST_TYPE_NAME=3;let rl=un;class ZX{constructor(t,e,s){this.searchValue=t,this.offers=e,this.filteredNodes=s}}function YT(a,t){let e=null;switch(t.toLowerCase()){case kt.FLOOR:e=tt().getFloorItemData(a);break;case kt.WALL:e=tt().getWallItemData(a);break}return e}function qm(a,t,e){const s=rt().getRoomObject(a,t,e);if(!s)return;const r=s.model.getValue(A.FURNITURE_TYPE_ID);switch(e){case Y.FLOOR:return tt().getFloorItemData(r);case Y.WALL:return tt().getWallItemData(r)}return null}function $X(){const a=Zl();return a?a.model.getValue(A.FIGURE_POSTURE):St.POSTURE_STAND}function cu(a){return a?tt().getProductData(a):null}const Se=()=>Yi().getSession(-1);function zT(){H(new bb)}function Pl(){return tt().clubLevel>=Pi.CLUB}function Xd(){return tt().clubLevel>=Pi.VIP}function tq(a){const t=rt().getRoomObject(Se().roomId,a,Y.FLOOR);if(!t||!t.model)return!1;const e=tt().userId,s=t.model.getValue(A.FURNITURE_OWNER_ID);return e===s}function eq(){const a=Zl();return a?a.model.getValue(A.FIGURE_EFFECT)===77:!1}function sq(a){Yi().startSession(a)}const yS=()=>{Se()&&(zT(),Yi().removeSession(-1))};function Zl(){const a=tt().userId,t=rt().activeRoomId,e=Y.UNIT,s=rt().getTotalObjectsForManager(t,e);let r=0;for(;r<s;){const n=rt().getRoomObjectByIndex(t,r,e);if(n){const o=Se().userDataManager.getUserDataByIndex(n.id);if(o&&o.webID===a)return n}r++}return null}const MS=(a,t,e,s=1)=>{const r=rt().getRoomObjectBoundingRectangle(a,t,e,s);return r?(r.x=Math.round(r.x),r.y=Math.round(r.y),r):null},eU=(a,t,e,s=1)=>{const r=rt().getRoomObjectScreenLocation(a,t,e,s);return r?(r.x=Math.round(r.x),r.y=Math.round(r.y),r):null},iq=(a,t,e=1)=>{const s=rt(),r=s.activeRoomId;s.initializeRoomInstanceRenderingCanvas(r,e,a,t)};function rq(a){let t=!1;const e=rt().getRoomObject(a.roomId,a.objectId,a.category);return e&&e.model.getValue(A.FURNITURE_SELECTION_DISABLED)===1&&(t=!0,tt().isModerator&&(t=!1)),t}function Ic(a,t,e){rt().processRoomObjectOperation(a,t,e)}function rA(a){rt().setActiveRoomId(a)}class dr{static getAchievementBadgeCode(t){if(!t)return null;let e=t.badgeId;return t.finalLevel||(e=Tn().getPreviousLevelBadgeId(e)),e}static getAchievementCategoryImageUrl(t,e=null,s=!1){const r=ct("achievements.images.url");let n=s?"achicon_":"achcategory_";return n+=t.code,e!==null&&(n+=`_${e>0?"active":"inactive"}`),r.replace("%image%",n)}static getAchievementCategoryMaxProgress(t){if(!t)return 0;let e=0;for(const s of t.achievements)e+=s.levelCount;return e}static getAchievementCategoryProgress(t){if(!t)return 0;let e=0;for(const s of t.achievements)e+=s.finalLevel?s.level:s.level-1;return e}static getAchievementCategoryTotalUnseen(t){if(!t)return 0;let e=0;for(const s of t.achievements)s.unseen>0&&e++;return e}static getAchievementHasStarted(t){return t?!!(t.finalLevel||t.level-1>0):!1}static getAchievementIsIgnored(t){if(!t)return!1;const e=ct("achievements.unseen.ignored"),s=t.badgeId.replace(/[0-9]/g,"");return e.indexOf(s)>=0}static getAchievementLevel(t){return t?t.finalLevel?t.level:t.level-1:0}}class nA{constructor(t){this._code=t,this._achievements=[]}getProgress(){return dr.getAchievementCategoryProgress(this)}getMaxProgress(){return dr.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(t){this._achievements=t}}const qc=class qc{};qc.ACTION_SAVE="AEA_ACTION_SAVE",qc.ACTION_CLEAR="AEA_ACTION_CLEAR",qc.ACTION_RESET="AEA_ACTION_RESET",qc.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";let Pn=qc;const nq=(a,t)=>{const e=a?a.clubLevel:-1,s=t?t.clubLevel:-1;return e<s?-1:e>s?1:a.index<t.index?-1:a.index>t.index?1:0},aq=a=>(t,e)=>{const s=t.partSet?t.partSet.clubLevel:-1,r=e.partSet?e.partSet.clubLevel:-1,n=t.partSet?t.partSet.isSellable:!1,o=e.partSet?e.partSet.isSellable:!1;if(n&&!o)return 1;if(o&&!n)return-1;if(a){if(s>r)return-1;if(s<r)return 1}else{if(s<r)return-1;if(s>r)return 1}return t.partSet.id<e.partSet.id?-1:t.partSet.id>e.partSet.id?1:0},ar=class ar{static getThumbnailKey(t,e){return`${t}-${e.partSet.id}`}static clearCache(){this.THUMBNAIL_CACHE.clear()}static async build(t,e,s,r,n=!1){if(!t||!t.length||!e||!e.partSet||!e.partSet.parts||!e.partSet.parts.length)return null;const o=this.getThumbnailKey(t,e),l=this.THUMBNAIL_CACHE.get(o);if(l)return l;const c=(u,h,d,f=!1)=>{const E=new FX,m=u.partSet.parts.concat().sort(this.sortByDrawOrder);for(const I of m){if(!I)continue;let p=null,T=0,R=!1;for(;!R&&T<ar.THUMB_DIRECTIONS.length;){const P=`${At.SCALE}_${At.STD}_${I.type}_${I.id}_${ar.THUMB_DIRECTIONS[T]}_${At.DEFAULT_FRAME}`;p=ae().getAsset(P),p&&p.texture?R=!0:T++}if(!R)continue;const S=p.offsetX,L=p.offsetY,M=new dd(p.texture);if(M.position.set(S,L),h&&I.colorLayerIndex>0&&d&&d.length){const P=d[I.colorLayerIndex-1];P&&(M.tint=P.rgb)}f&&(E.filters=[ar.ALPHA_FILTER]),E.addChild(M)}return E};return new Promise(async(u,h)=>{const d=async E=>{const m=c(e,s,r,n),I=await me.generateImageUrl(m);ar.THUMBNAIL_CACHE.set(o,I),u(I)},f=is().createFigureContainer(`${t}-${e.partSet.id}`);is().isFigureContainerReady(f)?d():is().downloadAvatarFigure(f,{resetFigure:d,dispose:null,disposed:!1})})}static async buildForFace(t,e=!1){if(!t||!t.length)return null;const s=t,r=this.THUMBNAIL_CACHE.get(s);return r||new Promise(async(n,o)=>{const l=async c=>{const u=is().createAvatarImage(c,hr.LARGE,null,{resetFigure:l,dispose:null,disposed:!1});if(u.isPlaceholder())return;const h=u.processAsTexture(ai.HEAD,!1),d=new dd(h);e&&(d.filters=[ar.ALPHA_FILTER]);const f=await me.generateImageUrl({target:d,frame:new xS(0,0,h.width,h.height)});d.destroy(),u.dispose(),ar.THUMBNAIL_CACHE.set(s,f),n(f)};l(t)})}static sortByDrawOrder(t,e){const s=ar.DRAW_ORDER.indexOf(t.type),r=ar.DRAW_ORDER.indexOf(e.type);return s<r?-1:s>r?1:t.index<e.index?-1:t.index>e.index?1:0}};ar.THUMBNAIL_CACHE=new Map,ar.THUMB_DIRECTIONS=[2,6,0,4,3,1],ar.ALPHA_FILTER=new wX({alpha:.2}),ar.DRAW_ORDER=[At.LEFT_HAND_ITEM,At.LEFT_HAND,At.LEFT_SLEEVE,At.LEFT_COAT_SLEEVE,At.BODY,At.SHOES,At.LEGS,At.CHEST,At.CHEST_ACCESSORY,At.COAT_CHEST,At.CHEST_PRINT,At.WAIST_ACCESSORY,At.RIGHT_HAND,At.RIGHT_SLEEVE,At.RIGHT_COAT_SLEEVE,At.HEAD,At.FACE,At.EYES,At.HAIR,At.HAIR_BIG,At.FACE_ACCESSORY,At.EYE_ACCESSORY,At.HEAD_ACCESSORY,At.HEAD_ACCESSORY_EXTRA,At.RIGHT_HAND_ITEM];let md=ar;const Tm=class Tm{};Tm.COLORMATRIX="colormatrix",Tm.COMPOSITE="composite";let Ed=Tm;class oq{constructor(t,e){this.texture=t,this.imageUrl=e}}class lq{constructor(t,e){this.effectName=t,this.thumbnailUrl=e}}class cq{constructor(t,e,s){this._productName=t,this._customImage=e,this._furnitureClassName=s}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}const Qc=class Qc{};Qc.STATE_UNLOCKED=1,Qc.STATE_LOCKED_AVAILABLE=2,Qc.STATE_LOCKED_EXPIRED=3,Qc.STATE_LOCKED_FUTURE=4;let xi=Qc;const bh=class bh{};bh.TYPE_CHAT=1,bh.TYPE_ROOM_INFO=2,bh.TYPE_IM=3;let On=bh;const sU=()=>{const a=new Date;return`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},aA=(a=0)=>{const t=a?new Date(Date.now()-a*1e3):new Date;return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},iU=(a,t)=>a.dispatchEvent(t),KT=a=>iU(X(),a),fa=new kN,Ps=a=>iU(fa,a),rU=a=>{if(!a||!a.length)return null;const t=a.split("/"),e=t[0],s=t[1],r=parseInt(t[2]);return{username:e,figure:s,userId:r}},Jc=class Jc{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0}populate(t){this.id=t.id,this.name=t.name,this.gender=t.gender,this.online=t.online,this.followingAllowed=t.followingAllowed,this.figure=t.figure,this.categoryId=t.categoryId,this.motto=t.motto,this.realName=t.realName,this.lastAccess=t.lastAccess,this.persistedMessageUser=t.persistedMessageUser,this.vipMember=t.vipMember,this.pocketHabboUser=t.pocketHabboUser,this.relationshipStatus=t.relationshipStatus}};Jc.RELATIONSHIP_NONE=0,Jc.RELATIONSHIP_HEART=1,Jc.RELATIONSHIP_SMILE=2,Jc.RELATIONSHIP_BOBBA=3;let Wi=Jc;const Rm=class Rm{};Rm.GROUP_CHAT=0,Rm.PRIVATE_CHAT=1;let jl=Rm;const Dh=class Dh{};Dh.HIDDEN=0,Dh.SHOW=1,Dh.UNREAD=2;let oa=Dh;class oA{populate(t){return t?(this._id=t.requestId,this._name=t.requesterName,this._figureString=t.figureString,this._requesterUserId=t.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class uq{constructor(t=0,e=0,s=0,r=[]){this.userFriendLimit=t,this.normalFriendLimit=e,this.extendedFriendLimit=s,this.categories=r}}const Zc=class Zc{constructor(t,e,s=0,r=null,n=0){this._type=n,this._senderId=t,this._message=e,this._secondsSinceSent=s,this._extraData=r,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}};Zc.CHAT=0,Zc.ROOM_INVITE=1,Zc.STATUS_NOTIFICATION=2,Zc.SECURITY_NOTIFICATION=3;let Qa=Zc;class hq{constructor(t,e=jl.PRIVATE_CHAT){this._userId=t,this._chats=[],this._type=e}addChat(t){this._chats.push(t)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(t){this._type=t}}const vh=class vh{constructor(t){this._threadId=++vh.THREAD_ID,this._participant=t,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(t,e,s=0,r=null,n=0){const o=t<0&&r,l=o?rU(r).userId:t,c=this.getLastGroup(l);if(!c)return;o&&(c.type=jl.GROUP_CHAT);const u=new Qa(t,e,s,r,n);return c.addChat(u),this._lastUpdated=new Date,this._unreadCount++,u}getLastGroup(t){let e=this._groups[this._groups.length-1];return e&&e.userId===t||(e=new hq(t),this._groups.push(e)),e}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}};vh.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED",vh.THREAD_ID=0;let XT=vh;function Qm(a=0){ht(a===0?"friends-messenger/toggle":`friends-messenger/${a}`)}function Dd(a){H(new Ou(a,!0))}function nU(a){ht(`groups/manage/${a}`)}function lA(a,t){ht(t?`group-members/${a}/${t}`:`group-members/${a}`)}const $c=class $c{constructor(t,e,s,r){this.type=t,this.key=e||0,this.color=s||0,this.position=r||4}get code(){return this.key===0&&this.type!==$c.BASE?null:$c.getCode(this.type,this.key,this.color,this.position)}static getCode(t,e,s,r){return t+(e<10?"0":"")+e+(s<10?"0":"")+s+r}};$c.BASE="b",$c.SYMBOL="s";let Ni=$c;const Ph=class Ph{};Ph.NOT_MEMBER=0,Ph.MEMBER=1,Ph.REQUEST_PENDING=2;let zs=Ph;const Lh=class Lh{};Lh.REGULAR=0,Lh.EXCLUSIVE=1,Lh.PRIVATE=2;let Ar=Lh;const dq=a=>{H(a.favourite?new cD(a.groupId):new tD(a.groupId))},bS=a=>H(new eD(a)),Us=class Us{};Us.NONE="NONE",Us.ERROR="ERROR",Us.REJECTED="REJECTED",Us.USER_CREATE="USER_CREATE",Us.USER_PENDING="USER_PENDING",Us.USER_ONGOING="USER_ONGOING",Us.USER_FEEDBACK="USER_FEEDBACK",Us.USER_NO_HELPERS="USER_NO_HELPERS",Us.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG",Us.USER_THANKS="USER_THANKS",Us.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED",Us.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU",Us.GUIDE_ACCEPT="GUIDE_ACCEPT",Us.GUIDE_ONGOING="GUIDE_ONGOING",Us.GUIDE_CLOSED="GUIDE_CLOSED",Us.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT",Us.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS",Us.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE",Us.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS",Us.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";let xe=Us;class cA{constructor(t,e){this._message=t,this._roomId=e}get message(){return this._message}get roomId(){return this._roomId}}class uA{constructor(t){this._userId=t,this._messages=[]}addChat(t){this._messages.push(t)}get userId(){return this._userId}get messages(){return this._messages}}const Uh=class Uh{};Uh.ACTIVE="active",Uh.NONE="none",Uh.EXPIRED="expired";let ea=Uh;const _q="HC1",gq=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],fq=a=>{let t=null;return gq.forEach(e=>a.indexOf(e)>-1&&(t=e)),t||_q},Sm=class Sm{};Sm.TOO_MANY_PENDING_CALLS_CODE=1,Sm.HAS_ABUSIVE_CALL_CODE=2;let Og=Sm;const mq=a=>a===1?"useless":a===2?"abusive":"resolved",Al=class Al{};Al.SELECT_USER=0,Al.SELECT_CHATS=1,Al.SELECT_TOPICS=2,Al.INPUT_REPORT_MESSAGE=3,Al.REPORT_SUMMARY=4;let Ii=Al;const Qn=class Qn{};Qn.EMERGENCY=1,Qn.GUIDE=2,Qn.IM=3,Qn.ROOM=4,Qn.BULLY=6,Qn.THREAD=7,Qn.MESSAGE=8,Qn.PHOTO=9;let ns=Qn;const ms=class ms{};ms.DEFAULT=1,ms.WALL_PAPER=2,ms.FLOOR=3,ms.LANDSCAPE=4,ms.POST_IT=5,ms.POSTER=6,ms.SOUND_SET=7,ms.TRAX_SONG=8,ms.PRESENT=9,ms.ECOTRON_BOX=10,ms.TROPHY=11,ms.CREDIT_FURNI=12,ms.PET_SHAMPOO=13,ms.PET_CUSTOM_PART=14,ms.PET_CUSTOM_PART_SHAMPOO=15,ms.PET_SADDLE=16,ms.GUILD_FURNI=17,ms.GAME_FURNI=18,ms.MONSTERPLANT_SEED=19,ms.MONSTERPLANT_REVIVAL=20,ms.MONSTERPLANT_REBREED=21,ms.MONSTERPLANT_FERTILIZE=22,ms.FIGURE_PURCHASABLE_SET=23;let Dt=ms;class pd{constructor(t){t&&(this._locked=!1,this._id=t.itemId,this._type=t.spriteId,this._ref=t.ref,this._category=t.category,this._groupable=t.isGroupable&&!t.rentable,this._tradeable=t.tradable,this._recyclable=t.isRecycleable,this._sellable=t.sellable,this._stuffData=t.stuffData,this._extra=t.extra,this._secondsToExpiration=t.secondsToExpiration,this._expirationTimeStamp=t.expirationTimeStamp,this._hasRentPeriodStarted=t.hasRentPeriodStarted,this._creationDay=t.creationDay,this._creationMonth=t.creationMonth,this._creationYear=t.creationYear,this._slotId=t.slotId,this._songId=t.songId,this._flatId=t.flatId,this._isRented=t.rentable,this._isWallItem=t.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(t){this._stuffData=t}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let t=-1;return this._hasRentPeriodStarted?(t=this._secondsToExpiration-(zt()-this._expirationTimeStamp)/1e3,t<0&&(t=0)):t=this._secondsToExpiration,t}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(t){this._locked=t}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(t){this._type=t.spriteId,this._ref=t.ref,this._category=t.category,this._groupable=t.isGroupable&&!t.rentable,this._tradeable=t.tradable,this._recyclable=t.isRecycleable,this._sellable=t.sellable,this._stuffData=t.stuffData,this._extra=t.extra,this._secondsToExpiration=t.secondsToExpiration,this._expirationTimeStamp=t.expirationTimeStamp,this._hasRentPeriodStarted=t.hasRentPeriodStarted,this._creationDay=t.creationDay,this._creationMonth=t.creationMonth,this._creationYear=t.creationYear,this._slotId=t.slotId,this._songId=t.songId,this._flatId=t.flatId,this._isRented=t.rentable,this._isWallItem=t.isWallItem}clone(){const t=new pd(null);return t._expirationTimeStamp=this._expirationTimeStamp,t._isWallItem=this._isWallItem,t._songId=this._songId,t._locked=this._locked,t._id=this._id,t._ref=this._ref,t._category=this._category,t._type=this._type,t._stuffData=this._stuffData,t._extra=this._extra,t._recyclable=this._recyclable,t._tradeable=this._tradeable,t._groupable=this._groupable,t._sellable=this._sellable,t._secondsToExpiration=this._secondsToExpiration,t._hasRentPeriodStarted=this._hasRentPeriodStarted,t._creationDay=this._creationDay,t._creationMonth=this._creationMonth,t._creationYear=this._creationYear,t._slotId=this._slotId,t._isRented=this._isRented,t._flatId=this._flatId,t}}const bi=a=>{if(a==null||typeof a!="object")return a;const t=new a.constructor;for(const e in a)a.hasOwnProperty(e)&&(t[e]=a[e]);return t};class zi{static makeColorHex(t){return"#"+t}static makeColorNumberHex(t){return"#"+t.toString(16).padStart(6,"0")}static convertFromHex(t){return parseInt(t.replace("#",""),16)}static uintHexColor(t){const e=t>>>0;return zi.makeColorHex(e.toString(16).substring(2))}static int_to_8BitVals(t){const e=t>>24&255,s=t>>16&255,r=t>>8&255,n=t&255;return[e,s,r,n]}static eight_bitVals_to_int(t,e,s,r){return(t<<24)+(e<<16)+(s<<8)+(r|0)}static int2rgb(t){t>>>=0;const e=t&255,s=(t&65280)>>>8;return"rgba("+[(t&16711680)>>>16,s,e,1].join(",")+")"}}const el=a=>{let t=Math.floor(a/86400),e=Math.floor(a%86400/3600),s=Math.floor(a%86400%3600/60),r=a%86400%3600%60;return t.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")};class Eq{constructor(t){this._data=[],this._maxSize=t,this._index=0}reset(){this._data=[],this._index=0}addValue(t){this._data.length<this._maxSize?this._data.push(t):this._data[this._index]=t,this._index=(this._index+1)%this._maxSize}getMax(){let t=Number.MIN_VALUE,e=0;for(;e<this._maxSize;)this._data[e]>t&&(t=this._data[e]),e++;return t}getMin(){let t=Number.MAX_VALUE,e=0;for(;e<this._maxSize;)this._data[e]<t&&(t=this._data[e]),e++;return t}}function g(a,t=null,e=null){return Tn().getValueWithParameters(a,t,e)}const Zt=class Zt{static format(t,e="",s=3){return t>s*Zt.YEAR?Zt.getLocalization("friendlytime.years"+e,Math.round(t/Zt.YEAR)):t>s*Zt.MONTH?Zt.getLocalization("friendlytime.months"+e,Math.round(t/Zt.MONTH)):t>s*Zt.DAY?Zt.getLocalization("friendlytime.days"+e,Math.round(t/Zt.DAY)):t>s*Zt.HOUR?Zt.getLocalization("friendlytime.hours"+e,Math.round(t/Zt.HOUR)):t>s*Zt.MINUTE?Zt.getLocalization("friendlytime.minutes"+e,Math.round(t/Zt.MINUTE)):Zt.getLocalization("friendlytime.seconds"+e,Math.round(t))}static shortFormat(t,e="",s=3){return t>s*Zt.YEAR?Zt.getLocalization("friendlytime.years.short"+e,Math.round(t/Zt.YEAR)):t>s*Zt.MONTH?Zt.getLocalization("friendlytime.months.short"+e,Math.round(t/Zt.MONTH)):t>s*Zt.DAY?Zt.getLocalization("friendlytime.days.short"+e,Math.round(t/Zt.DAY)):t>s*Zt.HOUR?Zt.getLocalization("friendlytime.hours.short"+e,Math.round(t/Zt.HOUR)):t>s*Zt.MINUTE?Zt.getLocalization("friendlytime.minutes.short"+e,Math.round(t/Zt.MINUTE)):Zt.getLocalization("friendlytime.seconds.short"+e,Math.round(t))}static getLocalization(t,e){return g(t,["amount"],[e.toString()])}};Zt.MINUTE=60,Zt.HOUR=60*Zt.MINUTE,Zt.DAY=24*Zt.HOUR,Zt.WEEK=7*Zt.DAY,Zt.MONTH=30*Zt.DAY,Zt.YEAR=365*Zt.DAY;let xr=Zt;const qT=a=>{try{JSON.parse(window.localStorage.getItem(a))}catch{return null}},Om=class Om{};Om.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects",Om.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation";let Id=Om;const DS=a=>{let t=Tn().getBadgeDesc(a);return(!t||!t.length)&&(t=`badge_desc_${a}`),t},vd=a=>{let t=Tn().getBadgeName(a);return(!t||!t.length)&&(t=`badge_name_${a}`),t};function Ag(a){return!a||isNaN(a)?"0":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function pq(a){if(!a||isNaN(a))return"0";let t=Math.abs(a);const e=Math.pow(10,1),s=a<0;let r="";const n=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const o of n){let l=t/o.value;if(l=Math.round(l*e)/e,l>=1){t=l,r=o.key;break}}return(s?"-":"")+t+r}let aU=!1;const ma=a=>{aU&&KT(new Eu(Eu.PLAY_SOUND,a))},hA=[lt.MOUSE_CLICK],Iq=()=>{const a=()=>hA.forEach(e=>window.removeEventListener(e,t)),t=e=>(aU=!0)&&a();hA.forEach(e=>window.addEventListener(e,t))};Iq();class __{static getProductImageUrl(t,e,s){let r=null;switch(t){case Wa.S:r=rt().getFurnitureFloorIconUrl(e);break;case Wa.I:this.getProductCategory(Wa.I,e)===1&&(r=rt().getFurnitureWallIconUrl(e,s));break}return r}static getProductCategory(t,e){if(t===Wa.S)return 1;if(t===Wa.I){if(e===3001)return Dt.WALL_PAPER;if(e===3002)return Dt.FLOOR;if(e===4057)return Dt.LANDSCAPE}return 1}}class qd{static getRandomNumber(t){return Math.floor(Math.random()*t)}static getRandomElement(t){return t[this.getRandomNumber(t.length)]}static getRandomElements(t,e){const s=new Array(e);let r=t.length;const n=new Array(r);for(;e--;){var o=this.getRandomNumber(r);s[e]=t[o in n?n[o]:o],n[o]=--r in n?n[r]:r}return s}}const at=new Map;at.set("r","red");at.set("b","blue");at.set("g","green");at.set("y","yellow");at.set("w","white");at.set("o","orange");at.set("c","cyan");at.set("br","brown");at.set("pr","purple");at.set("pk","pink");at.set("black","black");at.set("red","red");at.set("orangered","orangered");at.set("orange","orange");at.set("yellow","yellow");at.set("yellowgreen","yellowgreen");at.set("green","green");at.set("seagreen","seagreen");at.set("teal","teal");at.set("blue","blue");at.set("darkblue","darkblue");at.set("indigo","indigo");at.set("purple","purple");at.set("violet","violet");at.set("brown","brown");at.set("burlywood","burlywood");at.set("rosybrown","rosybrown");at.set("saddlebrown","saddlebrown");at.set("maroon","maroon");at.set("firebrick","firebrick");at.set("darkred","darkred");at.set("chocolate","chocolate");at.set("sienna","sienna");at.set("peru","peru");at.set("darkorange","darkorange");at.set("orange","orange");at.set("orangered","orangered");at.set("tomato","tomato");at.set("coral","coral");at.set("darkolivegreen","darkolivegreen");at.set("olive","olive");at.set("olivedrab","olivedrab");at.set("greenyellow","greenyellow");at.set("yellowgreen","yellowgreen");at.set("darkgreen","darkgreen");at.set("limegreen","limegreen");at.set("lime","lime");at.set("lawngreen","lawngreen");at.set("palegreen","palegreen");at.set("springgreen","springgreen");at.set("mediumseagreen","mediumseagreen");at.set("mediumaquamarine","mediumaquamarine");at.set("aquamarine","aquamarine");at.set("turquoise","turquoise");at.set("mediumturquoise","mediumturquoise");at.set("darkturquoise","darkturquoise");at.set("aqua","aqua");at.set("cyan","cyan");at.set("lightcyan","lightcyan");at.set("paleturquoise","paleturquoise");at.set("azure","azure");at.set("lightblue","lightblue");at.set("powderblue","powderblue");at.set("deepskyblue","deepskyblue");at.set("skyblue","skyblue");at.set("lightskyblue","lightskyblue");at.set("steelblue","steelblue");at.set("royalblue","royalblue");at.set("mediumslateblue","mediumslateblue");at.set("slateblue","slateblue");at.set("darkslateblue","darkslateblue");at.set("mediumpurple","mediumpurple");at.set("blueviolet","blueviolet");at.set("darkviolet","darkviolet");at.set("darkmagenta","darkmagenta");at.set("mediumvioletred","mediumvioletred");at.set("violetred","violetred");at.set("orchid","orchid");at.set("darkorchid","darkorchid");at.set("mediumorchid","mediumorchid");at.set("thistle","thistle");at.set("plum","plum");at.set("purple","purple");at.set("darkgrey","darkgrey");at.set("dimgray","dimgray");at.set("lightgrey","lightgrey");at.set("grey","grey");at.set("slategrey","slategrey");at.set("lightslategrey","lightslategrey");at.set("whitesmoke","whitesmoke");at.set("white","white");at.set("snow","snow");at.set("mistyrose","mistyrose");at.set("seashell","seashell");at.set("antiquewhite","antiquewhite");at.set("linen","linen");at.set("oldlace","oldlace");at.set("papayawhip","papayawhip");at.set("blanchedalmond","blanchedalmond");at.set("moccasin","moccasin");at.set("wheat","wheat");at.set("navajowhite","navajowhite");at.set("burlywood","burlywood");at.set("tan","tan");at.set("rosybrown","rosybrown");at.set("sandybrown","sandybrown");at.set("goldenrod","goldenrod");at.set("darkgoldenrod","darkgoldenrod");at.set("peru","peru");at.set("chocolate","chocolate");at.set("saddlebrown","saddlebrown");at.set("sienna","sienna");at.set("brown","brown");const Tq=a=>a.replace(/([\u00A0-\u9999<>&])(.|$)/g,(t,e,s)=>e!=="&"||s!=="#"?(/[\u00A0-\u9999<>&]/.test(s)&&(s="&#"+s.charCodeAt(0)+";"),"&#"+e.charCodeAt(0)+";"+s):t),Rq=a=>{let t="";a=Tq(a),a=a.replace(/\[tag\](.*?)\[\/tag\]/g,'<span class="chat-tag"><b>$1</b></span>'),jt()||(a=a.replace(/(?:http:\/\/|https:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?.*v=|shorts\/)?([a-zA-Z0-9_-]{11})/g,`
            <div>
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEQElEQVR4nO2X7WscRRzHt+AbfeEfICK+VVTwjWhVUnI7l8SkDY3Wu5ltfbiZXBNbq8ldiZEkVbHSIAEjCtUWNLXFaNWQElOUomKwD0bxoVLtk3I+oPhUjbvZ5x2Zmb29DUlaa3fTO9gvDOzMbx5+n535zYMkJUqUKFFNKoVIK0CEyogcKZfJCO/2y3qkaldLPn+ZDLEGELYbFeVyVgYgLnGADL5GqgUBRCaYwwC1NzUq5EruPCQnpVpRGpG87/RgGhJFLB88xGzyuvxVAOGtAOIXmU2SpGWsHKzNXcfaySh/Pe9DyeVSkNxzUQDkbO4KgIjH4kBGZLuAaa/j5ZD8LmZHJBniAd4Gtj8kynCXyBNVRuRX6WIJIDLN4gBA/CNzuq5uyyWhmRllQL69VJUAMsQDlT+NR3ynHhXLKVfkkJCcAZDoVQmQyuZuLAOkYPudNQcgSdIysZ0SWq/cf20tAkgyJDMJQHXNAN7ox8WTN6/pulRG2AAI/xZeQjLEj7ATG0BsVd0Sqs/iG2REHO64f70ACL/BbKEtVpUh+VvUqzIAJqDgewEip5lNRmQfO9xYeUNm/dUAkZ8AwidkmL+tKoI40VLJeGZbv97dWdIIVLVcRtOUVlPNrrR4urvZVlvrvSClb6Fq6iaR2HfYxur67TSl1eR9Eaiyvo1nB/ticV7vL04HDsWc9P5i8EiKRObw4GNL5bzqJzbbkQHo3R0/sE7dE99Qb2ZmXnK++HRRR6zxvbyO9fru85uFro7vIwPQcFZlnXq//EwXkvvtqUUdsQ/s53Xst8fOC0DLZdToANa1Gfyv9DxIjSd6qVv6Tjh+/Gue14sPRA+wdrURGYCaXWmHO3e+/Iw75Rz8UEx3X4Far45Qvb9AtUwz/7Z27ZwLMPUeNV9+gVqju6i2GlTW+uDj1Jl6n9ofHOD9BONkW+zoANrS7tkA7Mlx4eT+fVTvWi/WlefOAQjL+Ui0M3c8P8+mFzeIcdrSbnQALSu8CwVwjx0N6nnqP9zm/fmHaPfOBHVPnwz64OO0rPCiA2hYTi8UgMWA3vuwb/Ooesftlb9e6KTWm6Oiz+lDYpyG5TQ6gPCpGhVAc10A4GkapabpAxyOASCCJXQ2gLCcQ1MxLKEIgngOAKVzAPTuDrZtUn3zRjpLYAxBfI5t9H8BhGOguIFab/kx8PHB6LfR8kF2LgD31HG+2ywE4Bz9nFp7XhI22xK70F9neJYFsHvsK2GaHI/+ICtfJRYDsF7ZWVnEtr0gQFjMWd5u7555Nr1nU/RXifJlrpzM54aoPTFGjaGnxGB3NVL73Ul+cZvdRLjNGntNnLTbtvC8uX2Y/2m258/et8bfaW6l1sgODuR8coQaW/viuczV/HWaiT0ylsp5fWDzYSkOseeeXgg9KeEqq/KkbHL++5OyyQmelHCVFTwpC50lY/jp3licT5QoUSIpDv0L7jL5ksuHFDUAAAAASUVORK5CYII="
                    alt="YouTube Icon" style="vertical-align: middle; margin-right: 5px;"><strong>Click on open video to see the YouTube video</strong>
                </div><center><a href="https://youtu.be/$1" target="_blank" style="background-color: red; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none;">Open Video</a></center>
            `));const e=a.match(/@[a-zA-Z]+@/);if(e){const s=e[0].toString(),r=s.substr(1,s.length-2),n=a.replace(s,"");at.has(r)?t=`<span style="color: ${at.get(r)}">${n}</span>`:t=n}else t=a;return t},vS=(a,t)=>window.localStorage.setItem(a,JSON.stringify(t)),Ao=class Ao{};Ao.CAMERA_SHUTTER="camera_shutter",Ao.CREDITS="credits",Ao.DUCKETS="duckets",Ao.MESSENGER_NEW_THREAD="messenger_new_thread",Ao.MESSENGER_MESSAGE_RECEIVED="messenger_message_received",Ao.MODTOOLS_NEW_TICKET="modtools_new_ticket";let Ea=Ao;class PS{constructor(t=-1,e=-1,s=null,r=null,n=-1){this._type=t,this._category=e,this._roomEngine=s,this._stuffData=r,this._extra=n,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const t=new PS;return t._type=this._type,t._category=this._category,t._roomEngine=this._roomEngine,t._stuffData=this._stuffData,t._extra=this._extra,t._isWallItem=this._isWallItem,t._iconUrl=this._iconUrl,t._name=this._name,t._description=this._description,t._locked=this._locked,t._selected=this._selected,t._hasUnseenItems=this._hasUnseenItems,t._items=this._items,t}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(t){return this._items[t]}getItemById(t){for(const e of this._items)if(e.id===t)return e;return null}getTradeItems(t){const e=[],s=this.getLastItem();if(!s)return e;let r=0,n=0;for(;n<this._items.length&&!(r>=t);){const o=this.getItemByIndex(n);!o.locked&&o.isTradable&&o.type===s.type&&(e.push(o),r++),n++}return e}push(t){const e=[...this._items];let s=0;for(;s<e.length;){let r=e[s];if(r.id===t.id){r=r.clone(),r.locked=!1,e.splice(s,1),e.push(r),this._items=e;return}s++}e.push(t),this._items=e,this._items.length===1&&this.prepareGroup()}pop(){const t=[...this._items];let e=null;if(t.length>0){const s=t.length-1;e=t[s],t.splice(s,1)}return this._items=t,e}remove(t){const e=[...this._items];let s=0;for(;s<e.length;){let r=e[s];if(r.id===t)return e.splice(s,1),this._items=e,r;s++}return null}getTotalCount(){if(this._category===Dt.POST_IT){let t=0,e=0;for(;e<this._items.length;){const s=this.getItemByIndex(e);t=t+parseInt(s.stuffData.getLegacyString()),e++}return t}return this._items.length}getUnlockedCount(){if(this.category===Dt.POST_IT)return this.getTotalCount();let t=0,e=0;for(;e<this._items.length;)this.getItemByIndex(e).locked||t++,e++;return t}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const t=[...this._items];let e=0;for(;e<t.length;){const s=t[e];if(s.locked){const r=s.clone();r.locked=!1,t[e]=r}e++}this._items=t}lockItemIds(t){const e=[...this._items];let s=0,r=!1;for(;s<e.length;){const n=e[s],o=t.indexOf(n.ref)>=0;if(n.locked!==o){r=!0;const l=n.clone();l.locked=o,e[s]=l}s++}return this._items=e,r}setName(){const t=this.getLastItem();if(!t){this._name="";return}let e="";switch(this._category){case Dt.POSTER:e="poster_"+t.stuffData.getLegacyString()+"_name";break;case Dt.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?e="wallItem.name."+t.type:e="roomItem.name."+t.type}this._name=g(e)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let t=null;this.isWallItem?t=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):t=this._roomEngine.getFurnitureFloorIconUrl(this._type),t&&(this._iconUrl=t)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(t){this._hasUnseenItems=t}get locked(){return this._locked}set locked(t){this._locked=t}get selected(){return this._selected}set selected(t){this._selected=t}get isWallItem(){const t=this.getItemByIndex(0);return t?t.isWallItem:!1}get isGroupable(){const t=this.getItemByIndex(0);return t?t.isGroupable:!1}get isSellable(){const t=this.getItemByIndex(0);return t?t.sellable:!1}get items(){return this._items}set items(t){this._items=t}}const LS=(a,t,e,s=NaN)=>new PS(a,t,rt(),e,s),Sq=(a,t,e)=>{const s=[];for(const n of a)n.type===t.type&&s.push(n);for(const n of s)if(n.getItemById(t.id))return n;const r=LS(t.type,t.category,t.stuffData,t.extra);return r.push(t),e?(r.hasUnseenItems=!0,a.unshift(r)):a.push(r),r},Oq=(a,t,e)=>{let s=null;for(const r of a)if(r.type===t.type&&r.isWallItem===t.isWallItem&&r.isGroupable)if(t.category===Dt.POSTER){if(r.stuffData.getLegacyString()===t.stuffData.getLegacyString()){s=r;break}}else if(t.category===Dt.GUILD_FURNI){if(t.stuffData.compare(r.stuffData)){s=r;break}}else{s=r;break}if(s){if(s.push(t),e){s.hasUnseenItems=!0;const r=a.indexOf(s);r>=0&&a.splice(r,1),a.unshift(s)}return s}return s=LS(t.type,t.category,t.stuffData,t.extra),s.push(t),e?(s.hasUnseenItems=!0,a.unshift(s)):a.push(s),s},dA=(a,t,e)=>{t.isGroupable?Oq(a,t,e):Sq(a,t,e)},Aq=(a,t,e,s)=>{if(t===1)return a;s[e]=a;for(const n of s)if(!n)return null;const r=new Map;for(const n of s){for(const[o,l]of n)r.set(o,l);n.clear()}return s=null,r},Nq=a=>{const t=[];for(const e of a){let s=e.getTotalCount();e.category===Dt.POST_IT&&(s=1);let r=0;for(;r<s;)t.push(e.getItemByIndex(r).id),r++}return t};let oU=!1,lU=-1;const Cq=()=>oU,Pd=a=>oU=a,yu=()=>lU,Jm=a=>lU=a,Td=()=>{yu()!==-1&&(rt().cancelRoomObjectPlacement(),Jm(-1),Pd(!1))},QT=(a,t=!1)=>{const e=a.petData;if(!e)return!1;const s=Yi().getSession(1);return!s||!s.isRoomOwner&&!s.allowPets?!1:(ht("inventory/hide"),rt().processRoomObjectPlacement(Vo.INVENTORY,-e.id,Y.UNIT,Pe.PET,e.figureData.figuredata)&&(Jm(e.id),Pd(!0)),!0)},Mu=(a,t=!1)=>{if(!a||!a.getUnlockedCount())return!1;const e=a.getLastItem();if(!e)return!1;if(e.category===Dt.FLOOR||e.category===Dt.WALL_PAPER||e.category===Dt.LANDSCAPE)return t||H(new Yu(e.id)),!1;{ht("inventory/hide");let s=0,r=!1;e.isWallItem?s=Y.WALL:s=Y.FLOOR,e.category===Dt.POSTER?r=rt().processRoomObjectPlacement(Vo.INVENTORY,e.id,s,e.type,e.stuffData.getLegacyString()):r=rt().processRoomObjectPlacement(Vo.INVENTORY,e.id,s,e.type,e.extra.toString(),e.stuffData),r&&(Jm(e.ref),Pd(!0))}return!0},JT=(a,t=!1)=>{const e=a.botData;if(!e)return!1;const s=Yi().getSession(1);return!s||!s.isRoomOwner?!1:(ht("inventory/hide"),rt().processRoomObjectPlacement(Vo.INVENTORY,-e.id,Y.UNIT,Pe.RENTABLE_BOT,e.figure)&&(Jm(e.id),Pd(!0)),!0)},No=class No{};No.FURNI=1,No.RENTABLE=2,No.PET=3,No.BADGE=4,No.BOT=5,No.GAMES=6;let as=No;const xq=a=>a.map(t=>t.petData.id),cU=(a,t,e=!0)=>{const s={petData:a};return e?t.unshift(s):t.push(s),s},uU=(a,t)=>{let e=0;for(;e<t.length;){const s=t[e];if(s&&s.petData.id===a)return yu()===s.petData.id&&(Td(),ht("inventory/open")),t.splice(e,1),s;e++}return null},yq=(a,t,e)=>{const s=xq(a),r=[],n=[];for(const o of t.keys())s.indexOf(o)===-1&&r.push(o);for(const o of s)!t.get(o)&&n.push(o);s.length;for(const o of n)uU(o,a);for(const o of r){const l=t.get(o);l&&cU(l,a,e(as.PET,l.id))}return a},Mq=(a,t,e,s)=>{if(t===1)return a;s[e]=a;for(const n of s)if(!n)return null;const r=new Map;for(const n of s){for(const[o,l]of n)r.set(o,l);n.clear()}return s=null,r},ka=class ka{};ka.TRADING_STATE_READY=0,ka.TRADING_STATE_RUNNING=1,ka.TRADING_STATE_COUNTDOWN=2,ka.TRADING_STATE_CONFIRMING=3,ka.TRADING_STATE_CONFIRMED=4,ka.TRADING_STATE_COMPLETED=5,ka.TRADING_STATE_CANCELLED=6;let Fs=ka;class _A{constructor(t=-1,e="",s=new Is,r=0,n=0,o=!1,l=!1){this.userId=t,this.userName=e,this.userItems=s,this.itemCount=r,this.creditsCount=n,this.accepts=o,this.canTrade=l}}const hn=class hn{};hn.ALERT_SCAM=0,hn.HOTEL_TRADING_DISABLED=1,hn.YOU_NOT_ALLOWED=2,hn.THEY_NOT_ALLOWED=4,hn.ROOM_DISABLED=6,hn.YOU_OPEN=7,hn.THEY_OPEN=8,hn.ERROR_WHILE_COMMIT=9,hn.THEY_CANCELLED=10;let Bi=hn;const gA=a=>{var t;return((t=tt().getWallItemData(a))==null?void 0:t.isExternalImage)||!1},fA=a=>{const t=new Is;if(a.length)for(const s of a){const r=s.spriteId,n=s.category;let o=s.furniType+r;(!s.isGroupable||gA(r))&&(o="itemid"+s.itemId),s.category===Dt.POSTER?o=s.itemId+"poster"+s.stuffData.getLegacyString():s.category===Dt.GUILD_FURNI&&(o="");let l=s.isGroupable&&!gA(s.spriteId)?t.getValue(o):null;l||(l=LS(r,n,s.stuffData),t.add(o,l)),l.push(new pd(s))}return t},bq=(a,t)=>{let e=a.toString();if(!(t instanceof An))return e;let s=1;for(;s<5;)e=e+(","+t.getValue(s)),s++;return e},Dq=a=>{switch(a){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"},Co=class Co{constructor(t,e,s,r,n){this._actionId=t,this._name=e,this._actionType=s,this._sanctionTypeId=r,this._actionLengthHours=n}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}};Co.ALERT=1,Co.MUTE=2,Co.BAN=3,Co.KICK=4,Co.TRADE_LOCK=5,Co.MESSAGE=6;let ke=Co;const dn=class dn{};dn.NONE=0,dn.START_DOORBELL=1,dn.START_PASSWORD=2,dn.STATE_PENDING_SERVER=3,dn.UPDATE_STATE=4,dn.STATE_WAITING=5,dn.STATE_NO_ANSWER=6,dn.STATE_WRONG_PASSWORD=7,dn.STATE_ACCEPTED=8;let We=dn;const jh=class jh{};jh.LIST=0,jh.THUMBNAILS=1,jh.FORCED_THUMBNAILS=2;let ao=jh;const vq=()=>{const a=[];for(let t=10;t<=100;t=t+10)a.push(t);return a},mA=vq(),nc=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function Li(a){H(new ad(a,!1,!0))}const Ba=class Ba{};Ba.DEFAULT="default",Ba.MOTD="motd",Ba.MODERATION="moderation",Ba.EVENT="event",Ba.NITRO="nitro",Ba.SEARCH="search",Ba.ALERT="alert";let Yt=Ba;const wh=class wh{constructor(t,e=Yt.DEFAULT,s=null,r=null,n=null,o=null){wh.ITEM_ID+=1,this._id=wh.ITEM_ID,this._messages=t,this._alertType=e,this._clickUrl=s,this._clickUrlText=r,this._title=n,this._imageUrl=o}get id(){return this._id}get messages(){return this._messages}set alertType(t){this._alertType=t}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}};wh.ITEM_ID=-1;let Ng=wh;const si=class si{};si.FRIENDOFFLINE="friendoffline",si.FRIENDONLINE="friendonline",si.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline",si.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline",si.ACHIEVEMENT="achievement",si.BADGE_RECEIVED="badge_received",si.INFO="info",si.RECYCLEROK="recyclerok",si.RESPECT="respect",si.CLUB="club",si.SOUNDMACHINE="soundmachine",si.PETLEVEL="petlevel",si.CLUBGIFT="clubgift",si.BUYFURNI="buyfurni",si.VIP="vip",si.ROOMMESSAGESPOSTED="roommessagesposted";let Ci=si;const Fh=class Fh{constructor(t,e=Ci.INFO,s=null,r=null){Fh.ITEM_ID+=1,this._id=Fh.ITEM_ID,this._message=t,this._notificationType=e,this._iconUrl=s,this._linkUrl=r}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}};Fh.ITEM_ID=-1;let ZT=Fh;const Gh=class Gh{constructor(t,e,s,r,n,o,l){Gh.ITEM_ID+=1,this._id=Gh.ITEM_ID,this._confirmType=t,this._message=e,this._onConfirm=s,this._onCancel=r,this._confirmText=n,this._cancelText=o,this._title=l}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};Gh.ITEM_ID=-1;let $T=Gh;class US{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(t){const e=new US;return e._credits=t._credits,e._activityPoints=t._activityPoints,e._clubDays=t._clubDays,e._clubPeriods=t._clubPeriods,e._isVIP=t._isVIP,e._pastClubDays=t._pastClubDays,e._pastVipDays=t._pastVipDays,e._isExpiring=t._isExpiring,e._minutesUntilExpiration=t._minutesUntilExpiration,e._minutesSinceLastModified=t._minutesSinceLastModified,e._lastUpdated=t._lastUpdated,e}get credits(){return this._credits}set credits(t){this._lastUpdated=zt(),this._credits=t}get activityPoints(){return this._activityPoints}set activityPoints(t){this._lastUpdated=zt(),this._activityPoints=t}get clubDays(){return this._clubDays}set clubDays(t){this._lastUpdated=zt(),this._clubDays=t}get clubPeriods(){return this._clubPeriods}set clubPeriods(t){this._lastUpdated=zt(),this._clubPeriods=t}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(t){this._isVIP=t}get pastClubDays(){return this._pastClubDays}set pastClubDays(t){this._lastUpdated=zt(),this._pastClubDays=t}get pastVipDays(){return this._pastVipDays}set pastVipDays(t){this._lastUpdated=zt(),this._pastVipDays=t}get isExpiring(){return this._isExpiring}set isExpiring(t){this._isExpiring=t}get minutesUntilExpiration(){var t=(zt()-this._lastUpdated)/6e4,e=this._minutesUntilExpiration-t;return e>0?e:0}set minutesUntilExpiration(t){this._lastUpdated=zt(),this._minutesUntilExpiration=t}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(t){this._lastUpdated=zt(),this._minutesSinceLastModified=t}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?Pi.NO_CLUB:this.isVip?Pi.VIP:Pi.CLUB}}class Ld extends se{}const kh=class kh extends Ld{constructor(t,e){super(t),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=e}get id(){return this._id}get summary(){return this._summary}set summary(t){this._summary=t}get headline(){return this._headline}set headline(t){this._headline=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}};kh.OFFER="RWPUW_OFFER",kh.ERROR="RWPUW_ERROR",kh.CONTENT="RWPUW_CONTENT";let oo=kh;const Am=class Am extends Ld{constructor(t,e=0,s=0,r=0){super(t),this._hue=e,this._saturation=s,this._lightness=r}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};Am.PREVIEW="RWUBCPE_PREVIEW",Am.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";let vo=Am;const tu=class tu extends Ld{constructor(t,e){super(tu.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=t,this._userName=e}get chatMode(){return this._chatMode}get userName(){return this._userName}};tu.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT",tu.WHISPER="whisper",tu.SHOUT="shout";let wl=tu;const Nm=class Nm extends Ld{constructor(t,e,s,r,n,o,l){super(Nm.UPDATE_CHAT),this._objectId=t,this._category=e,this._botId=s,this._chat=r,this._automaticChat=n,this._chatDelay=o,this._mixSentences=l}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};Nm.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";let Cg=Nm;const Yr=class Yr extends Ld{constructor(t,e,s,r){super(t),this._id=e,this._category=s,this._roomId=r}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}};Yr.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED",Yr.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED",Yr.USER_REMOVED="RWUROE_USER_REMOVED",Yr.FURNI_REMOVED="RWUROE_FURNI_REMOVED",Yr.FURNI_ADDED="RWUROE_FURNI_ADDED",Yr.USER_ADDED="RWUROE_USER_ADDED",Yr.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER",Yr.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT",Yr.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION",Yr.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";let Be=Yr;const NO=class NO{constructor(t){this.type=t,this.id=0,this.category=0,this.name="",this.description="",this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1}};NO.FURNI="IFI_FURNI";let zl=NO;class hU{constructor(t,e,s,r,n,o=!1){this.roomIndex=t,this.category=e,this.id=s,this.name=r,this.userType=n,this.isFriend=o}}const CO=class CO{constructor(t){this.type=t,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}};CO.PET_INFO="IPI_PET_INFO";let Kl=CO;const xO=class xO{constructor(t){this.type=t,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}};xO.RENTABLE_BOT="IRBI_RENTABLE_BOT";let Xl=xO;const Jn=class Jn{constructor(t){this.type=t,this.name="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===Jn.OWN_USER}};Jn.OWN_USER="IUI_OWN_USER",Jn.PEER="IUI_PEER",Jn.BOT="IUI_BOT",Jn.TRADE_REASON_OK=0,Jn.TRADE_REASON_SHUTDOWN=2,Jn.TRADE_REASON_NO_TRADING=3,Jn.DEFAULT_BOT_BADGE_ID="BOT";let ws=Jn;class ac{static getObjectName(t,e){const s=Se();let r=-1,n=null,o=0;switch(e){case Y.FLOOR:case Y.WALL:{const l=rt().getRoomObject(s.roomId,t,e);if(!l)break;if(l.type.indexOf("poster")===0)n=g("${poster_"+parseInt(l.type.replace("poster",""))+"_name}");else{let c=null;const u=l.model.getValue(A.FURNITURE_TYPE_ID);if(e===Y.FLOOR?c=tt().getFloorItemData(u):e===Y.WALL&&(c=tt().getWallItemData(u)),!c)break;r=c.id,n=c.name}break}case Y.UNIT:{const l=s.userDataManager.getUserDataByIndex(t);if(!l)break;r=l.webID,n=l.name,o=l.type;break}}return!n||!n.length?null:new hU(t,e,r,n,o)}static getFurniInfo(t,e){const s=Se(),r=rt().getRoomObject(s.roomId,t,e);if(!r)return null;const n=new zl(zl.FURNI);n.id=t,n.category=e;const o=r.model;o.getValue(vs.INFOSTAND_EXTRA_PARAM)&&(n.extraParam=o.getValue(vs.INFOSTAND_EXTRA_PARAM));const l=ra.getData(o.getValue(A.FURNITURE_DATA_FORMAT));l.initializeFromRoomObjectModel(o),n.stuffData=l;const c=r.type;if(c.indexOf("poster")===0){const f=parseInt(c.replace("poster",""));n.name=g("${poster_"+f+"_name}"),n.description=g("${poster_"+f+"_desc}")}else{const f=o.getValue(A.FURNITURE_TYPE_ID);let E=null;e===Y.FLOOR?E=tt().getFloorItemData(f):e===Y.WALL&&(E=tt().getWallItemData(f)),E&&(n.name=E.name,n.description=E.description,n.purchaseOfferId=E.purchaseOfferId,n.purchaseCouldBeUsedForBuyout=E.purchaseCouldBeUsedForBuyout,n.rentOfferId=E.rentOfferId,n.rentCouldBeUsedForBuyout=E.rentCouldBeUsedForBuyout,n.availableForBuildersClub=E.availableForBuildersClub,n.tileSizeX=E.tileSizeX,n.tileSizeY=E.tileSizeY)}c.indexOf("post_it")>-1&&(n.isStickie=!0);const u=o.getValue(A.FURNITURE_EXPIRY_TIME),h=o.getValue(A.FURNITURE_EXPIRTY_TIMESTAMP);n.expiration=u<0?u:Math.max(0,u-(zt()-h)/1e3),n.isWallItem=e===Y.WALL,n.isRoomOwner=s.isRoomOwner,n.roomControllerLevel=s.controllerLevel,n.isAnyRoomController=tt().isModerator,n.ownerId=o.getValue(A.FURNITURE_OWNER_ID),n.ownerName=o.getValue(A.FURNITURE_OWNER_NAME),n.usagePolicy=o.getValue(A.FURNITURE_USAGE_POLICY);const d=o.getValue(A.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return d!==0&&(n.groupId=d),Ei(r)&&(n.isOwner=!0),n}static getUserInfo(t,e){const s=Se(),r=new ws(e.webID===tt().userId?ws.OWN_USER:ws.PEER);r.isSpectatorMode=s.isSpectator,r.name=e.name,r.motto=e.custom,r.achievementScore=e.activityPoints,r.webID=e.webID,r.roomIndex=e.roomIndex,r.userType=Pe.USER;const n=rt().getRoomObject(s.roomId,e.roomIndex,t);if(n&&(r.carryItem=n.model.getValue(A.FIGURE_CARRY_OBJECT)||0),r.type===ws.OWN_USER&&(r.allowNameChange=tt().canChangeName),r.amIOwner=s.isRoomOwner,r.isGuildRoom=s.isGuildRoom,r.roomControllerLevel=s.controllerLevel,r.amIAnyRoomController=tt().isModerator,r.isAmbassador=tt().isAmbassador,r.type===ws.PEER){n&&(r.targetRoomControllerLevel=n.model.getValue(A.FIGURE_FLAT_CONTROL),r.canBeMuted=this.canBeMuted(r),r.canBeKicked=this.canBeKicked(r),r.canBeBanned=this.canBeBanned(r)),r.isIgnored=tt().isUserIgnored(e.name),r.respectLeft=tt().respectsLeft;const o=tt().isSystemShutdown,l=s.tradeMode;if(o)r.canTrade=!1;else switch(l){case nu.ROOM_CONTROLLER_REQUIRED:{const c=r.roomControllerLevel!==Ce.NONE&&r.roomControllerLevel!==Ce.GUILD_MEMBER,u=r.targetRoomControllerLevel!==Ce.NONE&&r.targetRoomControllerLevel!==Ce.GUILD_MEMBER;r.canTrade=c||u;break}case nu.FREE_TRADING:r.canTrade=!0;break;default:r.canTrade=!1;break}r.canTradeReason=ws.TRADE_REASON_OK,o&&(r.canTradeReason=ws.TRADE_REASON_SHUTDOWN),l!==nu.FREE_TRADING&&(r.canTradeReason=ws.TRADE_REASON_NO_TRADING)}return r.groupId=e.groupId,r.groupBadgeId=tt().getGroupBadge(r.groupId),r.groupName=e.groupName,r.badges=s.userDataManager.getUserBadges(e.webID),r.figure=e.figure,r}static getBotInfo(t,e){const s=Se(),r=new ws(ws.BOT);r.name=e.name,r.motto=e.custom,r.webID=e.webID,r.roomIndex=e.roomIndex,r.userType=e.type;const n=rt().getRoomObject(s.roomId,e.roomIndex,t);return n&&(r.carryItem=n.model.getValue(A.FIGURE_CARRY_OBJECT)||0),r.amIOwner=s.isRoomOwner,r.isGuildRoom=s.isGuildRoom,r.roomControllerLevel=s.controllerLevel,r.amIAnyRoomController=tt().isModerator,r.isAmbassador=tt().isAmbassador,r.badges=[ws.DEFAULT_BOT_BADGE_ID],r.figure=e.figure,r}static getRentableBotInfo(t,e){const s=Se(),r=new Xl(Xl.RENTABLE_BOT);r.name=e.name,r.motto=e.custom,r.webID=e.webID,r.roomIndex=e.roomIndex,r.ownerId=e.ownerId,r.ownerName=e.ownerName,r.botSkills=e.botSkills;const n=rt().getRoomObject(s.roomId,e.roomIndex,t);return n&&(r.carryItem=n.model.getValue(A.FIGURE_CARRY_OBJECT)||0),r.amIOwner=s.isRoomOwner,r.roomControllerLevel=s.controllerLevel,r.amIAnyRoomController=tt().isModerator,r.badges=[ws.DEFAULT_BOT_BADGE_ID],r.figure=e.figure,r}static getPetInfo(t){const e=Se(),s=e.userDataManager.getPetData(t.id);if(!s)return;const r=new da(s.figure);let n=null;r.typeId===Ds.MONSTERPLANT&&(t.level>=t.adultLevel?n="std":n="grw"+t.level);const o=t.ownerId===tt().userId,l=new Kl(Kl.PET_INFO);return l.name=s.name,l.id=t.id,l.ownerId=t.ownerId,l.ownerName=t.ownerName,l.rarityLevel=t.rarityLevel,l.petType=r.typeId,l.petBreed=r.paletteId,l.petFigure=s.figure,l.posture=n,l.isOwner=o,l.roomIndex=s.roomIndex,l.level=t.level,l.maximumLevel=t.maximumLevel,l.experience=t.experience,l.levelExperienceGoal=t.levelExperienceGoal,l.energy=t.energy,l.maximumEnergy=t.maximumEnergy,l.happyness=t.happyness,l.maximumHappyness=t.maximumHappyness,l.respect=t.respect,l.respectsPetLeft=tt().respectsPetLeft,l.age=t.age,l.saddle=t.saddle,l.rider=t.rider,l.breedable=t.breedable,l.fullyGrown=t.fullyGrown,l.dead=t.dead,l.rarityLevel=t.rarityLevel,l.skillTresholds=t.skillTresholds,l.canRemovePet=!1,l.publiclyRideable=t.publiclyRideable,l.maximumTimeToLive=t.maximumTimeToLive,l.remainingTimeToLive=t.remainingTimeToLive,l.remainingGrowTime=t.remainingGrowTime,l.publiclyBreedable=t.publiclyBreedable,(o||e.isRoomOwner||tt().isModerator||e.controllerLevel>=Ce.GUEST)&&(l.canRemovePet=!0),l}static checkGuildSetting(t){return t.isGuildRoom?t.roomControllerLevel>=Ce.GUILD_ADMIN:t.roomControllerLevel>=Ce.GUEST}static isValidSetting(t,e){const s=Se();if(!s.isPrivateRoom)return!1;const r=s.moderationSettings;let n=!1;return r&&(n=e(t,r)),n&&t.targetRoomControllerLevel<Ce.ROOM_OWNER}static canBeMuted(t){const e=(s,r)=>{switch(r.allowMute){case Hi.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(s);default:return s.roomControllerLevel>=Ce.ROOM_OWNER}};return this.isValidSetting(t,e)}static canBeKicked(t){const e=(s,r)=>{switch(r.allowKick){case Hi.MODERATION_LEVEL_ALL:return!0;case Hi.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(s);default:return s.roomControllerLevel>=Ce.ROOM_OWNER}};return this.isValidSetting(t,e)}static canBeBanned(t){const e=(s,r)=>{switch(r.allowBan){case Hi.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(s);default:return s.roomControllerLevel>=Ce.ROOM_OWNER}};return this.isValidSetting(t,e)}}const _i=class _i{};_i.GENERIC_SKILL=0,_i.DRESS_UP=1,_i.SETUP_CHAT=2,_i.RANDOM_WALK=3,_i.DANCE=4,_i.CHANGE_BOT_NAME=5,_i.SERVE_BEVERAGE=6,_i.INCLIENT_LINK=7,_i.NUX_PROCEED=8,_i.CHANGE_BOT_MOTTO=9,_i.NUX_TAKE_TOUR=10,_i.NO_PICK_UP=12,_i.NAVIGATOR_SEARCH=14,_i.DONATE_TO_USER=24,_i.DONATE_TO_ALL=25;let Ke=_i;const Cm=class Cm{constructor(t=-1,e=-1,s=-1,r="",n="",o="",l=null,c=0,u=0,h=null,d=null,f=""){this.senderId=t,this.senderCategory=e,this.roomId=s,this.text=r,this.formattedText=n,this.username=o,this.location=l,this.type=c,this.styleId=u,this.imageUrl=h,this.color=d,this.chatColours=f,this.id=-1,this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this._top=0,this._left=0,this.id=++Cm.BUBBLE_COUNTER,this.color=d,this.chatColours=f}get top(){return this._top}set top(t){this._top=t,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(t){this._left=t,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};Cm.BUBBLE_COUNTER=0;let tR=Cm;const eu=class eu{static async setFigureImage(t){var o;const e=is().createAvatarImage(t,hr.LARGE,null,{resetFigure:l=>this.setFigureImage(l),dispose:()=>{},disposed:!1});if(!e)return null;const s=e.isPlaceholder();if(s&&((o=this.placeHolderImageUrl)!=null&&o.length))return this.placeHolderImageUrl;t=e.getFigure().getFigureString();const r=e.processAsImageUrl(ai.HEAD),n=e.getPartColor(At.CHEST);return s&&(this.placeHolderImageUrl=r),this.AVATAR_COLOR_CACHE.set(t,n&&n.rgb||16777215),this.AVATAR_IMAGE_CACHE.set(t,r),e.dispose(),r}static async getUserImage(t){let e=this.AVATAR_IMAGE_CACHE.get(t);return e||(e=await this.setFigureImage(t)),e}static async getPetImage(t,e,s,r=64,n=null){let o=this.PET_IMAGE_CACHE.get(t+n);if(o)return o;const l=new da(t),c=l.typeId,u=rt().getRoomObjectPetImage(c,l.paletteId,l.color,new w(e*45),r,null,!1,0,l.customParts,n);return u&&(o=await me.generateImageUrl(u.data),this.PET_IMAGE_CACHE.set(t+n,o)),o}};eu.AVATAR_COLOR_CACHE=new Map,eu.AVATAR_IMAGE_CACHE=new Map,eu.PET_IMAGE_CACHE=new Map,eu.placeHolderImageUrl="";let Ku=eu;const Bh=class Bh{};Bh.CHAT_DEFAULT=0,Bh.CHAT_WHISPER=1,Bh.CHAT_SHOUT=2;let sa=Bh;class EA{constructor(t=0,e=0,s=0,r=0){this.id=t,this.type=e,this.color=s,this.light=r}}const Pq=(a,t,e,s=0)=>!(a.left+s+a.width<t.left+s||a.left+s>t.left+s+t.width||a.top+a.height<t.top+e||a.top>t.top+e+t.height),su=class su{static savePreset(t,e,s,r,n){Se().updateMoodlightData(t,e,s,r,n)}static changeState(){Se().toggleMoodlightState()}static previewDimmer(t,e,s){rt().updateObjectRoomColor(Se().roomId,t,e,s)}static scaleBrightness(t){return~~((t-this.MIN_BRIGHTNESS)*100/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}};su.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0],su.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"],su.MIN_BRIGHTNESS=76,su.MAX_BRIGHTNESS=255;let Kr=su;const Lq=130,Uq=100,jq=130,wq=100,Fq=130,Gq=100,dU=a=>{let t=0,e=0,s=0,r=0;for(;r<a.length;){switch(r%3){case 0:t=t+a.charCodeAt(r)*37;break;case 1:e=e+a.charCodeAt(r)*37;break;case 2:s=s+a.charCodeAt(r)*37;break}r++}return t=t%Uq+Lq,e=e%wq+jq,s=s%Gq+Fq,`rgb(${t},${e},${s})`},xm=class xm{static getMergedMannequinFigureContainer(t,e){const s=is().createFigureContainer(t),r=is().createFigureContainer(e);for(const n of this.MANNEQUIN_CLOTHING_PART_TYPES)s.removePart(n);for(const n of r.getPartTypeIds())s.updatePart(n,r.getPartSetId(n),r.getPartColorIds(n));return s}static transformAsMannequinFigure(t){for(const e of t.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(e)>=0||t.removePart(e);t.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}};xm.MANNEQUIN_FIGURE=["hd",99999,[99998]],xm.MANNEQUIN_CLOTHING_PART_TYPES=[At.CHEST_ACCESSORY,At.COAT_CHEST,At.CHEST,At.LEGS,At.SHOES,At.WAIST_ACCESSORY];let uu=xm;const ym=class ym{};ym.POSTURE_STAND=0,ym.POSTURE_SIT=1;let xg=ym;class Tc{constructor(t,e,s){this._id=t,this._category=e,this._name=s}get id(){return this._id}get category(){return this._category}get name(){return this._name}}class kq{constructor(t,e,s,r,n,o,l){this.id=t,this.category=e,this.name=s,this.requestRoomObjectId=r,this.targetRoomObjectId=n,this.requestInventoryStripId=o,this.replace=l}}const yg="0",_U="1",xo=class xo{};xo.UNSTARTED=-1,xo.ENDED=0,xo.PLAYING=1,xo.PAUSED=2,xo.BUFFERING=3,xo.CUED=5;let Po=xo;function Ki(a){H(new oL(a))}const Ud=a=>{const t=Math.floor(a/2);return a%2?(t+.5).toString():t.toString()},Je=class Je{};Je.TOGGLE_FURNI_STATE=0,Je.RESET=1,Je.SET_FURNI_STATE=3,Je.MOVE_FURNI=4,Je.GIVE_SCORE=6,Je.CHAT=7,Je.TELEPORT=8,Je.JOIN_TEAM=9,Je.LEAVE_TEAM=10,Je.CHASE=11,Je.FLEE=12,Je.MOVE_AND_ROTATE_FURNI=13,Je.GIVE_SCORE_TO_PREDEFINED_TEAM=14,Je.TOGGLE_TO_RANDOM_STATE=15,Je.MOVE_FURNI_TO=16,Je.GIVE_REWARD=17,Je.CALL_ANOTHER_STACK=18,Je.KICK_FROM_ROOM=19,Je.MUTE_USER=20,Je.BOT_TELEPORT=21,Je.BOT_MOVE=22,Je.BOT_TALK=23,Je.BOT_GIVE_HAND_ITEM=24,Je.BOT_FOLLOW_AVATAR=25,Je.BOT_CHANGE_FIGURE=26,Je.BOT_TALK_DIRECT_TO_AVTR=27;let rs=Je;const Ze=class Ze{};Ze.STATES_MATCH=0,Ze.FURNIS_HAVE_AVATARS=1,Ze.ACTOR_IS_ON_FURNI=2,Ze.TIME_ELAPSED_MORE=3,Ze.TIME_ELAPSED_LESS=4,Ze.USER_COUNT_IN=5,Ze.ACTOR_IS_IN_TEAM=6,Ze.HAS_STACKED_FURNIS=7,Ze.STUFF_TYPE_MATCHES=8,Ze.STUFFS_IN_FORMATION=9,Ze.ACTOR_IS_GROUP_MEMBER=10,Ze.ACTOR_IS_WEARING_BADGE=11,Ze.ACTOR_IS_WEARING_EFFECT=12,Ze.NOT_STATES_MATCH=13,Ze.FURNI_NOT_HAVE_HABBO=14,Ze.NOT_ACTOR_ON_FURNI=15,Ze.NOT_USER_COUNT_IN=16,Ze.NOT_ACTOR_IN_TEAM=17,Ze.NOT_HAS_STACKED_FURNIS=18,Ze.NOT_FURNI_IS_OF_TYPE=19,Ze.NOT_STUFFS_IN_FORMATION=20,Ze.NOT_ACTOR_IN_GROUP=21,Ze.NOT_ACTOR_WEARS_BADGE=22,Ze.NOT_ACTOR_WEARING_EFFECT=23,Ze.DATE_RANGE_ACTIVE=24,Ze.ACTOR_HAS_HANDITEM=25;let cs=Ze;const pA=a=>`${a.getFullYear()}/${("0"+(a.getMonth()+1)).slice(-2)}/${("0"+a.getDate()).slice(-2)} ${("0"+a.getHours()).slice(-2)}:${("0"+a.getMinutes()).slice(-2)}`,iu=class iu{};iu.STUFF_SELECTION_OPTION_NONE=0,iu.STUFF_SELECTION_OPTION_BY_ID=1,iu.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2,iu.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;let bt=iu;const Rr=class Rr{static show(t){Rr.applySelectionShader(Rr.getRoomObject(t))}static hide(t){Rr.clearSelectionShader(Rr.getRoomObject(t))}static clearSelectionShaderFromFurni(t){for(const e of t)Rr.clearSelectionShader(Rr.getRoomObject(e))}static applySelectionShaderToFurni(t){for(const e of t)Rr.applySelectionShader(Rr.getRoomObject(e))}static getRoomObject(t){const e=rt();return e.getRoomObject(e.activeRoomId,t,Y.FLOOR)}static applySelectionShader(t){if(!t)return;const e=t.visualization;if(e)for(const s of e.sprites)s.blendMode!=="add"&&(s.filters||(s.filters=[]),s.filters.push(Rr._selectionShader),s.increaseUpdateCounter())}static clearSelectionShader(t){if(!t)return;const e=t.visualization;if(e)for(const s of e.sprites){if(!s.filters)continue;const r=s.filters.indexOf(Rr._selectionShader);r>=0&&(s.filters.splice(r,1),s.increaseUpdateCounter())}}};Rr._selectionShader=new ip({lineColor:[1,1,1],color:[.6,.6,.6]});let Fl=Rr;const bu="	",Si=class Si{};Si.AVATAR_SAYS_SOMETHING=0,Si.AVATAR_WALKS_ON_FURNI=1,Si.AVATAR_WALKS_OFF_FURNI=2,Si.EXECUTE_ONCE=3,Si.TOGGLE_FURNI=4,Si.EXECUTE_PERIODICALLY=6,Si.AVATAR_ENTERS_ROOM=7,Si.GAME_STARTS=8,Si.GAME_ENDS=9,Si.SCORE_ACHIEVED=10,Si.COLLISION=11,Si.EXECUTE_PERIODICALLY_LONG=12,Si.BOT_REACHED_STUFF=13,Si.BOT_REACHED_AVATAR=14;let Ri=Si;const V=a=>{const{ref:t=null,innerRef:e=null,display:s=null,fit:r=!1,fitV:n=!1,grow:o=!1,shrink:l=!1,fullWidth:c=!1,fullHeight:u=!1,overflow:h=null,position:d=null,float:f=null,pointer:E=!1,visible:m=null,textColor:I=null,classNames:p=[],className:T="",style:R={},children:S=null,...L}=a,M=_.useMemo(()=>{const G=[];return s&&s.length&&G.push("d-"+s),(r||c)&&G.push("w-100"),(r||u)&&G.push("h-100"),n&&G.push("vw-100","vh-100"),o&&G.push("flex-grow-1"),l&&G.push("flex-shrink-0"),h&&G.push("overflow-"+h),d&&G.push("position-"+d),f&&G.push("float-"+f),E&&G.push("cursor-pointer"),m!==null&&G.push(m?"visible":"invisible"),I&&G.push("text-"+I),p.length&&G.push(...p),G},[s,r,n,o,l,c,u,h,d,f,E,m,I,p]),P=_.useMemo(()=>{let G=M.join(" ");return T.length&&(G+=" "+T),G.trim()},[M,T]),k=_.useMemo(()=>{let G={};return Object.keys(R).length&&(G={...G,...R}),G},[R]);return i.jsx("div",{ref:e,className:P,style:k,...L,children:S})},gU=_.createContext({isCssGrid:!1}),Bq=a=>i.jsx(gU.Provider,{value:a.value,children:a.children}),Vq=()=>_.useContext(gU),pt=a=>{const{inline:t=!1,gap:e=2,maxContent:s=!1,columnCount:r=0,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,fullHeight:u=!0,classNames:h=[],style:d={},...f}=a,E=_.useMemo(()=>{const I=[];return t?I.push("inline-grid"):I.push("grid"),e?I.push("gap-"+e):e===0&&I.push("gap-0"),s&&I.push("flex-basis-max-content"),o&&I.push("align-self-"+o),l&&I.push("align-items-"+l),c&&I.push("justify-content-"+c),!l&&!c&&n&&I.push("align-items-center","justify-content-center"),h.length&&I.push(...h),I},[t,e,s,o,l,c,n,h]),m=_.useMemo(()=>{let I={};return r&&(I["--bs-columns"]=r.toString()),Object.keys(d).length&&(I={...I,...d}),I},[r,d]);return i.jsx(Bq,{value:{isCssGrid:!0},children:i.jsx(V,{fullHeight:u,classNames:E,style:m,...f})})},Fe=a=>{const{columnMinWidth:t=40,columnMinHeight:e=40,columnCount:s=0,fullHeight:r=!1,maxContent:n=!0,overflow:o="auto",style:l={},...c}=a,u=_.useMemo(()=>{let h={};return h["--nitro-grid-column-min-height"]=e+"px",s>1&&(h.gridTemplateColumns=`repeat(auto-fill, minmax(${t}px, 1fr))`),Object.keys(l).length&&(h={...h,...l}),h},[t,e,s,l]);return i.jsx(pt,{columnCount:s,fullHeight:r,overflow:o,style:u,...c})},x=a=>{const{display:t="flex",column:e=void 0,reverse:s=!1,gap:r=null,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,classNames:u=[],...h}=a,d=_.useMemo(()=>{const f=[];return e?s?f.push("flex-column-reverse"):f.push("flex-column"):s&&f.push("flex-row-reverse"),r&&f.push("gap-"+r),o&&f.push("align-self-"+o),l&&f.push("align-items-"+l),c&&f.push("justify-content-"+c),!l&&!c&&n&&f.push("align-items-center","justify-content-center"),u.length&&f.push(...u),f},[e,s,r,n,o,l,c,u]);return i.jsx(V,{display:t,classNames:d,...h})},W=a=>{const{variant:t="primary",size:e="sm",active:s=!1,disabled:r=!1,classNames:n=[],...o}=a,l=_.useMemo(()=>{const c=["btn"];return t&&c.push("btn-"+t),e&&c.push("btn-"+e),s&&c.push("active"),r&&c.push("disabled"),n.length&&c.push(...n),c},[t,e,s,r,n]);return i.jsx(x,{center:!0,classNames:l,...o})},ua=a=>{const{classNames:t=[],...e}=a,s=_.useMemo(()=>{const r=["btn-group"];return t.length&&r.push(...t),r},[t]);return i.jsx(V,{classNames:s,...e})},N=a=>{const{size:t=0,offset:e=0,column:s=!0,gap:r=2,classNames:n=[],...o}=a,{isCssGrid:l=!1}=Vq(),c=_.useMemo(()=>{const u=[];if(t){let h=`col-${t}`;l&&(h=`g-${h}`),u.push(h)}if(e){let h=`offset-${e}`;l&&(h=`g-start-${e}`),u.push(h)}return n.length&&u.push(...n),u},[t,e,l,n]);return i.jsx(x,{classNames:c,column:s,gap:r,...o})},Hq=a=>{const{classNames:t=[],...e}=a,s=_.useMemo(()=>{const r=["form-group"];return t.length&&r.push(...t),r},[t]);return i.jsx(x,{classNames:s,...e})},Wq=a=>{const{variant:t="black",height:e=1,classNames:s=[],style:r={},...n}=a,o=_.useMemo(()=>{const c=[];return t&&c.push("bg-"+t),s.length&&c.push(...s),c},[t,s]),l=_.useMemo(()=>{let c={display:"list-item"};return e>0&&(c.height=e),Object.keys(r).length&&(c={...c,...r}),c},[e,r]);return i.jsx(V,{classNames:o,style:l,...n})},jS=a=>{var u;const{rows:t=[],columnCount:e=4,overscan:s=5,estimateSize:r=45,itemRender:n=null}=a,o=_.useRef(null),l=DN({count:Math.ceil(t.length/e),overscan:s,getScrollElement:()=>o.current,estimateSize:()=>r});_.useEffect(()=>{!t||!t.length||l.scrollToIndex(0)},[t,l]);const c=l.getVirtualItems();return i.jsx(V,{innerRef:o,fit:!0,position:"relative",style:{overflowY:"auto"},children:i.jsx("div",{style:{height:l.getTotalSize(),width:"100%",position:"relative"},children:i.jsx(x,{column:!0,gap:1,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${((u=c[0])==null?void 0:u.start)??0}px)`},children:c.map(h=>i.jsx("div",{"data-index":h.index,ref:l.measureElement,style:{display:"grid",gap:"0.25rem",minHeight:h.index===0?r:h.size,gridTemplateColumns:`repeat(${e}, 1fr)`},children:Array.from(Array(e)).map((d,f)=>{const E=t[f+h.index*e];return E?i.jsx(_.Fragment,{children:n(E,f)},f):i.jsx(_.Fragment,{},h.index+f+"b")})},h.key+"a"))})})})},Yq=a=>_.useEffect(a,[]),wS=a=>Yq(()=>a()),fU=(a,t,e,s=!0)=>{_.useEffect(()=>{if(s)return Array.isArray(a)?a.map(r=>t.addEventListener(r,e)):t.addEventListener(a,e),()=>{Array.isArray(a)?a.map(r=>t.removeEventListener(r,e)):t.removeEventListener(a,e)}},[a,t,s,e])},z=(a,t)=>{_.useEffect(()=>{const e=new a(t);return it().registerMessageEvent(e),()=>it().removeMessageEvent(e)},[a,t])},ft=(a,t,e=!0)=>fU(a,X(),t,e),_s=(a,t,e=!0)=>fU(a,fa,t,e),zq=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[r,n]=_.useState(null),[o,l]=_.useState(-1),[c,u]=_.useState(0),h=_.useMemo(()=>{let T=0;return e.forEach(R=>T+=dr.getAchievementCategoryTotalUnseen(R)),T},[e]),d=_.useMemo(()=>{let T=0;return e.forEach(R=>T+=R.getProgress()),T},[e]),f=_.useMemo(()=>{let T=0;return e.forEach(R=>T+=R.getMaxProgress()),T},[e]),E=_.useMemo(()=>~~((d-0)*100/(f-0)+0),[d,f]),m=_.useMemo(()=>r===null?null:e.find(T=>T.code===r),[e,r]),I=_.useMemo(()=>o===-1||!m?null:m.achievements.find(T=>T.achievementId===o),[m,o]),p=_.useCallback((T,R)=>{s(S=>{const L=[...S];for(const M of L)if(M.code===T)for(const P of M.achievements)P.achievementId===R&&(P.unseen=0);return L})},[]);return z(fx,T=>{const S=T.getParser().achievement;s(L=>{const M=[...L],P=M.findIndex(k=>k.code===S.category);if(P===-1){const k=new nA(S.category);k.achievements.push(S),M.push(k)}else{const k=bi(M[P]),G=[...k.achievements],j=G.findIndex(U=>U.achievementId===S.achievementId);let F=null;j===-1?G.push(S):(F=G[j],G[j]=S),dr.getAchievementIsIgnored(S)||(S.unseen++,F&&(S.unseen+=F.unseen)),k.achievements=G,M[P]=k}return M})}),z(mx,T=>{const R=T.getParser(),S=[];for(const L of R.achievements){const M=L.category;let P=S.find(k=>k.code===M);P||(P=new nA(M),S.push(P)),P.achievements.push(L)}s(S)}),z(Ex,T=>{const R=T.getParser();u(R.score)}),_.useEffect(()=>{a&&(H(new eb),t(!1))},[a]),_.useEffect(()=>{!r||o===-1||p(r,o)},[r,o,p]),{achievementCategories:e,selectedCategoryCode:r,setSelectedCategoryCode:n,selectedAchievementId:o,setSelectedAchievementId:l,achievementScore:c,getTotalUnseen:h,getProgress:d,getMaxProgress:f,scaledProgressPercent:E,selectedCategory:m,selectedAchievement:I,setAchievementSeen:p}},Zm=()=>gs(zq),Kq=()=>{const[a,t]=_.useState({}),[e,s]=_.useState({}),[r,n]=_.useState(At.MALE),o=_.useCallback((d,f)=>{const E=p=>{const T=p.split(".");if(!T||!T.length)return;const R={},S={};for(const L of T){const M=L.split("-");if(!M.length)continue;const P=M[0],k=parseInt(M[1]),G=[];let j=2;for(;j<M.length;)G.push(parseInt(M[j])),j++;G.length||G.push(0),k>=0&&(R[P]=k),G.length&&(S[P]=G)}return{partSets:R,colorSets:S}},{partSets:m,colorSets:I}=E(d);t(m),s(I),n(f)},[]),l=_.useCallback((d,f)=>{!d||!d.length||t(E=>{const m={...E};return f===-1?delete m[d]:m[d]=f,m})},[]),c=_.useCallback((d,f,E)=>{!d||!d.length||s(m=>{const I={...m};return I[d]||(I[d]=[]),I[d][f]||(I[d][f]=0),I[d][f]=E,I})},[]),u=_.useMemo(()=>{let d="";const f=[],E=Object.keys(a);for(const m of E){const I=a[m];if(!I)continue;let p=`${m}-${I}`;if(e[m]&&e[m].length){let T=0;for(;T<e[m].length;)p+=`-${e[m][T]}`,T++}f.push(p)}for(const m of f)d+=m,f.indexOf(m)<f.length-1&&(d+=".");return d},[a,e]),h=_.useCallback((d,f=!0)=>[At.HEAD].map(m=>{let I=m===At.HEAD&&f?d:a[m];const p=e[m]||[];let T=`${m}-${I}`;return I>=0&&(T+=p.map(R=>`-${R}`).join("")),T}).join("."),[a,e]);return{selectedParts:a,selectedColors:e,gender:r,setGender:n,loadAvatarData:o,selectPart:l,selectColor:c,getFigureString:u,getFigureStringWithFace:h}},Xq=Kq,AE=2,qq=()=>{const[a,t]=_.useState(!1),[e,s]=_.useState({}),[r,n]=_.useState(""),[o,l]=_.useState(1),[c,u]=_.useState([]),[h,d]=_.useState([]),[f,E]=_.useState(null),{selectedColors:m,gender:I,setGender:p,loadAvatarData:T,selectPart:R,selectColor:S,getFigureString:L,getFigureStringWithFace:M,selectedParts:P}=Xq(),k=_.useMemo(()=>e[r]??null,[r,e]),G=_.useMemo(()=>{var J,Z;const B={};for(const Q of Object.keys(m)){if(!m[Q])continue;const ut=[];for(const Bt of Object.keys(m[Q])){const te=(Z=(J=k.find(de=>de.setType===Q))==null?void 0:J.colorItems[Bt])==null?void 0:Z.find(de=>de.id===m[Q][Bt]);te&&ut.push(te)}B[Q]=ut}return B},[k,m]),j=_.useCallback((B,J)=>{if(!B||!B.length)return;const Z=k.find(ut=>ut.setType===B);if(!Z||!Z.partItems||!Z.partItems.length)return;const Q=Z.partItems.find(ut=>ut.id===J);if(Q){if(Q.isClear){R(B,-1);return}pi()<Q.partSet.clubLevel||(l(Q.maxPaletteCount||1),R(B,J))}},[k,R]),F=_.useCallback((B,J,Z)=>{if(!B||!B.length)return;const Q=k.find(te=>te.setType===B);if(!Q||!Q.colorItems||!Q.colorItems.length)return;const ut=Q.colorItems[J];if(!ut||!ut.length)return;const Bt=ut.find(te=>te.id===Z);Bt&&(pi()<Bt.clubLevel||S(B,J,Z))},[k,S]),U=_.useCallback(B=>{const J=is().structureData.getSetType(B);if(!B)return-1;const Z=is().structureData.getPalette(J.paletteID);if(!Z)return-1;for(const Q of Z.colors.getValues())if(!(!Q.isSelectable||pi()<Q.clubLevel))return Q.id;return-1},[]),K=_.useCallback((B=[])=>{const J=is().structure,Z=new Hu(""),ut=((de,He)=>(He=He.filter(le=>de.indexOf(le)===-1),[...de,...qd.getRandomElements(He,qd.getRandomNumber(He.length)+1)]))(J.getMandatorySetTypeIds(I,pi()),At.FIGURE_SETS),Bt=(de,He,le,qe)=>{const vt=de.partSets.getValues().filter(Vt=>!Vt.isSelectable||Vt.gender!=="U"&&Vt.gender!==He||Vt.clubLevel>le||Vt.isSellable&&qe.indexOf(Vt.id)===-1?null:Vt);return!vt||!vt.length?null:qd.getRandomElement(vt)},te=(de,He,le)=>{const qe=de.colors.getValues().filter(Vt=>!Vt.isSelectable||Vt.clubLevel>le?null:Vt);if(!qe||!qe.length)return null;const vt=Vt=>{const xs=Vt.parts;let ie=0;for(const Ft of xs)ie=Math.max(ie,Ft.colorLayerIndex);return ie};return qd.getRandomElements(qe,vt(He))};for(const de of B){const He=P[de],le=m[de];Z.updatePart(de,He,le)}for(const de of ut){if(Z.hasPartType(de))continue;const He=J.figureData.getSetType(de),le=Bt(He,I,pi(),c);if(!le)continue;let qe=[];le.isColorable&&(qe=te(J.figureData.getPalette(He.paletteID),le,pi()).map(vt=>vt.id)),Z.updatePart(He.type,le.id,qe)}T(Z.getFigureString(),I)},[c,I,T,m,P]);return z(Tx,B=>{const J=B.getParser();u(J.figureSetIds),d(J.boundsFurnitureNames)}),z(tb,B=>{const J=B.getParser(),Z=[];let Q=0;for(;Q<ct("avatar.wardrobe.max.slots",10);)Z.push([null,null]),Q++;for(let[ut,[Bt,te]]of J.looks.entries()){const de=is().createFigureContainer(Bt);Z[ut-1]=[de,te]}E(Z)}),_.useEffect(()=>{md.clearCache()},[G]),_.useEffect(()=>{if(!a)return;const B={},J=Z=>{const Q=[],ut=[];for(let vt=0;vt<AE;vt++)ut.push([]);const Bt=is().structureData.getSetType(Z),te=is().structureData.getPalette(Bt.paletteID);if(!Bt||!te)return null;for(const vt of te.colors.getValues())if(!(!vt||!vt.isSelectable))for(let Vt=0;Vt<AE;Vt++)ut[Vt].push(vt);is().getMandatoryAvatarPartSetIds(I,pi()).indexOf(Z)===-1&&Q.push({id:-1,isClear:!0});const le=Z!==At.HEAD,qe=Bt.partSets;for(let vt=qe.length;vt>=0;vt--){const Vt=qe.getWithIndex(vt);if(!Vt||!Vt.isSelectable||Vt.gender!==I&&Vt.gender!==At.UNISEX||Vt.isSellable&&c.indexOf(Vt.id)===-1)continue;let xs=0;for(const ie of Vt.parts)xs=Math.max(xs,ie.colorLayerIndex);Q.push({id:Vt.id,partSet:Vt,usesColor:le,maxPaletteCount:xs})}Q.sort(aq(!1));for(let vt=0;vt<AE;vt++)ut[vt].sort(nq);return{setType:Z,partItems:Q,colorItems:ut}};B[qr.GENERIC]=[At.HEAD].map(Z=>J(Z)),B[qr.HEAD]=[At.HAIR,At.HEAD_ACCESSORY,At.HEAD_ACCESSORY_EXTRA,At.EYE_ACCESSORY,At.FACE_ACCESSORY].map(Z=>J(Z)),B[qr.TORSO]=[At.CHEST,At.CHEST_PRINT,At.COAT_CHEST,At.CHEST_ACCESSORY].map(Z=>J(Z)),B[qr.LEGS]=[At.LEGS,At.SHOES,At.WAIST_ACCESSORY].map(Z=>J(Z)),B[qr.WARDROBE]=[],s(B),n(qr.GENERIC)},[a,I,c]),_.useEffect(()=>{a&&T(tt().figure,tt().gender)},[a,T]),_.useEffect(()=>{!a||f||(E(new Array(ct("avatar.wardrobe.max.slots",10))),H(new rb))},[a,f]),{isVisible:a,setIsVisible:t,avatarModels:e,activeModelKey:r,setActiveModelKey:n,maxPaletteCount:o,selectedColorParts:G,selectEditorColor:F,selectEditorPart:j,loadAvatarData:T,getFigureString:L,getFigureStringWithFace:M,selectedParts:P,gender:I,setGender:p,figureSetIds:c,randomizeCurrentFigure:K,savedFigures:f,setSavedFigures:E,getFirstSelectableColor:U}},$l=()=>gs(qq),Qq=()=>{const[a,t]=_.useState([]),[e,s]=_.useState([]),[r,n]=_.useState(-1),[o,l]=_.useState(10),[c,u]=_.useState(null);return ft(Xh.INITIALIZED,h=>{t(Array.from(au().effects.values()))}),z(hC,h=>{const d=h.getParser();u({credits:d.creditPrice,duckets:d.ducketPrice,publishDucketPrice:d.publishDucketPrice})}),_.useEffect(()=>{if(!au().isLoaded){au().init(),H(new lb);return}},[]),{availableEffects:a,cameraRoll:e,setCameraRoll:s,selectedPictureIndex:r,setSelectedPictureIndex:n,myLevel:o,price:c}},mU=()=>gs(Qq),_n=class _n extends se{};_n.SHOW_CATALOG="CE_SHOW_CATALOG",_n.HIDE_CATALOG="CE_HIDE_CATALOG",_n.TOGGLE_CATALOG="CE_TOGGLE_CATALOG",_n.SOLD_OUT="CE_SOLD_OUT",_n.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT",_n.PURCHASE_APPROVED="CE_PURCHASE_APPROVED",_n.INIT_GIFT="CE_INIT_GIFT",_n.CATALOG_RESET="CE_RESET",_n.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";let ql=_n;class Jq extends ql{constructor(t,e,s){super(ql.INIT_GIFT),this._pageId=t,this._offerId=e,this._extraData=s}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const Mm=class Mm extends ql{constructor(t){super(Mm.POST_MARKETPLACE),this._item=t}get item(){return this._item}};Mm.POST_MARKETPLACE="CE_POST_MARKETPLACE";let Mg=Mm;const bm=class bm extends se{constructor(t){super(bm.PURCHASE_SUCCESS),this._purchase=t}get purchase(){return this._purchase}};bm.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";let pa=bm;const Dm=class Dm extends se{constructor(t){super(Dm.PURCHASE_FAILED),this._code=t}get code(){return this._code}};Dm.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";let Wo=Dm;const vm=class vm extends se{constructor(t){super(vm.NOT_ALLOWED),this._code=t}get code(){return this._code}};vm.NOT_ALLOWED="CPNAE_NOT_ALLOWED";let Rd=vm;const Ms=class Ms extends se{};Ms.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED",Ms.SELECT_PRODUCT="CWE_SELECT_PRODUCT",Ms.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM",Ms.PURCHASE="CWE_PURCHASE",Ms.COLOUR_ARRAY="CWE_COLOUR_ARRAY",Ms.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY",Ms.COLOUR_INDEX="CWE_COLOUR_INDEX",Ms.TEXT_INPUT="CWE_TEXT_INPUT",Ms.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT",Ms.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE",Ms.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES",Ms.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW",Ms.GUILD_SELECTED="CWE_GUILD_SELECTED",Ms.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED",Ms.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED",Ms.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA",Ms.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY",Ms.TOGGLE="CWE_CWE_TOGGLE",Ms.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED",Ms.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED",Ms.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";let IA=Ms;const Pm=class Pm extends se{constructor(){super(Pm.SOLD_OUT)}};Pm.SOLD_OUT="CPSOE_SOLD_OUT";let Sd=Pm;const Lm=class Lm extends se{constructor(t,e){super(Lm.UPDATE_STUFF_DATA),this._offer=t,this._stuffData=e}get offer(){return this._offer}get stuffData(){return this._stuffData}};Lm.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";let TA=Lm;const Nl=class Nl extends se{};Nl.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL",Nl.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL",Nl.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL",Nl.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST",Nl.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";let or=Nl;const yO=class yO extends se{};yO.INIT="HC_NAME_CHANGE_INIT";let Od=yO;const Um=class Um extends se{constructor(t,e){super(Um.DELETE_ITEM_CONFIRM),this._item=t,this._amount=e}get item(){return this._item}get amount(){return this._amount}};Um.DELETE_ITEM_CONFIRM="DIC_DELETE_ITEM_CONFIRM";let bg=Um;const jm=class jm extends se{constructor(t,e,s){super(jm.FURNI_ADDED),this.id=t,this.spriteId=e,this.category=s}};jm.FURNI_ADDED="IFAE_FURNI_ADDED";let Ad=jm;const Vh=class Vh extends se{};Vh.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL",Vh.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL",Vh.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";let ta=Vh;const RA=a=>a&&a.length?a.replace(/\\r/g,"\r"):"",SA=a=>{const t="0"+a;return t.substr(t.length-2,t.length)};let ju=null;const Zq=()=>{const[a,t]=_.useState([]),[e,s]=_.useState([]),[r,n]=_.useState([]),[o,l]=_.useState(!1),[c,u]=_.useState(!1),h=()=>ct("notification",{}),d=j=>{const F=h();return F?F[j]:null},f=(j,F,U,K)=>{if(j.has(U))return j.get(U);const B=["notification",F,U].join(".");return Tn().hasValue(B)||K?g(B,Array.from(j.keys()),Array.from(j.values())):null},E=(j,F)=>{let U=j.get("image");return U||(U=ct("image.library.notifications.url","").replace("%image%",F.replace(/\./g,"_"))),g(U)},m=_.useCallback((j,F=null,U=null,K=null,B=null,J=null)=>{(!B||!B.length)&&(B=g("notifications.broadcast.title")),(!F||!F.length)&&(F=Yt.DEFAULT);const Z=new Ng([RA(j)],F,U,K,B,J);t(Q=>[Z,...Q])},[]),I=_.useCallback(()=>m(null,Yt.NITRO),[m]),p=_.useCallback((j,F,U=null,K=null)=>{if(o)return;const B=new ZT(j,F,U,K);s(J=>[B,...J])},[o]),T=(j,F=null)=>{F||(F=new Map);const U=d("notification."+j);if(U)for(const ut in U)F.set(ut,U[ut]);j==="floorplan_editor.error"&&F.set("message",F.get("message").replace(/[^a-zA-Z._ ]/g,""));const K=f(F,j,"title",!0),B=f(F,j,"message",!0).replace(/\\r/g,"\r"),J=f(F,j,"linkTitle",!1),Z=f(F,j,"linkUrl",!1),Q=E(F,j);F.get("display")==="BUBBLE"?p(g(B),Ci.INFO,Q,Z):m(g(B),j,Z,J,K,Q),F.get("sound")&&ma(F.get("sound"))},R=_.useCallback((j,F,U,K=null,B=null,J=null,Z=null)=>{(!K||!K.length)&&(K=g("generic.confirm")),(!B||!B.length)&&(B=g("generic.cancel")),(!J||!J.length)&&(J=g("notifications.broadcast.title"));const Q=new $T(Z,j,F,U,K,B,J);n(ut=>[Q,...ut])},[]),S=(j,F=null,U=!0)=>{m(j,Yt.DEFAULT,F,g("mod.alert.link"),g("mod.alert.title"))},L=_.useCallback((j,F="")=>{switch(j){case Bi.ALERT_SCAM:m(g("inventory.trading.warning.other_not_offering"),null,null,null,g("inventory.trading.notification.title"));return;case Bi.HOTEL_TRADING_DISABLED:case Bi.YOU_NOT_ALLOWED:case Bi.THEY_NOT_ALLOWED:case Bi.ROOM_DISABLED:case Bi.YOU_OPEN:case Bi.THEY_OPEN:m(g(`inventory.trading.openfail.${j}`,["otherusername"],[F]),null,null,null,g("inventory.trading.openfail.title"));return;case Bi.ERROR_WHILE_COMMIT:m(`${g("inventory.trading.notification.caption")}, ${g("inventory.trading.notification.commiterror.info")}`,null,null,null,g("inventory.trading.notification.title"));return;case Bi.THEY_CANCELLED:m(g("inventory.trading.info.closed"),null,null,null,g("inventory.trading.notification.title"));return}},[m]),M=_.useCallback(j=>{t(F=>{const U=[...F],K=U.findIndex(B=>j===B);return K>=0&&U.splice(K,1),U})},[]),P=_.useCallback(j=>{s(F=>{const U=[...F],K=U.findIndex(B=>j===B);return K>=0&&U.splice(K,1),U})},[]),k=_.useCallback(j=>{n(F=>{const U=[...F],K=U.findIndex(B=>j===B);return K>=0&&U.splice(K,1),U})},[]);z(tS,j=>{const F=j.getParser();if(F.userId!==tt().userId)return;const U=g("notifications.text.respect.1"),K=g("notifications.text.respect.2",["count"],[F.respectsReceived.toString()]);p(U,Ci.RESPECT),p(K,Ci.RESPECT)}),z(Ny,j=>{const F=j.getParser();m(F.message.replace(/\\r/g,"\r"),null,null,g("notifications.broadcast.title"))}),z(Ry,j=>{const F=j.getParser(),U=g("achievements.levelup.desc"),K=vd(F.data.badgeCode),B=tt().getBadgeUrl(F.data.badgeCode),J="questengine/achievements/"+F.data.category;p(U+" "+K,Ci.ACHIEVEMENT,B,J)}),z(Oy,j=>{const F=j.getParser();F.numGifts<=0||p(F.numGifts.toString(),Ci.CLUBGIFT,null,"catalog/open/"+ct("catalog.links")["hc.hc_gifts"])}),z(Zx,j=>{const F=j.getParser();S(F.message,F.url,!1)}),z(YR,j=>{const F=j.getParser();if(F.amountChanged<=0||F.type!==5)return;const U=ct("currency.asset.icon.url","").replace("%type%",F.type.toString());p(g("notifications.text.loyalty.received",["AMOUNT"],[F.amountChanged.toString()]),Ci.INFO,U)}),z(ry,j=>{const F=j.getParser();S(F.message)}),z(ZN,j=>{const F=j.getParser();m(g("opening.hours."+(F.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[SA(F.openHour),SA(F.openMinute)]),Yt.DEFAULT,null,null,g("opening.hours.title"))}),z(Cx,async j=>{var J;const F=j.getParser(),U=g("notifications.text."+(F.boughtAsGift?"petbought":"petreceived"));let K=null;const B=rt().getRoomObjectPetImage(F.pet.typeId,F.pet.paletteId,parseInt(F.pet.color,16),new w(45*3),64,null,!0);B&&(K=(J=await B.getImage())==null?void 0:J.src),p(U,Ci.PETLEVEL,K)}),z(xy,j=>{const U=j.getParser().messages.map(B=>RA(B)),K=new Ng(U,Yt.MOTD,null,null,g("notifications.motd.title"));t(B=>[K,...B])}),z(My,async j=>{var B;const F=j.getParser();let U=null;const K=rt().getRoomObjectPetImage(F.figureData.typeId,F.figureData.paletteId,parseInt(F.figureData.color,16),new w(45*3),64,null,!0);K&&(U=(B=await K.getImage())==null?void 0:B.src),p(g("notifications.text.petlevel",["pet_name","level"],[F.petName,F.level.toString()]),Ci.PETLEVEL,U)}),z(Cy,j=>{const F=j.getParser();l(!F.enabled)}),z(TC,j=>{const F=j.getParser();if(!F.products||!F.products.length)return;const U=F.products[0];U&&p(g("notifications.text.club_gift.selected"),Ci.INFO,__.getProductImageUrl(U.productType,U.furniClassId,U.extraParam))}),z(tC,j=>{const F=j.getParser();m(g("maintenance.shutdown",["m","d"],[F.minutesUntilMaintenance.toString(),F.duration.toString()]),Yt.DEFAULT,null,null,g("opening.hours.title"))}),z(Qx,j=>{const F=j.getParser();S(F.message,F.url)}),z(yy,j=>{const F=j.getParser();T(F.type,F.parameters)}),z($N,j=>{const F=j.getParser();m(g("opening.hours.shutdown",["m"],[F.openMinute.toString()]),Yt.DEFAULT,null,null,g("opening.hours.title"))}),z(JN,j=>{const F=j.getParser();m(g("opening.hours.disconnected",["h","m"],[F.openHour.toString(),F.openMinute.toString()]),Yt.DEFAULT,null,null,g("opening.hours.title"))}),z(Ay,j=>{const F=j.getParser();switch(F.errorCode){default:case 0:m(g("connection.server.error.desc",["errorCode"],[F.errorCode.toString()]),Yt.ALERT,null,null,g("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:break;case 4013:m(g("connection.room.maintenance.desc"),Yt.ALERT,null,null,g("connection.room.maintenance.title"));break}}),z(Dy,j=>{const F=j.getParser();m(g(F.alertMessage),Yt.DEFAULT,null,null,g(F.titleMessage?F.titleMessage:"notifications.broadcast.title"))});const G=_.useCallback(()=>{if(!c)if(Cr.isRunning()){if(ju)return;ju=setTimeout(()=>{G()},Cr.totalRunningTime+5e3)}else ju&&(clearTimeout(ju),ju=null),p(g("mod.chatdisclaimer"),Ci.INFO),u(!0)},[c,p]);return z(Q_,G),{alerts:a,bubbleAlerts:e,confirms:r,simpleAlert:m,showNitroAlert:I,showTradeAlert:L,showConfirm:R,showSingleBubble:p,closeAlert:M,closeBubbleAlert:P,closeConfirm:k}},Ye=()=>gs(Zq),OA=new URLSearchParams(window.location.search).get("userid")||0,$q=(a,t)=>{a=OA?`${a}.${OA}`:a;const[e,s]=_.useState(()=>{try{return(typeof window<"u"?qT(a):void 0)??t}catch{return t}});return[e,n=>{try{const o=n instanceof Function?n(e):n;s(o),typeof window<"u"&&vS(a,o)}catch(o){Lt.error(o)}}]},Ja=$q,t7=()=>Ja(Id.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),EU=()=>gs(t7),e7=()=>Ja(Id.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),pU=()=>gs(e7),s7=-12345678,i7=()=>{const[a,t]=_.useState(!1),[e,s]=_.useState(!1),[r,n]=_.useState(-1),[o,l]=_.useState(-1),[c,u]=_.useState(Xr.NORMAL),[h,d]=_.useState(null),[f,E]=_.useState(null),[m,I]=_.useState(null),[p,T]=_.useState(null),[R,S]=_.useState([]),[L,M]=_.useState(null),[P,k]=_.useState([]),[G,j]=_.useState(null),[F,U]=_.useState(!1),[K,B]=_.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[J,Z]=_.useState({}),[Q,ut]=_.useState(!1),[Bt,te]=EU(),[de,He]=pU(),[le,qe]=_.useState(null),[vt,Vt]=_.useState(null),[xs,ie]=_.useState(0),[Ft,De]=_.useState(0),[Rs,wt]=_.useState(0),[pe,ls]=_.useState(0),[qi,Kt]=_.useState(0),[Ae,Lr]=_.useState(0),{simpleAlert:Jo=null}=Ye(),Qi=_.useRef(new rl),Gd=_.useCallback(()=>{n(-1),l(-1),d(null),E(null),I(null),T(null),S([]),M(null),k([]),t(!1)},[]),Pu=_.useCallback(et=>{if(!et)return Na.MISSING_OFFER;if(xs<0||xs>=Ft)return Na.FURNI_LIMIT_REACHED;const nt=Se();if(!nt)return Na.NOT_IN_ROOM;if(!nt.isRoomOwner)return Na.NOT_ROOM_OWNER;if(pe<=0){const dt=rt();let Mt=dt.getRoomObjectCount(nt.roomId,Y.UNIT);for(;Mt>0;){const Ie=dt.getRoomObjectByIndex(nt.roomId,Mt,Y.UNIT),ze=nt.userDataManager.getUserDataByIndex(Ie.id);if(ze&&ze.type===Pe.USER&&ze.roomIndex!==nt.ownRoomIndex&&!ze.isModerator)return Na.VISITORS_IN_ROOM;Mt--}}return Na.OKAY},[xs,Ft,pe]),Zo=_.useCallback(et=>{const nt=Se();return!!((nt&&et.page&&et.page.layoutCode!=="sold_ltd_items"&&c===Xr.NORMAL&&(nt.isRoomOwner||nt.isGuildRoom&&nt.controllerLevel>=Ce.GUILD_MEMBER)||c===Xr.BUILDER&&Pu(et)===Na.OKAY)&&et.pricingModel!==ni.PRICING_MODEL_BUNDLE&&et.product.productType!==kt.EFFECT&&et.product.productType!==kt.HABBO_CLUB)},[c,Pu]),$o=_.useCallback(et=>{if(!Zo(et))return;const nt=et.product;if(!nt)return;let dt=0;switch(nt.productType){case kt.FLOOR:dt=Y.FLOOR;break;case kt.WALL:dt=Y.WALL;break}rt().processRoomObjectPlacement(Vo.CATALOG,-et.offerId,dt,nt.productClassId,nt.extraParam)&&(qe(et),ut(!0),t(!1))},[Zo]),sc=_.useCallback((et,nt)=>{const dt=rt();let Mt=dt.getRoomInstanceVariable(dt.activeRoomId,A.ROOM_WALL_TYPE),Ie=dt.getRoomInstanceVariable(dt.activeRoomId,A.ROOM_FLOOR_TYPE),ze=dt.getRoomInstanceVariable(dt.activeRoomId,A.ROOM_LANDSCAPE_TYPE);switch(Mt=Mt&&Mt.length?Mt:"101",Ie=Ie&&Ie.length?Ie:"101",ze=ze&&ze.length?ze:"1.1",et){case"floor":dt.updateRoomInstancePlaneType(dt.activeRoomId,nt,Mt,ze,!0);return;case"wallpaper":dt.updateRoomInstancePlaneType(dt.activeRoomId,Ie,nt,ze,!0);return;case"landscape":dt.updateRoomInstancePlaneType(dt.activeRoomId,Ie,Mt,nt,!0);return;default:dt.updateRoomInstancePlaneType(dt.activeRoomId,Ie,Mt,ze,!0);return}},[]),Lu=_.useCallback(()=>{le&&(rt().cancelRoomObjectInsert(),ut(!1),qe(null))},[le]),io=_.useCallback((et=!0)=>{ut(nt=>(nt&&et&&ht("catalog/open"),!1))},[]),tl=_.useCallback((et=!1)=>{et||io(),Vt(nt=>{if(nt)switch(nt.category){case Y.FLOOR:rt().removeRoomObjectFloor(nt.roomId,nt.objectId);break;case Y.WALL:{switch(nt.furniData.className){case"floor":case"wallpaper":case"landscape":sc("reset","");break;default:rt().removeRoomObjectWall(nt.roomId,nt.objectId);break}break}default:rt().deleteRoomObject(nt.objectId,nt.category);break}return null})},[io,sc]),li=_.useCallback((et,nt)=>{if(nt.pageId===et&&nt!==h)return nt;for(const dt of nt.children){const Mt=li(et,dt);if(Mt)return Mt}return null},[h]),yn=_.useCallback((et,nt)=>{if(nt.pageName===et&&nt!==h)return nt;for(const dt of nt.children){const Mt=yn(et,dt);if(Mt)return Mt}return null},[h]),ic=_.useCallback((et,nt=!1)=>{if(!f||!f.size)return null;if(nt){const dt=[],Mt=f.get(et);if(Mt&&Mt.length)for(const Ie of Mt)Ie.isVisible&&dt.push(Ie);if(dt.length)return dt}return f.get(et)},[f]),Mn=_.useCallback((et,nt)=>{et<0||(s(!0),n(et),et>-1&&H(new mb(et,nt,c)))},[c]),n0=_.useCallback((et,nt,dt,Mt,Ie,ze)=>{const Hs=new Rg(et,nt,dt,Mt,ze);if(I(Hs),l(ee=>et!==-1?et:ee),U(!1),Ie>-1&&Hs.offers.length){for(const ee of Hs.offers)if(ee.offerId===Ie){T(ee);break}}},[]),Sa=_.useCallback((et,nt=-1)=>{if(Lu(),et.parent.pageName==="root"&&et.children.length){for(const Ie of et.children)if(Ie.isVisible){et=Ie;break}}const dt=[];let Mt=et;for(;Mt&&Mt.pageName!=="root";)dt.push(Mt),Mt=Mt.parent;dt.reverse(),S(Ie=>{const ze=Ie.indexOf(et)>=0,Hs=et.isOpen;for(const ee of Ie)ee.deactivate(),dt.indexOf(ee)===-1&&ee.close();for(const ee of dt)ee.activate(),ee.parent&&ee.open(),ee===et.parent&&ee.children.length&&ee.open();return ze&&Hs?et.close():et.open(),dt}),et.pageId>-1&&Mn(et.pageId,nt)},[S,Mn,Lu]),Uu=_.useCallback(et=>{if(et!==-1&&M(null),!a)Qi.current.requestById=et,t(!0);else{const nt=li(et,h);nt&&Sa(nt)}},[a,h,li,Sa]),lE=_.useCallback(et=>{if(M(null),!a)Qi.current.requestByName=et,t(!0);else{const nt=yn(et,h);nt&&Sa(nt)}},[a,h,yn,Sa]),cE=_.useCallback(et=>{if(M(null),!a)Qi.current.requestedByOfferId=et,t(!0);else{const nt=ic(et);if(!nt||!nt.length)return;Sa(nt[0],et)}},[a,ic,Sa]),MO=_.useCallback(()=>{},[]);return z(pC,et=>{const nt=et.getParser(),dt=new Map,Mt=(Ie,ze,Hs)=>{const ee=new VX(Ie,ze,Hs);for(const Ur of ee.offerIds)dt.has(Ur)?dt.get(Ur).push(ee):dt.set(Ur,[ee]);ze++;for(const Ur of Ie.children)ee.addChild(Mt(Ur,ze,ee));return ee};d(Mt(nt.root,0,null)),E(dt)}),z(EC,et=>{const nt=et.getParser();if(nt.catalogType!==c)return;const dt=[];for(const Mt of nt.offers){const Ie=[],ze=cu(Mt.localizationId);for(const ee of Mt.products){const Ur=YT(ee.furniClassId,ee.productType);Ie.push(new Go(ee.productType,ee.furniClassId,ee.extraParam,ee.productCount,ze,Ur,ee.uniqueLimitedItem,ee.uniqueLimitedSeriesSize,ee.uniqueLimitedItemsLeft))}if(!Ie.length)continue;const Hs=new ni(Mt.offerId,Mt.localizationId,Mt.rent,Mt.priceCredits,Mt.priceActivityPoints,Mt.priceActivityPointsType,Mt.giftable,Mt.clubLevel,Ie,Mt.bundlePurchaseAllowed);(c===Xr.NORMAL||Hs.pricingModel!==ni.PRICING_MODEL_BUNDLE&&Hs.pricingModel!==ni.PRICING_MODEL_MULTI)&&dt.push(Hs)}nt.frontPageItems&&nt.frontPageItems.length&&k(nt.frontPageItems),s(!1),r===nt.pageId&&n0(nt.pageId,nt.layoutCode,new tU(nt.localization.images.concat(),nt.localization.texts.concat()),dt,nt.offerId,nt.acceptSeasonCurrencyAsCredits)}),z(yC,et=>{const nt=et.getParser();Ps(new pa(nt.offer))}),z(CC,et=>{const nt=et.getParser();Ps(new Wo(nt.code))}),z(xC,et=>{const nt=et.getParser();Ps(new Rd(nt.code))}),z(AC,et=>{et.getParser(),Ps(new Sd)}),z(NC,et=>{const dt=et.getParser().offer;if(!dt||!dt.products.length)return;dt.products[0].uniqueLimitedItem;const Ie=[],ze=cu(dt.localizationId);for(const ee of dt.products){const Ur=YT(ee.furniClassId,ee.productType);Ie.push(new Go(ee.productType,ee.furniClassId,ee.extraParam,ee.productCount,ze,Ur,ee.uniqueLimitedItem,ee.uniqueLimitedSeriesSize,ee.uniqueLimitedItemsLeft))}const Hs=new ni(dt.offerId,dt.localizationId,dt.rent,dt.priceCredits,dt.priceActivityPoints,dt.priceActivityPointsType,dt.giftable,dt.clubLevel,Ie,dt.bundlePurchaseAllowed);(c===Xr.NORMAL||Hs.pricingModel!==ni.PRICING_MODEL_BUNDLE&&Hs.pricingModel!==ni.PRICING_MODEL_MULTI)&&(Hs.page=m,T(Hs),Hs.product&&Hs.product.productType===kt.WALL&&B(ee=>{const Ur={...ee};return Ur.extraData=Hs.product.extraParam||null,Ur}))}),z(bC,et=>{const nt=et.getParser(),dt=new HX(nt.productCode,nt.palettes.slice());Z(Mt=>{const Ie=[];Mt.petPalettes&&Ie.push(...Mt.petPalettes);for(let ze=0;ze<Ie.length;ze++)if(Ie[ze].breed===dt.breed){Ie.splice(ze,1);break}return Ie.push(dt),{...Mt,petPalettes:Ie}})}),z(OC,et=>{const nt=et.getParser();Z(dt=>{const Mt=nt.offers;return{...dt,clubOffers:Mt}})}),z(WM,et=>{const nt=et.getParser();Z(dt=>{const Mt=nt.groups;return{...dt,groups:Mt}})}),z(SC,et=>{const nt=et.getParser();Z(dt=>{const Mt=new QX(nt);return{...dt,giftConfiguration:Mt}})}),z(Vx,et=>{const nt=et.getParser();if(!nt)return;let dt="";nt.result===1?dt=g("inventory.marketplace.result.title.success"):dt=g("inventory.marketplace.result.title.failure");const Mt=g(`inventory.marketplace.result.${nt.result}`);Jo(Mt,Yt.DEFAULT,null,null,dt)}),z(vR,et=>{const nt=et.getParser();Z(dt=>({...dt,clubGifts:nt}))}),z(IC,et=>{const nt=a;Gd(),nt&&Jo(g("catalog.alert.published.description"),Yt.ALERT,null,null,g("catalog.alert.published.title"))}),z(fC,et=>{const nt=et.getParser();ie(nt.furniCount),MO()}),z(mC,et=>{const nt=et.getParser();De(nt.furniLimit),wt(nt.maxFurniLimit),ls(nt.secondsLeft),Kt(zt()),Lr(nt.secondsLeftWithGrace),MO()}),_s(pa.PURCHASE_SUCCESS,et=>ma(Ea.CREDITS)),ft(up.PLACED,et=>{if(!Q||et.type!==up.PLACED)return;if(tl(!0),!le){io();return}let nt=!1;const dt=le.product;if(et.category===Y.WALL)switch(dt.furnitureData.className){case"floor":case"wallpaper":case"landscape":nt=et.placedOnFloor||et.placedOnWall;break;default:nt=et.placedInRoom;break}else nt=et.placedInRoom;if(!nt){io();return}switch(Vt(new JX(et.roomId,et.objectId,et.category,et.wallLocation,et.x,et.y,et.direction,le)),c){case Xr.NORMAL:{switch(et.category){case Y.FLOOR:rt().addFurnitureFloor(et.roomId,et.objectId,dt.productClassId,new w(et.x,et.y,et.z),new w(et.direction),0,new Di);break;case Y.WALL:switch(dt.furnitureData.className){case"floor":case"wallpaper":case"landscape":sc(dt.furnitureData.className,dt.extraParam);break;default:rt().addFurnitureWall(et.roomId,et.objectId,dt.productClassId,new w(et.x,et.y,et.z),new w(et.direction*45),0,et.instanceData,0);break}}const Mt=rt().getRoomObject(et.roomId,et.objectId,et.category);Mt&&Mt.model.setValue(A.FURNITURE_ALPHA_MULTIPLIER,.5),de&&H(new Md(r,le.offerId,dt.extraParam,1)),Bt&&$o(le);break}case Xr.BUILDER:{let Mt=le.page.pageId;switch(Mt===s7&&(Mt=-1),et.category){case Y.FLOOR:H(new hb(Mt,le.offerId,dt.extraParam,et.x,et.y,et.direction));break;case Y.WALL:H(new db(Mt,le.offerId,dt.extraParam,et.wallLocation));break}Bt&&$o(le);break}}}),_s(Ad.FURNI_ADDED,et=>{const nt=rt();if(!(!vt||vt.productClassId!==et.spriteId||vt.roomId!==nt.activeRoomId)){switch(et.category){case Dt.FLOOR:{const dt=nt.getRoomInstanceVariable(nt.activeRoomId,A.ROOM_FLOOR_TYPE);vt.extraParam!==dt&&H(new Yu(et.id));break}case Dt.WALL_PAPER:{const dt=nt.getRoomInstanceVariable(nt.activeRoomId,A.ROOM_WALL_TYPE);vt.extraParam!==dt&&H(new Yu(et.id));break}case Dt.LANDSCAPE:{const dt=nt.getRoomInstanceVariable(nt.activeRoomId,A.ROOM_LANDSCAPE_TYPE);vt.extraParam!==dt&&H(new Yu(et.id));break}default:H(new hS(et.id,vt.category,vt.wallLocation,vt.x,vt.y,vt.direction))}Bt||tl()}}),_.useEffect(()=>()=>T(null),[m]),_.useEffect(()=>{if(!(!a||!h||!f||!Qi.current))switch(Qi.current.requestType){case rl.REQUEST_TYPE_NONE:if(m)return;if(h.isBranch){for(const et of h.children)if(et&&et.isVisible){Sa(et);return}}return;case rl.REQUEST_TYPE_ID:Uu(Qi.current.requestById),Qi.current.resetRequest();return;case rl.REQUEST_TYPE_OFFER:cE(Qi.current.requestedByOfferId),Qi.current.resetRequest();return;case rl.REQUEST_TYPE_NAME:lE(Qi.current.requestByName),Qi.current.resetRequest();return}},[a,h,f,m,Sa,Uu,cE,lE]),_.useEffect(()=>{!L&&m&&m.pageId===-1&&Uu(o)},[L,m,o,Uu]),_.useEffect(()=>{p&&B({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null})},[p]),_.useEffect(()=>{!a||h||(H(new pb),H(new eS),H(new fb(c)),H(new _b))},[a,h,c]),_.useEffect(()=>(j(new xu(rt(),++xu.PREVIEW_COUNTER)),()=>{j(et=>(et.dispose(),null))}),[]),{isVisible:a,setIsVisible:t,isBusy:e,pageId:r,previousPageId:o,currentType:c,rootNode:h,offersToNodes:f,currentPage:m,setCurrentPage:I,currentOffer:p,setCurrentOffer:T,activeNodes:R,searchResult:L,setSearchResult:M,frontPageItems:P,roomPreviewer:G,navigationHidden:F,setNavigationHidden:U,purchaseOptions:K,setPurchaseOptions:B,catalogOptions:J,setCatalogOptions:Z,getNodeById:li,getNodeByName:yn,activateNode:Sa,openPageById:Uu,openPageByName:lE,openPageByOfferId:cE,requestOfferToMover:$o}},be=()=>gs(i7),r7=1e3,n7=10,a7=1e3;let o7=0,l7=0;const c7=()=>{const[a,t]=Ja("chatHistory",[]),[e,s]=Ja("roomHistory",[]),[r,n]=Ja("messengerHistory",[]),[o,l]=Ja("needsRoomInsert",!1),c=d=>{d.id=o7++,t(f=>{const E=[...f];return E.push(d),E.length>r7&&E.shift(),E})},u=d=>{s(f=>{const E=[...f];return E.push(d),E.length>n7&&E.shift(),E})},h=d=>{d.id=l7++,n(f=>{const E=[...f];return E.push(d),E.length>a7&&E.shift(),E})};return ft(yt.STARTED,d=>l(!0)),z($a,d=>{if(!o)return;const f=d.getParser();e.length&&e[e.length-1].id===f.data.roomId||(c({id:-1,webId:-1,entityId:-1,name:f.data.roomName,timestamp:sU(),type:On.TYPE_ROOM_INFO,roomId:f.data.roomId}),u({id:f.data.roomId,name:f.data.roomName}),l(!1))}),z(PR,d=>{const f=d.getParser();h({id:-1,webId:f.senderId,entityId:-1,name:"",message:f.messageText,roomId:-1,timestamp:aA(f.secondsSinceSent),type:On.TYPE_IM})}),z(UR,d=>{const f=d.getParser();h({id:-1,webId:f.senderId,entityId:-1,name:"",message:f.messageText,roomId:-1,timestamp:aA(),type:On.TYPE_IM})}),{addChatEntry:c,chatHistory:a,roomHistory:e,messengerHistory:r}},jd=()=>gs(c7),u7=()=>{const[a,t]=_.useState([]),[e,s]=_.useState([]),[r,n]=_.useState([]),[o,l]=_.useState([]),[c,u]=_.useState(null),{simpleAlert:h}=Ye(),d=_.useMemo(()=>{const S=a.filter(L=>L.online);return S.sort((L,M)=>L.name.toLowerCase().localeCompare(M.name.toLowerCase())),S},[a]),f=_.useMemo(()=>{const S=a.filter(L=>!L.online);return S.sort((L,M)=>L.name.toLowerCase().localeCompare(M.name.toLowerCase())),S},[a]),E=S=>H(new Ym(S.id)),m=(S,L)=>L!==S.relationshipStatus&&H(new mc(S.id,L)),I=S=>{for(const L of a)if(L.id===S)return L;return null},p=S=>!(S===tt().userId||I(S)||e.find(L=>L.requesterUserId===S)||r.indexOf(S)>=0),T=(S,L)=>{if(!p(S))return!1;n(M=>{const P=[...M];return P.push(S),P}),H(new iS(L))},R=(S,L)=>{S===-1&&!L?(H(new PI(!0)),s([])):s(M=>{const P=[...M],k=P.findIndex(G=>G.id===S);return k===-1?M:(H(L?new vb(P[k].id):new PI(!1,P[k].id)),P.splice(k,1),P)})};return z(WC,S=>{const L=S.getParser();u(new uq(L.userFriendLimit,L.normalFriendLimit,L.extendedFriendLimit,L.categories)),H(new Ub)}),z(kC,S=>{const L=S.getParser();t(M=>{const P=[...M];for(const k of L.fragment){const G=P.findIndex(F=>F.id===k.id),j=new Wi;j.populate(k),G>-1?P[G]=j:P.push(j)}return P})}),z(BC,S=>{const L=S.getParser();t(M=>{const P=[...M],k=G=>{const j=P.findIndex(F=>F.id===G.id);if(j===-1){const F=new Wi;F.populate(G),P.unshift(F)}else P[j].populate(G)};for(const G of L.addedFriends)k(G);for(const G of L.updatedFriends)k(G);for(const G of L.removedFriendIds){const j=P.findIndex(F=>F.id===G);j>-1&&P.splice(j,1)}return P})}),z(VC,S=>{const L=S.getParser();s(M=>{const P=[...M];for(const k of L.requests){const G=P.findIndex(j=>j.requesterUserId===k.requesterUserId);if(G>=0)P[G]=bi(P[G]),P[G].populate(k);else{const j=new oA;j.populate(k),P.push(j)}}return P})}),z(GC,S=>{const L=S.getParser();L&&h(g(L.success?"friendbar.find.success.text":"friendbar.find.error.text"),"","","",g(L.success?"friendbar.find.success.title":"friendbar.find.error.title"))}),z(LR,S=>{const M=S.getParser().request;s(P=>{const k=[...P];if(k.findIndex(j=>j.requesterUserId===M.requesterUserId)===-1){const j=new oA;j.populate(M),k.push(j)}return k})}),_.useEffect(()=>{H(new wb);const S=window.setInterval(()=>H(new Lb),12e4);return()=>{clearInterval(S)}},[]),{friends:a,requests:e,sentRequests:r,dismissedRequestIds:o,setDismissedRequestIds:l,settings:c,onlineFriends:d,offlineFriends:f,getFriend:I,canRequestFriend:p,requestFriend:T,requestResponse:R,followFriend:E,updateRelationship:m}},gr=()=>gs(u7),h7=()=>{const[a,t]=_.useState([]),[e,s]=_.useState(-1),[r,n]=_.useState([]),[o,l]=_.useState(oa.HIDDEN),{getFriend:c=null}=gr(),{simpleAlert:u=null}=Ye(),h=_.useMemo(()=>a.filter(I=>r.indexOf(I.threadId)===-1),[a,r]),d=_.useMemo(()=>e>0&&h.find(I=>I.threadId===e||null),[e,h]),f=I=>{let p=a.find(T=>T.participant&&T.participant.id===I);if(p){const T=r.indexOf(p.threadId);T>=0&&n(R=>{const S=[...R];return S.splice(T,1),S})}else{const T=c(I);if(!T)return null;p=new XT(T),p.addMessage(null,g("messenger.moderationinfo"),0,null,Qa.SECURITY_NOTIFICATION),p.setRead(),t(R=>{const S=[...R];return S.push(p),S})}return p},E=I=>{n(p=>{const T=[...p];return T.indexOf(I)>=0?p:(T.push(I),T)}),e===I&&s(-1)},m=(I,p,T,R=0,S=null,L=Qa.CHAT)=>{if(!I||!T||!T.length)return;const M=p===tt().userId;M&&T.length<=255&&H(new Gb(I.participant.id,T)),t(P=>{const k=[...P],G=k.findIndex(j=>j.threadId===I.threadId);return G===-1?P:(I=bi(k[G]),M&&I.groups.length===1&&ma(Ea.MESSENGER_NEW_THREAD),I.addMessage(L===Qa.ROOM_INVITE?null:p,T,R,S,L),e===I.threadId&&I.setRead(),k[G]=I,!M&&I.unread&&ma(Ea.MESSENGER_MESSAGE_RECEIVED),k)})};return z(PR,I=>{const p=I.getParser(),T=f(p.senderId);T&&m(T,p.senderId,p.messageText,p.secondsSinceSent,p.extraData)}),z(UR,I=>{const p=I.getParser(),T=f(p.senderId);T&&m(T,p.senderId,p.messageText,0,null,Qa.ROOM_INVITE)}),z(YC,I=>{const p=I.getParser();u(`Received room invite error: ${p.errorCode},recipients: ${p.failedRecipients}`,Yt.DEFAULT,null,null,g("friendlist.alert.title"))}),_.useEffect(()=>{e<=0||t(I=>{const p=[...I],T=p.findIndex(R=>R.threadId===e);return T>=0&&(p[T]=bi(p[T]),p[T].setRead()),p})},[e]),_.useEffect(()=>{l(I=>{if(!h.length)return oa.HIDDEN;let p=!1;for(const T of h)if(T.unreadCount>0){p=!0;break}return p?oa.UNREAD:oa.SHOW})},[h]),{messageThreads:a,activeThread:d,iconState:o,visibleThreads:h,getMessageThread:f,setActiveThreadId:s,closeThread:E,sendMessage:m}},IU=()=>gs(h7),d7=()=>{const[a,t]=_.useState(!1),[e,s]=_.useState(null),[r,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(!1),[h,d]=_.useState(null);return z(KC,f=>{let E=f.getParser();!E||E&&!E.games.length||(n(E.games[0]),s(E.games))}),z(zC,f=>{let E=f.getParser();E&&l(E)}),z(XC,f=>{let E=f.getParser();E&&u(E.isInMaintenance)}),z(jR,f=>{let E=f.getParser();if(E)switch(E.gameTypeId){case 2:return console.log("snowwar");default:return d(E.url)}}),_.useEffect(()=>{a&&(H(new Hb),yS())},[a]),{isVisible:a,setIsVisible:t,games:e,accountStatus:o,selectedGame:r,setSelectedGame:n,gameOffline:c,gameURL:h,setGameURL:d}},$m=()=>gs(d7),_7=()=>{const[a,t]=_.useState(null);return z(wR,e=>{const s=e.getParser(),r={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};s.bases.forEach((o,l)=>r.badgeBases.push({id:l,images:o})),s.symbols.forEach((o,l)=>r.badgeSymbols.push({id:l,images:o})),s.partColors.forEach((o,l)=>r.badgePartColors.push({id:l,color:o})),s.colorsA.forEach((o,l)=>r.groupColorsA.push({id:l,color:o})),s.colorsB.forEach((o,l)=>r.groupColorsB.push({id:l,color:o}));const n=(o,l)=>o.id<l.id?-1:o.id>l.id?1:0;r.badgeBases.sort(n),r.badgeSymbols.sort(n),r.badgePartColors.sort(n),r.groupColorsA.sort(n),r.groupColorsB.sort(n),t(r)}),_.useEffect(()=>{H(new qb)},[]),{groupCustomize:a}},wd=()=>gs(_7),g7=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),{simpleAlert:r=null,showConfirm:n=null}=Ye(),o=(l,c)=>{const u={reportType:l,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(l){case ns.BULLY:case ns.EMERGENCY:case ns.IM:u.reportedUserId=c.reportedUserId,u.currentStep=Ii.SELECT_CHATS;break;case ns.ROOM:u.roomId=c.roomId,u.roomName=c.roomName,u.currentStep=Ii.SELECT_TOPICS;break;case ns.THREAD:u.groupId=c.groupId,u.threadId=c.threadId,u.currentStep=Ii.SELECT_TOPICS;break;case ns.MESSAGE:u.groupId=c.groupId,u.threadId=c.threadId,u.messageId=c.messageId,u.currentStep=Ii.SELECT_TOPICS;break;case ns.PHOTO:u.extraData=c.extraData,u.roomId=c.roomId,u.reportedUserId=c.reportedUserId,u.roomObjectId=c.roomObjectId,u.currentStep=Ii.SELECT_TOPICS;break}t(u)};return z(ax,l=>{const c=l.getParser();let u=c.messageText;switch(c.resultType){case Og.TOO_MANY_PENDING_CALLS_CODE:H(new SD),r(g("help.cfh.error.pending"),Yt.MODERATION,null,null,g("help.cfh.error.title"));break;case Og.HAS_ABUSIVE_CALL_CODE:r(g("help.cfh.error.abusive"),Yt.MODERATION,null,null,g("help.cfh.error.title"));break;default:u.trim().length===0&&(u=g("help.cfh.sent.text")),r(u,Yt.MODERATION,null,null,g("help.cfh.sent.title"))}}),z(gx,l=>{const c=l.getParser(),u=c.messageText.length===0?g("help.cfh.closed."+mq(c.closeReason)):c.messageText;r(u,Yt.MODERATION,null,null,g("mod.alert.title"))}),z(rx,l=>{const c=l.getParser();c.count>0&&n(g("help.emergency.pending.title")+`
`+c.pendingCalls[0].message,()=>{H(new TD)},null,g("help.emergency.pending.button.discard"),g("help.emergency.pending.button.keep"),g("help.emergency.pending.message.subtitle"))}),z(ix,l=>{r("Your pending calls were deleted",Yt.MODERATION,null,null,g("mod.alert.title"))}),z(nx,l=>{const c=l.getParser();r(c.message,Yt.MODERATION,null,null,g("help.cfh.reply.title"))}),z(sx,l=>{const c=l.getParser();r(g("help.emergency.global_mute.message"),Yt.MODERATION,c.infoUrl,g("help.emergency.global_mute.link"),g("help.emergency.global_mute.subtitle"))}),z(oC,l=>{const c=l.getParser();s(c)}),{activeReport:a,setActiveReport:t,sanctionInfo:e,setSanctionInfo:s,report:o}},en=()=>gs(g7),tE=()=>{const[a,t]=_.useState([]),e=_.useMemo(()=>!!a.length,[a]),s=_.useCallback(()=>{let n=-1;return t(o=>{const l=[...o];return n=l.length?l[l.length-1]+1:0,l.push(n),l}),n},[]),r=_.useCallback(n=>{t(o=>{const l=[...o],c=l.indexOf(n);return c===-1?o:(l.splice(c,1),l)})},[]);return{isVisible:e,activate:s,deactivate:r}},f7=a=>H(new HD(a)),m7=(a,t)=>H(new WD(a,...t)),E7=()=>{const[a,t]=_.useState(new Map),e=_.useCallback(c=>{var u;return((u=a.get(c))==null?void 0:u.length)||0},[a]),s=_.useMemo(()=>{let c=0;for(const u of a.keys())c+=e(u);return c},[a,e]),r=_.useCallback(c=>{let u=!0;return t(h=>{if(!h.has(c))return u=!1,h;const d=new Map(h);return d.delete(c),f7(c),d}),u},[]),n=_.useCallback((c,u)=>{let h=!0;return t(d=>{if(!d.has(c))return h=!1,d;const f=new Map(d),E=f.get(c);if(E)for(const m of u)E.splice(E.indexOf(m),1);return m7(c,u),f}),h},[]),o=_.useCallback((c,u)=>a.has(c)?a.get(c).indexOf(u)>=0:!1,[a]),l=_.useCallback((c,u)=>{t(h=>{if(!h.has(c))return h;const d=new Map(h),f=d.get(c),E=f.indexOf(u);return E>=0&&f.splice(E,1),d})},[]);return z(vy,c=>{const u=c.getParser();t(h=>{const d=new Map(h);for(const f of u.categories){let E=d.get(f);E||(E=[],d.set(f,E));const m=u.getItemsByCategory(f);for(const I of m)E.indexOf(I)===-1&&E.push(I)}return d})}),{getCount:e,getFullCount:s,resetCategory:r,resetItems:n,isUnseen:o,removeUnseen:l}},vr=()=>gs(E7),p7=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[r,n]=_.useState(new Map),[o,l]=_.useState([]),[c,u]=_.useState(null),{isVisible:h=!1,activate:d=null,deactivate:f=null}=tE(),{isUnseen:E=null,resetCategory:m=null}=vr(),I=ct("user.badges.max.slots",5),p=L=>o.indexOf(L)>=0,T=()=>o.length<I,R=L=>{l(M=>{const P=[...M],k=P.indexOf(L);if(k===-1){if(!T())return M;P.push(L)}else P.splice(k,1);const G=new vD;for(let j=0;j<I;j++)G.addActivatedBadge(P[j]??"");return H(G),P})},S=L=>e.indexOf(L)===-1?0:r.get(L)??0;return z(Ix,L=>{const M=L.getParser(),P=[];n(k=>{const G=new Map(k);return M.getAllBadgeCodes().forEach(j=>{const F=e.indexOf(j)>=0,U=M.getBadgeId(j);G.set(j,U),!F&&P.push(j)}),G}),l(M.getActiveBadgeCodes()),s(k=>[...k,...P])}),z(px,L=>{const M=L.getParser(),P=E(as.BADGE,M.badgeId);s(k=>{const G=[...k];return P?G.unshift(M.badgeCode):G.push(M.badgeCode),G}),n(k=>{const G=new Map(k);return G.set(M.badgeCode,M.badgeId),G})}),_.useEffect(()=>{!e||!e.length||u(L=>{let M=L;return M&&e.indexOf(M)===-1&&(M=null),M||(M=e[0]),M})},[e]),_.useEffect(()=>{if(h)return()=>{m(as.BADGE)}},[h,m]),_.useEffect(()=>{!h||!a||(H(new DD),t(!1))},[h,a]),{badgeCodes:e,activeBadgeCodes:o,selectedBadgeCode:c,setSelectedBadgeCode:u,isWearingBadge:p,canWearBadges:T,toggleBadge:R,getBadgeId:S,activate:d,deactivate:f}},eE=()=>gs(p7),I7=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[r,n]=_.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=tE(),{isUnseen:u=null,resetCategory:h=null}=vr();return z(iC,d=>{const f=d.getParser();s(E=>{const m=[...E],I=m.map(T=>T.botData.id),p=[];for(const T of f.items.values())I.indexOf(T.id)===-1&&p.push(T);for(const T of I){let R=!0;for(const M of f.items.values())if(M.id===T){R=!1;break}if(!R)continue;const S=m.findIndex(M=>M.botData.id===T),L=m[S];S===-1||!L||(yu()===L.botData.id&&(Td(),ht("inventory/open")),m.splice(S,1))}for(const T of p){const R={botData:T};u(as.BOT,T.id)?m.unshift(R):m.push(R)}return m})}),z(sC,d=>{const f=d.getParser();s(E=>{const m=[...E];if(m.findIndex(R=>R.botData.id===f.item.id)>=0)return E;const p={botData:f.item};return u(as.BOT,p.botData.id)?m.unshift(p):m.push(p),m})}),z(rC,d=>{const f=d.getParser();s(E=>{const m=[...E],I=m.findIndex(p=>p.botData.id===f.itemId);return I===-1?E:(m.splice(I,1),yu()===f.itemId&&(Td(),ht("inventory/show")),m)})}),_.useEffect(()=>{!e||!e.length||n(d=>{let f=d;return f&&e.indexOf(f)===-1&&(f=null),f||(f=e[0]),f})},[e]),_.useEffect(()=>{if(o)return()=>{h(as.BOT)}},[o,h]),_.useEffect(()=>{!o||!a||(H(new FI),t(!1))},[o,a]),{botItems:e,selectedBot:r,setSelectedBot:n,activate:l,deactivate:c}},TU=()=>gs(I7);let Qd=null;const T7=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[r,n]=_.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=tE(),{isUnseen:u=null,resetCategory:h=null}=vr(),d=m=>{if(!(!e||!e.length))return e.filter(I=>I.type===m)},f=m=>{if(!(!e||!e.length)){for(const I of e){const p=I.getItemById(m);if(p&&p.isWallItem)return I}return null}},E=m=>{if(!(!e||!e.length)){for(const I of e){const p=I.getItemById(m);if(p&&!p.isWallItem)return I}return null}};return z(VR,m=>{const I=m.getParser();s(p=>{const T=[...p];for(const R of I.items){let S=0,L=null;for(;S<T.length;){const M=T[S];let P=0;for(;P<M.items.length;){const k=M.items[P];if(k.id===R.itemId){k.update(R);const G=[...M.items];G[P]=k,M.items=G,L=M;break}P++}if(L)break;S++}if(L)L.hasUnseenItems=!0,T[S]=bi(L);else{const M=new pd(R);dA(T,M,u(as.FURNI,R.itemId)),Ps(new Ad(M.id,M.type,M.category))}}return T})}),z(K_,m=>{const I=m.getParser();Qd||(Qd=new Array(I.totalFragments));const p=Aq(I.fragment,I.totalFragments,I.fragmentNumber,Qd);p&&(s(T=>{const R=[...T],S=Nq(R);for(const L of S){if(p.get(L))continue;let M=0;for(;M<R.length;){const P=R[M],k=P.remove(L);if(!k){M++;continue}yu()===k.ref&&(Td(),Mu(P)||ht("inventory/show")),P.getTotalCount()<=0&&(R.splice(M,1),P.dispose());break}}for(const L of p.keys()){if(S.indexOf(L)>=0)continue;const M=p.get(L);if(!M)continue;const P=new pd(M);dA(R,P,u(as.FURNI,L)),Ps(new Ad(P.id,P.type,P.category))}return R}),Qd=null)}),z(Rx,m=>{t(!0)}),z(HR,m=>{const I=m.getParser();s(p=>{const T=[...p];let R=0;for(;R<T.length;){const S=T[R],L=S.remove(I.itemId);if(!L){R++;continue}yu()===L.ref&&(Td(),Mu(S)||ht("inventory/show")),S.getTotalCount()<=0&&(T.splice(R,1),S.dispose());break}return T})}),z(Sx,m=>{}),_.useEffect(()=>{!e||!e.length||n(m=>{let I=m;return I&&e.indexOf(I)===-1&&(I=null),I||(I=e[0]),I})},[e]),_.useEffect(()=>{if(o)return()=>{h(as.FURNI)&&s(m=>{const I=[...m];for(const p of I)p.hasUnseenItems=!1;return I})}},[o,h]),_.useEffect(()=>{!o||!a||(H(new LD),t(!1))},[o,a]),{isVisible:o,groupItems:e,setGroupItems:s,selectedItem:r,setSelectedItem:n,activate:l,deactivate:c,getWallItemById:f,getFloorItemById:E,getItemsByType:d}},tc=()=>gs(T7);let Jd=null;const R7=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[r,n]=_.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=tE(),{isUnseen:u=null,resetCategory:h=null}=vr();return z(Nx,d=>{const f=d.getParser();Jd||(Jd=new Array(f.totalFragments));const E=Mq(f.fragment,f.totalFragments,f.fragmentNumber,Jd);E&&(s(m=>{const I=[...m];return yq(I,E,u),I}),Jd=null)}),z(Ax,d=>{const f=d.getParser();s(E=>{const m=[...E];return cU(f.pet,m,u(as.PET,f.pet.id)),m})}),z(xx,d=>{const f=d.getParser();s(E=>{const m=[...E];return uU(f.petId,m),m})}),_.useEffect(()=>{!e||!e.length||n(d=>{let f=d;return f&&e.indexOf(f)===-1&&(f=null),f||(f=e[0]),f})},[e]),_.useEffect(()=>{if(o)return()=>{h(as.PET)}},[o,h]),_.useEffect(()=>{!o||!a||(H(new GI),t(!1))},[o,a]),{petItems:e,selectedPet:r,setSelectedPet:n,activate:l,deactivate:c}},RU=()=>gs(R7),S7=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[r,n]=_.useState(Fs.TRADING_STATE_READY),{groupItems:o=[],setGroupItems:l=null,activate:c=null,deactivate:u=null}=tc(),{simpleAlert:h=null,showTradeAlert:d=null}=Ye(),f=r>=Fs.TRADING_STATE_RUNNING,E=()=>{switch(r){case Fs.TRADING_STATE_RUNNING:!e.itemCount&&!a.accepts&&h(g("inventory.trading.warning.other_not_offering"),null,null,null),a.accepts?H(new VD):H(new UD);return;case Fs.TRADING_STATE_CONFIRMING:H(new FD),n(Fs.TRADING_STATE_CONFIRMED);return}},m=p=>{const T=p.getLastItem();T&&H(new kD(T.id))},I=()=>{if(f)switch(r){case Fs.TRADING_STATE_RUNNING:H(new wD);return;default:H(new jD);return}};return z(yx,p=>{const T=p.getParser();!a||!e||(a.userId===T.userID?t(R=>{const S=bi(R);return S.accepts=T.userAccepts,S}):e.userId===T.userID&&s(R=>{const S=bi(R);return S.accepts=T.userAccepts,S}))}),z(Mx,p=>{const T=p.getParser();T.reason===W_.ERROR_WHILE_COMMIT?d(Bi.ERROR_WHILE_COMMIT):a&&T.userID!==a.userId&&d(Bi.THEY_CANCELLED),t(null),s(null),n(Fs.TRADING_STATE_READY)}),z(bx,p=>{p.getParser(),t(null),s(null),n(Fs.TRADING_STATE_READY)}),z(Dx,p=>{p.getParser(),n(Fs.TRADING_STATE_COUNTDOWN)}),z(vx,p=>{const T=p.getParser(),R=fA(T.firstUserItemArray),S=fA(T.secondUserItemArray);t(L=>{const M=bi(L);M.userId===T.firstUserID?(M.creditsCount=T.firstUserNumCredits,M.itemCount=T.firstUserNumItems,M.userItems=R):(M.creditsCount=T.secondUserNumCredits,M.itemCount=T.secondUserNumItems,M.userItems=S);const P=[];for(const k of M.userItems.getValues()){let G=0;for(;G<k.getTotalCount();){const j=k.getItemByIndex(G);j&&P.push(j.ref),G++}}return l(k=>{const G=[...k];for(const j of G)j.lockItemIds(P);return G}),M}),s(L=>{const M=bi(L);return M.userId===T.firstUserID?(M.creditsCount=T.firstUserNumCredits,M.itemCount=T.firstUserNumItems,M.userItems=R):(M.creditsCount=T.secondUserNumCredits,M.itemCount=T.secondUserNumItems,M.userItems=S),M})}),z(Px,p=>{p.getParser()}),z(Lx,p=>{const T=p.getParser(),R=new _A,S=Se().userDataManager.getUserData(T.userID);R.userItems=new Is;const L=new _A,M=Se().userDataManager.getUserData(T.otherUserID);L.userItems=new Is,S.webID===tt().userId?(R.userId=S.webID,R.userName=S.name,R.canTrade=T.userCanTrade,L.userId=M.webID,L.userName=M.name,L.canTrade=T.otherUserCanTrade):M.webID===tt().userId&&(R.userId=M.webID,R.userName=M.name,R.canTrade=T.otherUserCanTrade,L.userId=S.webID,L.userName=S.name,L.canTrade=T.userCanTrade),t(R),s(L),n(Fs.TRADING_STATE_RUNNING)}),z(Ux,p=>{const T=p.getParser();d(T.reason,T.otherUserName)}),z(jx,p=>{p.getParser(),d(Bi.THEY_NOT_ALLOWED)}),z(wx,p=>{p.getParser(),d(Bi.YOU_NOT_ALLOWED)}),_.useEffect(()=>{if(r===Fs.TRADING_STATE_READY)return;const p=c();return()=>u(p)},[r,c,u]),{ownUser:a,otherUser:e,tradeState:r,setTradeState:n,isTrading:f,groupItems:o,progressTrade:E,removeItem:m,stopTrading:I}},SU=()=>gs(S7),O7=()=>{const[a,t]=_.useState(null),[e,s]=_.useState([]),[r,n]=_.useState([]),[o,l]=_.useState([]),[c,u]=_.useState([]),[h,d]=_.useState([]),[f,E]=_.useState([]),{simpleAlert:m=null}=Ye(),I=U=>{e.indexOf(U)>=0||s(K=>[...K,U])},p=U=>{s(K=>{const B=[...K],J=B.indexOf(U);return J>=0&&B.splice(J),B})},T=U=>{e.indexOf(U)>=0?p(U):I(U)},R=U=>{r.indexOf(U)>=0||n(K=>[...K,U])},S=U=>{n(K=>{const B=[...K],J=B.indexOf(U);return J>=0&&B.splice(J),B})},L=U=>{r.indexOf(U)>=0?S(U):R(U)},M=U=>{o.indexOf(U)>=0||l(K=>[...K,U])},P=U=>{l(K=>{const B=[...K],J=B.indexOf(U);return J>=0&&B.splice(J),B})},k=U=>{o.indexOf(U)>=0?P(U):M(U)},G=U=>{c.indexOf(U)>=0||u(K=>[...K,U])},j=U=>{u(K=>{const B=[...K],J=B.indexOf(U);return J>=0&&B.splice(J),B})},F=U=>{r.indexOf(U)>=0?j(U):G(U)};return z(Jx,U=>{const B=U.getParser().data;t(B),d(B.issues)}),z(Kx,U=>{const K=U.getParser();d(B=>{const J=[...B],Z=J.findIndex(Q=>Q.issueId===K.issueData.issueId);return Z>=0?J[Z]=K.issueData:(J.push(K.issueData),ma(Ea.MODTOOLS_NEW_TICKET)),J})}),z(ty,U=>{U.getParser()}),z(Xx,U=>{U.getParser()&&m("Failed to pick issue",Yt.DEFAULT,null,null,"Error")}),z(zx,U=>{const K=U.getParser();d(B=>{const J=[...B],Z=J.findIndex(Q=>Q.issueId===K.issueId);return Z>=0&&J.splice(Z,1),J})}),z(qx,U=>{U.getParser().success?m("Moderation action was successfull",Yt.MODERATION,null,null,"Success"):m("There was a problem applying tht moderation action",Yt.MODERATION,null,null,"Error")}),z(aC,U=>{const K=U.getParser();E(K.callForHelpCategories)}),z(nC,U=>{U.getParser()}),{settings:a,openRooms:e,openRoomChatlogs:r,openUserChatlogs:c,openUserInfos:o,cfhCategories:f,tickets:h,openRoomInfo:I,closeRoomInfo:p,toggleRoomInfo:T,openRoomChatlog:R,closeRoomChatlog:S,toggleRoomChatlog:L,openUserInfo:M,closeUserInfo:P,toggleUserInfo:k,openUserChatlog:G,closeUserChatlog:j,toggleUserChatlog:F}},vu=()=>gs(O7),A7=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[r,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState({roomInfo:null,state:We.NONE}),[h,d]=_.useState(null),[f,E]=_.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0}),{simpleAlert:m=null}=Ye();return z(py,I=>{const p=I.getParser();H(new ad(p.roomId,!1,!1))}),z(uy,I=>{const p=I.getParser();p.canCreate||m(g(`navigator.cannotcreateevent.error.${p.errorCode}`),null,null,null,g("navigator.cannotcreateevent.title"))}),z(Su,I=>{H(new fv),H(new aS)}),z(qR,I=>{const p=I.getParser();E(T=>{const R={...T};return R.eventMod=p.securityLevel>=kl.MODERATOR,R.roomPicker=p.securityLevel>=kl.COMMUNITY,R})}),z(Xy,I=>{const p=I.getParser();Li(p.roomId)}),z(KR,I=>{const p=I.getParser();E(T=>{const R={...T};return R.enteredGuestRoom=null,R.currentRoomOwner=p.isOwner,R.currentRoomId=p.roomId,R}),H(new ad(p.roomId,!0,!1)),re.available&&re.call("legacyTrack","navigator","private",[p.roomId])}),z($a,I=>{const p=I.getParser();if(p.roomEnter)u({roomInfo:null,state:We.NONE}),E(T=>{const R={...T};return R.enteredGuestRoom=p.data,R.currentRoomIsStaffPick=p.staffPick,!(R.createdFlatId===p.data.roomId)&&p.data.displayRoomEntryAd&&ct("roomenterad.habblet.enabled",!1)&&Nn.openRoomEnterAd(),R.createdFlatId=0,R.enteredGuestRoom&&R.enteredGuestRoom.habboGroupId>0,R});else if(p.roomForward){if(p.data.ownerName!==tt().userName&&!p.isGroupMember)switch(p.data.doorMode){case je.DOORBELL_STATE:u(T=>{const R={...T};return R.roomInfo=p.data,R.state=We.START_DOORBELL,R});return;case je.PASSWORD_STATE:u(T=>{const R={...T};return R.roomInfo=p.data,R.state=We.START_PASSWORD,R});return}if(p.data.doorMode===je.NOOB_STATE&&!tt().isAmbassador&&!tt().isRealNoob&&!tt().isModerator)return;vl(p.data.roomId)}else E(T=>{const R={...T};return R.enteredGuestRoom=p.data,R.currentRoomIsStaffPick=p.staffPick,R})}),z(Jy,I=>{const p=I.getParser();E(T=>{const R={...T};return R.currentRoomRating=p.totalLikes,R.canRate=p.canLike,R})}),z(WR,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(T=>{const R={...T};return R.state=We.STATE_WAITING,R})}),z(q_,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(T=>{const R={...T};return R.state=We.STATE_ACCEPTED,R})}),z(X_,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(T=>{const R={...T};return R.state=We.STATE_NO_ANSWER,R})}),z(z_,I=>{switch(I.getParser().errorCode){case-100002:u(T=>{const R={...T};return R.state=We.STATE_WRONG_PASSWORD,R});return;case 4009:m(g("navigator.alert.need.to.be.vip"),Yt.DEFAULT,null,null,g("generic.alert.title"));return;case 4010:m(g("navigator.alert.invalid_room_name"),Yt.DEFAULT,null,null,g("generic.alert.title"));return;case 4011:m(g("navigator.alert.cannot_perm_ban"),Yt.DEFAULT,null,null,g("generic.alert.title"));return;case 4013:m(g("navigator.alert.room_in_maintenance"),Yt.DEFAULT,null,null,g("generic.alert.title"));return}}),z(_y,I=>{const p=I.getParser();l(p.topLevelContexts),n(p.topLevelContexts.length?p.topLevelContexts[0]:null)}),z(fy,I=>{const p=I.getParser();n(T=>{let R=T;if(R||(R=o&&o.length&&o[0]||null),!R)return null;if(p.result.code!==R.code&&o&&o.length)for(const S of o)S.code===p.result.code&&(R=S);for(const S of o)S.code===p.result.code&&(R=S);return R}),d(p.result)}),z(Ty,I=>{const p=I.getParser();t(p.categories)}),z(Iy,I=>{const p=I.getParser();s(p.categories)}),z(hy,I=>{const p=I.getParser();vl(p.roomId)}),z(dy,I=>{const p=I.getParser();let T=!1;if(E(L=>{T=L.settingsReceived;const M={...L};return M.homeRoomId=p.homeRoomId,M.settingsReceived=!0,M}),T)return;let R=-1,S=-1;ct("friend.id")!==void 0&&parseInt(ct("friend.id"))>0&&(R=0,H(new Ym(parseInt(ct("friend.id"))))),ct("forward.type")!==void 0&&ct("forward.id")!==void 0&&(R=parseInt(ct("forward.type")),S=parseInt(ct("forward.id"))),R===2?Li(S):R===-1&&p.roomIdToEnter>0&&(ht("navigator/close"),p.roomIdToEnter!==p.homeRoomId?vl(p.roomIdToEnter):vl(p.homeRoomId))}),z(Ky,I=>{const p=I.getParser();switch(p.reason){case ou.REASON_FULL:m(g("navigator.guestroomfull.text"),Yt.DEFAULT,null,null,g("navigator.guestroomfull.title"));break;case ou.REASON_QUEUE_ERROR:m(g(`room.queue.error.${p.parameter}`),Yt.DEFAULT,null,null,g("room.queue.error.title"));break;case ou.REASON_BANNED:m(g("navigator.banned.text"),Yt.DEFAULT,null,null,g("navigator.banned.title"));break;default:m(g("room.queue.error.title"),Yt.DEFAULT,null,null,g("room.queue.error.title"));break}yS()}),z(gy,I=>ht("navigator/show")),{categories:a,doorData:c,setDoorData:u,topLevelContext:r,topLevelContexts:o,searchResult:h,navigatorData:f}},sn=()=>gs(A7),N7=()=>{const[a,t]=_.useState(new US),e=_.useMemo(()=>ct("hc.disabled",!1),[]),s=_.useMemo(()=>e||a.clubDays>0?ea.ACTIVE:a.pastVipDays>0||a.pastVipDays>0?ea.EXPIRED:ea.NONE,[a,e]),r=n=>{if(n===-1)return a.credits;for(const[o,l]of a.activityPoints.entries())if(o===n)return l;return 0};return z(XM,n=>{const o=n.getParser();t(l=>{const c=bi(l);return c.credits=parseFloat(o.credits),l.credits!==c.credits&&ma(Ea.CREDITS),c})}),z(qM,n=>{const o=n.getParser();t(l=>{const c=bi(l);return c.activityPoints=o.currencies,c})}),z(YR,n=>{const o=n.getParser();t(l=>{const c=bi(l);return c.activityPoints=new Map(c.activityPoints),c.activityPoints.set(o.type,o.amount),o.type===0&&ma(Ea.DUCKETS),c})}),z(QM,n=>{const o=n.getParser(),l=o.productName;l!=="club_habbo"&&l!=="habbo_club"||t(c=>{const u=bi(c);return u.clubDays=Math.max(0,o.daysToPeriodEnd),u.clubPeriods=Math.max(0,o.periodsSubscribedAhead),u.isVip=o.isVip,u.pastClubDays=o.pastClubDays,u.pastVipDays=o.pastVipDays,u.isExpiring=o.responseType===k_.RESPONSE_TYPE_DISCOUNT_AVAILABLE,u.minutesUntilExpiration=o.minutesUntilExpiration,u.minutesSinceLastModified=o.minutesSinceLastModified,u})}),_.useEffect(()=>{if(e)return;H(new QI("habbo_club"));const n=setInterval(()=>H(new QI("habbo_club")),5e4);return()=>clearInterval(n)},[e]),_.useEffect(()=>{H(new cL)},[]),{purse:a,hcDisabled:e,clubStatus:s,getCurrencyAmount:r}},ec=()=>gs(N7),C7=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return fa.addEventListener(Be.FURNI_ADDED,e),()=>{fa.removeEventListener(Be.FURNI_ADDED,e)}},[a,t])},Pr=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return fa.addEventListener(Be.FURNI_REMOVED,e),()=>{fa.removeEventListener(Be.FURNI_REMOVED,e)}},[a,t])},x7=a=>{_s(Be.OBJECT_DESELECTED,a)},y7=a=>{_s(Be.OBJECT_ROLL_OUT,a)},M7=a=>{_s(Be.OBJECT_ROLL_OVER,a)},FS=a=>{_s(Be.OBJECT_SELECTED,a)},OU=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return fa.addEventListener(Be.USER_ADDED,e),()=>{fa.removeEventListener(Be.USER_ADDED,e)}},[a,t])},AU=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return fa.addEventListener(Be.USER_REMOVED,e),()=>{fa.removeEventListener(Be.USER_REMOVED,e)}},[a,t])},b7=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(!1);return z(my,r=>{const n=r.getParser();n&&t(n)}),{promoteInformation:a,isExtended:e,setPromoteInformation:t,setIsExtended:s}},GS=()=>gs(b7),D7=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[r,n]=_.useState(null),[o,l]=_.useState(0),c=(h,d,f,E=!1)=>{if(!e)return;const m=yr.hslToRGB(((h&255)<<16)+((d&255)<<8)+(f&255));E&&l(m),!h&&!d&&!f?e.tint=0:e.tint=m},u=h=>{if(!r)return;const d=h>>16&255,f=h>>8&255,E=h&255;r.red=d/255,r.green=f/255,r.blue=E/255};return _s(vo.PREVIEW,h=>c(h.hue,h.saturation,h.lightness)),_s(vo.CLEAR_PREVIEW,h=>{e&&(e.tint=o)}),ft(qh.ROOM_BACKGROUND_COLOR,h=>{pn.isRoomPreviewerId(h.roomId)||(h.enable?c(h.hue,h.saturation,h.lightness,!0):c(0,0,0,!0))}),ft(O_.ROOM_COLOR,h=>{if(pn.isRoomPreviewerId(h.roomId))return;let d=0,f=255;h.bgOnly||(d=h.color,f=h.brightness),u(yr.hslToRGB((yr.rgbToHSL(d)&16776960)+f))}),ft([Ne.INITIALIZED,Ne.DISPOSED],h=>{if(pn.isRoomPreviewerId(h.roomId))return;const d=Se();if(d)switch(h.type){case Ne.INITIALIZED:rA(h.roomId),t(d);return;case Ne.DISPOSED:t(null);return}}),ft([yt.CREATED,yt.ENDED],h=>{switch(h.type){case yt.CREATED:sq(h.session);return;case yt.ENDED:t(null);return}}),ft([Ot.SELECTED,Ot.DESELECTED,Ot.ADDED,Ot.REMOVED,Ot.PLACED,Ot.REQUEST_MOVE,Ot.REQUEST_ROTATE,Ot.MOUSE_ENTER,Ot.MOUSE_LEAVE,Ot.DOUBLE_CLICK],h=>{if(pn.isRoomPreviewerId(h.roomId))return;let d=null;switch(h.type){case Ot.SELECTED:rq(h)||(d=new Be(Be.OBJECT_SELECTED,h.objectId,h.category,h.roomId));break;case Ot.DESELECTED:d=new Be(Be.OBJECT_DESELECTED,h.objectId,h.category,h.roomId);break;case Ot.ADDED:{let f=null;switch(h.category){case Y.FLOOR:case Y.WALL:f=Be.FURNI_ADDED;break;case Y.UNIT:f=Be.USER_ADDED;break}f&&(d=new Be(f,h.objectId,h.category,h.roomId));break}case Ot.REMOVED:{let f=null;switch(h.category){case Y.FLOOR:case Y.WALL:f=Be.FURNI_REMOVED;break;case Y.UNIT:f=Be.USER_REMOVED;break}f&&(d=new Be(f,h.objectId,h.category,h.roomId));break}case Ot.REQUEST_MOVE:_d(a,h.objectId,h.category)&&Ic(h.objectId,h.category,Gt.OBJECT_MOVE);break;case Ot.REQUEST_ROTATE:_d(a,h.objectId,h.category)&&Ic(h.objectId,h.category,Gt.OBJECT_ROTATE_POSITIVE);break;case Ot.MOUSE_ENTER:d=new Be(Be.OBJECT_ROLL_OVER,h.objectId,h.category,h.roomId);break;case Ot.MOUSE_LEAVE:d=new Be(Be.OBJECT_ROLL_OUT,h.objectId,h.category,h.roomId);break;case Ot.DOUBLE_CLICK:d=new Be(Be.OBJECT_DOUBLE_CLICKED,h.objectId,h.category,h.roomId);break}d&&Ps(d)}),_.useEffect(()=>{if(!a)return;const h=rt(),d=a.roomId,f=1,E=Math.floor(window.innerWidth),m=Math.floor(window.innerHeight),I=Mr();I&&I.resize(E,m,window.devicePixelRatio);const p=h.getRoomInstanceDisplay(d,f,E,m,Ho.SCALE_ZOOMED_IN),T=rt().getRoomInstanceRenderingCanvas(d,f);if(!p||!T)return;const R=new dd(GX.WHITE),S=new jX,L=T.master;R.tint=0,R.width=E,R.height=m,L.addChildAt(R,0),L.filters=[S],s(R),n(S);const M=h.getRoomInstanceGeometry(d,f);if(M){const k=h.getRoomInstanceVariable(d,ks.ROOM_MIN_X)||0,G=h.getRoomInstanceVariable(d,ks.ROOM_MAX_X)||0,j=h.getRoomInstanceVariable(d,ks.ROOM_MIN_Y)||0,F=h.getRoomInstanceVariable(d,ks.ROOM_MAX_Y)||0;let U=(k+G)/2,K=(j+F)/2;const B=20;U=U+(B-1),K=K+(B-1);const J=Math.sqrt(B*B+B*B)*Math.tan(30/180*Math.PI);M.location=new w(U,K,J)}Yh().addChild(p),rA(a.roomId);const P=k=>{const G=Math.floor(window.innerWidth),j=Math.floor(window.innerHeight);R.width=G,R.height=j,I.resize(G,j,window.devicePixelRatio),iq(G,j,1),Mr().render(Yh())};return window.addEventListener("resize",P),()=>{s(null),n(null),l(0),window.removeEventListener("resize",P)}},[a]),{roomSession:a}},Le=()=>gs(D7),v7=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(0),{roomSession:o=null}=Le(),l=()=>{const h=yr.rgbToHSL(r),[d,f,E,m]=zi.int_to_8BitVals(h);H(new RP(a,f,E,m))},c=()=>o.useMultistateItem(a),u=()=>{Ps(new vo(vo.CLEAR_PREVIEW)),t(-1),s(-1),n(0)};return ft(ot.REQUEST_BACKGROUND_COLOR,h=>{if(!_d(o,h.objectId,h.category))return;const f=rt().getRoomObject(h.roomId,h.objectId,h.category).model;t(h.objectId),s(h.category);const E=parseInt(f.getValue(A.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),m=parseInt(f.getValue(A.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),I=parseInt(f.getValue(A.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),p=zi.eight_bitVals_to_int(0,E,m,I),T=yr.hslToRGB(p);n(T)}),Pr(a!==-1&&e!==-1,h=>{h.id!==a||h.category!==e||u()}),_.useEffect(()=>{if(a===-1||e===-1)return;const h=yr.rgbToHSL(r),[d,f,E,m]=zi.int_to_8BitVals(h);Ps(new vo(vo.PREVIEW,f,E,m))},[a,e,r]),{objectId:a,color:r,setColor:n,applyToner:l,toggleToner:c,onClose:u}},P7=v7,L7=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState("1"),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(""),[f,E]=_.useState(""),{simpleAlert:m=null}=Ye(),I=()=>{t(-1),s(-1),n("1"),l(""),u(""),d(""),E("")};return ft([ot.REQUEST_BADGE_DISPLAY_ENGRAVING,ot.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],p=>{const T=rt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=new An;R.initializeFromRoomObjectModel(T.model),t(p.objectId),s(p.category),n("1"),l(vd(R.getValue(1))),u(DS(R.getValue(1))),d(R.getValue(2)),E(R.getValue(3))}),ft(ot.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,p=>{const T=rt().getRoomObject(p.roomId,p.objectId,p.category);!T||T.model.getValue(A.FURNITURE_OWNER_ID)!==tt().userId||m(`${g("resolution.failed.subtitle")} ${g("resolution.failed.text")}`,null,null,null,g("resolution.failed.title"))}),Pr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||I()}),{objectId:a,category:e,color:r,badgeName:o,badgeDesc:c,date:h,senderName:f,onClose:I}},U7=L7,eR="MONSTERPLANT_SEED_CONFIRMATION",sR="PURCHASABLE_CLOTHING_CONFIRMATION",NU="GROUP_FURNITURE",CU="EFFECTBOX_OPEN",iR="MYSTERYTROPHY_OPEN_DIALOG",j7=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(null),[r,n]=_.useState(null),[o,l]=_.useState(-1),[c,u]=_.useState(null),[h,d]=_.useState(!1),[f,E]=_.useState(-1),{roomSession:m=null}=Le(),I=()=>{t(-1),u(null),d(!1),s(null)},p=()=>{n(null),l(-1)},T=R=>{if(R)switch(R){case"use_friend_furni":m.useMultistateItem(a);break;case"use_monsterplant_seed":n(eR),l(a);break;case"use_random_teleport":rt().useRoomObject(a,Y.FLOOR);break;case"use_purchaseable_clothing":n(sR),l(a);break;case"use_mystery_box":m.useMultistateItem(a);break;case"use_mystery_trophy":n(iR),l(a);break;case"join_group":bS(c.guildId),d(!0);return;case"go_to_group_homeroom":c&&Li(c.guildHomeRoomId);break}I()};return ft([ot.OPEN_FURNI_CONTEXT_MENU,ot.CLOSE_FURNI_CONTEXT_MENU,ot.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,ot.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,ot.REQUEST_EFFECTBOX_OPEN_DIALOG,ot.REQUEST_MYSTERYBOX_OPEN_DIALOG,ot.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],R=>{const S=rt().getRoomObject(m.roomId,R.objectId,R.category);if(S)switch(E(S.model.getValue(A.FURNITURE_OWNER_ID)),R.type){case ot.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!Ei(S))return;l(S.id),n(eR),I();return;case ot.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!Ei(S))return;l(S.id),n(CU),I();return;case ot.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!Ei(S))return;l(S.id),n(sR),I();return;case ot.REQUEST_MYSTERYBOX_OPEN_DIALOG:m.useMultistateItem(S.id),I();return;case ot.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!Ei(S))return;l(S.id),n(iR),I();return;case ot.OPEN_FURNI_CONTEXT_MENU:switch(t(S.id),R.contextMenu){case es.FRIEND_FURNITURE:s(es.FRIEND_FURNITURE);return;case es.MONSTERPLANT_SEED:Ei(S)&&s(es.MONSTERPLANT_SEED);return;case es.MYSTERY_BOX:s(es.MYSTERY_BOX);return;case es.MYSTERY_TROPHY:Ei(S)&&s(es.MYSTERY_TROPHY);return;case es.RANDOM_TELEPORT:s(es.RANDOM_TELEPORT);return;case es.PURCHASABLE_CLOTHING:Ei(S)&&s(es.PURCHASABLE_CLOTHING);return}return;case ot.CLOSE_FURNI_CONTEXT_MENU:S.id===a&&I();return}}),z(eM,R=>{const S=R.getParser();t(S.objectId),u(S),d(S.userIsMember),s(NU)}),{objectId:a,mode:e,confirmMode:r,confirmingObjectId:o,groupData:c,isGroupMember:h,objectOwnerId:f,closeConfirm:p,processAction:T,onClose:I}},w7=j7,F7=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState([]),[r,n]=_.useState(null),[o,l]=_.useState([]),[c,u]=_.useState(null),[h,d]=_.useState(new Map),[f,E]=_.useState(!1),{groupItems:m=[],getItemsByType:I=null,activate:p=null,deactivate:T=null}=tc(),{simpleAlert:R=null}=Ye(),S=r&&h.get(r.name)||null,L=()=>{s([]),n(null),l([]),d(new Map)},M=()=>{t(-1),L()},P=()=>{E(!0),H(new xb(a,r.name))},k=G=>{n(G),h.get(G.name)||H(new Mb(G.name))};return ft(ot.OPEN_WIDGET,G=>{G.widget===Wh.CRAFTING&&(t(G.objectId),L(),H(new yb(G.objectId)))}),z(UC,G=>{const j=G.getParser();if(!j.isActive()){t(-1);return}s(F=>{const U=[];for(const K of j.recipes){const B=Sr()._activeObjectTypeIds.get(K.itemName),J=rt().getFurnitureFloorIconUrl(B);U.push({name:K.recipeName,localizedName:g("roomItem.name."+B),iconUrl:J})}return U}),u(j.ingredients)}),z(jC,G=>{const j=G.getParser();d(F=>{const U=new Map(F);return U.set(r.name,j.ingredients),U})}),z(FC,G=>{n(null),E(!1),G.getParser().result&&R(g("crafting.info.result.ok"))}),z(wC,G=>{}),_.useEffect(()=>{!c||!c.length||l(G=>{const j=[];for(const F of c){const U=Sr()._activeObjectTypeIds.get(F),K=rt().getFurnitureFloorIconUrl(U),B=I(U);let J=0;if(B)for(const Z of B)J+=Z.items.length;j.push({name:F,iconUrl:K,count:J})}return j})},[m,c,I]),_.useEffect(()=>{if(a===-1)return;const G=p();return()=>T(G)},[a,p,T]),{objectId:a,recipes:e,ingredients:o,selectedRecipe:r,requiredIngredients:S,isCrafting:f,selectRecipe:k,craft:P,onClose:M}},G7=F7,k7=()=>{const[a,t]=_.useState([]),[e,s]=_.useState(0),[r,n]=_.useState(0),[o,l]=_.useState(0),[c,u]=_.useState(0),[h,d]=_.useState(16777215),[f,E]=_.useState(255),[m,I]=_.useState(0),[p,T]=_.useState(0),[R,S]=_.useState(0),{roomSession:L=null}=Le(),M=()=>L.isRoomOwner||L.controllerLevel>=Ce.GUEST||tt().isModerator,P=G=>{const j=a[G-1];j&&(s(j.id),I(j.type),T(j.color),S(j.light))},k=()=>{if(r===0)return;const G=e-1;if(e<1||e>a.length)return;const j=a[G];!j||m===j.type&&p===j.color&&R===j.light||(t(F=>{const U=[...F];return U[G]=new EA(j.id,m,p,R),U}),Kr.savePreset(j.id,m,p,R,!0))};return ft(ot.REQUEST_DIMMER,G=>{M()&&L.requestMoodlightSettings()}),ft(Qh.ROOM_DIMMER_PRESETS,G=>{const j=[];let F=0;for(;F<G.presetCount;){const U=G.getPreset(F);U&&j.push(new EA(U.id,U.type,U.color,U.brightness)),F++}t(j),s(G.selectedPresetId)}),ft(N_.ROOM_COLOR,G=>{pn.isRoomPreviewerId(G.roomId)||(l(r),n(G.state),s(G.presetId),u(G.effectId),I(G.effectId),d(G.color),T(G.color),E(G.brightness),S(G.brightness))}),_.useEffect(()=>{r===0&&o===0||Kr.previewDimmer(p,R,m===2)},[r,o,p,R,m]),{presets:a,selectedPresetId:e,dimmerState:r,lastDimmerState:o,effectId:c,color:h,brightness:f,selectedEffectId:m,setSelectedEffectId:I,selectedColor:p,setSelectedColor:T,selectedBrightness:R,setSelectedBrightness:S,selectPresetId:P,applyChanges:k}},B7=k7,V7=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(0),o=()=>{t(-1),s(-1),n(0)},l=()=>{H(new _P(a)),o()};return ft(ot.REQUEST_CREDITFURNI,c=>{const u=rt().getRoomObject(c.roomId,c.objectId,c.category);!u||!Ei(u)||(t(c.objectId),s(c.category),n(u.model.getValue(A.FURNITURE_CREDIT_VALUE)||0))}),Pr(a!==-1&&e!==-1,c=>{c.id!==a||c.category!==e||o()}),{objectId:a,value:r,redeem:l,onClose:o}},H7=V7,W7=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(-1),[o,l]=_.useState([]),{roomSession:c=null}=Le(),u=()=>{t(-1),s(-1),n(-1),l([])};return ft(ot.REQUEST_EXTERNAL_IMAGE,h=>{const d=rt().getRoomObject(h.roomId,h.objectId,h.category),f=rt().getRoomObjects(c==null?void 0:c.roomId,Y.WALL);if(!d)return;const E=[];f.forEach(I=>{if(I.type!=="external_image_wallitem_poster_small")return null;const p=I.model.getValue(A.FURNITURE_DATA),T=JSON.parse(p);E.push(T)}),t(h.objectId),s(h.category),l(E);const m=JSON.parse(d.model.getValue(A.FURNITURE_DATA));n(I=>{let p=0;return m&&(p=E.findIndex(T=>T.u===m.u)),p<0&&(p=0),p})}),Pr(a!==-1&&e!==-1,h=>{h.id!==a||h.category!==e||u()}),{objectId:a,currentPhotoIndex:r,currentPhotos:o,onClose:u}},Y7=W7,z7=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(0),[o,l]=_.useState([]),[c,u]=_.useState([]),[h,d]=_.useState(null),[f,E]=_.useState(0),m=()=>{t(-1),s(-1),n(0),l([]),u([]),d(null)},I=p=>{H(new Db(a,p)),m()};return z(rM,p=>{const T=p.getParser();t(T.furniId),E(T.start?1:2)}),z(sM,p=>m()),z(iM,p=>m()),ft(ot.REQUEST_FRIEND_FURNITURE_ENGRAVING,p=>{const T=rt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=T.model.getValue(A.FURNITURE_DATA),S=T.model.getValue(A.FURNITURE_FRIENDFURNI_ENGRAVING);R[0]!=="1"||R.length!==6||(t(p.objectId),s(p.category),n(S),l([R[1],R[2]]),u([R[3],R[4]]),d(R[5]),E(0))}),Pr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||m()}),{objectId:a,type:r,usernames:o,figures:c,date:h,stage:f,onClose:m,respond:I}},K7=z7,X7=["perteam","mostwins","classic"],q7=["alltime","daily","weekly","monthly"],Q7=()=>{const[a,t]=_.useState(new Map),{roomSession:e=null}=Le(),s=n=>X7[n],r=n=>q7[n];return ft(ot.REQUEST_HIGH_SCORE_DISPLAY,n=>{const o=rt().getRoomObject(n.roomId,n.objectId,n.category);if(!o)return;const l=o.model.getValue(A.FURNITURE_DATA_FORMAT),c=ra.getData(l);c.initializeFromRoomObjectModel(o.model),t(u=>{const h=new Map(u);return h.set(o.id,c),h})}),ft(ot.REQUEST_HIDE_HIGH_SCORE_DISPLAY,n=>{n.roomId===e.roomId&&t(o=>{const l=new Map(o);return l.delete(n.objectId),l})}),{stuffDatas:a,getScoreType:s,getClearType:r}},J7=Q7,Z7="internalLink",$7=()=>(ft(ot.REQUEST_INTERNAL_LINK,a=>{const t=rt().getRoomObject(a.roomId,a.objectId,a.category);if(!t)return;let s=t.model.getValue(A.FURNITURE_DATA)[Z7];(!s||!s.length)&&(s=t.model.getValue(A.FURNITURE_INTERNAL_LINK)),s&&s.length&&ht(s)}),{}),t8=$7,e8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(Pi.NO_CLUB),[h,d]=_.useState(null),f=()=>{t(-1),s(-1),n(null),l(null),d(null)},E=()=>{a!==-1&&(H(new EP(a)),f())},m=()=>{a!==-1&&(H(new Au(a)),f())},I=()=>{a!==-1&&H(new pP(a,h))};return ft(ot.REQUEST_MANNEQUIN,p=>{const T=rt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=T.model,S=R.getValue(A.FURNITURE_MANNEQUIN_FIGURE)||null,L=R.getValue(A.FURNITURE_MANNEQUIN_GENDER)||null,M=is().createFigureContainer(S),P=is().getFigureClubLevel(M,L,uu.MANNEQUIN_CLOTHING_PART_TYPES);t(p.objectId),s(p.category),n(S),l(L),u(P),d(R.getValue(A.FURNITURE_MANNEQUIN_NAME)||null)}),Pr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||f()}),{objectId:a,figure:r,gender:o,clubLevel:c,name:h,setName:d,saveFigure:E,wearFigure:m,saveName:I,onClose:f}},s8=e8,i8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(-1),[o,l]=_.useState(new Is),[c,u]=_.useState([]),{roomSession:h=null}=Le(),{showSingleBubble:d=null,simpleAlert:f=null}=Ye(),E=()=>{t(-1),s(-1)},m=_.useCallback((R,S)=>H(new KP(R,S)),[]),I=_.useCallback(R=>H(new $P(R)),[]),p=_.useCallback((R,S)=>H(new Au(R,S)),[]);ft(ot.REQUEST_PLAYLIST_EDITOR,R=>{var L,M,P;const S=rt().getRoomObject(R.roomId,R.objectId,R.category);if(S){if(Ei(S)){t(R.objectId),s(R.category),(L=Os().musicController)==null||L.requestUserSongDisks(),(P=(M=Os().musicController)==null?void 0:M.getRoomItemPlaylist())==null||P.requestPlayList();return}(h.isRoomOwner||h.controllerLevel>=Ce.GUEST||tt().isModerator)&&H(new Au(R.objectId,-2))}}),Pr(a!==-1&&e!==-1,R=>{R.id!==a||R.category!==e||E()}),ft(aa.NPE_SONG_CHANGED,R=>{n(R.position)}),ft(w_.NOTIFY_PLAYED_SONG,R=>{d(g("soundmachine.notification.playing",["songname","songauthor"],[R.name,R.creator]),Ci.SOUNDMACHINE)}),ft(yl.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,R=>{var S;l((S=Os().musicController)==null?void 0:S.songDiskInventory.clone())}),ft($n.PLUE_PLAY_LIST_UPDATED,R=>{var S,L;u((L=(S=Os().musicController)==null?void 0:S.getRoomItemPlaylist())==null?void 0:L.entries.concat())}),ft($n.PLUE_PLAY_LIST_FULL,R=>{f(g("playlist.editor.alert.playlist.full"),Yt.ALERT,"","",g("playlist.editor.alert.playlist.full.title"))});const T=R=>{var S,L;a!==-1&&(R instanceof K_?R.getParser().fragmentNumber===0&&((S=Os().musicController)==null||S.requestUserSongDisks()):(L=Os().musicController)==null||L.requestUserSongDisks())};return z(K_,T),z(HR,T),z(VR,T),{objectId:a,diskInventory:o,playlist:c,currentPlayingIndex:r,onClose:E,addToPlaylist:m,removeFromPlaylist:I,togglePlayPause:p}},r8=i8,AA="floor",n8="wallpaper",NA="landscape",a8="poster",o8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(!1),[h,d]=_.useState(null),[f,E]=_.useState(null),[m,I]=_.useState(-1),[p,T]=_.useState(null),[R,S]=_.useState(!1),[L,M]=_.useState(null),{roomSession:P=null}=Le(),k=()=>{t(-1),s(-1),n(null),l(null),u(!1),d(null),E(null),I(-1),T(null),S(!1),M(null)},G=()=>{a!==-1&&(P.openGift(a),rt().changeObjectModelData(rt().activeRoomId,a,Y.FLOOR,A.FURNITURE_DISABLE_PICKING_ANIMATION,1))},j=_.useMemo(()=>({imageReady:(F,U,K)=>{(async()=>(!K&&U&&(K=await me.generateImage(U)),M(K.src)))()},imageFailed:null}),[]);return ft(Jh.RSPE_PRESENT_OPENED,F=>{let U=null;F.itemType===kt.FLOOR?U=tt().getFloorItemData(F.classId):F.itemType===kt.WALL&&(U=tt().getWallItemData(F.classId));let K=!1;if(F.placedInRoom){const B=rt().getRoomObject(P.roomId,F.placedItemId,Y.FLOOR);B&&(K=Ei(B))}switch(F.itemType){case kt.WALL:{if(U)switch(U.className){case AA:case NA:case n8:let B=null;U.className===AA?B=g("inventory.furni.item.floor.name"):U.className===NA?B=g("inventory.furni.item.landscape.name"):B=g("inventory.furni.item.wallpaper.name"),l(B);break;case a8:{const J=F.productCode;let Z=null;J.indexOf("poster")===0&&(Z=J.replace("poster",""));const Q=tt().getProductData(J);let ut=null;Q?ut=Q.name:U&&(ut=U.name),l(ut),M(rt().getFurnitureWallIconUrl(F.classId,Z));break}default:{l(U.name||null),M(rt().getFurnitureWallIconUrl(F.classId));break}}break}case kt.HABBO_CLUB:l(g("widget.furni.present.hc"));break;default:{if(F.placedItemType===kt.PET){const J=F.petFigureString;if(J&&J.length){const Z=new da(J);(async()=>{const Q=rt().getRoomObjectPetImage(Z.typeId,Z.paletteId,Z.color,new w(90),64,j,!0,0,Z.customParts);Q&&M((await Q.getImage()).src)})()}}else(async()=>{const J=rt().getFurnitureFloorImage(F.classId,new w(90),64,j);J&&M((await J.getImage()).src)})();const B=tt().getProductData(F.productCode);l(B&&B.name||U.name);break}}t(0),s(F.classId),n(F.itemType),u(K),I(F.placedItemId),T(F.placedItemType),S(F.placedInRoom)}),ft(ot.REQUEST_PRESENT,F=>{const U=rt().getRoomObject(F.roomId,F.objectId,F.category);if(!U)return null;k(),t(F.objectId),s(-1),l(U.model.getValue(A.FURNITURE_DATA)||""),u(Ei(U)),d(U.model.getValue(A.FURNITURE_PURCHASER_NAME)||null),E(U.model.getValue(A.FURNITURE_PURCHASER_FIGURE)||null)}),Pr(a!==-1,F=>{F.id===a&&k(),F.id===m&&R&&S(!1)}),{objectId:a,classId:e,itemType:r,text:o,isOwnerOfFurniture:c,senderName:h,senderFigure:f,placedItemId:m,placedItemType:p,placedInRoom:R,imageUrl:L,openPresent:G,onClose:k}},l8=o8,c8="internalLink",u8=()=>{const[a,t]=_.useState(0);return ft(ot.REQUEST_ROOM_LINK,e=>{const s=rt().getRoomObject(e.roomId,e.objectId,e.category);if(!s)return;let n=s.model.getValue(A.FURNITURE_DATA)[c8];(!n||!n.length)&&(n=s.model.getValue(A.FURNITURE_INTERNAL_LINK)),!(!n||!n.length)&&(n=parseInt(n,10),!isNaN(n)&&(t(n),H(new ad(n,!1,!1))))}),z($a,e=>{!a||e.getParser().data.roomId!==a||t(0)}),{}},h8=u8,d8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(""),[o,l]=_.useState(""),[c,u]=_.useState("0"),[h,d]=_.useState(""),[f,E]=_.useState(!1),{getWallItemById:m=null}=tc(),I=()=>{H(new sP(a,o,c,h)),t(-1),s(-1),n(""),l(""),u("0"),d(""),E(!1)};return z(nM,p=>{const T=p.getParser();t(T.itemId),s(Y.WALL);const R=m(T.itemId);let S="post_it";if(R){const L=rt().getFurnitureWallName(R.type);L.match("post_it_")&&(S=L)}n(S),l(T.location),u("FFFF33"),d(""),E(!0)}),{objectId:a,color:c,setColor:u,text:h,setText:d,canModify:f,onClose:I}},_8=d8,NE=40,g8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(0),[o,l]=_.useState(-1),c=()=>{t(-1),s(-1),n(0),l(-1)},u=(h,d=!1)=>{h||(h=0),h=Math.abs(h),d||h>NE&&(h=NE),n(parseFloat(h.toFixed(2))),d||l(h*100)};return z(tM,h=>{const d=h.getParser();a===d.furniId&&u(d.height,!0)}),ft(ot.REQUEST_STACK_HEIGHT,h=>{if(!_d(Se(),h.objectId,h.category))return;const d=rt().getRoomObject(h.roomId,h.objectId,h.category);d&&(t(h.objectId),s(h.category),n(d.getLocation().z),l(-1))}),Pr(a!==-1&&e!==-1,h=>{h.id!==a||h.category!==e||c()}),_.useEffect(()=>{if(a===-1||o===-1)return;const h=setTimeout(()=>H(new lg(a,~~o)),10);return()=>clearTimeout(h)},[a,o]),{objectId:a,height:r,maxHeight:NE,onClose:c,updateHeight:u}},f8=g8,m8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState("0"),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(!1),f=()=>{t(-1),s(-1),n("0"),l(""),u(""),d(!1)},E=p=>{p!==r&&(n(p),rt().modifyRoomObjectData(a,e,p,o))},m=p=>{l(p),rt().modifyRoomObjectData(a,e,r,p)},I=()=>rt().deleteRoomObject(a,e);return ft(ot.REQUEST_STICKIE,p=>{const T=rt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=T.model.getValue(A.FURNITURE_ITEMDATA);if(R.length<6)return;let S=null,L=null;R.indexOf(" ")>0?(S=R.slice(0,R.indexOf(" ")),L=R.slice(R.indexOf(" ")+1,R.length)):S=R,t(p.objectId),s(p.category),n(S||"0"),l(L||""),u(T.type||"post_it"),d(Se().isRoomOwner||tt().isModerator||Ei(T))}),Pr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||f()}),{objectId:a,color:r,text:o,type:c,canModify:h,updateColor:E,updateText:m,trash:I,onClose:f}},E8=m8,p8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState("1"),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(""),f=()=>{t(-1),s(-1),n("1"),l(""),u(""),d("")};return ft(ot.REQUEST_TROPHY,E=>{const m=rt().getRoomObject(E.roomId,E.objectId,E.category);if(!m)return;let I=m.model.getValue(A.FURNITURE_DATA);m.model.getValue(A.FURNITURE_EXTRAS),t(E.objectId),s(E.category),n(m.model.getValue(A.FURNITURE_COLOR)||"1");const p=I.substring(0,I.indexOf("	"));I=I.substring(p.length+1,I.length);const T=I.substring(0,I.indexOf("	")),R=I.substr(T.length+1,I.length);l(p),u(T),d(R)}),Pr(a!==-1&&e!==-1,E=>{E.id!==a||E.category!==e||f()}),{objectId:a,color:r,senderName:o,date:c,message:h,onClose:f}},I8=p8,T8=0,R8=1,S8=2,O8=3,A8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[r,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(null),[h,d]=_.useState(-1),[f,E]=_.useState(null),[m,I]=_.useState(null),[p,T]=_.useState(!1),R=()=>{t(-1),s(-1),n(null),l(null),u(null),d(-1),E(null),I(null),T(!1)},S=()=>H(new wu(a,T8)),L=()=>H(new wu(a,R8)),M=()=>p&&r&&r.length&&H(new wu(a,S8)),P=()=>p&&r&&r.length&&H(new wu(a,O8)),k=G=>{if(f===G){E(null),H(new KI(a,""));return}E(G),H(new KI(a,G))};return ft(ot.REQUEST_YOUTUBE,G=>{if(pn.isRoomPreviewerId(G.roomId))return;const j=rt().getRoomObject(G.roomId,G.objectId,G.category);j&&(t(G.objectId),s(G.category),T(tt().hasSecurity(kl.EMPLOYEE)||Ei(j)),H(new OP(G.objectId)))}),z(cM,G=>{const j=G.getParser();a===-1||a!==j.furniId||(n(j.videoId),l(j.startAtSeconds),u(j.endAtSeconds),d(j.state))}),z(lM,G=>{const j=G.getParser();a===-1||a!==j.furniId||(I(j.playlists),E(j.selectedPlaylistId),n(null),d(-1),u(null),l(null))}),z(oM,G=>{const j=G.getParser();if(!(a===-1||a!==j.furniId))switch(j.commandId){case 1:d(Po.PLAYING);break;case 2:d(Po.PAUSED);break}}),Pr(a!==-1&&e!==-1,G=>{G.id!==a||G.category!==e||R()}),{objectId:a,videoId:r,videoStart:o,videoEnd:c,currentVideoState:h,selectedVideo:f,playlists:m,onClose:R,previous:S,next:L,pause:M,play:P,selectVideo:k}},N8=A8,C8=()=>{const[a,t]=_.useState(null),[e,s]=_.useState([]),[r,n]=_.useState(""),[o,l]=_.useState([]),[c,u]=_.useState(0),[h,d]=_.useState(bt.STUFF_SELECTION_OPTION_NONE),{showConfirm:f=null}=Ye(),E=()=>{const I=p=>{p&&(p instanceof MR?H(new WP(p.id,e,r,o,c,p.stuffTypeSelectionCode)):p instanceof yR?H(new zP(p.id,e,r,o,p.stuffTypeSelectionCode)):p instanceof xR&&H(new YP(p.id,e,r,o,p.stuffTypeSelectionCode)))};tq(a.id)?I(a):f(g("wiredfurni.nonowner.change.confirm.body"),()=>{I(a)},null,null,null,g("wiredfurni.nonowner.change.confirm.title"))},m=(I,p)=>{!a||!h||I<=0||l(T=>{const R=[...T],S=T.indexOf(I);return S>=0?(R.splice(S,1),Fl.hide(I)):R.length<a.maximumItemSelectionCount&&(R.push(I),Fl.show(I)),R})};return z(OM,I=>{const p=I.getParser();H(new VP(p.stuffId))}),z(AM,I=>{I.getParser(),t(null)}),z(TM,I=>{const p=I.getParser();t(p.definition)}),z(RM,I=>{const p=I.getParser();t(p.definition)}),z(SM,I=>{const p=I.getParser();t(p.definition)}),_.useEffect(()=>{if(a)return()=>{s([]),n(""),u(0),l(I=>(I&&I.length&&Fl.clearSelectionShaderFromFurni(I),[])),d(bt.STUFF_SELECTION_OPTION_NONE)}},[a]),{trigger:a,setTrigger:t,intParams:e,setIntParams:s,stringParam:r,setStringParam:n,furniIds:o,setFurniIds:l,actionDelay:c,setActionDelay:u,setAllowsFurni:d,saveWired:E,selectObjectForWired:m}},oe=()=>gs(C8),x8=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[r,n]=_.useState([]),[o,l]=_.useState([]),[c,u]=_.useState(null),[h,d]=_.useState(-1),[f,E]=_.useState(!1),{friends:m=[]}=gr(),{selectObjectForWired:I=null}=oe(),{roomSession:p=null}=Le(),T=P=>{n(k=>{const G=[...k];return G.splice(P,1),G})},R=P=>{l(k=>{const G=[...k],j=G.splice(P,1)[0];return c===j&&u(null),G})},S=P=>{u(P),l([])},L=(P,k)=>{const G=ac.getObjectName(P,k);G&&(s(G),k!==Y.UNIT&&l([]))},M=(P,k)=>{let G=null;switch(k){case Y.FLOOR:case Y.WALL:G=ac.getFurniInfo(P,k),G&&I(P,k);break;case Y.UNIT:{const j=p.userDataManager.getUserDataByIndex(P);if(!j)break;switch(j.type){case Pe.PET:p.userDataManager.requestPetInfo(j.webID),d(j.webID);break;case Pe.USER:G=ac.getUserInfo(k,j);break;case Pe.BOT:G=ac.getBotInfo(k,j);break;case Pe.RENTABLE_BOT:G=ac.getRentableBotInfo(k,j);break}}}G&&t(G)};return ft(L_.USER_DATA_UPDATED,P=>{if(!P.addedUsers.length)return;let k=[];P.addedUsers.forEach(G=>{G.webID===tt().userId||G.type!==Pe.USER||m.find(j=>j.id===G.webID)&&k.push(new hU(G.roomIndex,Y.UNIT,G.webID,G.name,G.type,!0))}),k.length&&n(G=>{const j=[...G];return k.forEach(F=>{const U=j.findIndex(K=>K.id===F.id);U>-1&&j.splice(U,1),j.push(F)}),j})}),ft(M_.PET_INFO,P=>{const k=P.petInfo;if(!k||k.id!==h)return;const G=ac.getPetInfo(k);G&&(t(G),d(-1))}),ft(b_.PET_STATUS_UPDATE,P=>{}),ft(pu.USE_PRODUCT_FROM_INVENTORY,P=>{}),ft(pu.USE_PRODUCT_FROM_ROOM,P=>{const k=rt().getRoomObject(p.roomId,P.objectId,Y.FLOOR);if(!k||!Ei(k))return;const G=k.model.getValue(A.FURNITURE_OWNER_ID),j=k.model.getValue(A.FURNITURE_TYPE_ID),F=tt().getFloorItemData(j),U=F.customParams.split(" "),K=U.length?parseInt(U[0]):-1;if(K===-1)return;const B=[],J=rt().getRoomObjects(p.roomId,Y.UNIT);for(const Z of J){const Q=p.userDataManager.getUserDataByIndex(Z.id);let ut=!1;if(!(!Q||Q.type!==Pe.PET)){if(Q.ownerId===G){Q.hasSaddle&&F.specialType===Dt.PET_SADDLE&&(ut=!0);const Bt=Q.figure.split(" ");if((Bt.length?parseInt(Bt[0]):-1)===K){if(F.specialType===Dt.MONSTERPLANT_REVIVAL&&!Q.canRevive||F.specialType===Dt.MONSTERPLANT_REBREED&&(Q.petLevel<7||Q.canRevive||Q.canBreed)||F.specialType===Dt.MONSTERPLANT_FERTILIZE&&(Q.petLevel>=7||Q.canRevive))continue;B.push(new kq(Q.roomIndex,Y.UNIT,Q.name,P.objectId,Z.id,-1,ut))}}}}u(null),B.length&&l(B)}),ft(Ot.REQUEST_MANIPULATION,P=>{_d(p,P.objectId,P.category)&&E(!0)}),FS(P=>{M(P.id,P.category)}),x7(P=>{t(null),l([])}),M7(P=>{a||P.category!==Y.UNIT||L(P.id,P.category)}),y7(P=>{!e||P.category!==Y.UNIT||e.roomIndex!==P.id||s(null)}),_s([Be.FURNI_REMOVED,Be.USER_REMOVED],P=>{if(e&&e.category===P.category&&e.roomIndex===P.id&&s(null),P.category===Y.UNIT){let k=r.findIndex(G=>G.roomIndex===P.id);k>-1&&n(G=>G.filter(j=>j.roomIndex===P.id)),k=o.findIndex(G=>G.id===P.id),k>-1&&l(G=>G.filter(j=>j.id!==P.id))}else P.category===Y.FLOOR&&o.findIndex(G=>G.id===P.id)>-1&&l(G=>G.filter(j=>j.requestRoomObjectId!==P.id));a&&(a instanceof zl?a.id===P.id&&t(null):(a instanceof ws||a instanceof Xl||a instanceof Kl)&&a.roomIndex===P.id&&t(null))}),_.useEffect(()=>{a&&(s(null),n([]),l([]))},[a]),_.useEffect(()=>{e&&n([])},[e]),_.useEffect(()=>{p&&(p.isDecorating=f)},[p,f]),{avatarInfo:a,setAvatarInfo:t,activeNameBubble:e,setActiveNameBubble:s,nameBubbles:r,productBubbles:o,confirmingProduct:c,isDecorating:f,setIsDecorating:E,removeNameBubble:T,removeProductBubble:R,updateConfirmingProduct:S,getObjectName:L}},y8=x8,M8=()=>{const[a,t]=_.useState(""),[e,s]=_.useState(!1),[r,n]=_.useState(!1),[o,l]=_.useState(!1),[c,u]=_.useState(!1),[h,d]=_.useState(0),{showNitroAlert:f=null,showConfirm:E=null}=Ye(),{roomSession:m=null}=Le(),I=(p,T,R="",S=0,L="")=>{if(p==="")return null;const M=p.split(" ");if(M.length>0){const P=M[0];let k="";if(M.length>1&&(k=M[1]),P.charAt(0)===":"&&k==="x"){const G=rt().selectedAvatarId;if(G>-1){const j=m.userDataManager.getUserDataByIndex(G);j&&(k=j.name,p=p.replace(" x"," "+j.name))}}switch(P.toLowerCase()){case":shake":return Cu.init(2500,5e3),Cu.turnVisualizationOn(),null;case":rotate":return hd.init(2500,5e3),hd.turnVisualizationOn(),null;case":d":case";d":pi()===Pi.VIP&&m.sendExpressionMessage(Qr.LAUGH.ordinal);break;case"o/":case"_o/":return m.sendExpressionMessage(Qr.WAVE.ordinal),null;case":kiss":if(pi()===Pi.VIP)return m.sendExpressionMessage(Qr.BLOW.ordinal),null;break;case":jump":if(pi()===Pi.VIP)return m.sendExpressionMessage(Qr.JUMP.ordinal),null;break;case":idle":return m.sendExpressionMessage(Qr.IDLE.ordinal),null;case"_b":return m.sendExpressionMessage(Qr.RESPECT.ordinal),null;case":sign":return m.sendSignMessage(parseInt(k)),null;case":iddqd":case":flip":return X().dispatchEvent(new xl(m.roomId,-1,!0)),null;case":zoom":let G=parseFloat(k);return isNaN(G)&&(G=1),G>=1&&G<=5?rt().events.dispatchEvent(new xl(m.roomId,G,!1)):G===0?rt().events.dispatchEvent(new xl(m.roomId,1,!1)):rt().events.dispatchEvent(new xl(m.roomId,1,!1)),null;case":screenshot":const j=rt().createTextureFromRoom(m.roomId,1);return(async()=>{const F=new Image;F.src=await me.generateImageUrl(j),window.open("").document.write(F.outerHTML)})(),null;case":pickall":return(m.isRoomOwner||tt().isModerator)&&E(g("room.confirm.pick_all"),()=>{tt().sendSpecialCommandMessage(":pickall")},null,null,null,g("generic.alert.title"),null,"pickall"),null;case":ejectall":return(m.isRoomOwner||tt().isModerator||m.controllerLevel>=Ce.GUEST)&&E(g("room.confirm.eject_all"),()=>{tt().sendSpecialCommandMessage(":ejectall")},null,null,null,g("generic.alert.title")),null;case":furni":return ht("furni-chooser/"),null;case":chooser":return ht("user-chooser/"),null;case":floor":case":bcfloor":return m.controllerLevel>=Ce.ROOM_OWNER&&ht("floor-editor/show"),null;case":togglefps":return Ti().maxFPS>0?Ti().maxFPS=0:Ti().maxFPS=ct("system.animation.fps"),null;case":client":case":nitro":case":billsonnn":return f(),null;case":settings":return(m.isRoomOwner||tt().isModerator)&&H(new cS(m.roomId)),null}}switch(T){case sa.CHAT_DEFAULT:m.sendChatMessage(p,S,L);break;case sa.CHAT_SHOUT:m.sendChatMessage(p,S,L);break;case sa.CHAT_WHISPER:m.sendWhisperMessage(R,p,S);break}};return ft(fe.FLOOD_EVENT,p=>{u(!0),d(parseFloat(p.message))}),FS(p=>{if(p.category!==Y.UNIT)return;const T=m.userDataManager.getUserDataByIndex(p.id);T&&t(T.name)}),ft(Ot.DESELECTED,p=>t("")),_.useEffect(()=>{if(!c)return;let p=0;const T=window.setInterval(()=>{d(R=>(p=(R||0)-1,p)),p<0&&(clearInterval(T),u(!1))},1e3);return()=>clearInterval(T)},[c]),_.useEffect(()=>{if(!o)return;let p=null;return o&&(p=setTimeout(()=>{l(!1),s(!1)},1e4)),()=>clearTimeout(p)},[o]),_.useEffect(()=>{e?r||(n(!0),m.sendChatTypingMessage(e)):r&&(n(!1),m.sendChatTypingMessage(e))},[m,e,r]),{selectedUsername:a,floodBlocked:c,floodBlockedSeconds:h,setIsTyping:s,setIsIdle:l,sendChat:I}},b8=M8,D8=()=>{const[a,t]=_.useState([]),[e,s]=_.useState({mode:ss.CHAT_MODE_FREE_FLOW,weight:ss.CHAT_BUBBLE_WIDTH_NORMAL,speed:ss.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:ss.FLOOD_FILTER_NORMAL}),{roomSession:r=null}=Le(),{addChatEntry:n}=jd(),o=_.useRef(!1),l=_.useMemo(()=>{if(!e)return 6e3;switch(e.speed){case ss.CHAT_SCROLL_SPEED_FAST:return 3e3;case ss.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case ss.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[e]);return ft(fe.CHAT_EVENT,async c=>{const u=rt().getRoomObject(r.roomId,c.objectId,Y.UNIT),h=u?eU(r.roomId,u==null?void 0:u.id,Y.UNIT):{x:0,y:0},d=u?r.userDataManager.getUserDataByIndex(c.objectId):new IL(-1);let f="",E=0,m=null,I=c.chatType,p=c.style,T=0,R=c.message,S=c._chatColours;if(d){T=d.type;const k=d.figure;switch(T){case Pe.PET:m=await Ku.getPetImage(k,2,!0,64,u.model.getValue(A.FIGURE_POSTURE)),new da(k).typeId,S="black";break;case Pe.USER:m=await Ku.getUserImage(k);break;case Pe.RENTABLE_BOT:case Pe.BOT:p=yo.BOT,S="black";break}E=Ku.AVATAR_COLOR_CACHE.get(k),f=d.name}switch(I){case fe.CHAT_TYPE_RESPECT:R=g("widgets.chatbubble.respect",["username"],[f]),ct("respect.options").enabled&&ma(ct("respect.options").sound);break;case fe.CHAT_TYPE_PETREVIVE:case fe.CHAT_TYPE_PET_REBREED_FERTILIZE:case fe.CHAT_TYPE_PET_SPEED_FERTILIZE:{let k="widget.chatbubble.petrevived";I===fe.CHAT_TYPE_PET_REBREED_FERTILIZE?k="widget.chatbubble.petrefertilized;":I===fe.CHAT_TYPE_PET_SPEED_FERTILIZE&&(k="widget.chatbubble.petspeedfertilized");let G=null;if(rt().getRoomObject(r.roomId,c.extraParam,Y.UNIT)){const F=r.userDataManager.getUserDataByIndex(u.id);F&&(G=F.name)}R=g(k,["petName","userName"],[f,G]);break}case fe.CHAT_TYPE_PETRESPECT:R=g("widget.chatbubble.petrespect",["petname"],[f]);break;case fe.CHAT_TYPE_PETTREAT:R=g("widget.chatbubble.pettreat",["petname"],[f]);break;case fe.CHAT_TYPE_HAND_ITEM_RECEIVED:R=g("widget.chatbubble.handitem",["username","handitem"],[f,g("handitem"+c.extraParam)]);break;case fe.CHAT_TYPE_MUTE_REMAINING:{const k=(c.extraParam>0?Math.floor(c.extraParam/3600):0).toString(),G=(c.extraParam>0?Math.floor(c.extraParam%3600/60):0).toString(),j=(c.extraParam%60).toString();R=g("widget.chatbubble.mutetime",["hours","minutes","seconds"],[k,G,j]);break}}const L=Rq(R),M=E&&("#"+E.toString(16).padStart(6,"0")||null),P=new tR(d.roomIndex,Y.UNIT,r.roomId,R,L,f,{x:h.x,y:h.y},I,p,m,M,S);t(k=>[...k,P]),n({id:-1,webId:d.webID,entityId:d.roomIndex,name:f,imageUrl:m,style:p,chatType:I,entityType:d.type,message:L,timestamp:sU(),type:On.TYPE_CHAT,roomId:r.roomId,color:M,chatColours:S})}),ft(A_.ROOM_DRAG,c=>{if(!a.length||c.roomId!==r.roomId)return;const u=c.offsetX;a.forEach(h=>h.elementRef&&(h.left+=u))}),z($a,c=>{const u=c.getParser();u.roomEnter&&s(u.chat)}),z(Qy,c=>{const u=c.getParser();s(u.chat)}),_.useEffect(()=>(o.current=!1,()=>{o.current=!0}),[]),{chatMessages:a,setChatMessages:t,chatSettings:e,getScrollSpeed:l}},v8=D8,P8=()=>{const[a,t]=_.useState([]),e=n=>{a.indexOf(n)>=0||t([...a,n])},s=n=>{const o=a.indexOf(n);if(o===-1)return;const l=[...a];l.splice(o,1),t(l)},r=(n,o)=>{Se().sendDoorbellApprovalMessage(n,o),s(n)};return ft(In.DOORBELL,n=>e(n.userName)),ft(In.RSDE_REJECTED,n=>s(n.userName)),ft(In.RSDE_ACCEPTED,n=>s(n.userName)),{users:a,addUser:e,removeUser:s,answer:r}},L8=P8,U8=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(!1),r=()=>s(!1);return z(Ey,n=>{const o=n.getParser();s(!0),t(o.words)}),{wordsFilter:a,isVisible:e,setWordsFilter:t,onClose:r}},j8=U8,w8=()=>{const[a,t]=_.useState([]),{requests:e=[],dismissedRequestIds:s=[],setDismissedRequestIds:r=null}=gr(),n=_.useMemo(()=>a.filter(l=>s.indexOf(l.request.requesterUserId)===-1),[a,s]),o=l=>{r(c=>{if(c.indexOf(l)>=0)return c;const u=[...c];return u.push(l),u})};return OU(!0,l=>{if(l.category!==Y.UNIT)return;const c=Se().userDataManager.getUserDataByIndex(l.id);if(!c||c.type!==Ue.getTypeNumber(Ue.USER))return;const u=e.find(d=>d.requesterUserId===c.webID);if(!u||a.find(d=>d.request.requesterUserId===c.webID))return;const h=[...a];h.push({roomIndex:c.roomIndex,request:u}),t(h)}),AU(!0,l=>{if(l.category!==Y.UNIT)return;const c=a.findIndex(h=>h.roomIndex===l.id);if(c===-1)return;const u=[...a];u.splice(c,1),t(u)}),_.useEffect(()=>{const l=[];for(const c of e){const u=Se().userDataManager.getUserData(c.requesterUserId);u&&l.push({roomIndex:u.roomIndex,request:c})}t(l)},[e]),{displayedRequests:n,hideFriendRequest:o}},F8=w8,G8=()=>{const[a,t]=_.useState(null),{roomSession:e=null}=Le(),s=()=>t(null),r=o=>o&&rt().selectRoomObject(Se().roomId,o.id,o.category),n=()=>{const o=tt(),l=rt().getRoomObjects(e.roomId,Y.WALL),c=rt().getRoomObjects(e.roomId,Y.FLOOR),u=l.map(d=>{if(d.id<0)return null;let f=d.type;if(f.startsWith("poster"))f=g(`poster_${f.replace("poster","")}_name`);else{const E=d.model.getValue(A.FURNITURE_TYPE_ID),m=o.getWallItemData(E);m&&m.name.length&&(f=m.name)}return new Tc(d.id,Y.WALL,f)}),h=c.map(d=>{if(d.id<0)return null;let f=d.type;const E=d.model.getValue(A.FURNITURE_TYPE_ID),m=o.getFloorItemData(E);return m&&m.name.length&&(f=m.name),new Tc(d.id,Y.FLOOR,f)});t([...u,...h].sort((d,f)=>d.name<f.name?-1:1))};return C7(!!a,o=>{if(o.id<0)return;const l=rt().getRoomObject(Se().roomId,o.id,o.category);if(!l)return;let c=null;switch(o.category){case Y.WALL:{let u=l.type;if(u.startsWith("poster"))u=g(`poster_${u.replace("poster","")}_name`);else{const h=l.model.getValue(A.FURNITURE_TYPE_ID),d=tt().getWallItemData(h);d&&d.name.length&&(u=d.name)}c=new Tc(l.id,Y.WALL,u);break}case Y.FLOOR:{let u=l.type;const h=l.model.getValue(A.FURNITURE_TYPE_ID),d=tt().getFloorItemData(h);d&&d.name.length&&(u=d.name),c=new Tc(l.id,Y.FLOOR,u)}}t(u=>[...u,c].sort((h,d)=>h.name<d.name?-1:1))}),Pr(!!a,o=>{o.id<0||t(l=>{const c=[...l];for(let u=0;u<c.length;u++){const h=c[u];if(!(h.id!==o.id||h.category!==o.category)){c.splice(u,1);break}}return c})}),{items:a,onClose:s,selectItem:r,populateChooser:n}},k8=G8,B8=()=>{const[a,t]=_.useState(!1),[e,s]=_.useState(-1),[r,n]=_.useState(""),[o,l]=_.useState(""),[c,u]=_.useState(""),h=()=>{u(""),l(""),n(""),s(-1),t(!1)},d=()=>{H(new dS(e,o))},f=m=>{l(m),c.length>0&&u("")},E=m=>{if(!(!m||m===0))switch(m){case 1:return g("catalog.alert.petname.long");case 2:return g("catalog.alert.petname.short");case 3:return g("catalog.alert.petname.chars");case 4:default:return g("catalog.alert.petname.bobba")}};return ft(bo.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,m=>{if(!m)return;const I=rt().getRoomObject(m.session.roomId,m.objectId,Y.FLOOR);s(m.objectId),n(I.type),t(!0)}),ft(bo.RSOPPE_OPEN_PET_PACKAGE_RESULT,m=>{m&&(m.nameValidationStatus===0&&h(),m.nameValidationStatus!==0&&u(E(m.nameValidationStatus)))}),{isVisible:a,errorResult:c,petName:o,objectType:r,onChangePetName:f,onConfirm:d,onClose:h}},V8=B8,H8=()=>{const{roomSession:a=null}=Le(),t=r=>a.sendPollStartMessage(r),e=r=>a.sendPollRejectMessage(r),s=(r,n,o)=>a.sendPollAnswerMessage(r,n,o);return ft(mn.OFFER,r=>{const n=new oo(oo.OFFER,r.id);n.summary=r.summary,n.headline=r.headline,Ps(n)}),ft(mn.ERROR,r=>{const n=new oo(oo.ERROR,r.id);n.summary=r.summary,n.headline=r.headline,Ps(n)}),ft(mn.CONTENT,r=>{const n=new oo(oo.CONTENT,r.id);n.startMessage=r.startMessage,n.endMessage=r.endMessage,n.numQuestions=r.numQuestions,n.questionArray=r.questionArray,n.npsPoll=r.npsPoll,Ps(n)}),{startPoll:t,rejectPoll:e,answerPoll:s}},W8=H8,Y8=()=>{const[a,t]=_.useState(null);Le();const e=()=>t(null),s=n=>n&&rt().selectRoomObject(Se().roomId,n.id,n.category),r=()=>{const n=Se(),o=rt().getRoomObjects(n.roomId,Y.UNIT);t(o.map(l=>{if(l.id<0)return null;const c=n.userDataManager.getUserDataByIndex(l.id);return c?new Tc(c.roomIndex,Y.UNIT,c.name):null}).sort((l,c)=>l.name<c.name?-1:1))};return OU(!!a,n=>{if(n.id<0)return;const o=Se().userDataManager.getUserDataByIndex(n.id);o&&t(l=>{const c=[...l];return c.push(new Tc(o.roomIndex,Y.UNIT,o.name)),c.sort((u,h)=>u.name<h.name?-1:1),c})}),AU(!!a,n=>{n.id<0||t(o=>{const l=[...o];for(let c=0;c<l.length;c++){const u=l[c];if(!(u.id!==n.id||u.category!==n.category)){l.splice(c,1);break}}return l})}),{items:a,onClose:e,selectItem:s,populateChooser:r}},z8=Y8,CA=4e3,K8=3,X8=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(null),[r,n]=_.useState(!1),[o,l]=_.useState(null),[c,u]=_.useState(new Map),[h,d]=_.useState(new Map),{answerPoll:f=null}=W8(),{roomSession:E=null}=Le(),m=()=>{t(-1),s(null)},I=p=>{r||!e||(f(a,e.id,[p]),n(!0))};return ft(En.ANSWERED,p=>{const T=E.userDataManager.getUserData(p.userId);T&&(u(p.answerCounts),d(R=>{if(!R.has(T.roomIndex)){const S=new Map(h);return S.set(T.roomIndex,{value:p.value,secondsLeft:K8}),S}return R}),rt().updateRoomObjectUserGesture(E.roomId,T.roomIndex,St.getGestureId(p.value==="0"?St.GESTURE_SAD:St.GESTURE_SMILE)))}),ft(En.FINISHED,p=>{e&&e.id===p.questionId&&(u(p.answerCounts),n(!0),l(T=>(T&&clearTimeout(T),setTimeout(()=>m(),CA)))),d(new Map)}),ft(En.QUESTION,p=>{t(p.id),s(p.question),n(!1),u(new Map),d(new Map),l(T=>{if(T&&clearTimeout(T),p.duration>0){const R=p.duration<1e3?CA:p.duration;return setTimeout(()=>m(),R)}return null})}),_.useEffect(()=>{const p=()=>{d(R=>{const S=[];if(R.forEach((M,P)=>{M.secondsLeft--,M.secondsLeft<=0&&S.push(P)}),S.length===0)return R;const L=new Map(R);return S.forEach(M=>L.delete(M)),L})},T=setInterval(()=>p(),1e3);return()=>clearInterval(T)},[]),_.useEffect(()=>()=>{l(p=>(p&&clearTimeout(p),null))},[]),{question:e,answerSent:r,answerCounts:c,userAnswers:h,vote:I}},q8=X8,Q8=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[r,n]=Ja(0),[o,l]=Ja("chatColour",""),[c,u]=_.useState(0),[h,d]=_.useState(0),f=p=>{n(p),H(new bP(p))},E=p=>{l(p)},m=p=>{tt().giveRespect(p),u(tt().respectsLeft)},I=p=>{tt().givePetRespect(p),d(tt().respectsPetLeft)};return z(Su,p=>{const T=p.getParser();t(T.userInfo),s(T.userInfo.figure),u(T.userInfo.respectsRemaining),d(T.userInfo.respectsPetRemaining)}),z(DR,p=>{const T=p.getParser();s(T.figure)}),z(ZR,p=>{const T=p.getParser();n(T.chatType)}),{userInfo:a,userFigure:e,chatStyleId:r,userRespectRemaining:c,petRespectRemaining:h,respectUser:m,respectPet:I,updateChatStyleId:f,updateChatColour:E,chatColour:o}},to=()=>gs(Q8),sE=a=>{var p,T;const{rows:t=[],overscan:e=5,scrollToBottom:s=!1,rowRender:r=null}=a,n=t.length-1,o=_.useRef(null),{getVirtualItems:l,getTotalSize:c,scrollToIndex:u=null,measureElement:h}=DN({count:t.length,getScrollElement:()=>o.current,estimateSize:()=>8,overscan:e}),d=l(),f=c(),E=d.length>0&&((p=d==null?void 0:d[0])==null?void 0:p.start)||0,m=d.length>0?f-(((T=d==null?void 0:d[d.length-1])==null?void 0:T.end)||0):0,I=R=>{if(!o.current)return!1;const S=o.current,L=S.querySelector(`[data-index="${R-1}"]`);if(!L)return!1;const M=L.getBoundingClientRect(),{scrollTop:P,scrollHeight:k,clientHeight:G}=S;return P+G+M.height>=k-M.height};return wS(()=>{setTimeout(()=>u(n),0)}),_.useEffect(()=>{s&&I(n)&&u(n)},[s,n,u]),i.jsxs(V,{fit:!0,innerRef:o,position:"relative",overflow:"auto",children:[E>0&&i.jsx("div",{style:{minHeight:`${E}px`}}),d.map(R=>{const S=t[R.index];return S?i.jsx("div",{"data-index":R.index,ref:h,children:r(S)},R.key):i.jsx(_.Fragment,{},R.key)}),m>0&&i.jsx("div",{style:{minHeight:`${m}px`}})]})},O=a=>{const{variant:t="black",fontWeight:e=null,fontSize:s=0,align:r=null,bold:n=!1,underline:o=!1,italics:l=!1,truncate:c=!1,center:u=!1,textEnd:h=!1,small:d=!1,wrap:f=!1,noWrap:E=!1,textBreak:m=!1,...I}=a,p=_.useMemo(()=>{const T=["d-inline"];return t&&T.push("text-"+t),n&&T.push("fw-bold"),e&&T.push("fw-"+e),s&&T.push("fs-"+s),r&&T.push("text-"+r),o&&T.push("text-decoration-underline"),l&&T.push("fst-italic"),c&&T.push("text-truncate"),u&&T.push("text-center"),h&&T.push("text-end"),d&&T.push("small"),f&&T.push("text-wrap"),E&&T.push("text-nowrap"),m&&T.push("text-break"),T},[t,e,s,r,n,o,l,c,u,h,d,f,E,m]);return i.jsx(V,{classNames:p,...I})},xU=_.createContext({closers:null,setClosers:null,closeAll:null}),J8=a=>i.jsx(xU.Provider,{...a}),Z8=()=>_.useContext(xU),Dg=a=>{const{alignItems:t="center",gap:e=1,children:s=null,...r}=a;return i.jsx(x,{alignItems:t,gap:e,...r,children:s})},vg=a=>{const{headerText:t="",isExpanded:e=!1,gap:s=0,classNames:r=[],children:n=null,...o}=a,[l,c]=_.useState(!1),{setClosers:u=null,closeAll:h=null}=Z8(),d=()=>{h(),c(m=>!m)},f=_.useCallback(()=>c(!1),[]),E=_.useMemo(()=>{const m=["nitro-card-accordion-set"];return l&&m.push("active"),r&&r.length&&m.push(...r),m},[l,r]);return _.useEffect(()=>{c(e)},[e]),_.useEffect(()=>{const m=f;return u(I=>{const p=[...I];return p.push(m),p}),()=>{u(I=>{const p=[...I],T=p.indexOf(m);return T>=0&&p.splice(T,1),p})}},[f,u]),i.jsxs(N,{classNames:E,gap:s,...o,children:[i.jsxs(x,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:d,children:[i.jsx(O,{children:t}),l&&i.jsx(oR,{className:"fa-icon"}),!l&&i.jsx(lR,{className:"fa-icon"})]}),l&&i.jsx(N,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content",children:n})]})},$8=a=>{const{...t}=a,[e,s]=_.useState([]),r=_.useCallback(()=>{for(const n of e)n()},[e]);return i.jsx(J8,{value:{closers:e,setClosers:s,closeAll:r},children:i.jsx(N,{gap:0,...t})})},It=a=>{const{overflow:t="auto",classNames:e=[],...s}=a,r=_.useMemo(()=>{const n=["container-fluid","content-area"];return e.length&&n.push(...e),n},[e]);return i.jsx(N,{classNames:r,overflow:t,...s})},t9=_.createContext({theme:null}),e9=a=>i.jsx(t9.Provider,{value:a.value,children:a.children}),Nt=a=>{const{headerText:t=null,isGalleryPhoto:e=!1,noCloseButton:s=!1,onReportPhoto:r=null,onCloseClick:n=null,justifyContent:o="center",alignItems:l="center",classNames:c=[],children:u=null,...h}=a,d=_.useMemo(()=>{const E=["drag-handler","container-fluid","nitro-card-header"];return c.length&&E.push(...c),E},[c]),f=E=>{E.stopPropagation(),E.nativeEvent.stopImmediatePropagation()};return i.jsx(N,{center:!0,position:"relative",classNames:d,...h,children:i.jsxs(x,{fullWidth:!0,center:!0,children:[i.jsx("span",{className:"nitro-card-header-text",children:t}),e&&i.jsx(V,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:r,children:i.jsx(S0,{className:"fa-icon"})}),i.jsx(x,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:f,onClick:n,children:i.jsx(Dr,{className:"fa-icon w-12 h-12"})})]})})},yU=a=>{const{justifyContent:t="center",classNames:e=[],variant:s="muted",...r}=a,n=_.useMemo(()=>{const o=["container-fluid","p-1"];return e.length&&o.push(...e),o.push("bg-"+s),o},[e,s]);return i.jsx(x,{justifyContent:t,classNames:n,...r})},ru=class ru{};ru.CENTER="DWP_CENTER",ru.TOP_CENTER="DWP_TOP_CENTER",ru.TOP_LEFT="DWP_TOP_LEFT",ru.NOTHING="DWP_NOTHING";let oi=ru;const Oa=[],xA=0,yA=0,qo=a=>{const{uniqueKey:t=null,handleSelector:e=".drag-handler",windowPosition:s=oi.CENTER,disableDrag:r=!1,dragStyle:n={},children:o=null,offsetLeft:l=0,offsetTop:c=0}=a,[u,h]=_.useState(null),[d,f]=_.useState(null),[E,m]=_.useState({x:0,y:0}),[I,p]=_.useState(!1),[T,R]=_.useState(null),S=_.useRef(),L=_.useCallback(()=>{let Q=400;for(const ut of Oa)Q+=1,ut.style.zIndex=Q.toString()},[]),M=_.useCallback(()=>{const Q=Oa.indexOf(S.current);if(Q===-1)Oa.push(S.current);else{if(Q===Oa.length-1)return;Q>=0&&(Oa.splice(Q,1),Oa.push(S.current))}L()},[L]),P=_.useCallback(Q=>{M()},[M]),k=_.useCallback(Q=>{M()},[M]),G=_.useCallback((Q,ut)=>{m({x:Q,y:ut}),p(!0)},[]),j=_.useCallback(Q=>{G(Q.clientX,Q.clientY)},[G]),F=_.useCallback(Q=>{const ut=Q.touches[0];G(ut.clientX,ut.clientY)},[G]),U=_.useCallback(Q=>{h({x:Q.clientX-E.x,y:Q.clientY-E.y})},[E]),K=_.useCallback(Q=>{const ut=Q.touches[0];h({x:ut.clientX-E.x,y:ut.clientY-E.y})},[E]),B=_.useCallback(()=>{if(!S.current||!T)return;let Q=d.x+u.x,ut=d.y+u.y;const Bt=S.current.offsetLeft+Q,te=S.current.offsetTop+ut;if(te<xA?ut=-S.current.offsetTop:te+T.offsetHeight>=document.body.offsetHeight-xA&&(ut=document.body.offsetHeight-S.current.offsetHeight-S.current.offsetTop),Bt+S.current.offsetWidth<yA?Q=-S.current.offsetLeft:Bt>=document.body.offsetWidth-yA&&(Q=document.body.offsetWidth-S.current.offsetWidth-S.current.offsetLeft),h({x:0,y:0}),f({x:Q,y:ut}),p(!1),t!==null){const de={...qT(`nitro.windows.${t}`)};de.offset={x:Q,y:ut},vS(`nitro.windows.${t}`,de)}},[T,u,d,t]),J=_.useCallback(Q=>{B()},[B]),Z=_.useCallback(Q=>{B()},[B]);return _.useEffect(()=>{const Q=S.current;if(!Q)return;if(Oa.push(Q),L(),!r){const te=Q.querySelector(e);te&&R(te)}let ut=0,Bt=0;switch(s){case oi.TOP_CENTER:Q.style.top=50+c+"px",Q.style.left=`calc(50vw - ${Q.offsetWidth/2+l}px)`;break;case oi.CENTER:Q.style.top=`calc(50vh - ${Q.offsetHeight/2+c}px)`,Q.style.left=`calc(50vw - ${Q.offsetWidth/2+l}px)`;break;case oi.TOP_LEFT:Q.style.top=50+c+"px",Q.style.left=50+l+"px";break}return h({x:0,y:0}),f({x:ut,y:Bt}),()=>{const te=Oa.indexOf(Q);te>=0&&Oa.splice(te,1)}},[e,s,t,r,l,c,L]),_.useEffect(()=>{if(!d&&!u)return;const Q=S.current;Q&&(Q.style.transform=`translate(${d.x+u.x}px, ${d.y+u.y}px)`,Q.style.visibility="visible")},[d,u]),_.useEffect(()=>{if(T)return T.addEventListener(lt.MOUSE_DOWN,j),T.addEventListener(Vi.TOUCH_START,F),()=>{T.removeEventListener(lt.MOUSE_DOWN,j),T.removeEventListener(Vi.TOUCH_START,F)}},[T,j,F]),_.useEffect(()=>{if(I)return document.addEventListener(lt.MOUSE_UP,J),document.addEventListener(Vi.TOUCH_END,Z),document.addEventListener(lt.MOUSE_MOVE,U),document.addEventListener(Vi.TOUCH_MOVE,K),()=>{document.removeEventListener(lt.MOUSE_UP,J),document.removeEventListener(Vi.TOUCH_END,Z),document.removeEventListener(lt.MOUSE_MOVE,U),document.removeEventListener(Vi.TOUCH_MOVE,K)}},[I,J,U,Z,K]),_.useEffect(()=>{if(!t)return;const Q=qT(`nitro.windows.${t}`);!Q||!Q.offset||(h({x:0,y:0}),Q.offset&&f(Q.offset))},[t]),cR.createPortal(i.jsx(V,{position:"absolute",innerRef:S,className:"draggable-window",onMouseDownCapture:P,onTouchStartCapture:k,style:n,children:o}),document.getElementById("draggable-windows-container"))},Ct=a=>{const{theme:t="primary",uniqueKey:e=null,handleSelector:s=".drag-handler",windowPosition:r=oi.CENTER,disableDrag:n=!1,overflow:o="hidden",position:l="relative",gap:c=0,classNames:u=[],...h}=a,d=_.useRef(),f=_.useMemo(()=>{const E=["nitro-card","rounded","shadow"];return E.push(`theme-${t||"primary"}`),u.length&&E.push(...u),E},[t,u]);return i.jsx(e9,{value:{theme:t},children:i.jsx(qo,{uniqueKey:e,handleSelector:s,windowPosition:r,disableDrag:n,children:i.jsx(N,{innerRef:d,overflow:o,position:l,gap:c,classNames:f,...h})})})},CE=new Map,os=a=>{const{figure:t="",gender:e="M",headOnly:s=!1,direction:r=0,scale:n=1,classNames:o=[],style:l={},...c}=a,[u,h]=_.useState(null),[d,f]=_.useState(!1),E=_.useRef(!1),m=_.useMemo(()=>{const p=["avatar-image"];return o.length&&p.push(...o),p},[o]),I=_.useMemo(()=>{let p={};return u&&u.length&&(p.backgroundImage=`url('${u}')`),n!==1&&(p.transform=`scale(${n})`,n%1||(p.imageRendering="pixelated")),Object.keys(l).length&&(p={...p,...l}),p},[u,n,l]);return _.useEffect(()=>{if(!d)return;const p=[t,e,r,s].join("-");if(CE.has(p))h(CE.get(p));else{const T=R=>{if(E.current)return;const S=is().createAvatarImage(R,hr.LARGE,e,{resetFigure:P=>T(P),dispose:null,disposed:!1});let L=ai.FULL;s&&(L=ai.HEAD),S.setDirection(L,r);const M=S.processAsImageUrl(L);M&&!E.current&&(S.isPlaceholder()||CE.set(p,M),h(M)),S.dispose(!0)};T(t)}},[t,e,r,s,d]),_.useEffect(()=>(E.current=!1,f(!0),()=>{E.current=!0}),[]),i.jsx(V,{classNames:m,style:I,...c})},MU=a=>{const{imageUrl:t=null,fit:e=!0,style:s=null,...r}=a,n=_.useMemo(()=>{const o={...s};return t&&(o.background=`url(${t}) center no-repeat`),o},[s,t]);return i.jsx(V,{fit:e,style:n,...r})},Xe=a=>{const{badgeCode:t=null,isGroup:e=!1,showInfo:s=!1,customTitle:r=null,isGrayscale:n=!1,scale:o=1,classNames:l=[],style:c={},children:u=null,...h}=a,[d,f]=_.useState(null),E=_.useMemo(()=>{const I=["badge-image"];return e&&I.push("group-badge"),n&&I.push("grayscale"),l.length&&I.push(...l),I},[l,e,n]),m=_.useMemo(()=>{let I={};return d&&(I.backgroundImage=`url(${e?d.src:ct("badge.asset.url").replace("%badgename%",t.toString())})`,I.width=d.width,I.height=d.height,o!==1&&(I.transform=`scale(${o})`,o%1||(I.imageRendering="pixelated"),I.width=d.width*o,I.height=d.height*o)),Object.keys(c).length&&(I={...I,...c}),I},[t,e,d,o,c]);return _.useEffect(()=>{if(!t||!t.length)return;let I=!1;const p=async R=>{if(R.badgeId!==t)return;const S=await me.generateImage(new dd(R.image));S.onload=()=>f(S),I=!0,X().removeEventListener(Za.IMAGE_READY,p)};X().addEventListener(Za.IMAGE_READY,p);const T=e?tt().getGroupBadgeImage(t):tt().getBadgeImage(t);return T&&!I&&(async()=>{const R=await me.generateImage(new dd(T));R.onload=()=>f(R)})(),()=>X().removeEventListener(Za.IMAGE_READY,p)},[t,e]),i.jsxs(V,{classNames:E,style:m,...h,children:[s&&ct("badge.descriptions.enabled",!0)&&i.jsxs(V,{className:"badge-information text-black py-1 px-2 small",children:[i.jsx("div",{className:"fw-bold mb-1",children:e?r:vd(t)}),i.jsx("div",{children:e?g("group.badgepopup.body"):DS(t)})]}),u]})},s9=a=>{const{day:t="00",hour:e="00",minutes:s="00",seconds:r="00",classNames:n=[],children:o=null,...l}=a,c=_.useMemo(()=>{const u=["nitro-counter-time"];return n.length&&u.push(...n),u},[n]);return i.jsxs(x,{gap:1,children:[i.jsx(V,{classNames:c,...l,children:i.jsxs("div",{children:[t!="00"?t:e,t!="00"?g("countdown_clock_unit_days"):g("countdown_clock_unit_hours")]})}),i.jsx(V,{style:{marginTop:"3px"},children:":"}),i.jsx(V,{classNames:c,...l,children:i.jsxs("div",{children:[s,g("countdown_clock_unit_minutes")]})}),i.jsx(V,{style:{marginTop:"3px"},children:":"}),i.jsx(V,{classNames:c,...l,children:i.jsxs("div",{children:[r,g("countdown_clock_unit_seconds")]})}),o]})},ps=a=>{const{type:t="",classNames:e=[],style:s={},...r}=a,n=_.useMemo(()=>{const c=["nitro-currency-icon topcurrencygen"];return e.length&&c.push(...e),c},[e]),o=_.useMemo(()=>{let c=ct("currency.asset.icon.url","");return c=c.replace("%type%",t.toString()),`url(${c})`},[t]),l=_.useMemo(()=>{let c={};return c.backgroundImage=o,Object.keys(s).length&&(c={...c,...s}),c},[s,o]);return i.jsx(V,{classNames:n,style:l,...r})},Ta=a=>{const{imageUrl:t=null,className:e="",...s}=a;return i.jsx("img",{src:t,className:"no-select "+e,alt:"",...s})},iE=a=>{const{productType:t="s",productClassId:e=-1,direction:s=2,extraData:r="",scale:n=1,style:o={},...l}=a,[c,u]=_.useState(null),h=_.useMemo(()=>{var f;let d={};return(f=c==null?void 0:c.src)!=null&&f.length&&(d.backgroundImage=`url('${c.src}')`,d.width=c.width,d.height=c.height),n!==1&&(d.transform=`scale(${n})`,n%1||(d.imageRendering="pixelated")),Object.keys(o).length&&(d={...d,...o}),d},[c,n,o]);return _.useEffect(()=>{let d=null;const f={imageReady:async(E,m,I)=>u(await me.generateImage(m)),imageFailed:null};switch(t.toLocaleLowerCase()){case kt.FLOOR:d=rt().getFurnitureFloorImage(e,new w(s),64,f,0,r);break;case kt.WALL:d=rt().getFurnitureWallImage(e,new w(s),64,f,0,r);break}d&&(async()=>u(await me.generateImage(d.data)))()},[t,e,s,r]),c?i.jsx(V,{classNames:["furni-image"],style:h,...l}):null},bU=a=>{const{figure:t=null,userName:e=null,message:s=null,editable:r=!1,onChange:n=null}=a;return i.jsxs(x,{overflow:"hidden",className:"nitro-gift-card text-black",children:[i.jsxs("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!e&&i.jsx("div",{className:"gift-incognito"}),t&&i.jsx("div",{className:"gift-avatar",children:i.jsx(os,{figure:t,direction:2,headOnly:!0})})]}),i.jsx(x,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:i.jsxs(N,{grow:!0,overflow:"auto",justifyContent:"between",children:[!r&&i.jsx(O,{textBreak:!0,className:"gift-message",children:s}),r&&n!==null&&i.jsx("textarea",{className:"gift-message h-100",maxLength:140,value:s,onChange:o=>n(o.target.value),placeholder:g("catalog.gift_wrapping_new.message_hint")}),e&&i.jsx(O,{italics:!0,textEnd:!0,className:"pe-1",children:g("catalog.gift_wrapping_new.message_from",["name"],[e])})]})})]})},ko=a=>{const{count:t=0,position:e="absolute",classNames:s=[],children:r=null,...n}=a,o=_.useMemo(()=>{const l=["badge","border","border-black","bg-danger","px-1","nitro-item-count"];return s.length&&l.push(...s),l},[s]);return i.jsxs(V,{position:"absolute",classNames:o,...n,children:[t,r]})},Nd=a=>{const{value:t=0}=a,e=t.toString().split("");return i.jsx(i.Fragment,{children:e.map((s,r)=>i.jsx("i",{className:"limited-edition-number n-"+s},r))})},DU=a=>{const{uniqueNumber:t=0,uniqueSeries:e=0,classNames:s=[],children:r=null,...n}=a,o=_.useMemo(()=>{const l=["unique-compact-plate","z-index-1"];return s.length&&l.push(...s),l},[s]);return i.jsxs(V,{classNames:o,...n,children:[i.jsx("div",{children:i.jsx(Nd,{value:t})}),i.jsx("div",{children:i.jsx(Nd,{value:e})}),r]})},i9=a=>{const{uniqueLimitedItemsLeft:t=0,uniqueLimitedSeriesSize:e=0,classNames:s=[],...r}=a,n=_.useMemo(()=>{const o=["unique-complete-plate"];return s.length&&o.push(...s),o},[s]);return i.jsx(V,{classNames:n,...r,children:i.jsxs(N,{className:"plate-container",gap:0,children:[i.jsxs(x,{justifyContent:"between",alignItems:"center",children:[g("unique.items.left"),i.jsx("div",{children:i.jsx(Nd,{value:t})})]}),i.jsxs(x,{justifyContent:"between",alignItems:"center",children:[g("unique.items.number.sold"),i.jsx("div",{children:i.jsx(Nd,{value:e})})]})]})})},$t=a=>{const{itemImage:t=void 0,itemColor:e=void 0,itemActive:s=!1,itemCount:r=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:u=!1,disabled:h=!1,center:d=!0,column:f=!0,style:E={},classNames:m=[],position:I="relative",overflow:p="hidden",children:T=null,...R}=a,S=_.useMemo(()=>{const M=["layout-grid-item","border","border-2","border-muted","rounded"];return s&&M.push("active"),(o||l>0)&&M.push("unique-item"),o&&M.push("sold-out"),c&&M.push("unseen"),u&&M.push("has-highlight"),h&&M.push("disabled"),t===null&&M.push("icon","loading-icon"),m.length&&M.push(...m),M},[s,o,l,c,u,h,t,m]),L=_.useMemo(()=>{let M={...E};return t&&!(o||l>0)&&(M.backgroundImage=`url(${t})`),e&&(M.backgroundColor=e),Object.keys(E).length&&(M={...M,...E}),M},[E,t,e,o,l]);return i.jsxs(N,{center:d,pointer:!0,position:I,overflow:p,column:f,classNames:S,style:L,...R,children:[r>n&&i.jsx(ko,{count:r}),l>0&&i.jsxs(i.Fragment,{children:[i.jsx(V,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${t})`}}),i.jsx("div",{className:"position-absolute bottom-0 unique-item-counter",children:i.jsx(Nd,{value:l})})]}),T]})},kS=a=>{const{...t}=a;return i.jsxs(V,{classNames:["spinner-container"],...t,children:[i.jsx(V,{className:"spinner"}),i.jsx(V,{className:"spinner"}),i.jsx(V,{className:"spinner"})]})},r9=a=>{const{roomId:t=-1,textureReceiver:e=null,onClose:s=null}=a,r=_.useRef(),n=()=>{if(!r||!r.current)return null;const l=r.current.getBoundingClientRect();return new xS(Math.floor(l.x),Math.floor(l.y),Math.floor(l.width),Math.floor(l.height))},o=()=>{ma(Ea.CAMERA_SHUTTER),e(rt().createTextureFromRoom(t,1,n()))};return i.jsx(qo,{handleSelector:".nitro-room-thumbnail-camera",children:i.jsxs("div",{className:"nitro-room-thumbnail-camera px-2",children:[i.jsx("div",{ref:r,className:"camera-frame"}),i.jsxs("div",{className:"d-flex align-items-end h-100 pb-2",children:[i.jsx("button",{className:"btn btn-sm btn-danger w-100 mb-1 me-2",onClick:s,children:g("cancel")}),i.jsx("button",{className:"btn btn-sm btn-success w-100 mb-1",onClick:o,children:g("navigator.thumbeditor.save")})]})]})})},BS=a=>{const{title:t="",onClose:e=null,classNames:s=[],children:r=null,type:n=Yt.DEFAULT,...o}=a,l=_.useMemo(()=>{const c=["nitro-alert"];return c.push("nitro-alert-"+n),s.length&&c.push(...s),c},[s,n]);return i.jsxs(Ct,{classNames:l,theme:"primary-slim",...o,children:[i.jsx(Nt,{headerText:t,onCloseClick:e}),i.jsx(It,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:r})]})},n9=a=>{const{title:t="",onClose:e=null,classNames:s=[],children:r=null,type:n=Yt.DEFAULT,...o}=a,l=_.useMemo(()=>{const c=["nitro-alert","nitro-alert-credits"];return s.length&&c.push(...s),c},[s,n]);return i.jsxs(Ct,{classNames:l,theme:"primary",...o,children:[i.jsx(Nt,{headerText:t,onCloseClick:e}),i.jsx(It,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:r})]})},VS=a=>{const{fadesOut:t=!0,timeoutMs:e=8e3,onClose:s=null,overflow:r="hidden",classNames:n=[],...o}=a,[l,c]=_.useState(!1),u=_.useMemo(()=>{const h=["nitro-notification-bubble","rounded"];return n.length&&h.push(...n),h},[n]);return _.useEffect(()=>(c(!0),()=>c(!1)),[]),_.useEffect(()=>{if(!t)return;const h=setTimeout(()=>{c(!1),setTimeout(()=>s(),300)},e);return()=>clearTimeout(h)},[t,e,s]),i.jsx(hu,{children:l&&i.jsx(du.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i.jsx(x,{overflow:r,classNames:u,onClick:s,...o})})})},ia=a=>{const{figure:t="",typeId:e=-1,paletteId:s=-1,petColor:r=16777215,customParts:n=[],posture:o="std",headOnly:l=!1,direction:c=0,scale:u=1,style:h={},...d}=a,[f,E]=_.useState(null),[m,I]=_.useState(0),[p,T]=_.useState(0),R=_.useRef(!1),S=_.useMemo(()=>{let L={};return f&&f.length&&(L.backgroundImage=`url(${f})`),u!==1&&(L.transform=`scale(${u})`,u%1||(L.imageRendering="pixelated")),L.width=m,L.height=p,Object.keys(h).length&&(L={...L,...h}),L},[f,u,h,m,p]);return _.useEffect(()=>{let L=e,M=s,P=r,k=n,G=l;if(t&&t.length){const F=new da(t);L=F.typeId,M=F.paletteId,P=F.color,k=F.customParts}L===16&&(G=!1);const j=rt().getRoomObjectPetImage(L,M,P,new w(c*45),64,{imageReady:async(F,U,K)=>{R.current||(K?(E(K.src),I(K.width),T(K.height)):U&&(E(await me.generateImageUrl(U)),I(U.width),T(U.height)))},imageFailed:F=>{}},G,0,k,o);j&&(async()=>{const F=await j.getImage();F&&(E(F.src),I(F.width),T(F.height))})()},[t,e,s,r,n,o,l,c]),_.useEffect(()=>(R.current=!1,()=>{R.current=!0}),[]),i.jsx(V,{classNames:["pet-image"],style:S,...d})},vU=a=>{const{text:t="",progress:e=0,maxProgress:s=100,position:r="relative",justifyContent:n="center",classNames:o=[],children:l=null,...c}=a,u=_.useMemo(()=>{const h=["nitro-progress-bar","text-white"];return o.length&&h.push(...o),h},[o]);return i.jsxs(N,{position:r,justifyContent:n,classNames:u,...c,children:[t&&t.length>0&&i.jsx(x,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:t}),i.jsx(V,{className:"nitro-progress-bar-inner",style:{width:~~((e-0)*100/(s-0)+0)+"%"}}),l]})},HS=a=>{const{level:t=0,classNames:e=[],children:s=null,...r}=a,n=_.useMemo(()=>{const o=["nitro-rarity-level"];return e.length&&o.push(...e),o},[e]);return i.jsxs(V,{classNames:n,...r,children:[i.jsx("div",{children:t}),s]})},a9=a=>{const{roomId:t=-1,objectId:e=1,category:s=-1,direction:r=2,scale:n=1,style:o={},...l}=a,[c,u]=_.useState(null),h=_.useMemo(()=>{var f;let d={};return(f=c==null?void 0:c.src)!=null&&f.length&&(d.backgroundImage=`url('${c.src}')`,d.width=c.width,d.height=c.height),n!==1&&(d.transform=`scale(${n})`,n%1||(d.imageRendering="pixelated")),Object.keys(o).length&&(d={...d,...o}),d},[c,n,o]);return _.useEffect(()=>{const d=rt().getRoomObjectImage(t,e,s,new w(r*45),64,{imageReady:async(f,E,m)=>u(await me.generateImage(E)),imageFailed:null});d&&(async()=>u(await me.generateImage(d.data)))()},[t,e,s,r,n]),c?i.jsx(V,{classNames:["furni-image"],style:h,...l}):null},rE=a=>{const{roomPreviewer:t=null,height:e=0,children:s=null}=a,r=_.useRef(),n=o=>{t&&(o.shiftKey?t.changeRoomObjectDirection():t.changeRoomObjectState())};return _.useEffect(()=>{if(!r)return;const o=r.current.parentElement.clientWidth,l=me.createRenderTexture(o,e),c=async h=>{if(!t||!r.current)return;const d=t.getRoomCanvas(o,e);if(!t.getRenderingCanvas().canvasUpdated)return;t.updatePreviewRoomView(),Mr().render({target:l,container:d,clear:!0});const E=await me.generateImageUrl(l);!r||!r.current||(r.current.style.backgroundImage=`url(${E})`)};Ti().add(c);const u=new ResizeObserver(()=>{if(!t||!r.current)return;const h=r.current.parentElement.offsetWidth;t.modifyRoomCanvas(h,e),c(Ti())});return u.observe(r.current),()=>{Ti().remove(c),u.disconnect(),l.destroy(!0)}},[t,r,e]),i.jsxs("div",{className:"room-preview-container",children:[i.jsx("div",{ref:r,className:"room-preview-image",style:{height:e},onClick:n}),s]})},nE=a=>{const{roomId:t=-1,customUrl:e=null,shrink:s=!0,overflow:r="hidden",classNames:n=[],children:o=null,...l}=a,c=_.useMemo(()=>{const h=["room-thumbnail","rounded","border"];return n.length&&h.push(...n),h},[n]),u=_.useMemo(()=>e&&e.length?ct("image.library.url")+e:ct("thumbnails.url").replace("%thumbnail%",t.toString()),[e,t]);return i.jsxs(V,{shrink:s,overflow:r,classNames:c,...l,children:[u&&i.jsx("img",{alt:"",src:u}),o]})},PU=a=>{const{color:t="",message:e="",date:s="",senderName:r="",customTitle:n=null,onCloseClick:o=null}=a;return i.jsx(qo,{handleSelector:".drag-handler",children:i.jsxs(N,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${t}`,children:[i.jsxs(x,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[i.jsx(V,{position:"absolute",pointer:!0,className:"trophy-close",onClick:o}),i.jsx(O,{bold:!0,children:g("widget.furni.trophy.title")})]}),i.jsxs(N,{className:"trophy-content py-1",gap:1,children:[n&&i.jsx(O,{bold:!0,children:n}),e]}),i.jsxs(x,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[i.jsx(O,{bold:!0,children:s}),i.jsx(O,{bold:!0,children:r})]})]})})},br=a=>{const{userId:t=0,userName:e=null,classNames:s=[],pointer:r=!0,children:n=null,...o}=a,l=_.useMemo(()=>{const c=["nitro-friends-spritesheet","icon-profile-sm"];return s.length&&c.push(...s),c},[s]);return i.jsx(V,{classNames:l,pointer:r,onClick:c=>Ki(t),...o,children:n})},Ia=a=>{const{isActive:t=!1,count:e=0,overflow:s="hidden",position:r="relative",pointer:n=!0,classNames:o=[],children:l=null,...c}=a,u=_.useMemo(()=>{const h=["nav-item","rounded-top","border"];return t&&h.push("active"),o.length&&h.push(...o),h},[t,o]);return i.jsxs(x,{overflow:s,pointer:n,position:r,classNames:u,...c,children:[i.jsx(x,{shrink:!0,center:!0,children:l}),e>0&&i.jsx(ko,{count:e})]})},eo=a=>{const{justifyContent:t="center",gap:e=1,classNames:s=[],children:r=null,...n}=a,o=_.useMemo(()=>{const l=["container-fluid","nitro-card-tabs","pt-1"];return s.length&&l.push(...s),l},[s]);return i.jsx(x,{justifyContent:t,gap:e,classNames:o,...n,children:r})},fi=(...a)=>a.filter(Boolean).join(" "),o9=a=>{const{isError:t=!1,message:e=""}=a;return i.jsx(N,{fullHeight:!0,position:"relative",className:"nitro-loading",children:i.jsx(V,{fullHeight:!0,className:"container h-100",children:i.jsxs(N,{fullHeight:!0,alignItems:"center",justifyContent:"end",children:[i.jsx(V,{className:"connecting-duck"}),i.jsx(V,{className:"logo"}),i.jsx(N,{size:6,className:"text-center py-4",children:t&&e&&e.length?i.jsx(V,{className:"fs-4 text-shadow",children:e}):i.jsx(i.Fragment,{children:i.jsx(O,{fontSize:4,variant:"white",className:"text-shadow",children:"The hotel is loading ..."})})})]})})})},LU=a=>{const{achievement:t=null,scale:e=1,...s}=a;return t?i.jsx(Xe,{badgeCode:dr.getAchievementBadgeCode(t),isGrayscale:!dr.getAchievementHasStarted(t),scale:e,...s}):null},l9=a=>{const{achievement:t=null}=a,{selectedAchievement:e=null,setSelectedAchievementId:s=null}=Zm();return t?i.jsx($t,{itemActive:e===t,itemUnseen:t.unseen>0,onClick:r=>s(t.achievementId),children:i.jsx(LU,{achievement:t})}):null},c9=a=>{const{achievements:t=null}=a;return i.jsx(Fe,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:t&&t.length>0&&t.map((e,s)=>i.jsx(l9,{achievement:e},s))})},u9=a=>{const{achievement:t=null}=a;return t?i.jsxs(x,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[i.jsxs(N,{center:!0,gap:1,children:[i.jsx(LU,{className:"nitro-achievements-badge-image",achievement:t,scale:2}),i.jsx(O,{fontWeight:"bold",children:g("achievements.details.level",["level","limit"],[dr.getAchievementLevel(t).toString(),t.levelCount.toString()])})]}),i.jsxs(N,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontWeight:"bold",truncate:!0,children:vd(dr.getAchievementBadgeCode(t))}),i.jsx(O,{textBreak:!0,children:DS(dr.getAchievementBadgeCode(t))})]}),(t.levelRewardPoints>0||t.scoreLimit>0)&&i.jsxs(N,{gap:1,children:[t.levelRewardPoints>0&&i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{truncate:!0,className:"small",children:g("achievements.details.reward")}),i.jsxs(x,{center:!0,className:"fw-bold small",gap:1,children:[t.levelRewardPoints,i.jsx(ps,{type:t.levelRewardPointType})]})]}),t.scoreLimit>0&&i.jsx(vU,{text:g("achievements.details.progress",["progress","limit"],[(t.currentPoints+t.scoreAtStartOfLevel).toString(),(t.scoreLimit+t.scoreAtStartOfLevel).toString()]),progress:t.currentPoints+t.scoreAtStartOfLevel,maxProgress:t.scoreLimit+t.scoreAtStartOfLevel})]})]})]}):null},h9=a=>{const{category:t=null}=a,{selectedAchievement:e=null,setSelectedAchievementId:s=null}=Zm();return _.useEffect(()=>{var r,n;t&&(e||s((n=(r=t==null?void 0:t.achievements)==null?void 0:r[0])==null?void 0:n.achievementId))},[t,e,s]),t?i.jsxs(N,{fullHeight:!0,justifyContent:"between",children:[i.jsx(c9,{achievements:t.achievements}),!!e&&i.jsx(u9,{achievement:e})]}):null},d9=a=>{const{category:t=null,selectedCategoryCode:e=null,setSelectedCategoryCode:s=null}=a;if(!t)return null;const r=dr.getAchievementCategoryProgress(t),n=dr.getAchievementCategoryMaxProgress(t),o=dr.getAchievementCategoryImageUrl(t,r),l=dr.getAchievementCategoryTotalUnseen(t);return i.jsxs($t,{itemActive:e===t.code,itemCount:l,itemCountMinimum:0,gap:1,onClick:c=>s(t.code),children:[i.jsx(O,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:g(`quests.${t.code}.name`)}),i.jsx(MU,{position:"relative",imageUrl:o,children:i.jsxs(O,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[r," / ",n]})})]})},_9=a=>{const{categories:t=null,selectedCategoryCode:e=null,setSelectedCategoryCode:s=null}=a;return i.jsx(Fe,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:t&&t.length>0&&t.map((r,n)=>i.jsx(d9,{category:r,selectedCategoryCode:e,setSelectedCategoryCode:s},n))})},g9=a=>{const[t,e]=_.useState(!1),{achievementCategories:s=[],selectedCategoryCode:r=null,setSelectedCategoryCode:n=null,achievementScore:o=0,getProgress:l=0,getMaxProgress:c=0,selectedCategory:u=null}=Zm();return _.useEffect(()=>{const h={linkReceived:d=>{const f=d.split("/");if(!(f.length<2))switch(f[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(E=>!E);return}},eventUrlPrefix:"achievements/"};return As(h),()=>Ns(h)},[]),t?i.jsxs(Ct,{uniqueKey:"achievements",className:"nitro-achievements",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("inventory.achievements"),onCloseClick:h=>e(!1)}),u&&i.jsxs(yU,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[i.jsx(V,{onClick:h=>n(null),className:"nitro-achievements-back-arrow"}),i.jsxs(N,{grow:!0,gap:0,children:[i.jsx(O,{fontSize:4,fontWeight:"bold",className:"text-small",children:g(`quests.${u.code}.name`)}),i.jsx(O,{children:g("achievements.details.categoryprogress",["progress","limit"],[u.getProgress().toString(),u.getMaxProgress().toString()])})]}),i.jsx(Ta,{imageUrl:dr.getAchievementCategoryImageUrl(u,null,!0)})]}),i.jsxs(It,{gap:1,children:[!u&&i.jsxs(i.Fragment,{children:[i.jsx(_9,{categories:s,selectedCategoryCode:r,setSelectedCategoryCode:n}),i.jsxs(N,{grow:!0,justifyContent:"end",gap:1,children:[i.jsx(O,{small:!0,center:!0,children:g("achievements.categories.score",["score"],[o.toString()])}),i.jsx(vU,{text:g("achievements.categories.totalprogress",["progress","limit"],[l.toString(),c.toString()]),progress:l,maxProgress:c})]})]}),u&&i.jsx(h9,{category:u})]})]}):null},Bo=a=>{const{icon:t=null,selected:e=!1,classNames:s=[],children:r=null,...n}=a,o=_.useMemo(()=>{const l=["nitro-avatar-editor-spritesheet"];return t&&t.length&&l.push(t+"-icon"),e&&l.push("selected"),s.length&&l.push(...s),l},[t,e,s]);return i.jsx(V,{classNames:o,...n})},f9=4,m9=a=>{const[t,e]=_.useState(f9),{getFigureString:s=null}=$l(),r=n=>{t<Jr.MIN_DIRECTION&&(n=Jr.MAX_DIRECTION+(t+1)),t>Jr.MAX_DIRECTION&&(n=t-(Jr.MAX_DIRECTION+1)),e(n)};return i.jsxs(N,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[i.jsx(os,{figure:s,direction:t,scale:2}),i.jsx(Bo,{className:"avatar-spotlight",icon:"spotlight"}),i.jsx(V,{className:"avatar-shadow"}),i.jsxs(V,{className:"arrow-container",children:[i.jsx(Bo,{pointer:!0,icon:"arrow-left",onClick:n=>r(t+1)}),i.jsx(Bo,{pointer:!0,icon:"arrow-right",onClick:n=>r(t-1)})]})]})},E9=a=>{var h;const{setType:t=null,partItem:e=null,isSelected:s=!1,...r}=a,[n,o]=_.useState(""),{selectedColorParts:l=null,getFigureStringWithFace:c=null}=$l(),u=!ct("hc.disabled",!1)&&(((h=e.partSet)==null?void 0:h.clubLevel)??0)>0;return _.useEffect(()=>{if(!t||!t.length||!e)return;(async()=>{var m;const f=!ct("hc.disabled",!1)&&(((m=e.partSet)==null?void 0:m.clubLevel)??0)>0;let E=null;t===At.HEAD?E=await md.buildForFace(c(e.id),f):E=await md.build(t,e,e.usesColor,l[t]??null,f),E&&E.length&&o(E)})()},[t,e,l,c]),e?i.jsxs($t,{itemImage:e.isClear?void 0:n,itemActive:s,style:{width:"100%",flex:"1",backgroundPosition:t===At.HEAD?"center -35px":"center"},...r,children:[!e.isClear&&u&&i.jsx(ps,{className:"position-absolute end-1 bottom-1",type:"hc"}),e.isClear&&i.jsx(Bo,{icon:"clear"}),!e.isClear&&e.partSet.isSellable&&i.jsx(Bo,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"})]}):null},p9=a=>{const{category:t=null}=a,{selectedParts:e=null,selectEditorPart:s}=$l(),r=n=>!t||!t.setType||!e?!1:e[t.setType]?e[t.setType]===n.id:!!n.isClear;return i.jsx(jS,{rows:t.partItems,columnCount:3,overscan:5,itemRender:n=>n?i.jsx(E9,{setType:t.setType,partItem:n,isSelected:r(n),onClick:o=>{var l;return s(t.setType,((l=n.partSet)==null?void 0:l.id)??-1)}}):null})},I9=a=>{const{setType:t=null,partColor:e=null,isSelected:s=!1,...r}=a;if(!e)return null;const n=!ct("hc.disabled",!1)&&e.clubLevel>0;return i.jsx($t,{itemHighlight:!0,itemColor:yr.int2rgb(e.rgb),itemActive:s,className:"clear-bg",...r,children:n&&i.jsx(ps,{className:"position-absolute end-1 bottom-1",type:"hc"})})},MA=a=>{const{category:t=null,paletteIndex:e=-1}=a,{selectedColorParts:s=null,selectEditorColor:r=null}=$l(),n=o=>!t||!t.setType||!s||!s[t.setType]||!s[t.setType][e]?!1:s[t.setType][e].id===o.id;return i.jsx(jS,{rows:t.colorItems[e],columnCount:5,overscan:5,itemRender:o=>o?i.jsx(I9,{setType:t.setType,partColor:o,isSelected:n(o),onClick:l=>r(t.setType,e,o.id)}):null})},T9=a=>{const{name:t="",categories:e=[]}=a,[s,r]=_.useState(!1),[n,o]=_.useState(""),{maxPaletteCount:l=1,gender:c=null,setGender:u=null,selectedColorParts:h=null,getFirstSelectableColor:d=null,selectEditorColor:f=null}=$l(),E=_.useMemo(()=>e.find(I=>I.setType===n)??null,[e,n]),m=_.useCallback(I=>{const p=h[I];(!p||!p.length)&&f(I,0,d(I)),o(I)},[d,f,h]);return _.useEffect(()=>{var I;!e||!e.length||!s||(m((I=e[0])==null?void 0:I.setType),r(!1))},[e,s,m]),_.useEffect(()=>{r(!0)},[e]),E?i.jsxs(pt,{children:[i.jsxs(N,{size:2,children:[t===qr.GENERIC&&i.jsxs(i.Fragment,{children:[i.jsx(x,{center:!0,pointer:!0,className:"category-item",onClick:I=>u(At.MALE),children:i.jsx(Bo,{icon:"male",selected:c===$h.MALE})}),i.jsx(x,{center:!0,pointer:!0,className:"category-item",onClick:I=>u(At.FEMALE),children:i.jsx(Bo,{icon:"female",selected:c===$h.FEMALE})})]}),t!==qr.GENERIC&&e.length>0&&e.map(I=>i.jsx(x,{center:!0,pointer:!0,className:"category-item",onClick:p=>m(I.setType),children:i.jsx(Bo,{icon:I.setType,selected:n===I.setType})},I.setType))]}),i.jsx(N,{size:5,overflow:"hidden",children:i.jsx(p9,{category:E})}),i.jsxs(N,{size:5,overflow:"hidden",children:[l>=1&&i.jsx(MA,{category:E,paletteIndex:0}),l===2&&i.jsx(MA,{category:E,paletteIndex:1})]})]}):null},R9=a=>{const{savedFigures:t=[],setSavedFigures:e=null,loadAvatarData:s=null,getFigureString:r=null,gender:n=null}=$l(),o=ct("hc.disabled",!1),l=_.useCallback(u=>{if(u>=t.length||u<0)return;const[h,d]=t[u];s(h.getFigureString(),d)},[t,s]),c=_.useCallback(u=>{if(u>=t.length||u<0)return;const h=[...t],d=r;h[u]=[is().createFigureContainer(d),n],e(h),H(new nb(u+1,d,n))},[r,n,t,e]);return i.jsx(jS,{rows:t,columnCount:5,overscan:5,estimateSize:140,itemRender:(u,h)=>{const[d,f]=u;let E=0;return d&&(E=is().getFigureClubLevel(d,f)),i.jsxs($t,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[d&&i.jsx(os,{figure:d.getFigureString(),gender:f,direction:2}),i.jsx(V,{className:"avatar-shadow"}),!o&&E>0&&i.jsx(ps,{className:"position-absolute top-1 start-1",type:"hc"}),i.jsxs(x,{gap:1,className:"button-container",children:[i.jsxs(W,{variant:"link",fullWidth:!0,onClick:()=>c(h),title:g("avatareditor.wardrobe.save"),children:[" ",i.jsx(vN,{size:20,style:{color:"black"}})," "]}),d&&i.jsxs(W,{variant:"link",fullWidth:!0,onClick:m=>l(h),disabled:E>pi(),title:g("widget.generic_usable.button.use"),children:[" ",i.jsx(O0,{size:20,style:{color:"white"}})," "]})]})]})}})},S9=a=>{const[t,e]=_.useState(!1),{setIsVisible:s,avatarModels:r,activeModelKey:n,setActiveModelKey:o,loadAvatarData:l,getFigureStringWithFace:c,gender:u,figureSetIds:h=[],randomizeCurrentFigure:d=null,getFigureString:f=null}=$l(),E=m=>{switch(m){case Pn.ACTION_RESET:l(tt().figure,tt().gender);return;case Pn.ACTION_CLEAR:l(c(0,!1),u);return;case Pn.ACTION_RANDOMIZE:d();return;case Pn.ACTION_SAVE:H(new pS(u,f)),e(!1);return}};return _.useEffect(()=>{const m={linkReceived:I=>{const p=I.split("/");if(!(p.length<2))switch(p[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(T=>!T);return}},eventUrlPrefix:"avatar-editor/"};return As(m),()=>Ns(m)},[]),_.useEffect(()=>{s(t)},[t,s]),t?i.jsxs(Ct,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[i.jsx(Nt,{headerText:g("avatareditor.title"),onCloseClick:m=>e(!1)}),i.jsx(eo,{children:Object.keys(r).map(m=>{const I=n===m;return i.jsx(Ia,{isActive:I,onClick:p=>o(m),children:g(`avatareditor.category.${m}`)},m)})}),i.jsx(It,{children:i.jsxs(pt,{children:[i.jsxs(N,{size:9,overflow:"hidden",children:[n.length>0&&n!==qr.WARDROBE&&i.jsx(T9,{name:n,categories:r[n]}),n===qr.WARDROBE&&i.jsx(R9,{})]}),i.jsxs(N,{size:3,overflow:"hidden",children:[i.jsx(m9,{}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsxs(ua,{children:[i.jsx(W,{variant:"secondary",onClick:m=>E(Pn.ACTION_RESET),children:i.jsx(A0,{className:"fa-icon"})}),i.jsx(W,{variant:"secondary",onClick:m=>E(Pn.ACTION_CLEAR),children:i.jsx(uR,{className:"fa-icon"})}),i.jsx(W,{variant:"secondary",onClick:m=>E(Pn.ACTION_RANDOMIZE),children:i.jsx(N0,{className:"fa-icon"})})]}),i.jsx(W,{className:"w-100",variant:"success",onClick:m=>E(Pn.ACTION_SAVE),children:g("avatareditor.save")})]})]})]})})]}):null},O9=5,A9=a=>{const{onClose:t=null,onEdit:e=null,onDelete:s=null}=a,{cameraRoll:r=null,setCameraRoll:n=null,selectedPictureIndex:o=-1,setSelectedPictureIndex:l=null}=mU(),{simpleAlert:c=null}=Ye(),u=_.useRef(),h=o>-1?r[o]:null,d=()=>{if(!u||!u.current)return null;const E=u.current.getBoundingClientRect();return new xS(Math.floor(E.x),Math.floor(E.y),Math.floor(E.width),Math.floor(E.height))},f=async()=>{if(o>-1){l(-1);return}const E=rt().createTextureFromRoom(Se().roomId,1,d()),m=[...r];m.length>=O9&&(c(g("camera.full.body")),m.pop()),ma(Ea.CAMERA_SHUTTER),m.push(new oq(E,await me.generateImageUrl(E))),n(m)};return i.jsx(qo,{uniqueKey:"nitro-camera-capture",children:i.jsxs(N,{center:!0,className:"nitro-camera-capture",gap:0,children:[h&&i.jsx("img",{alt:"",className:"camera-area",src:h.imageUrl}),i.jsxs("div",{className:"camera-canvas drag-handler",children:[i.jsx("div",{className:"position-absolute header-close",onClick:t,children:i.jsx(Dr,{className:"fa-icon"})}),!h&&i.jsx("div",{ref:u,className:"camera-area camera-view-finder"}),h&&i.jsx("div",{className:"camera-area camera-frame",children:i.jsxs("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[i.jsx("button",{className:"btn btn-success me-3",title:g("camera.editor.button.tooltip"),onClick:e,children:g("camera.editor.button.text")}),i.jsx("button",{className:"btn btn-danger",onClick:s,children:g("camera.delete.button.text")})]})}),i.jsx("div",{className:"d-flex justify-content-center",children:i.jsx("div",{className:"camera-button",title:g("camera.take.photo.button.tooltip"),onClick:f})})]}),r.length>0&&i.jsx(x,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:r.map((E,m)=>i.jsx("img",{alt:"",src:E.imageUrl,onClick:I=>l(m)},m))})]})})},N9=a=>{const{base64Url:t=null,onCloseClick:e=null,onCancelClick:s=null,price:r=null}=a,[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(0),[d,f]=_.useState(!1),[E,m]=_.useState(!1),[I,p]=_.useState(0),T=_.useMemo(()=>ct("camera.publish.disabled",!1),[]);z(cC,S=>{h(L=>L+1),m(!1)}),z(lC,S=>{const L=S.getParser();c(L.extraDataId),p(L.secondsToWait),f(L.ok),m(!1)}),z(uC,S=>{const L=S.getParser();o(ct("camera.url")+"/"+L.url)});const R=(S,L=null)=>{switch(S){case"close":e();return;case"buy":if(E)return;m(!0),H(new ob(""));return;case"publish":if(E)return;m(!0),H(new ab);return;case"cancel":s();return}};return _.useEffect(()=>{t&&rt().saveBase64AsScreenshot(t)},[t]),r?i.jsxs(Ct,{className:"nitro-camera-checkout",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("camera.confirm_phase.title"),onCloseClick:S=>R("close")}),i.jsxs(It,{children:[i.jsxs(x,{center:!0,children:[n&&n.length&&i.jsx(Ta,{className:"picture-preview border",imageUrl:n}),(!n||!n.length)&&i.jsx(x,{center:!0,className:"picture-preview border",children:i.jsx(O,{bold:!0,children:g("camera.loading")})})]}),i.jsxs(x,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[i.jsxs(N,{size:T?10:6,gap:1,children:[i.jsx(O,{bold:!0,children:g("camera.purchase.header")}),(r.credits>0||r.duckets>0)&&i.jsxs(x,{gap:1,children:[i.jsx(O,{children:g("catalog.purchase.confirmation.dialog.cost")}),r.credits>0&&i.jsxs(x,{gap:1,children:[i.jsx(O,{bold:!0,children:r.credits}),i.jsx(ps,{type:-1})]}),r.duckets>0&&i.jsxs(x,{gap:1,children:[i.jsx(O,{bold:!0,children:r.duckets}),i.jsx(ps,{type:5})]})]}),u>0&&i.jsxs(O,{children:[i.jsx(O,{bold:!0,children:g("camera.purchase.count.info")})," ",u,i.jsx("u",{className:"ms-1 cursor-pointer",onClick:()=>ht("inventory/toggle"),children:g("camera.open.inventory")})]})]}),i.jsx(x,{alignItems:"center",children:i.jsx(W,{variant:"success",disabled:E,onClick:S=>R("buy"),children:g(u?"camera.buy.another.button.text":"buy")})})]}),!T&&i.jsxs(x,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g(d?"camera.publish.successful":"camera.publish.explanation")}),i.jsx(O,{children:g(d?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),d&&i.jsx("a",{href:l,rel:"noreferrer",target:"_blank",children:g("camera.link.to.published")}),!d&&r.publishDucketPrice>0&&i.jsxs(x,{gap:1,children:[i.jsx(O,{children:g("catalog.purchase.confirmation.dialog.cost")}),i.jsxs(x,{gap:1,children:[i.jsx(O,{bold:!0,children:r.publishDucketPrice}),i.jsx(ps,{type:5})]})]}),I>0&&i.jsx("div",{className:"mt-1 text-center fw-bold",children:g("camera.publish.wait",["minutes"],[Math.ceil(I/60).toString()])})]}),!d&&i.jsx(x,{className:"d-flex align-items-end",children:i.jsx(W,{variant:"success",disabled:E||I>0,onClick:S=>R("publish"),children:g("camera.publish.button.text")})})]}),i.jsx(O,{center:!0,children:g("camera.warning.disclaimer")}),i.jsx(x,{justifyContent:"end",children:i.jsx(W,{onClick:S=>R("cancel"),children:g("generic.cancel")})})]})]}):null},C9=a=>{const{effect:t=null,thumbnailUrl:e=null,isActive:s=!1,isLocked:r=!1,selectEffect:n=null,removeEffect:o=null}=a;return i.jsxs($t,{title:g(r?`camera.effect.required.level ${t.minLevel}`:`camera.effect.name.${t.name}`),itemActive:s,onClick:l=>!s&&n(),children:[s&&i.jsx(W,{variant:"danger",className:"rounded-circle remove-effect",onClick:o,children:i.jsx(Dr,{className:"fa-icon"})}),!r&&e&&e.length>0&&i.jsx("div",{className:"effect-thumbnail-image border",children:i.jsx("img",{alt:"",src:e})}),r&&i.jsxs(O,{center:!0,bold:!0,children:[i.jsx("div",{children:i.jsx(PN,{className:"fa-icon"})}),t.minLevel]})]})},x9=a=>{const{myLevel:t=0,selectedEffects:e=[],effects:s=[],thumbnails:r=[],processAction:n=null}=a;return i.jsx(pt,{columnCount:3,overflow:"auto",children:s&&s.length>0&&s.map((o,l)=>{const c=r.find(h=>h.effectName===o.name),u=e.findIndex(h=>h.effect.name===o.name)>-1;return i.jsx(C9,{effect:o,isActive:u,isLocked:o.minLevel>t,removeEffect:()=>n("remove_effect",o.name),selectEffect:()=>n("select_effect",o.name),thumbnailUrl:c&&c.thumbnailUrl||null},l)})})},bA=[Ed.COLORMATRIX,Ed.COMPOSITE],y9=a=>{const{picture:t=null,availableEffects:e=null,myLevel:s=1,onClose:r=null,onCancel:n=null,onCheckout:o=null}=a,[l,c]=_.useState(bA[0]),[u,h]=_.useState(null),[d,f]=_.useState([]),[E,m]=_.useState([]),[I,p]=_.useState(!1),[T,R]=_.useState(""),S=_.useMemo(()=>e.filter(U=>U.colorMatrix),[e]),L=_.useMemo(()=>e.filter(U=>U.texture),[e]),M=_.useCallback(()=>l===Ed.COLORMATRIX?S:L,[l,S,L]),P=_.useCallback(U=>!U||!U.length||!d||!d.length?-1:d.findIndex(K=>K.effect.name===U),[d]),k=_.useMemo(()=>P(u),[u,P]),G=_.useMemo(()=>u&&d[k]||null,[u,k,d]),j=_.useCallback(U=>{const K=k;K!==-1&&f(B=>{const J=[...B],Z=J[K];return J[k]=new mE(Z.effect,U),J})},[k,f]),F=_.useCallback((U,K=null)=>{switch(U){case"close":r();return;case"cancel":n();return;case"checkout":o(T);return;case"change_tab":c(String(K));return;case"select_effect":{if(P(K)>=0)return;const J=e.find(Z=>Z.name===K);if(!J)return;f(Z=>[...Z,new mE(J,1)]),h(J.name);return}case"remove_effect":{let B=P(K);if(B===-1)return;f(J=>{const Z=[...J];return Z.splice(B,1),Z}),u===K&&h(null);return}case"clear_effects":h(null),f([]);return;case"download":{(async()=>{const B=new Image;B.src=T,window.open("").document.write(B.outerHTML)})();return}case"zoom":p(!I);return}},[I,e,u,T,P,n,o,r,p,f]);return _.useEffect(()=>{(async()=>{const U=[];for await(const K of e){const B=await au().applyEffects(t.texture,[new mE(K,1)],!1);U.push(new lq(K.name,B.src))}m(U)})()},[t,e]),_.useEffect(()=>{(async()=>{const U=await au().applyEffects(t.texture,d,I);R(U.src)})()},[t,d,I]),i.jsxs(Ct,{className:"nitro-camera-editor",children:[i.jsx(Nt,{headerText:g("camera.editor.button.text"),onCloseClick:U=>F("close")}),i.jsx(eo,{children:bA.map(U=>i.jsx(Ia,{isActive:l===U,onClick:K=>F("change_tab",U),children:i.jsx("i",{className:"icon icon-camera-"+U})},U))}),i.jsx(It,{children:i.jsxs(pt,{children:[i.jsx(N,{size:5,overflow:"hidden",children:i.jsx(x9,{myLevel:s,selectedEffects:d,effects:M(),thumbnails:E,processAction:F})}),i.jsxs(N,{size:7,justifyContent:"between",overflow:"hidden",children:[i.jsxs(N,{center:!0,children:[i.jsx(Ta,{imageUrl:T,className:"picture-preview"}),u&&i.jsxs(N,{center:!0,fullWidth:!0,gap:1,children:[i.jsx(O,{children:g("camera.effect.name."+u)}),i.jsx(Xs,{className:"nitro-slider",max:1,min:0,renderThumb:(U,K)=>i.jsx("div",{...U,children:K.valueNow}),step:.01,value:G.alpha,onChange:U=>j(U)})]})]}),i.jsxs(x,{justifyContent:"between",children:[i.jsxs(ua,{children:[i.jsx(W,{onClick:U=>F("clear_effects"),children:i.jsx(uR,{className:"fa-icon"})}),i.jsx(W,{onClick:U=>F("download"),children:i.jsx(vN,{className:"fa-icon"})}),i.jsxs(W,{onClick:U=>F("zoom"),children:[I&&i.jsx(C0,{className:"fa-icon"}),!I&&i.jsx(x0,{className:"fa-icon"})]})]}),i.jsxs(x,{gap:1,children:[i.jsx(W,{onClick:U=>F("cancel"),children:g("generic.cancel")}),i.jsx(W,{onClick:U=>F("checkout"),children:g("camera.preview.button.text")})]})]})]})]})})]})},oc=0,Zd=1,DA=2,vA=3,M9=a=>{const[t,e]=_.useState(oc),[s,r]=_.useState(null),{availableEffects:n=[],selectedPictureIndex:o=-1,cameraRoll:l=[],setCameraRoll:c=null,myLevel:u=0,price:h={credits:0,duckets:0,publishDucketPrice:0}}=mU(),d=E=>{switch(E){case"close":e(oc);return;case"edit":e(DA);return;case"delete":c(m=>{const I=[...m];return I.splice(o,1),I});return;case"editor_cancel":e(Zd);return}},f=E=>{r(E),e(vA)};return ft(yt.ENDED,E=>e(oc)),_.useEffect(()=>{const E={linkReceived:m=>{const I=m.split("/");if(!(I.length<2))switch(I[1]){case"show":e(Zd);return;case"hide":e(oc);return;case"toggle":e(p=>p?oc:Zd);return}},eventUrlPrefix:"camera/"};return As(E),()=>Ns(E)},[]),t===oc?null:i.jsxs(i.Fragment,{children:[t===Zd&&i.jsx(A9,{onClose:()=>d("close"),onEdit:()=>d("edit"),onDelete:()=>d("delete")}),t===DA&&i.jsx(y9,{picture:l[o],myLevel:u,onClose:()=>d("close"),onCancel:()=>d("editor_cancel"),onCheckout:f,availableEffects:n}),t===vA&&i.jsx(N9,{base64Url:s,onCloseClick:()=>d("close"),onCancelClick:()=>d("editor_cancel"),price:h})]})},b9=a=>{const{itemId:t=-1,state:e=null,product:s=null,active:r=!1,onClick:n=null}=a,o=l=>{let c=tt().getFloorItemDataByName(l),u=null;return c?u=rt().getFurnitureFloorIconUrl(c.id):(c=tt().getWallItemDataByName(l),c&&(u=rt().getFurnitureWallIconUrl(c.id))),u};return i.jsxs(N,{fit:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${r?"active":""}`,onClick:()=>n(t),children:[e===xi.STATE_UNLOCKED&&i.jsx(x,{center:!0,className:"campaign-spritesheet unlocked-bg",children:i.jsx(x,{center:!0,className:"campaign-spritesheet campaign-opened",children:s&&i.jsx(Ta,{imageUrl:s.customImage?ct("image.library.url")+s.customImage:o(s.productName)})})}),e!==xi.STATE_UNLOCKED&&i.jsxs(x,{center:!0,className:"campaign-spritesheet locked-bg",children:[e===xi.STATE_LOCKED_AVAILABLE&&i.jsx(V,{className:"campaign-spritesheet available"}),(e===xi.STATE_LOCKED_EXPIRED||e===xi.STATE_LOCKED_FUTURE)&&i.jsx(V,{className:"campaign-spritesheet unavailable"})]})]})},xE=5,D9=a=>{const{onClose:t=null,campaignName:e=null,currentDay:s=null,numDays:r=null,missedDays:n=null,openedDays:o=null,openPackage:l=null,receivedProducts:c=null}=a,[u,h]=_.useState(s),[d,f]=_.useState(Math.max(0,u-1)),E=S=>o.includes(S)?xi.STATE_UNLOCKED:S>s?xi.STATE_LOCKED_FUTURE:n.includes(S)?xi.STATE_LOCKED_EXPIRED:xi.STATE_LOCKED_AVAILABLE,m=S=>{switch(E(S)){case xi.STATE_UNLOCKED:return g("campaign.calendar.info.unlocked");case xi.STATE_LOCKED_FUTURE:return g("campaign.calendar.info.future");case xi.STATE_LOCKED_EXPIRED:return g("campaign.calendar.info.expired");default:return g("campaign.calendar.info.available.desktop")}},I=()=>{const S=u+1;S!==r&&(h(S),d+xE<S+1&&f(d+1))},p=()=>{const S=u-1;S<0||(h(S),d>S&&f(d-1))},T=S=>{if(u===S){E(S)===xi.STATE_LOCKED_AVAILABLE&&l(S,!1);return}h(S)},R=()=>{const S=u;E(S)!==xi.STATE_UNLOCKED&&l(S,!0)};return i.jsxs(Ct,{className:"nitro-campaign-calendar",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g(`campaign.calendar.${e}.title`),onCloseClick:t}),i.jsxs(It,{children:[i.jsxs(pt,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[i.jsx(N,{size:1}),i.jsx(N,{size:10,children:i.jsxs(x,{justifyContent:"between",alignItems:"center",gap:1,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontSize:3,children:g("campaign.calendar.heading.day",["number"],[(u+1).toString()])}),i.jsx(O,{children:m(u)})]}),i.jsx("div",{children:tt().isModerator&&i.jsx(W,{variant:"danger",onClick:R,children:"Force open"})})]})}),i.jsx(N,{size:1})]}),i.jsxs(x,{fullHeight:!0,gap:2,children:[i.jsx(x,{center:!0,children:i.jsx(V,{pointer:!0,className:"campaign-spritesheet prev",onClick:p})}),i.jsx(N,{center:!0,fullWidth:!0,children:i.jsx(pt,{fit:!0,columnCount:xE,gap:1,children:[...Array(xE)].map((S,L)=>{const M=d+L;return i.jsx(N,{overflow:"hidden",children:i.jsx(b9,{itemId:M,state:E(M),active:u===M,product:c.has(M)?c.get(M):null,onClick:T})},L)})})}),i.jsx(x,{center:!0,children:i.jsx(V,{pointer:!0,className:"campaign-spritesheet next",onClick:I})})]})]})]})},v9=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(-1),[n,o]=_.useState(new Map),[l,c]=_.useState(!1),u=(h,d=!1)=>{t&&(r(h),H(d?new cb(t.campaignName,h):new ub(t.campaignName,h)))};return z(dC,h=>{const d=h.getParser();d&&e(d.calendarData)}),z(_C,h=>{const d=h.getParser();if(!d)return;const f=s;d.doorOpened&&(e(E=>{const m=E.clone();return m.openedDays.push(s),m}),o(E=>{const m=new Map(E);return m.set(f,new cq(d.productName,d.customImage,d.furnitureClassName)),m})),r(-1)}),_.useEffect(()=>{const h={linkReceived:d=>{const f=d.split("/");if(!(f.length<2))switch(f[1]){case"calendar":c(!0);break}},eventUrlPrefix:"openView/"};return As(h),()=>Ns(h)},[]),i.jsx(i.Fragment,{children:t&&l&&i.jsx(D9,{onClose:()=>c(!1),campaignName:t.campaignName,currentDay:t.currentDay,numDays:t.campaignDays,openedDays:t.openedDays,missedDays:t.missedDays,openPackage:u,receivedProducts:n})})},UU=a=>{const{icon:t=0}=a,e=_.useMemo(()=>ct("catalog.asset.icon.url").replace("%name%",t.toString()),[t]);return i.jsx(Ta,{imageUrl:e,style:{width:20,height:20}})},P9=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(0),[n,o]=_.useState(0),[l,c]=_.useState(""),[u,h]=_.useState(""),[d,f]=_.useState(!0),[E,m]=_.useState(""),[I,p]=_.useState([]),[T,R]=_.useState(0),[S,L]=_.useState(0),[M,P]=_.useState(0),[k,G]=_.useState(0),[j,F]=_.useState(0),[U,K]=_.useState(!1),{catalogOptions:B=null}=be(),{friends:J}=gr(),{giftConfiguration:Z=null}=B,[Q,ut]=_.useState([]),[Bt,te]=_.useState([]),[de,He]=_.useState(!0),le=_.useCallback(()=>{e(!1),r(0),o(0),c(""),h(""),f(!0),m(""),R(0),L(0),He(!1),te([]),I.length&&P(I[0].id)},[I]),qe=_.useMemo(()=>Z?Z.defaultStuffTypes.findIndex(Kt=>Kt===Q[T])>-1:!1,[Q,Z,T]),vt=_.useMemo(()=>Z?(Q[T]*1e3+Z.ribbonTypes[S]).toString():"",[Z,T,S,Q]),Vt=_.useMemo(()=>{if(!Z||qe)return!1;const Kt=Q[T];return!(Kt===8||Kt>=3&&Kt<=6)},[Z,T,qe,Q]),xs=_.useMemo(()=>qe?Q[T]:M,[qe,Q,T,M]),ie=J.filter(Kt=>Kt.id!==-1),Ft=Kt=>{const Ae=Kt.target.value;let Lr=[];Ae.length>0&&(Lr=ie.sort().filter(Jo=>Jo.name.includes(Ae))),h(Ae),He(!0),te(Lr)},De=Kt=>{h(Kt),He(!1)},Rs=_.useCallback(Kt=>{switch(Kt){case"prev_box":R(Ae=>Ae===0?k:Ae-1);return;case"next_box":R(Ae=>Ae===k?0:Ae+1);return;case"prev_ribbon":L(Ae=>Ae===0?j:Ae-1);return;case"next_ribbon":L(Ae=>Ae===j?0:Ae+1);return;case"buy":if(!u||u.length===0){K(!0);return}H(new Sb(s,n,l,u,E,xs,T,S,d));return}},[xs,l,k,j,E,n,s,u,T,S,d]);z(RC,Kt=>K(!0)),_s([pa.PURCHASE_SUCCESS,ql.INIT_GIFT],Kt=>{switch(Kt.type){case pa.PURCHASE_SUCCESS:le();return;case ql.INIT_GIFT:const Ae=Kt;le(),r(Ae.pageId),o(Ae.offerId),c(Ae.extraData),e(!0);return}}),_.useEffect(()=>{K(!1)},[u]);const wt=_.useCallback(()=>{Z&&ut(Kt=>{let Ae=[...Z.boxTypes];return Ae.push(Z.defaultStuffTypes[Math.floor(Math.random()*(Z.defaultStuffTypes.length-1))]),G(Ae.length-1),F(Ae.length-1),Ae})},[Z]);if(_.useEffect(()=>{if(!Z)return;const Kt=[];for(const Ae of Z.stuffTypes){const Lr=tt().getFloorItemData(Ae);Lr&&Lr.colors&&Lr.colors.length>0&&Kt.push({id:Ae,color:zi.makeColorNumberHex(Lr.colors[0])})}wt(),Kt.length&&(P(Kt[0].id),p(Kt))},[Z,wt]),_.useEffect(()=>{t&&wt()},[wt,t]),!Z||!Z.isEnabled||!t)return null;const pe="catalog.gift_wrapping_new.box."+(qe?"default":Q[T]),ls=`catalog.gift_wrapping_new.ribbon.${S}`,qi="catalog.gift_wrapping_new."+(qe?"freeprice":"price");return i.jsxs(Ct,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("catalog.gift_wrapping.title"),onCloseClick:le}),i.jsxs(It,{className:"text-black",children:[i.jsxs(Hq,{column:!0,children:[i.jsx(O,{children:g("catalog.gift_wrapping.receiver")}),i.jsx("input",{type:"text",className:fi("form-control form-control-sm",U&&"is-invalid"),value:u,onChange:Kt=>Ft(Kt)}),Bt.length>0&&de&&i.jsx(N,{className:"autocomplete-gift-container",children:Bt.map(Kt=>i.jsx(V,{className:"autocomplete-gift-item",onClick:Ae=>De(Kt.name),children:Kt.name},Kt.id))}),U&&i.jsx(V,{className:"invalid-feedback",children:g("catalog.gift_wrapping.receiver_not_found.title")})]}),i.jsx(bU,{figure:tt().figure,userName:tt().userName,message:E,editable:!0,onChange:Kt=>m(Kt)}),i.jsxs(V,{className:"form-check",children:[i.jsx("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:d,onChange:Kt=>f(Ae=>!Ae)}),i.jsx("label",{className:"form-check-label",children:g("catalog.gift_wrapping.show_face.title")})]}),i.jsxs(x,{alignItems:"center",gap:2,children:[M&&i.jsx(V,{className:"gift-preview",children:i.jsx(iE,{productType:kt.FLOOR,productClassId:xs,extraData:vt})}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{gap:2,children:[i.jsxs(ua,{children:[i.jsx(W,{variant:"primary",onClick:()=>Rs("prev_box"),children:i.jsx(lr,{className:"fa-icon"})}),i.jsx(W,{variant:"primary",onClick:()=>Rs("next_box"),children:i.jsx(cr,{className:"fa-icon"})})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{fontWeight:"bold",children:g(pe)}),i.jsxs(x,{alignItems:"center",gap:1,children:[g(qi,["price"],[Z.price.toString()]),i.jsx(ps,{type:-1})]})]})]}),i.jsxs(x,{alignItems:"center",gap:2,className:Vt?"":"opacity-50 pointer-events-none",children:[i.jsxs(ua,{children:[i.jsx(W,{variant:"primary",onClick:()=>Rs("prev_ribbon"),children:i.jsx(lr,{className:"fa-icon"})}),i.jsx(W,{variant:"primary",onClick:()=>Rs("next_ribbon"),children:i.jsx(cr,{className:"fa-icon"})})]}),i.jsx(O,{fontWeight:"bold",children:g(ls)})]})]})]}),i.jsxs(N,{gap:1,className:Vt?"":"opacity-50 pointer-events-none",children:[i.jsx(O,{fontWeight:"bold",children:g("catalog.gift_wrapping.pick_color")}),i.jsx(ua,{fullWidth:!0,children:I.map(Kt=>i.jsx(W,{variant:"dark",active:Kt.id===M,disabled:!Vt,style:{backgroundColor:Kt.color},onClick:()=>P(Kt.id)},Kt.id))})]}),i.jsxs(x,{justifyContent:"between",alignItems:"center",children:[i.jsx(W,{variant:"link",onClick:le,className:"text-black",children:g("cancel")}),i.jsx(W,{variant:"success",onClick:()=>Rs("buy"),children:g("catalog.gift_wrapping.give_gift")})]})]})]})},L9=a=>{const[t,e]=_.useState(""),{currentType:s=null,rootNode:r=null,offersToNodes:n=null,searchResult:o=null,setSearchResult:l=null,setCurrentPage:c=null}=be();return _.useEffect(()=>{let u=t==null?void 0:t.toLocaleLowerCase().replace(" ","");if(!u||!u.length){l(null);return}const h=setTimeout(()=>{const d=tt().getAllFurnitureData();if(!d||!d.length)return;const f=[],E=[];for(const p of d){if(s===Xr.BUILDER&&!p.availableForBuildersClub||s===Xr.NORMAL&&p.excludeDynamic)continue;const T=[p.className,p.name,p.description].join(" ").replace(/ /gi,"").toLowerCase();if(s===Xr.BUILDER&&p.purchaseOfferId===-1&&p.rentOfferId===-1)p.furniLine!==""&&E.indexOf(p.furniLine)<0&&T.indexOf(u)>=0&&E.push(p.furniLine);else if([...iA(n,p.purchaseOfferId),...iA(n,p.rentOfferId)].length&&(T.indexOf(u)>=0&&f.push(p),f.length===250))break}const m=[];for(const p of f)m.push(new XX(p));let I=[];$L(u,E,r,I),l(new ZX(u,m,I.filter(p=>p.isVisible))),c(new Rg(-1,"default_3x3",new tU([],[]),m,!1,1))},300);return()=>clearTimeout(h)},[n,s,r,t,c,l]),i.jsxs(x,{gap:1,children:[i.jsx(x,{fullWidth:!0,alignItems:"center",position:"relative",children:i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:t,onChange:u=>e(u.target.value)})}),(!t||!t.length)&&i.jsx(W,{variant:"primary",className:"catalog-search-button",children:i.jsx(hR,{className:"fa-icon"})}),t&&!!t.length&&i.jsx(W,{variant:"primary",className:"catalog-search-button",onClick:u=>e(""),children:i.jsx(Dr,{className:"fa-icon"})})]})},jU=a=>{const{node:t=null,child:e=!1}=a;return i.jsx(i.Fragment,{children:t&&t.children.length>0&&t.children.map((s,r)=>s.isVisible?i.jsx(wU,{node:s,child:e},r):null)})},wU=a=>{const{node:t=null,child:e=!1}=a,{activateNode:s=null}=be();return i.jsxs(V,{className:"nitro-catalog-navigation-section",children:[i.jsxs($t,{gap:1,column:!1,itemActive:t.isActive,onClick:r=>s(t),className:e?"inset":"",children:[i.jsx(UU,{icon:t.iconId}),i.jsx(O,{grow:!0,truncate:!0,children:t.localization}),t.isBranch&&i.jsxs(i.Fragment,{children:[t.isOpen&&i.jsx(oR,{className:"fa-icon"}),!t.isOpen&&i.jsx(lR,{className:"fa-icon"})]})]}),t.isOpen&&t.isBranch&&i.jsx(jU,{node:t,child:!0})]})},U9=a=>{const{node:t=null}=a,{searchResult:e=null}=be();return i.jsxs(i.Fragment,{children:[i.jsx(L9,{}),i.jsx(N,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container rounded p-1",overflow:"hidden",children:i.jsxs(Fe,{id:"nitro-catalog-main-navigation",gap:1,columnCount:1,children:[e&&e.filteredNodes.length>0&&e.filteredNodes.map((s,r)=>i.jsx(wU,{node:s},r)),!e&&i.jsx(jU,{node:t})]})})]})},j9=a=>{const{columnCount:t=5,...e}=a,[s,r]=_.useState(!1),[n,o]=_.useState(null),{currentOffer:l=null,setPurchaseOptions:c=null}=be(),{badgeCodes:u=[],activate:h=null,deactivate:d=null}=eE(),f=_.useMemo(()=>{if(!n)return null;const E=new An;return E.setValue(["0",n,"",""]),E},[n]);return _.useEffect(()=>{l&&c(E=>{const m={...E};return m.extraParamRequired=!0,m.extraData=f&&f.getValue(1)||null,m.previewStuffData=f,m})},[l,f,c]),_.useEffect(()=>{if(!s)return;const E=h();return()=>d(E)},[s,h,d]),_.useEffect(()=>(r(!0),()=>r(!1)),[]),i.jsx(Fe,{columnCount:t,...e,children:u&&u.length>0&&u.map((E,m)=>i.jsx($t,{itemActive:n===E,onClick:I=>o(E),children:i.jsx(Xe,{badgeCode:E})},m))})},aE=a=>{const{currentPage:t=null,setCurrentOffer:e=null}=be();return _.useEffect(()=>{!t||!t.offers.length||e(t.offers[0])},[t,e]),null},WS=a=>{const{offer:t=null,selectOffer:e=null,itemActive:s=!1,...r}=a,[n,o]=_.useState(!1),{requestOfferToMover:l=null}=be(),{isVisible:c=!1}=tc(),u=_.useMemo(()=>t.pricingModel===ni.PRICING_MODEL_BUNDLE?null:t.product.getIconUrl(t),[t]),h=f=>{switch(f.type){case lt.MOUSE_DOWN:e(t),o(!0);return;case lt.MOUSE_UP:o(!1);return;case lt.ROLL_OUT:if(!n||!s||!c)return;l(t);return}},d=t.product;return d?i.jsx($t,{itemImage:u,itemCount:t.pricingModel===ni.PRICING_MODEL_MULTI?d.productCount:1,itemUniqueSoldout:d.uniqueLimitedItemSeriesSize&&!d.uniqueLimitedItemsLeft,itemUniqueNumber:d.uniqueLimitedItemSeriesSize,itemActive:s,onMouseDown:h,onMouseUp:h,onMouseOut:h,...r,children:t.product.productType===kt.ROBOT&&i.jsx(os,{figure:t.product.extraParam,headOnly:!0,direction:3})}):null},Fd=a=>{const{columnCount:t=5,children:e=null,...s}=a,{currentOffer:r=null,setCurrentOffer:n=null,currentPage:o=null,setPurchaseOptions:l=null}=be(),c=_.useRef();if(_.useEffect(()=>{c&&c.current&&(c.current.scrollTop=0)},[o]),!o)return null;const u=h=>{h.activate(),!h.isLazy&&(n(h),h.product&&h.product.productType===kt.WALL&&l(d=>{const f={...d};return f.extraData=h.product.extraParam||null,f}))};return i.jsxs(Fe,{innerRef:c,columnCount:t,...s,children:[o.offers&&o.offers.length>0&&o.offers.map((h,d)=>i.jsx(WS,{itemActive:r&&r.offerId===h.offerId,offer:h,selectOffer:u},d)),e]})},oE=a=>{const{children:t=null,...e}=a,{currentOffer:s=null}=be();return!s||s.pricingModel!==ni.PRICING_MODEL_SINGLE||!s.product.isUniqueLimitedItem?null:i.jsxs(V,{...e,children:[i.jsx(i9,{className:"mx-auto",uniqueLimitedItemsLeft:s.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:s.product.uniqueLimitedItemSeriesSize}),t]})},xn=a=>{const{noGiftOption:t=!1,purchaseCallback:e=null}=a;_.useState(!1);const[s,r]=_.useState($e.NONE);Ja(Id.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1);const{currentOffer:n=null,currentPage:o=null,purchaseOptions:l=null,setPurchaseOptions:c=null}=be(),{getCurrencyAmount:u=null}=ec(),h=_.useCallback(m=>{switch(m.type){case pa.PURCHASE_SUCCESS:r($e.NONE);return;case Wo.PURCHASE_FAILED:r($e.FAILED);return;case Rd.NOT_ALLOWED:r($e.FAILED);return;case Sd.SOLD_OUT:r($e.SOLD_OUT);return}},[]);_s(pa.PURCHASE_SUCCESS,h),_s(Wo.PURCHASE_FAILED,h),_s(Rd.NOT_ALLOWED,h),_s(Sd.SOLD_OUT,h);const d=_.useMemo(()=>{if(!n||l.extraParamRequired&&(!l.extraData||!l.extraData.length))return!1;if(n.pricingModel===ni.PRICING_MODEL_SINGLE){const m=n.product;if(m&&m.isUniqueLimitedItem)return!m.uniqueLimitedItemsLeft}return!1},[n,l]),f=(m=!1)=>{if(!n)return;if(pi()<n.clubLevel){ht("habboUI/open/hccenter");return}if(m){Ps(new Jq(n.page.pageId,n.offerId,l.extraData));return}if(r($e.PURCHASE),e){e();return}let I=n.page.pageId;H(new Md(I,n.offerId,l.extraData,l.quantity))};if(_.useEffect(()=>{n&&r($e.NONE)},[n,c]),_.useEffect(()=>{let m=null;return(s===$e.CONFIRM||s===$e.FAILED)&&(m=setTimeout(()=>r($e.NONE),3e3)),()=>{m&&clearTimeout(m)}},[s]),!n)return null;const E=()=>{const m=n.priceInCredits*l.quantity,I=n.priceInActivityPoints*l.quantity;if(pi()<n.clubLevel)return i.jsx(W,{variant:"danger",disabled:!0,children:g("catalog.alert.hc.required")});if(d)return i.jsx(W,{variant:"danger",disabled:!0,children:g("catalog.alert.limited_edition_sold_out.title")});if(m>u(-1))return i.jsx(W,{variant:"danger",disabled:!0,children:g("catalog.alert.notenough.title")});if(I>u(n.activityPointType))return i.jsx(W,{variant:"danger",disabled:!0,children:g("catalog.alert.notenough.activitypoints.title."+n.activityPointType)});switch(s){case $e.CONFIRM:return i.jsx(W,{variant:"warning",onClick:p=>f(),children:g("catalog.marketplace.confirm_title")});case $e.PURCHASE:return i.jsx(W,{disabled:!0,children:i.jsx(kS,{})});case $e.FAILED:return i.jsx(W,{variant:"danger",children:g("generic.failed")});case $e.SOLD_OUT:return i.jsx(W,{variant:"danger",children:g("generic.failed")+" - "+g("catalog.alert.limited_edition_sold_out.title")});case $e.NONE:default:return i.jsx(W,{disabled:l.extraParamRequired&&(!l.extraData||!l.extraData.length),onClick:p=>r($e.CONFIRM),children:g("catalog.purchase_confirmation."+(n.isRentOffer?"rent":"buy"))})}};return i.jsxs(i.Fragment,{children:[i.jsx(E,{}),!t&&!n.isRentOffer&&i.jsx(W,{disabled:l.quantity>1||!n.giftable||d||l.extraParamRequired&&(!l.extraData||!l.extraData.length),onClick:m=>f(!0),children:g("catalog.purchase_confirmation.gift")})]})},FU=a=>{const{offer:t=null,separator:e=!1}=a,{purchaseOptions:s=null}=be(),{quantity:r=1}=s;return t?i.jsxs(i.Fragment,{children:[t.priceInCredits>0&&i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{bold:!0,children:t.priceInCredits*r}),i.jsx(ps,{type:-1})]}),e&&t.priceInCredits>0&&t.priceInActivityPoints>0&&i.jsx(Cd,{size:"xs",color:"black",className:"fa-icon"}),t.priceInActivityPoints>0&&i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{bold:!0,children:t.priceInActivityPoints*r}),i.jsx(ps,{type:t.activityPointType})]})]}):null},so=a=>{const{gap:t=1,...e}=a,{currentOffer:s=null}=be();return i.jsx(N,{gap:t,...e,children:i.jsx(FU,{offer:s})})},Qo=a=>{const{currentOffer:t=null,roomPreviewer:e=null,purchaseOptions:s=null}=be(),{previewStuffData:r=null}=s;return _.useEffect(()=>{if(!t||t.pricingModel===ni.PRICING_MODEL_BUNDLE||!e)return;const n=t.product;if(n)switch(e.reset(!1),n.productType){case kt.FLOOR:{if(!n.furnitureData)return;if(n.furnitureData.specialType===Dt.FIGURE_PURCHASABLE_SET){const l=tt().getFloorItemData(n.furnitureData.id).customParams.split(",").map(h=>parseInt(h)),c=[];for(const h of l)is().isValidFigureSetForGender(h,tt().gender)&&c.push(h);const u=is().getFigureStringWithFigureIds(tt().figure,tt().gender,c);e.addAvatarIntoRoom(u,n.productClassId)}else e.addFurnitureIntoRoom(n.productClassId,new w(90),r,n.extraParam);return}case kt.WALL:{if(!n.furnitureData)return;switch(n.furnitureData.specialType){case Dt.FLOOR:e.updateObjectRoom(n.extraParam);return;case Dt.WALL_PAPER:e.updateObjectRoom(null,n.extraParam);return;case Dt.LANDSCAPE:{e.updateObjectRoom(null,null,n.extraParam);const o=tt().getWallItemDataByName("window_double_default");o&&e.addWallItemIntoRoom(o.id,new w(90),o.customParams);return}default:e.updateObjectRoom("default","default","default"),e.addWallItemIntoRoom(n.productClassId,new w(90),n.extraParam);return}}case kt.ROBOT:e.addAvatarIntoRoom(n.extraParam,0);return;case kt.EFFECT:e.addAvatarIntoRoom(tt().figure,n.productClassId);return}},[t,r,e]),t?t.pricingModel===ni.PRICING_MODEL_BUNDLE?i.jsx(N,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:i.jsx(Fe,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:t.products.length>0&&t.products.map((n,o)=>i.jsx($t,{itemImage:n.getIconUrl(t),itemCount:n.productCount},o))})}):i.jsx(rE,{roomPreviewer:e,height:140}):null},w9=a=>{const{page:t=null}=a,{currentOffer:e=null}=be();return i.jsxs(i.Fragment,{children:[i.jsx(aE,{}),i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",children:[i.jsx(Fd,{shrink:!0}),i.jsxs(N,{gap:1,overflow:"hidden",children:[i.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:g("catalog_selectbadge")}),i.jsx(j9,{})]})]}),i.jsxs(N,{center:!e,size:5,overflow:"hidden",children:[!e&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",src:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&i.jsxs(i.Fragment,{children:[i.jsx(V,{position:"relative",overflow:"hidden",children:i.jsx(Qo,{})}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(oE,{fullWidth:!0}),i.jsx(O,{grow:!0,truncate:!0,children:e.localizationName}),i.jsx(x,{justifyContent:"end",children:i.jsx(so,{alignItems:"end"})}),i.jsx(xn,{})]})]})]})]})]})},Yo=a=>{const{...t}=a,{currentOffer:e=null}=be();return!e||!e.badgeCode||!e.badgeCode.length?null:i.jsx(Xe,{badgeCode:e.badgeCode,...t})},F9=1,G9=100,YS=a=>{const{currentOffer:t=null,purchaseOptions:e=null,setPurchaseOptions:s=null}=be(),{quantity:r=1}=e,n=o=>{isNaN(o)&&(o=1),o=Math.max(o,F9),o=Math.min(o,G9),o!==r&&s(l=>{const c={...l};return c.quantity=o,c})};return!t||!t.bundlePurchaseAllowed?null:i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("catalog.bundlewidget.spinner.select.amount")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(dR,{className:"text-black cursor-pointer fa-icon",onClick:o=>n(r-1)}),i.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",value:r,onChange:o=>n(o.target.valueAsNumber)}),i.jsx(_R,{className:"text-black cursor-pointer fa-icon",onClick:o=>n(r+1)})]})]})},k9=a=>{const{page:t=null}=a,[e,s]=_.useState(new Map),{currentOffer:r=null,setCurrentOffer:n=null}=be(),[o,l]=_.useState(!1),c=(E,m)=>!E.product.furnitureData.colorIndex||!m.product.furnitureData.colorIndex||E.product.furnitureData.colorIndex>m.product.furnitureData.colorIndex?1:E==m?0:-1,u=(E,m)=>E.product.furnitureData.className>m.product.furnitureData.className?1:E==m?0:-1,h=E=>{E.activate(),n(E)},d=(E,m)=>{const I=`${m}*${E}`,p=t.offers.findIndex(T=>T.product.furnitureData.fullName===I);p>-1&&h(t.offers[p])},f=_.useMemo(()=>{const E=[],m=new Map,I=new Map;return t.offers.sort(c),t.offers.forEach(p=>{if(!p.product)return;const T=p.product.furnitureData;if(!T||!T.hasIndexedColor)E.push(p);else{const R=T.className,S=T.colorIndex;I.has(R)||I.set(R,[]);let L=16777215;if(T.colors){for(let M of T.colors)M!==16777215&&(L=M);I.get(R).indexOf(L)===-1&&(I.get(R)[S]=L)}m.has(R)||(E.push(p),m.set(R,!0))}}),E.sort(u),s(I),E},[t.offers]);return i.jsxs(pt,{children:[i.jsx(N,{size:7,overflow:"hidden",children:i.jsxs(Fe,{columnCount:5,children:[(!o||!r||!e.has(r.product.furnitureData.className))&&f.map((E,m)=>i.jsx(WS,{itemActive:r&&(r.product.furnitureData.hasIndexedColor?r.product.furnitureData.className===E.product.furnitureData.className:r.offerId===E.offerId),offer:E,selectOffer:h},m)),o&&r&&e.has(r.product.furnitureData.className)&&e.get(r.product.furnitureData.className).map((E,m)=>i.jsx($t,{itemHighlight:!0,itemActive:r.product.furnitureData.colorIndex===m,itemColor:yr.int2rgb(E),className:"clear-bg",onClick:I=>d(m,r.product.furnitureData.className)},m))]})}),i.jsxs(N,{center:!r,size:5,overflow:"hidden",children:[!r&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",src:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),r&&i.jsxs(i.Fragment,{children:[i.jsxs(V,{position:"relative",overflow:"hidden",children:[i.jsx(Qo,{}),i.jsx(Yo,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),r.product.furnitureData.hasIndexedColor&&i.jsx(W,{position:"absolute",className:"bottom-1 start-1",onClick:E=>l(m=>!m),children:i.jsx(LN,{className:"fa-icon"})})]}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(oE,{fullWidth:!0}),i.jsx(O,{grow:!0,truncate:!0,children:r.localizationName}),i.jsxs(x,{justifyContent:"between",children:[i.jsx(N,{gap:1,children:i.jsx(YS,{})}),i.jsx(so,{justifyContent:"end",alignItems:"end"})]}),i.jsx(xn,{})]})]})]})]})},GU=a=>{const{imageUrl:t=null}=a,[e,s]=_.useState("");return _.useEffect(()=>{s(t??ct("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder"))},[t]),i.jsx(x,{center:!0,fullWidth:!0,className:"nitro-catalog-header",children:i.jsx("img",{src:e,onError:({currentTarget:r})=>{r.src=ct("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder")}})})},B9=a=>{const{page:t=null}=a,{currentOffer:e=null,currentPage:s=null}=be();return i.jsx(i.Fragment,{children:i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",children:[ct("catalog.headers")&&i.jsx(GU,{imageUrl:s.localization.getImage(0)}),i.jsx(Fd,{})]}),i.jsxs(N,{center:!e,size:5,overflow:"hidden",children:[!e&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx(Ta,{imageUrl:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{center:!0,overflow:"hidden",style:{height:140},children:[e.product.productType!==kt.BADGE&&i.jsxs(i.Fragment,{children:[i.jsx(Qo,{}),i.jsx(Yo,{className:"bg-muted rounded bottom-1 end-1"})]}),e.product.productType===kt.BADGE&&i.jsx(Yo,{className:"scale-2"})]}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(oE,{fullWidth:!0}),i.jsx(O,{grow:!0,truncate:!0,children:e.localizationName}),i.jsxs(x,{justifyContent:"between",children:[i.jsx(N,{gap:1,children:i.jsx(YS,{})}),i.jsx(so,{justifyContent:"end",alignItems:"end"})]}),i.jsx(xn,{})]})]})]})]})})},V9=a=>{const{...t}=a,{currentOffer:e=null,purchaseOptions:s=null}=be(),{previewStuffData:r=null}=s,n=_.useMemo(()=>{if(!e||!r)return null;const o=r.getValue(2);return!o||!o.length?null:o},[e,r]);return n?i.jsx(Xe,{badgeCode:n,isGroup:!0,...t}):null},kU=a=>{const[t,e]=_.useState(0),{currentOffer:s=null,catalogOptions:r=null,setPurchaseOptions:n=null}=be(),{groups:o=null}=r,l=_.useMemo(()=>{if(!o||!o.length)return null;const u=o[t];if(!u)return null;const h=new An;return h.setValue(["0",u.groupId.toString(),u.badgeCode,u.colorA,u.colorB]),h},[t,o]);if(_.useEffect(()=>{s&&n(u=>{const h={...u};return h.extraParamRequired=!0,h.extraData=l&&l.getValue(1)||null,h.previewStuffData=l,h})},[s,l,n]),_.useEffect(()=>{H(new mS)},[]),!o||!o.length)return i.jsxs(V,{className:"bg-muted rounded p-1 text-black text-center",children:[g("catalog.guild_selector.members_only"),i.jsx(W,{className:"mt-1",children:g("catalog.guild_selector.find_groups")})]});const c=o[t];return i.jsxs(x,{gap:1,children:[!!c&&i.jsxs(x,{overflow:"hidden",className:"rounded border",children:[i.jsx(V,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorA}}),i.jsx(V,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorB}})]}),i.jsx("select",{className:"form-select form-select-sm",value:t,onChange:u=>e(parseInt(u.target.value)),children:o.map((u,h)=>i.jsx("option",{value:h,children:u.groupName},h))})]})},H9=a=>{const{page:t=null}=a,{currentOffer:e=null}=be();return i.jsxs(pt,{children:[i.jsx(N,{size:7,overflow:"hidden",children:i.jsx(Fd,{})}),i.jsxs(N,{center:!e,size:5,overflow:"hidden",children:[!e&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",src:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&i.jsxs(i.Fragment,{children:[i.jsxs(V,{position:"relative",overflow:"hidden",children:[i.jsx(Qo,{}),i.jsx(V9,{position:"absolute",className:"bottom-1 end-1"})]}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{truncate:!0,children:e.localizationName}),i.jsx(V,{grow:!0,children:i.jsx(kU,{})}),i.jsx(x,{justifyContent:"end",children:i.jsx(so,{alignItems:"end"})}),i.jsx(xn,{})]})]})]})]})},W9=a=>{const{page:t=null}=a;_.useState(0);const{currentOffer:e=null,setCurrentOffer:s=null,catalogOptions:r=null}=be();return _.useEffect(()=>{H(new mS)},[t]),i.jsxs(i.Fragment,{children:[i.jsx(aE,{}),i.jsxs(pt,{children:[i.jsx(N,{className:"bg-muted rounded p-2 text-black",size:7,overflow:"hidden",children:i.jsx(V,{className:"overflow-auto",dangerouslySetInnerHTML:{__html:t.localization.getText(1)}})}),i.jsx(N,{size:5,overflow:"hidden",gap:1,children:!!e&&i.jsx(i.Fragment,{children:i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{truncate:!0,children:e.localizationName}),i.jsx(V,{grow:!0,children:i.jsx(kU,{})}),i.jsx(x,{justifyContent:"end",children:i.jsx(so,{alignItems:"end"})}),i.jsx(xn,{noGiftOption:!0})]})})})]})]})},Y9=a=>{const{page:t=null}=a;return i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",className:"bg-muted rounded p-2 text-black",children:[i.jsx(V,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}}),i.jsx(V,{overflow:"auto",dangerouslySetInnerHTML:{__html:t.localization.getText(0)}}),i.jsx(V,{dangerouslySetInnerHTML:{__html:t.localization.getText(1)}})]}),i.jsxs(N,{center:!0,size:5,overflow:"hidden",children:[i.jsx(Ta,{imageUrl:t.localization.getImage(1)}),i.jsx(W,{onClick:()=>ht("groups/create"),children:g("catalog.start.guild.purchase.button")})]})]})},z9=a=>{const{page:t=null}=a;return i.jsx("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:i.jsx("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:i.jsx("div",{dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})})})},BU=a=>{const{page:t=null}=a,e=t.localization.getImage(1);return i.jsxs(N,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[i.jsxs(x,{alignItems:"center",gap:2,children:[e&&i.jsx("img",{alt:"",src:e}),i.jsx(V,{className:"fs-5",dangerouslySetInnerHTML:{__html:t.localization.getText(1)}})]}),i.jsx(N,{grow:!0,alignItems:"center",overflow:"auto",children:i.jsx(V,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}})}),i.jsx(x,{alignItems:"center",children:i.jsx(V,{className:"fw-bold",dangerouslySetInnerHTML:{__html:t.localization.getText(3)}})})]})},K9=a=>i.jsx(BU,{...a}),X9=a=>{const{page:t=null}=a,[e,s]=_.useState(""),[r,n]=_.useState(""),[o,l]=_.useState(-1),[c,u]=_.useState([]),[h,d]=_.useState(!1),[f,E]=_.useState(1),{categories:m=null}=sn(),{setIsVisible:I=null}=be(),{promoteInformation:p,isExtended:T,setIsExtended:R}=GS();_.useEffect(()=>{T&&(l(p.data.flatId),s(p.data.eventName),n(p.data.eventDescription),E(p.data.categoryId),d(T),R(!1))},[T,e,r,f]);const S=()=>{l(-1),s(""),n(""),E(1),R(!1),I(!1)},L=()=>{const M=t.pageId,P=t.offers.length>=1?t.offers[0].offerId:-1,k=o,G=e,j=r,F=f;H(new Ob(M,P,k,G,h,j,F)),S()};return z(MC,M=>{const P=M.getParser();P&&u(P.rooms)}),_.useEffect(()=>{H(new Tb),H(new aS)},[]),i.jsxs(i.Fragment,{children:[i.jsx(O,{bold:!0,center:!0,children:g("roomad.catalog_header")}),i.jsxs(N,{size:12,overflow:"hidden",className:"text-black",children:[i.jsx(V,{children:g("roomad.catalog_text",["duration"],["120"])}),i.jsxs(V,{className:"bg-muted rounded p-1",children:[i.jsxs(N,{gap:2,children:[i.jsx(O,{bold:!0,children:g("navigator.category")}),i.jsx("select",{className:"form-select form-select-sm",value:f,onChange:M=>E(parseInt(M.target.value)),disabled:h,children:m&&m.map((M,P)=>i.jsx("option",{value:M.id,children:g(M.name)},P))})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("roomad.catalog_name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:e,onChange:M=>s(M.target.value),readOnly:h})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("roomad.catalog_description")}),i.jsx("textarea",{className:"form-control form-control-sm",maxLength:64,value:r,onChange:M=>n(M.target.value),readOnly:h})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("roomad.catalog_roomname")}),i.jsxs("select",{className:"form-select form-select-sm",value:o,onChange:M=>l(parseInt(M.target.value)),disabled:h,children:[i.jsx("option",{value:-1,disabled:!0,children:g("roomad.catalog_roomname")}),c&&c.map((M,P)=>i.jsx("option",{value:M.roomId,children:M.roomName},P))]})]}),i.jsx(N,{gap:1,children:i.jsx(W,{variant:!e||!r||o===-1?"danger":"success",onClick:L,disabled:!e||!r||o===-1,children:g(h?"roomad.extend.event":"buy")})})]})]})]})},VU=a=>{const{columnCount:t=5,children:e=null,...s}=a,{currentOffer:r=null}=be(),n=_.useRef();return _.useEffect(()=>{n&&n.current&&(n.current.scrollTop=0)},[r]),r?i.jsxs(Fe,{innerRef:n,columnCount:5,...s,children:[r.products&&r.products.length>0&&r.products.map((o,l)=>i.jsx($t,{itemImage:o.getIconUrl(),itemCount:o.productCount},l)),e]}):null},HU=a=>{const{gap:t=1,...e}=a,{currentOffer:s=null}=be();return i.jsx(x,{gap:t,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...e,children:i.jsx(FU,{separator:!0,offer:s})})},q9=a=>{const{page:t=null}=a;return i.jsxs(i.Fragment,{children:[i.jsx(aE,{}),i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",children:[!!t.localization.getText(2)&&i.jsx(O,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}}),i.jsx(N,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:i.jsx(VU,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),i.jsxs(N,{size:5,overflow:"hidden",gap:1,children:[!!t.localization.getText(1)&&i.jsx(O,{center:!0,small:!0,overflow:"auto",children:t.localization.getText(1)}),i.jsxs(N,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",className:"flex-grow-1",src:t.localization.getImage(1)}),i.jsx(Yo,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),i.jsx(HU,{position:"absolute",className:"bottom-0 end-0"})]}),i.jsx(N,{gap:1,children:i.jsx(xn,{})})]})]})]})},Q9=a=>{const{page:t=null}=a;return i.jsxs(i.Fragment,{children:[i.jsx(aE,{}),i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",children:[!!t.localization.getText(2)&&i.jsx(O,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}}),i.jsx(N,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:i.jsx(VU,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),i.jsxs(N,{size:5,overflow:"hidden",gap:1,children:[!!t.localization.getText(1)&&i.jsx(O,{center:!0,small:!0,overflow:"auto",children:t.localization.getText(1)}),i.jsxs(N,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",className:"flex-grow-1",src:t.localization.getImage(1)}),i.jsx(Yo,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),i.jsx(HU,{position:"absolute",className:"bottom-0 end-0"})]}),i.jsx(N,{gap:1,children:i.jsx(xn,{})})]})]})]})},J9=a=>{const{page:t=null}=a,[e,s]=_.useState(-1),[r,n]=_.useState(""),{currentOffer:o=null,currentPage:l=null}=be(),c=u=>{var h;return(h=Os().musicController)==null?void 0:h.playSong(u,ri.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return z(UM,u=>{const h=u.getParser();h.officialSongId===r&&s(h.songId)}),_.useEffect(()=>{if(!o)return;const u=o.product;if(u){if(u.extraParam.length>0){const h=parseInt(u.extraParam);h>0?s(h):(n(u.extraParam),H(new QP(u.extraParam)))}else n(""),s(-1);return()=>{var h;return(h=Os().musicController)==null?void 0:h.stop(ri.PRIORITY_PURCHASE_PREVIEW)}}},[o]),_.useEffect(()=>()=>{var u;return(u=Os().musicController)==null?void 0:u.stop(ri.PRIORITY_PURCHASE_PREVIEW)},[]),i.jsx(i.Fragment,{children:i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",children:[ct("catalog.headers")&&i.jsx(GU,{imageUrl:l.localization.getImage(0)}),i.jsx(Fd,{})]}),i.jsxs(N,{center:!o,size:5,overflow:"hidden",children:[!o&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx(Ta,{imageUrl:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),o&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{center:!0,overflow:"hidden",style:{height:140},children:[o.product.productType!==kt.BADGE&&i.jsxs(i.Fragment,{children:[i.jsx(Qo,{}),i.jsx(Yo,{className:"bg-muted rounded bottom-1 end-1"})]}),o.product.productType===kt.BADGE&&i.jsx(Yo,{className:"scale-2"})]}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(oE,{fullWidth:!0}),i.jsx(O,{grow:!0,truncate:!0,children:o.localizationName}),e>-1&&i.jsx(W,{onClick:()=>c(e),children:g("play_preview_button")}),i.jsxs(x,{justifyContent:"between",children:[i.jsx(N,{gap:1,children:i.jsx(YS,{})}),i.jsx(so,{justifyContent:"end",alignItems:"end"})]}),i.jsx(xn,{})]})]})]})]})})},Z9=["floors","walls","views"],$9=a=>{const{columnCount:t=5,children:e=null,...s}=a,[r,n]=_.useState(null),[o,l]=_.useState(-1),[c,u]=_.useState(null),{currentPage:h=null,currentOffer:d=null,setCurrentOffer:f=null,setPurchaseOptions:E=null}=be(),m=_.useRef(),I=T=>{T&&u(R=>{const S=[...R];return S[o]=T,S})};if(_.useEffect(()=>{if(!h)return;const T=[[],[],[]];for(const R of h.offers){if(R.pricingModel!==ni.PRICING_MODEL_SINGLE&&R.pricingModel!==ni.PRICING_MODEL_MULTI)continue;const S=R.product;if(!S||S.productType!==kt.WALL&&S.productType!==kt.FLOOR||!S.furnitureData)continue;switch(S.furnitureData.className){case"floor":T[0].push(R);break;case"wallpaper":T[1].push(R);break;case"landscape":T[2].push(R);break}}n(T),l(0),u([T[0][0],T[1][0],T[2][0]])},[h]),_.useEffect(()=>{o===-1||!c||f(c[o])},[o,c,f]),_.useEffect(()=>{o===-1||!c||!d||E(T=>{const R={...T};return R.extraData=c[o].product.extraParam,R.extraParamRequired=!0,R})},[d,o,c,E]),_.useEffect(()=>{m&&m.current&&(m.current.scrollTop=0)},[o]),!r||o===-1)return null;const p=r[o];return i.jsxs(i.Fragment,{children:[i.jsx(ua,{children:Z9.map((T,R)=>i.jsx(W,{active:o===R,onClick:S=>l(R),children:g(`catalog.spaces.tab.${T}`)},R))}),i.jsxs(Fe,{innerRef:m,columnCount:t,...s,children:[p&&p.length>0&&p.map((T,R)=>i.jsx(WS,{itemActive:d&&d===T,offer:T,selectOffer:S=>I(S)},R)),e]})]})},tQ=a=>{const{page:t=null}=a,{currentOffer:e=null,roomPreviewer:s=null}=be();return _.useEffect(()=>{s.updatePreviewObjectBoundingRectangle()},[s]),i.jsxs(pt,{children:[i.jsx(N,{size:7,overflow:"hidden",children:i.jsx($9,{})}),i.jsxs(N,{center:!e,size:5,overflow:"hidden",children:[!e&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",src:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&i.jsxs(i.Fragment,{children:[i.jsx(V,{position:"relative",overflow:"hidden",children:i.jsx(Qo,{})}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{grow:!0,truncate:!0,children:e.localizationName}),i.jsx(x,{justifyContent:"end",children:i.jsx(so,{alignItems:"end"})}),i.jsx(xn,{})]})]})]})]})},eQ=a=>{const{page:t=null}=a,[e,s]=_.useState(""),{currentOffer:r=null,setPurchaseOptions:n=null}=be();return _.useEffect(()=>{r&&n(o=>{const l={...o};return l.extraData=e,l})},[r,e,n]),i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",children:[i.jsx(Fd,{}),i.jsx("textarea",{className:"flex-grow-1 form-control w-100",defaultValue:e||"",onChange:o=>s(o.target.value)})]}),i.jsxs(N,{center:!r,size:5,overflow:"hidden",children:[!r&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",src:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),r&&i.jsxs(i.Fragment,{children:[i.jsx(Qo,{}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{grow:!0,truncate:!0,children:r.localizationName}),i.jsx(x,{justifyContent:"end",children:i.jsx(so,{alignItems:"end"})}),i.jsx(xn,{})]})]})]})]})},sQ=a=>{const[t,e]=_.useState(null),[s,r]=_.useState($e.NONE),{currentPage:n=null,catalogOptions:o=null}=be(),{purse:l=null,getCurrencyAmount:c=null}=ec(),{clubOffers:u=null}=o,h=_.useCallback(R=>{switch(R.type){case pa.PURCHASE_SUCCESS:r($e.NONE);return;case Wo.PURCHASE_FAILED:r($e.FAILED);return}},[]);_s(pa.PURCHASE_SUCCESS,h),_s(Wo.PURCHASE_FAILED,h);const d=_.useCallback(R=>{let S="";return R.months>0&&(S=g("catalog.vip.item.header.months",["num_months"],[R.months.toString()])),R.extraDays>0&&(S!==""&&(S+=" "),S+=" "+g("catalog.vip.item.header.days",["num_days"],[R.extraDays.toString()])),S},[]),f=_.useCallback(()=>{if(!l)return"";const R=l.clubDays>0||l.clubPeriods>0?"extension.":"subscription.",S=t.months===0?"days":"months",L=t.months===0?t.extraDays:t.months;return g("catalog.vip.buy.confirm."+R+S).replace("%NUM_"+S.toUpperCase()+"%",L.toString())},[t,l]),E=_.useCallback(()=>{let R=g("catalog.vip.buy.confirm.end_date");return R=R.replace("%month%",t.month.toString()),R=R.replace("%day%",t.day.toString()),R=R.replace("%year%",t.year.toString()),R},[t]),m=_.useMemo(()=>{const R=l.clubDays,L=l.clubPeriods*31+R;return g("catalog.vip.extend.info",["days"],[L.toString()])},[l]),I=_.useCallback(()=>{t&&(r($e.PURCHASE),H(new Md(n.pageId,t.offerId,null,1)))},[t,n]),p=_.useCallback(R=>{r($e.NONE),e(R)},[]),T=_.useCallback(()=>{if(!t)return null;if(t.priceCredits>c(-1))return i.jsx(W,{fullWidth:!0,variant:"danger",children:g("catalog.alert.notenough.title")});if(t.priceActivityPoints>c(t.priceActivityPointsType))return i.jsx(W,{fullWidth:!0,variant:"danger",children:g("catalog.alert.notenough.activitypoints.title."+t.priceActivityPointsType)});switch(s){case $e.CONFIRM:return i.jsx(W,{fullWidth:!0,variant:"warning",onClick:I,children:g("catalog.marketplace.confirm_title")});case $e.PURCHASE:return i.jsx(W,{fullWidth:!0,variant:"primary",disabled:!0,children:i.jsx(kS,{})});case $e.FAILED:return i.jsx(W,{fullWidth:!0,variant:"danger",disabled:!0,children:g("generic.failed")});case $e.NONE:default:return i.jsx(W,{fullWidth:!0,variant:"success",onClick:()=>r($e.CONFIRM),children:g("buy")})}},[t,s,I,c]);return _.useEffect(()=>{u||H(new Eb(1))},[u]),i.jsxs(pt,{children:[i.jsxs(N,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[i.jsx(Fe,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:u&&u.length>0&&u.map((R,S)=>i.jsxs($t,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:t===R,className:"p-1",onClick:()=>p(R),children:[i.jsx("i",{className:"icon-hc-banner"}),i.jsxs(N,{justifyContent:"end",gap:0,children:[i.jsx(O,{textEnd:!0,children:d(R)}),i.jsxs(x,{justifyContent:"end",gap:1,children:[R.priceCredits>0&&i.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[i.jsx(O,{children:R.priceCredits}),i.jsx(ps,{type:-1})]}),R.priceActivityPoints>0&&i.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[i.jsx(O,{children:R.priceActivityPoints}),i.jsx(ps,{type:R.priceActivityPointsType})]})]})]})]},S))}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:g("catalog.vip.buy.hccenter")}})]}),i.jsxs(N,{size:5,overflow:"hidden",children:[i.jsxs(N,{fullHeight:!0,center:!0,overflow:"hidden",children:[n.localization.getImage(1)&&i.jsx("img",{alt:"",src:n.localization.getImage(1)}),i.jsx(O,{center:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:m}})]}),t&&i.jsxs(N,{fullWidth:!0,grow:!0,justifyContent:"end",children:[i.jsxs(x,{alignItems:"end",children:[i.jsxs(N,{grow:!0,gap:0,children:[i.jsx(O,{fontWeight:"bold",children:f()}),i.jsx(O,{children:E()})]}),i.jsxs(N,{gap:1,children:[t.priceCredits>0&&i.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[i.jsx(O,{children:t.priceCredits}),i.jsx(ps,{type:-1})]}),t.priceActivityPoints>0&&i.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[i.jsx(O,{children:t.priceActivityPoints}),i.jsx(ps,{type:t.priceActivityPointsType})]})]})]}),T()]})]})]})},iQ=a=>{const{text:t=null}=a,[e,s]=_.useState(""),[r,n]=_.useState(!1),{simpleAlert:o=null}=Ye(),l=()=>{!e||!e.length||r||(H(new Nb(e)),n(!0))};return z(PC,c=>{const u=c.getParser();let h=g("catalog.alert.voucherredeem.ok.description");u.productName&&(h=g("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[u.productName,u.productDescription])),o(h,null,null,null,g("catalog.alert.voucherredeem.ok.title")),n(!1),s("")}),z(vC,c=>{const u=c.getParser();o(g(`catalog.alert.voucherredeem.error.description.${u.errorCode}`),null,null,null,g("catalog.alert.voucherredeem.error.title")),n(!1)}),i.jsxs(x,{gap:1,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:t,value:e,onChange:c=>s(c.target.value)}),i.jsx(W,{variant:"primary",onClick:l,disabled:r,children:i.jsx(y0,{className:"fa-icon"})})]})},$d=a=>{const{item:t=null,position:e="relative",pointer:s=!0,overflow:r="hidden",fullHeight:n=!0,classNames:o=[],children:l=null,...c}=a,u=_.useMemo(()=>{const d=["rounded","nitro-front-page-item"];return o.length&&d.push(...o),d},[o]);if(!t)return null;const h=ct("image.library.url")+t.itemPromoImage;return i.jsxs(MU,{imageUrl:h,classNames:u,position:e,fullHeight:n,pointer:s,overflow:r,...c,children:[i.jsx(O,{position:"absolute",variant:"white",className:"bg-dark rounded p-2 m-2 bottom-0",children:t.itemName}),l]})},rQ=a=>{const{page:t=null,hideNavigation:e=null}=a,{frontPageItems:s=[]}=be(),r=_.useCallback(n=>{switch(n.type){case td.ITEM_CATALOGUE_PAGE:ht(`catalog/open/${n.catalogPageLocation}`);return;case td.ITEM_PRODUCT_OFFER:ht(`catalog/open/${n.productOfferId}`);return}},[]);return _.useEffect(()=>{e()},[t,e]),i.jsxs(pt,{children:[i.jsx(N,{size:4,children:s[0]&&i.jsx($d,{item:s[0],onClick:n=>r(s[0])})}),i.jsxs(N,{size:8,children:[s[1]&&i.jsx($d,{item:s[1],onClick:n=>r(s[1])}),s[2]&&i.jsx($d,{item:s[2],onClick:n=>r(s[2])}),s[3]&&i.jsx($d,{item:s[3],onClick:n=>r(s[3])}),i.jsx(iQ,{text:t.localization.getText(1)})]})]})},rR=1,g_=2,WU=a=>{const{offerData:t=null,type:e=g_,onClick:s=null}=a,r=_.useMemo(()=>t?g((t.furniType===2?"wallItem":"roomItem")+`.name.${t.furniId}`):"",[t]),n=_.useCallback(()=>{if(!t)return"";if(t.status===fd.SOLD)return g("catalog.marketplace.offer.sold");if(t.timeLeftMinutes<=0)return g("catalog.marketplace.offer.expired");const o=Math.max(1,t.timeLeftMinutes),l=Math.floor(o/60);let u=o-l*60+" "+g("catalog.marketplace.offer.minutes");return l>0&&(u=l+" "+g("catalog.marketplace.offer.hours")+" "+u),g("catalog.marketplace.offer.time_left",["time"],[u])},[t]);return i.jsxs($t,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[i.jsx(N,{style:{width:40,height:40},children:i.jsx($t,{column:!1,itemImage:qX(t.furniType===gd.TYPE_FLOOR?kt.FLOOR:kt.WALL,t.furniId,t.extraData),itemUniqueNumber:t.isUniqueLimitedItem?t.stuffData.uniqueNumber:0})}),i.jsxs(N,{grow:!0,gap:0,children:[i.jsx(O,{fontWeight:"bold",children:r}),e===rR&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("catalog.marketplace.offer.price_own_item",["price"],[t.price.toString()])}),i.jsx(O,{children:n()})]}),e===g_&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("catalog.marketplace.offer.price_public_item",["price","average"],[t.price.toString(),t.averagePrice>0?t.averagePrice.toString():"-"])}),i.jsx(O,{children:g("catalog.marketplace.offer_count",["count"],[t.offerCount.toString()])})]})]}),i.jsxs(N,{gap:1,children:[e===rR&&t.status!==fd.SOLD&&i.jsx(W,{variant:"secondary",onClick:()=>s(t),children:g("catalog.marketplace.offer.pick")}),e===g_&&i.jsxs(i.Fragment,{children:[i.jsx(W,{variant:"secondary",onClick:()=>s(t),children:g("buy")}),i.jsx(W,{variant:"secondary",disabled:!0,children:g("catalog.marketplace.view_more")})]})]})]})},nQ=a=>{const[t,e]=_.useState(0),[s,r]=_.useState([]),{simpleAlert:n=null}=Ye();z(Wx,u=>{const h=u.getParser();if(!h)return;const d=h.offers.map(f=>{const E=new gd(f.offerId,f.furniId,f.furniType,f.extraData,f.stuffData,f.price,f.status,f.averagePrice,f.offerCount);return E.timeLeftMinutes=f.timeLeftMinutes,E});e(h.creditsWaiting),r(d)}),z(kx,u=>{const h=u.getParser();if(h){if(!h.success){n(g("catalog.marketplace.cancel_failed"),Yt.DEFAULT,null,null,g("catalog.marketplace.operation_failed.topic"));return}r(d=>d.filter(f=>f.offerId!==h.offerId))}});const o=_.useMemo(()=>s.filter(u=>u.status===fd.SOLD),[s]),l=_.useCallback(()=>{r(u=>{const h=o.map(d=>d.offerId);return u.filter(d=>h.indexOf(d.offerId)===-1)}),H(new JD)},[o]),c=u=>{H(new zD(u.offerId))};return _.useEffect(()=>{H(new qD)},[]),i.jsxs(N,{overflow:"hidden",children:[t<=0&&i.jsx(O,{center:!0,className:"bg-muted rounded p-1",children:g("catalog.marketplace.redeem.no_sold_items")}),t>0&&i.jsxs(N,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[i.jsx(O,{children:g("catalog.marketplace.redeem.get_credits",["count","credits"],[o.length.toString(),t.toString()])}),i.jsx(W,{className:"mt-1",onClick:l,children:g("catalog.marketplace.offer.redeem")})]}),i.jsxs(N,{gap:1,overflow:"hidden",children:[i.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:g("catalog.marketplace.items_found",["count"],[s.length.toString()])}),i.jsx(N,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:s.length>0&&s.map(u=>i.jsx(WU,{offerData:u,type:rR,onClick:c},u.offerId))})]})]})},aQ=a=>{const{searchType:t=null,sortTypes:e=null,onSearch:s=null}=a,[r,n]=_.useState(e?e[0]:3),[o,l]=_.useState(""),[c,u]=_.useState(0),[h,d]=_.useState(0),f=_.useCallback(m=>{n(m),(t===gi.BY_ACTIVITY||t===gi.BY_VALUE)&&s({minPrice:-1,maxPrice:-1,query:"",type:m})},[s,t]),E=_.useCallback(()=>{const m=c>0?c:-1,I=h>0?h:-1;s({minPrice:m,maxPrice:I,type:r,query:o})},[h,c,s,o,r]);return _.useEffect(()=>{if(!e||!e.length)return;const m=e[0];n(m),(t===gi.BY_ACTIVITY||gi.BY_VALUE===t)&&s({minPrice:-1,maxPrice:-1,query:"",type:m})},[s,t,e]),i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("catalog.marketplace.sort_order")}),i.jsx("select",{className:"form-select form-select-sm",value:r,onChange:m=>f(parseInt(m.target.value)),children:e.map(m=>i.jsx("option",{value:m,children:g(`catalog.marketplace.sort.${m}`)},m))})]}),t===gi.ADVANCED&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("catalog.marketplace.search_name")}),i.jsx("input",{className:"form-control form-control-sm",type:"text",value:o,onChange:m=>l(m.target.value)})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("catalog.marketplace.search_price")}),i.jsxs(x,{fullWidth:!0,gap:1,children:[i.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:c,onChange:m=>u(m.target.valueAsNumber)}),i.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:h,onChange:m=>d(m.target.valueAsNumber)})]})]}),i.jsx(W,{variant:"secondary",className:"mx-auto",onClick:E,children:g("generic.search")})]})]})},oQ=[1,2],lQ=[3,4,5,6],cQ=[1,2,3,4,5,6],uQ=a=>{const[t,e]=_.useState(gi.BY_ACTIVITY),[s,r]=_.useState(0),[n,o]=_.useState(new Map),[l,c]=_.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:u=null}=ec(),{simpleAlert:h=null,showConfirm:d=null}=Ye(),f=_.useCallback(I=>{c(I),H(new XD(I.minPrice,I.maxPrice,I.query,I.type))},[]),E=_.useMemo(()=>{switch(t){case gi.BY_ACTIVITY:return lQ;case gi.BY_VALUE:return oQ;case gi.ADVANCED:return cQ}return[]},[t]),m=_.useCallback(I=>{if(I.price>u(-1)){h(g("catalog.alert.notenough.credits.description"),Yt.DEFAULT,null,null,g("catalog.alert.notenough.title"));return}const p=I.offerId;d(g("catalog.marketplace.confirm_header"),()=>{H(new BI(p))},null,null,null,g("catalog.marketplace.confirm_title"))},[u,h,d]);return z(Hx,I=>{const p=I.getParser();if(!p)return;const T=new Map;p.offers.forEach(R=>{const S=new gd(R.offerId,R.furniId,R.furniType,R.extraData,R.stuffData,R.price,R.status,R.averagePrice,R.offerCount);S.timeLeftMinutes=R.timeLeftMinutes,T.set(R.offerId,S)}),r(p.totalItemsFound),o(T)}),z(Gx,I=>{const p=I.getParser();if(p)switch(p.result){case 1:f(l);break;case 2:o(T=>{const R=new Map(T);return R.delete(p.requestedOfferId),R}),h(g("catalog.marketplace.not_available_header"),Yt.DEFAULT,null,null,g("catalog.marketplace.not_available_title"));break;case 3:o(T=>{const R=new Map(T),S=R.get(p.requestedOfferId);return S&&(S.offerId=p.offerId,S.price=p.newPrice,S.offerCount--,R.set(S.offerId,S)),R.delete(p.requestedOfferId),R}),d(g("catalog.marketplace.confirm_higher_header")+`
`+g("catalog.marketplace.confirm_price",["price"],[p.newPrice.toString()]),()=>{H(new BI(p.offerId))},null,null,null,g("catalog.marketplace.confirm_higher_title"));break;case 4:h(g("catalog.alert.notenough.credits.description"),Yt.DEFAULT,null,null,g("catalog.alert.notenough.title"));break}}),i.jsxs(i.Fragment,{children:[i.jsxs(ua,{children:[i.jsx(W,{active:t===gi.BY_ACTIVITY,onClick:()=>e(gi.BY_ACTIVITY),children:g("catalog.marketplace.search_by_activity")}),i.jsx(W,{active:t===gi.BY_VALUE,onClick:()=>e(gi.BY_VALUE),children:g("catalog.marketplace.search_by_value")}),i.jsx(W,{active:t===gi.ADVANCED,onClick:()=>e(gi.ADVANCED),children:g("catalog.marketplace.search_advanced")})]}),i.jsx(aQ,{sortTypes:E,searchType:t,onSearch:f}),i.jsxs(N,{gap:1,overflow:"hidden",children:[i.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:g("catalog.marketplace.items_found",["count"],[n.size.toString()])}),i.jsx(N,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(n.values()).map((I,p)=>i.jsx(WU,{offerData:I,type:g_,onClick:m},p))})]})]})},hQ=a=>{const{page:t=null}=a,[e,s]=_.useState(-1),[r,n]=_.useState([]),[o,l]=_.useState(-1),[c,u]=_.useState([]),[h,d]=_.useState(-1),[f,E]=_.useState(!1),[m,I]=_.useState("");_.useState(!0);const[p,T]=_.useState(-1),{currentOffer:R=null,setCurrentOffer:S=null,setPurchaseOptions:L=null,catalogOptions:M=null,roomPreviewer:P=null}=be(),{petPalettes:k=null}=M,G=_.useMemo(()=>!c.length||h===-1?16777215:c[h][0],[c,h]),j=_.useMemo(()=>e===-1||!r.length||o===-1?"":g(`pet.breed.${e}.${r[o].breedId}`),[e,r,o]),F=_.useMemo(()=>{if(!r.length||o===-1)return"";const B=r[o].paletteId;let J=16777215;if(e<=7){if(h===-1)return"";J=c[h][0]}let Z=J.toString(16).toUpperCase();for(;Z.length<6;)Z="0"+Z;return`${B}
${Z}`},[r,o,e,c,h]),U=_.useMemo(()=>{let B="";switch(p){case 1:B="catalog.alert.petname.long";break;case 2:B="catalog.alert.petname.short";break;case 3:B="catalog.alert.petname.chars";break;case 4:B="catalog.alert.petname.bobba";break}return!B||!B.length?"":g(B)},[p]),K=_.useCallback(()=>{if(p===-1){H(new tL(m,1));return}if(p===0){H(new Md(t.pageId,R.offerId,`${m}
${F}`,1));return}},[t,R,m,F,p]);return z(GM,B=>{const J=B.getParser();T(J.result),J.result===0?K():Ps(new Wo(-1))}),_.useEffect(()=>{if(!t||!t.offers.length)return;const B=t.offers[0];S(B),s(zX(B.localizationId)),E(!1)},[t,S]),_.useEffect(()=>{if(!R)return;const B=R.product.productData;if(B){if(k)for(const J of k){if(J.breed!==B.type)continue;const Z=[];for(const Q of J.palettes)Q.sellable&&Z.push(Q);l(Z.length?0:-1),n(Z);return}l(-1),n([]),H(new Rb(B.type))}},[R,k]),_.useEffect(()=>{if(e===-1)return;const B=KX(e,r);d(B.length?0:-1),u(B)},[e,r]),_.useEffect(()=>{if(!P||(P.reset(!1),e===-1||!r.length||o===-1))return;let B=`${e} ${r[o].paletteId}`;e<=7&&(B+=` ${G.toString(16)}`),P.addPetIntoRoom(B)},[P,e,r,o,G]),_.useEffect(()=>{T(-1)},[m]),R?i.jsxs(pt,{children:[i.jsx(N,{size:7,overflow:"hidden",children:i.jsxs(Fe,{columnCount:5,children:[!f&&r.length>0&&r.map((B,J)=>i.jsx($t,{itemActive:o===J,onClick:Z=>l(J),children:i.jsx(ia,{typeId:e,paletteId:B.paletteId,direction:2,headOnly:!0})},J)),f&&c.length>0&&c.map((B,J)=>i.jsx($t,{itemHighlight:!0,itemActive:h===J,itemColor:yr.int2rgb(B[0]),className:"clear-bg",onClick:Z=>d(J)},J))]})}),i.jsxs(N,{center:!R,size:5,overflow:"hidden",children:[!R&&i.jsxs(i.Fragment,{children:[!!t.localization.getImage(1)&&i.jsx("img",{alt:"",src:t.localization.getImage(1)}),i.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),R&&i.jsxs(i.Fragment,{children:[i.jsxs(V,{position:"relative",overflow:"hidden",children:[i.jsx(Qo,{}),i.jsx(Yo,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),e>-1&&e<=7&&i.jsx(W,{position:"absolute",className:"bottom-1 start-1",onClick:B=>E(!f),children:i.jsx(LN,{className:"fa-icon"})})]}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{truncate:!0,children:j}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:g("widgets.petpackage.name.title"),value:m,onChange:B=>I(B.target.value)}),p>0&&i.jsx(V,{className:"invalid-feedback d-block m-0",children:U})]}),i.jsx(x,{justifyContent:"end",children:i.jsx(so,{justifyContent:"end",alignItems:"end"})}),i.jsx(xn,{purchaseCallback:K})]})]})]})]}):null},dQ=a=>{const{offer:t=null,isAvailable:e=!1,daysRequired:s=0,onSelect:r=null}=a,n=_.useCallback(()=>{if(!t||!t.products.length)return"";const l=t.products[0];return __.getProductImageUrl(l.productType,l.furniClassId,l.extraParam)},[t]),o=_.useCallback(()=>{if(!t||!t.products.length)return"";const l=t.products[0],c=__.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.name."+l.furniClassId:"roomItem.name."+l.furniClassId;return g(c)},[t]);return _.useCallback(()=>{if(!t||!t.products.length)return"";const l=t.products[0],c=__.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.desc."+l.furniClassId:"roomItem.desc."+l.furniClassId;return g(c)},[t]),_.useCallback(()=>Math.floor(s/31),[s]),i.jsxs($t,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[i.jsx(Ta,{imageUrl:n()}),i.jsx(O,{grow:!0,fontWeight:"bold",children:o()}),i.jsx(W,{variant:"secondary",onClick:()=>r(t.localizationId),disabled:!e,children:g("catalog.club_gift.select")})]})},_Q=a=>{const{purse:t=null}=ec(),{catalogOptions:e=null,setCatalogOptions:s=null}=be(),{clubGifts:r=null}=e,{showConfirm:n=null}=Ye(),o=_.useCallback(()=>r?r.giftsAvailable>0?g("catalog.club_gift.available",["amount"],[r.giftsAvailable.toString()]):r.daysUntilNextGift>0?g("catalog.club_gift.days_until_next",["days"],[r.daysUntilNextGift.toString()]):t.isVip?g("catalog.club_gift.not_available"):g("catalog.club_gift.no_club"):"",[r,t]),l=_.useCallback(u=>{n(g("catalog.club_gift.confirm"),()=>{H(new Cb(u)),s(h=>(h.clubGifts.giftsAvailable--,{...h}))},null)},[s,n]),c=_.useMemo(()=>r.offers.sort((h,d)=>r.getOfferExtraData(h.offerId).daysRequired-r.getOfferExtraData(d.offerId).daysRequired),[r]);return i.jsxs(i.Fragment,{children:[i.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:o()}),i.jsx(Fe,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:r.offers.length>0&&c.map(u=>i.jsx(dQ,{offer:u,isAvailable:r.getOfferExtraData(u.offerId).isSelectable&&r.giftsAvailable>0,onSelect:l,daysRequired:r.getOfferExtraData(u.offerId).daysRequired},u.offerId))})]})},gQ=(a,t)=>{if(!a)return null;const e={page:a,hideNavigation:t};switch(a.layoutCode){case"frontpage_featured":return null;case"frontpage4":return i.jsx(rQ,{...e});case"pets":return i.jsx(hQ,{...e});case"pets2":return i.jsx(K9,{...e});case"pets3":return i.jsx(BU,{...e});case"vip_buy":return i.jsx(sQ,{...e});case"guild_frontpage":return i.jsx(Y9,{...e});case"guild_forum":return i.jsx(W9,{...e});case"guild_custom_furni":return i.jsx(H9,{...e});case"club_gifts":return i.jsx(_Q,{...e});case"marketplace_own_items":return i.jsx(nQ,{...e});case"marketplace":return i.jsx(uQ,{...e});case"single_bundle":return i.jsx(Q9,{...e});case"room_bundle":return i.jsx(q9,{...e});case"spaces_new":return i.jsx(tQ,{...e});case"trophies":return i.jsx(eQ,{...e});case"info_loyalty":return i.jsx(z9,{...e});case"badge_display":return i.jsx(w9,{...e});case"roomads":return i.jsx(X9,{...e});case"default_3x3_color_grouping":return i.jsx(k9,{...e});case"soundmachine":return i.jsx(J9,{...e});case"bots":case"default_3x3":default:return i.jsx(B9,{...e})}},fQ=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(0),[n,o]=_.useState("0"),{catalogOptions:l=null,setCatalogOptions:c=null}=be(),{marketplaceConfiguration:u=null}=l,{showConfirm:h=null}=Ye(),d=p=>{o(p);const T=parseInt(p);isNaN(T)||T===s||r(parseInt(p))};if(z(Bx,p=>{const T=p.getParser();c(R=>{const S={...R};return S.marketplaceConfiguration=T,S})}),_s(Mg.POST_MARKETPLACE,p=>e(p.item)),_.useEffect(()=>{!t||u||H(new KD)},[t,u]),_.useEffect(()=>{if(t)return()=>r(0)},[t]),!u||!t)return null;const f=t?g(t.isWallItem?"wallItem.name."+t.type:"roomItem.name."+t.type):"",E=t?g(t.isWallItem?"wallItem.desc."+t.type:"roomItem.desc."+t.type):"",m=()=>Math.max(Math.ceil(u.commission*.01*s),1),I=()=>{!t||s<u.minimumPrice||h(g("inventory.marketplace.confirm_offer.info",["furniname","price"],[f,s.toString()]),()=>{H(new QD(s,t.isWallItem?2:1,t.id)),e(null)},()=>{e(null)},null,null,g("inventory.marketplace.confirm_offer.title"))};return i.jsxs(Ct,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("inventory.marketplace.make_offer.title"),onCloseClick:p=>e(null)}),i.jsx(It,{overflow:"hidden",children:i.jsxs(pt,{fullHeight:!0,children:[i.jsx(N,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:i.jsx(iE,{productType:t.isWallItem?kt.WALL:kt.FLOOR,productClassId:t.type,extraData:t.extra.toString()})}),i.jsxs(N,{size:8,justifyContent:"between",overflow:"hidden",children:[i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{fontWeight:"bold",children:f}),i.jsx(O,{truncate:!0,shrink:!0,children:E})]}),i.jsxs(N,{overflow:"auto",children:[i.jsx(O,{italics:!0,children:g("inventory.marketplace.make_offer.expiration_info",["time"],[u.offerTime.toString()])}),i.jsxs("div",{className:"input-group has-validation",children:[i.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:n,onChange:p=>d(p.target.value),placeholder:g("inventory.marketplace.make_offer.price_request")}),(s<u.minimumPrice||isNaN(s))&&i.jsx(V,{className:"invalid-feedback d-block",children:g("inventory.marketplace.make_offer.min_price",["minprice"],[u.minimumPrice.toString()])}),s>u.maximumPrice&&!isNaN(s)&&i.jsx(V,{className:"invalid-feedback d-block",children:g("inventory.marketplace.make_offer.max_price",["maxprice"],[u.maximumPrice.toString()])}),!(s<u.minimumPrice||s>u.maximumPrice||isNaN(s))&&i.jsx(V,{className:"invalid-feedback d-block",children:g("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[m().toString(),(s+m()).toString()])})]}),i.jsx(W,{disabled:s<u.minimumPrice||s>u.maximumPrice||isNaN(s),onClick:I,children:g("inventory.marketplace.make_offer.post")})]})]})]})})]})},mQ=a=>{const{isVisible:t=!1,setIsVisible:e=null,rootNode:s=null,currentPage:r=null,navigationHidden:n=!1,setNavigationHidden:o=null,activeNodes:l=[],searchResult:c=null,setSearchResult:u=null,openPageByName:h=null,openPageByOfferId:d=null,activateNode:f=null,getNodeById:E}=be();return _.useEffect(()=>{const m={linkReceived:I=>{const p=I.split("/");if(!(p.length<2))switch(p[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(T=>!T);return;case"open":if(p.length>2)if(p.length===4)switch(p[2]){case"offerId":d(parseInt(p[3]));return}else h(p[2]);else e(!0);return}},eventUrlPrefix:"catalog/"};return As(m),()=>Ns(m)},[e,d,h]),i.jsxs(i.Fragment,{children:[t&&i.jsxs(Ct,{uniqueKey:"catalog",className:"nitro-catalog",style:ct("catalog.headers")?{width:710}:{},children:[i.jsx(Nt,{headerText:g("catalog.title"),onCloseClick:m=>e(!1)}),i.jsx(eo,{children:s&&s.children.length>0&&s.children.map((m,I)=>{if(!m.isVisible)return null;const p=`${m.pageId}-${I}`;return i.jsx(Ia,{isActive:m.isActive,onClick:T=>{c&&u(null),f(m)},children:i.jsxs(x,{gap:jt()?1:0,alignItems:"center",children:[jt()&&i.jsx(UU,{icon:m.iconId}),m.localization]})},p)})}),i.jsx(It,{children:i.jsxs(pt,{children:[!n&&i.jsx(N,{size:3,overflow:"hidden",children:l&&l.length>0&&i.jsx(U9,{node:l[0]})}),i.jsx(N,{size:n?12:9,overflow:"hidden",children:gQ(r,()=>o(!0))})]})})]}),i.jsx(P9,{}),i.jsx(fQ,{})]})},EQ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(""),{chatHistory:n=[]}=jd(),o=_.useRef(null),l=_.useMemo(()=>{if(s.length===0)return n;let c=s.toLowerCase();return n.filter(u=>u.message&&u.message.toLowerCase().includes(c)||u.name&&u.name.toLowerCase().includes(c))},[n,s]);return _.useEffect(()=>{o&&o.current&&t&&(o.current.scrollTop=o.current.scrollHeight)},[t]),_.useEffect(()=>{const c={linkReceived:u=>{const h=u.split("/");if(!(h.length<2))switch(h[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(d=>!d);return}},eventUrlPrefix:"chat-history/"};return As(c),()=>Ns(c)},[]),t?i.jsxs(Ct,{uniqueKey:"chat-history",className:"nitro-chat-history",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("room.chathistory.button.text"),onCloseClick:c=>e(!1)}),i.jsxs(It,{innerRef:o,overflow:"hidden",gap:2,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:s,onChange:c=>r(c.target.value)}),i.jsx(sE,{rows:l,scrollToBottom:!0,rowRender:c=>i.jsxs(x,{alignItems:"center",className:"p-1",gap:2,children:[i.jsx(O,{variant:"muted",children:c.timestamp}),c.type===On.TYPE_CHAT&&i.jsxs("div",{className:"bubble-container",style:{position:"relative"},children:[c.style===0&&i.jsx("div",{className:"user-container-bg",style:{backgroundColor:c.color}}),i.jsxs("div",{className:`chat-bubble bubble-${c.style} type-${c.chatType}`,style:{maxWidth:"100%"},children:[i.jsx("div",{className:"user-container",children:c.imageUrl&&c.imageUrl.length>0&&i.jsx("div",{className:"user-image",style:{backgroundImage:`url(${c.imageUrl})`}})}),i.jsxs("div",{className:"chat-content",children:[i.jsx("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${c.name}: `}}),i.jsx("span",{className:"message",dangerouslySetInnerHTML:{__html:`${c.message}`}})]})]})]}),c.type===On.TYPE_ROOM_INFO&&i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"icon icon-small-room"}),i.jsx(O,{textBreak:!0,wrap:!0,grow:!0,children:c.name})]})]})})]})]}):null},YU=_.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),pQ=a=>i.jsx(YU.Provider,{...a}),zS=()=>_.useContext(YU),Lo=32,sl=64,Xu="x0123456789abcdefghijklmnopq",Cl=class Cl{};Cl.DOOR=0,Cl.UP=1,Cl.DOWN=2,Cl.SET=3,Cl.UNSET=4;let Ks=Cl;const IQ={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class TQ{constructor(){this._currentAction=Ks.SET,this._currentHeight=Xu[1]}get currentAction(){return this._currentAction}set currentAction(t){this._currentAction=t}get currentHeight(){return this._currentHeight}set currentHeight(t){this._currentHeight=t}clear(){this._currentAction=Ks.SET,this._currentHeight=Xu[1]}}const RQ="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAAC+CAMAAADnThrbAAAAYFBMVEUAAAAiIiIAZf8A6P8A/5MZ/wCb/wD/tQD/MgD/AHr/APxDXocAkf8A/+oA/2hE/wDy/wD/iQD/BwD/AKXWAP////8AvP8A/78A/z1w/wD/4AD/XgD/ACP/ANGqAP8QEBBSz3qJAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEwAACxMBAJqcGAAABJxJREFUeNrt1tuOszoMBeDpD7QFBloKDGf6/m+51UTj1PUhN1uWOup3vSQLkSzn6+vV4fAV9X9lLIcdDv/+xWKHw/d3PPPzE8k8Rj1osceoBz3z4yiZ31HauN9R2rjfUcq451HSuOdR0rjnUcK411HcuNdR3LjXUcw4btTrOG7U6zhu1Ms4adTzOGnU8zhpVBh30Eb5cQ/fKp/5UR1+51l9mfU/Mz6NxvfMuEGMu9G49f/y8vzLz4Ikif/8qopnhiF6FhNHP9aVo2cGR71lCZAvbAXkzADE/kgQvooqhM8MCNuMCUFLtiJoZiBI5ycsvD4qFs4MLLTNElFYjJUoZAYRPAsSlV/5lcpnBhU8C6y+zPqfGZ9G43tm3CDG3Wjc+p9N/Z7PgjSN//y6jmfGMXoWU0c/1rWjZ0ZHvWUpkC9sDeTMCMT+SBG+imqEz4wI24wpQUu2JmhmJEjnpyy8PmoWzowstM1SUViMtShkRhE8C1KVX/m1ymdGFTwLrL7M+p8Zn0bje2bcIMbdaNz6n039ns+CLIv//Mslnpmm6FnMHP1YXxw9MznqLcuAfGEvQM5MQOyPDOGr6ILwmQlhmzEjaMleCJqZCNL5GQuvjwsLZyYW2maZKCzGiyhkJhE8CzKVX/kXlc9MKngWWH2Z9T8zPo3G98y4QYy70bj1P5v6PZ8Fx2P851+v8cw8R8/i0dGP9dXRM7Oj3rIjkC/sFciZGYj9cUT4KroifGZG2GY8ErRkrwTNzATp/CMLr48rC2dmFtpmR1FYjFdRyMwieBYcVX7lX1U+M6vgWWD1Zdb/zPg0Gt8z4wYx7kbj1v9s6vd8FpxO8Z/fNPHMskTP4snRj3Xj6JnFUW/ZCcgXtgFyZgFif5wQvooahM8sCNuMJ4KWbEPQzEKQzj+x8PpoWDizsNA2O4nCYmxEIbOI4FlwUvmV36h8ZlHBs8Dqy6z/mfFpNL5nxg1i3I3Grf/Z1O/5LDif4z//dotn1jV6Fs+Ofqxvjp5ZHfWWnYF8YW9AzqxA7I8zwlfRDeEzK8I245mgJXsjaGYlSOefWXh93Fg4s7LQNjuLwmK8iUJmFcGz4KzyK/+m8plVBc8Cqy+z/mfGp9H4nhk3iHE3Grf+Z1O/57Mgz+M/v23jmW2LnsXc0Y916+iZzVFvWQ7kC9sCObMBsT9yhK+iFuEzG8I2Y07Qkm0JmtkI0vk5C6+PloUzGwtts1wUFmMrCplNBM+CXOVXfqvymU0FzwKrL7P+Z8an0fieGTeIcTcat/5nU7/ns6Ao4j+/6+KZfY+excLRj3Xn6JndUW9ZAeQL2wE5swOxPwqEr6IO4TM7wjZjQdCS7Qia2QnS+QULr4+OhTM7C22zQhQWYycKmV0Ez4JC5Vd+p/KZXQXPAqsvs/5nxqfR+J4ZN4hxNxq3/mdTv+ezoCzjP7/v45n7PXoWS0c/1r2jZ+6OestKIF/YHsiZOxD7o0T4KuoRPnNH2GYsCVqyPUEzd4J0fsnC66Nn4cydhbZZKQqLsReFzF0Ez4JS5Vd+r/KZuwqeBVZfZv3PjE+j8T0zbhDjbjRu/b+0PP8DZwi9QurvbfwAAAAASUVORK5CYII=",SQ={frames:{0:{frame:{x:1,y:1,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},1:{frame:{x:37,y:1,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},2:{frame:{x:73,y:1,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},3:{frame:{x:1,y:20,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},4:{frame:{x:37,y:20,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},5:{frame:{x:73,y:20,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},6:{frame:{x:1,y:39,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},7:{frame:{x:37,y:39,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},8:{frame:{x:73,y:39,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},9:{frame:{x:1,y:58,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},a:{frame:{x:37,y:58,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},b:{frame:{x:73,y:58,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},c:{frame:{x:1,y:77,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},d:{frame:{x:37,y:77,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},e:{frame:{x:73,y:77,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},f:{frame:{x:1,y:96,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},g:{frame:{x:37,y:96,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},h:{frame:{x:73,y:96,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},i:{frame:{x:1,y:115,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},j:{frame:{x:37,y:115,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},k:{frame:{x:73,y:115,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},l:{frame:{x:1,y:134,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},m:{frame:{x:37,y:134,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},n:{frame:{x:73,y:134,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},o:{frame:{x:1,y:153,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},p:{frame:{x:37,y:153,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},q:{frame:{x:73,y:153,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},r_blocked:{frame:{x:1,y:172,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},r_door:{frame:{x:37,y:172,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}},x:{frame:{x:73,y:172,w:34,h:17},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:34,h:17},sourceSize:{w:34,h:17}}},meta:{app:"https://www.codeandweb.com/texturepacker",version:"1.0",image:"tiles.png",format:"RGBA8888",size:{w:108,h:190},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:6d0f8373580629749f786a0b0f6c6bb9:96dff9df69bdc6938cf02f254bbe028b:accbe1e7e294ded8391337fc1c446319$"}};class t_{constructor(t,e){this._height=t,this._isBlocked=e}get height(){return this._height}set height(t){this._height=t}get isBlocked(){return this._isBlocked}set isBlocked(t){this._isBlocked=t}}const PA=(a,t)=>{let e=a*Lo/2-t*Lo/2;const s=a*Lo/4+t*Lo/4;return e=e+1024,[e,s]},Pg=a=>{switch(a=parseInt(a.toString()),a){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},e_=a=>{switch(a){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},gn=class gn{constructor(){const t=Lo*sl+20,e=Lo*sl/2+100,s=document.createElement("canvas");s.height=e,s.width=t,s.style.touchAction="none",this._renderer=s.getContext("2d"),this._image=new Image,this._image.src=RQ,this._tilemap=[],this._doorLocation={x:0,y:0},this._width=0,this._height=0,this._isPointerDown=!1,this._lastUsedTile={x:-1,y:-1},this._actionSettings=new TQ}onPointerRelease(){this._isPointerDown=!1}onPointerDown(t){if(t.button===2)return;const e={x:t.offsetX,y:t.offsetY};this._isPointerDown=!0,this.tileHitDetection(e,!0)}onPointerMove(t){if(!this._isPointerDown)return;const e={x:t.offsetX,y:t.offsetY};this.tileHitDetection(e,!1)}tileHitDetection(t,e=!1){const s=Math.floor(t.x),r=Math.floor(t.y),n=Lo,o=Lo/2;for(let l=0;l<this._tilemap.length;l++)for(let c=0;c<this.tilemap[l].length;c++){const[u,h]=PA(c,l),d=u+n/2,f=h+o/2,E=Math.abs(s-d),m=Math.abs(r-f);if(E/(n*.5)+m/(o*.5)<=1)return this._isPointerDown&&(e?this.onClick(c,l):(this._lastUsedTile.x!==c||this._lastUsedTile.y!==l)&&(this._lastUsedTile.x=c,this._lastUsedTile.y=l,this.onClick(c,l))),!0}return!1}onClick(t,e){const s=this._tilemap[e][t],r=Xu.indexOf(s.height);let n=0;switch(this._actionSettings.currentAction){case Ks.DOOR:s.height!=="x"&&(this._doorLocation.x=t,this._doorLocation.y=e,this.renderTiles());return;case Ks.UP:if(s.height==="x")return;n=r+1;break;case Ks.DOWN:if(s.height==="x"||r<=1)return;n=r-1;break;case Ks.SET:n=Xu.indexOf(this._actionSettings.currentHeight);break;case Ks.UNSET:n=0;break}if(n===-1||r===n)return;n>0&&(t+1>this._width&&(this._width=t+1),e+1>this._height&&(this._height=e+1));const o=Xu[n];o&&(s.isBlocked||(this._tilemap[e][t].height=o,this.renderTiles()))}renderTiles(){this.clearCanvas();for(let t=0;t<this._tilemap.length;t++)for(let e=0;e<this.tilemap[t].length;e++){const s=this.tilemap[t][e];let r=s.height;this._doorLocation.x===e&&this._doorLocation.y===t&&(r=gn.TILE_DOOR),s.isBlocked&&(r=gn.TILE_BLOCKED);const[n,o]=PA(e,t),l=SQ.frames[r];this.renderer.drawImage(this._image,l.frame.x,l.frame.y,l.frame.w,l.frame.h,n,o,l.frame.w,l.frame.h)}}setTilemap(t,e){this._tilemap=[];const s=t.split("\r");let r=0,n=s.length;for(let o=0;o<n;o++){const l=s[o];if(l.length===0){s.splice(o,1),n=s.length,o--;continue}l.length>r&&(r=l.length)}for(let o=0;o<n;o++){this._tilemap[o]=[];const l=s[o];for(let c=0;c<r;c++){const u=e[o]&&e[o][c]||!1,h=l[c];h!=="x"&&h!=="X"&&h?this._tilemap[o][c]=new t_(h,u):this._tilemap[o][c]=new t_("x",u)}for(let c=r;c<sl;c++)this.tilemap[o][c]=new t_("x",!1)}for(let o=n;o<sl;o++){this.tilemap[o]||(this.tilemap[o]=[]);for(let l=0;l<sl;l++)this.tilemap[o][l]=new t_("x",!1)}this._width=r,this._height=n}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let s=sl-1;s>=0;s--)if(this._tilemap[s])for(let r=sl-1;r>=0;r--){if(!this._tilemap[s][r])continue;this._tilemap[s][r].height!=="x"&&(r+1>this._width&&(this._width=r+1),s+1>this._height&&(this._height=s+1))}}const e=[];for(let s=0;s<this._height;s++){const r=[];for(let n=0;n<this._width;n++){const o=this._tilemap[s][n];r[n]=o.height}e[s]=r.join("")}return e.join("\r")}clear(){this._tilemap=[],this._doorLocation={x:-1,y:-1},this._width=0,this._height=0,this._isPointerDown=!1,this._lastUsedTile={x:-1,y:-1},this._actionSettings.clear(),this.clearCanvas()}clearCanvas(){this.renderer.fillStyle="0x000000",this.renderer.fillRect(0,0,this._renderer.canvas.width,this._renderer.canvas.height)}get renderer(){return this._renderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(t){this._doorLocation=t}get actionSettings(){return this._actionSettings}static get instance(){return gn._INSTANCE||(gn._INSTANCE=new gn),gn._INSTANCE}};gn._INSTANCE=null,gn.TILE_BLOCKED="r_blocked",gn.TILE_DOOR="r_door";let Zs=gn;const OQ=a=>{const{gap:t=1,children:e=null,...s}=a,[r,n]=_.useState(!1),[o,l]=_.useState(!1),{originalFloorplanSettings:c=null,setOriginalFloorplanSettings:u=null,setVisualizationSettings:h=null}=zS(),d=_.useRef(null);z(uM,I=>{const p=I.getParser();u(T=>{const R={...T};return R.reservedTiles=p.blockedTilesMap,Zs.instance.setTilemap(R.tilemap,R.reservedTiles),R}),n(!0),d.current.scrollTo(Zs.instance.renderer.canvas.width/3,0)}),z(Z_,I=>{const p=I.getParser();u(T=>{const R={...T};return R.entryPoint=[p.x,p.y],R.entryPointDir=p.direction,R}),h(T=>{const R={...T};return R.entryPointDir=p.direction,R}),Zs.instance.doorLocation={x:p.x,y:p.y},l(!0)});const f=I=>{const p=d.current;if(p)switch(I){case"up":p.scrollBy({top:-10});break;case"down":p.scrollBy({top:10});break;case"left":p.scrollBy({left:-10});break;case"right":p.scrollBy({left:10});break}},E=I=>{switch(I.preventDefault(),I.type){case"pointerout":case"pointerup":Zs.instance.onPointerRelease();break;case"pointerdown":Zs.instance.onPointerDown(I);break;case"pointermove":Zs.instance.onPointerMove(I);break}};_.useEffect(()=>()=>{Zs.instance.clear(),h(I=>({wallHeight:c.wallHeight,thicknessWall:c.thicknessWall,thicknessFloor:c.thicknessFloor,entryPointDir:I.entryPointDir}))},[c.thicknessFloor,c.thicknessWall,c.wallHeight,h]),_.useEffect(()=>{!o||!r||Zs.instance.renderTiles()},[o,r]),_.useEffect(()=>{H(new NP),H(new AP);const I=d.current;if(I)return I.appendChild(Zs.instance.renderer.canvas),I.addEventListener("pointerup",E),I.addEventListener("pointerout",E),I.addEventListener("pointerdown",E),I.addEventListener("pointermove",E),()=>{I&&(I.removeEventListener("pointerup",E),I.removeEventListener("pointerout",E),I.removeEventListener("pointerdown",E),I.removeEventListener("pointermove",E))}},[]);const m=()=>window.innerWidth<768;return i.jsxs(N,{gap:t,...s,children:[i.jsxs(pt,{overflow:"hidden",gap:1,children:[i.jsx(N,{center:!0,size:1,className:"d-md-none",children:i.jsx(W,{className:"d-md-none",onClick:I=>f("left"),children:i.jsx(UN,{className:"fa-icon"})})}),i.jsxs(N,{overflow:"hidden",size:m()?10:12,gap:1,children:[i.jsx(x,{justifyContent:"center",className:"d-md-none",children:i.jsx(W,{shrink:!0,onClick:I=>f("up"),children:i.jsx(M0,{className:"fa-icon"})})}),i.jsx(V,{overflow:"auto",innerRef:d}),i.jsx(x,{justifyContent:"center",className:"d-md-none",children:i.jsx(W,{shrink:!0,onClick:I=>f("down"),children:i.jsx(b0,{className:"fa-icon"})})})]}),i.jsx(N,{center:!0,size:1,className:"d-md-none",children:i.jsx(W,{className:"d-md-none",onClick:I=>f("right"),children:i.jsx(jN,{className:"fa-icon"})})})]}),e]})},LA=a=>a.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),AQ=a=>{const{onCloseClick:t=null}=a,[e,s]=_.useState(""),{originalFloorplanSettings:r=null}=zS(),n=()=>{H(new _S(e.split(`
`).join("\r"),r.entryPoint[0],r.entryPoint[1],r.entryPointDir,Pg(r.thicknessWall),Pg(r.thicknessFloor),r.wallHeight-1))};return wS(()=>{s(LA(r.tilemap))}),i.jsxs(Ct,{theme:"primary-slim",className:"floorplan-import-export",children:[i.jsx(Nt,{headerText:g("floor.plan.editor.import.export"),onCloseClick:t}),i.jsxs(It,{children:[i.jsx("textarea",{className:"h-100",value:e,onChange:o=>s(o.target.value)}),i.jsxs(x,{justifyContent:"between",children:[i.jsx(W,{onClick:o=>s(LA(r.tilemap)),children:g("floor.plan.editor.revert.to.last.received.map")}),i.jsx(W,{onClick:n,children:g("floor.plan.editor.save")})]})]})]})},UA=0,s_=16,NQ=0,CQ=26,xQ=a=>{const{visualizationSettings:t=null,setVisualizationSettings:e=null}=zS(),[s,r]=_.useState(Ks.SET),[n,o]=_.useState(0),l=I=>{r(I),Zs.instance.actionSettings.currentAction=I},c=()=>{e(I=>{const p={...I};return p.entryPointDir<7?++p.entryPointDir:p.entryPointDir=0,p})},u=I=>{(isNaN(I)||I<=0)&&(I=0),I>26&&(I=26),o(I),Zs.instance.actionSettings.currentHeight=I.toString(36)},h=I=>{e(p=>{const T={...p};return T.thicknessFloor=I,T})},d=I=>{e(p=>{const T={...p};return T.thicknessWall=I,T})},f=I=>{(isNaN(I)||I<=0)&&(I=UA),I>s_&&(I=s_),e(p=>{const T={...p};return T.wallHeight=I,T})},E=()=>{let I=t.wallHeight+1;I>s_&&(I=s_),f(I)},m=()=>{let I=t.wallHeight-1;I<=0&&(I=UA),f(I)};return i.jsxs(N,{children:[i.jsxs(x,{gap:1,children:[i.jsxs(N,{size:5,gap:1,children:[i.jsx(O,{bold:!0,children:g("floor.plan.editor.draw.mode")}),i.jsxs(x,{gap:3,children:[i.jsxs(x,{gap:1,children:[i.jsx($t,{itemActive:s===Ks.SET,onClick:I=>l(Ks.SET),children:i.jsx("i",{className:"icon icon-set-tile"})}),i.jsx($t,{itemActive:s===Ks.UNSET,onClick:I=>l(Ks.UNSET),children:i.jsx("i",{className:"icon icon-unset-tile"})})]}),i.jsxs(x,{gap:1,children:[i.jsx($t,{itemActive:s===Ks.UP,onClick:I=>l(Ks.UP),children:i.jsx("i",{className:"icon icon-increase-height"})}),i.jsx($t,{itemActive:s===Ks.DOWN,onClick:I=>l(Ks.DOWN),children:i.jsx("i",{className:"icon icon-decrease-height"})})]}),i.jsx($t,{itemActive:s===Ks.DOOR,onClick:I=>l(Ks.DOOR),children:i.jsx("i",{className:"icon icon-set-door"})})]})]}),i.jsxs(N,{alignItems:"center",size:4,children:[i.jsx(O,{bold:!0,children:g("floor.plan.editor.enter.direction")}),i.jsx("i",{className:`icon icon-door-direction-${t.entryPointDir} cursor-pointer`,onClick:c})]}),i.jsxs(N,{size:3,children:[i.jsx(O,{bold:!0,children:g("floor.editor.wall.height")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(dR,{className:"cursor-pointer fa-icon",onClick:m}),i.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",value:t.wallHeight,onChange:I=>f(I.target.valueAsNumber)}),i.jsx(_R,{className:"cursor-pointer fa-icon",onClick:E})]})]})]}),i.jsxs(x,{gap:1,children:[i.jsxs(N,{size:6,children:[i.jsxs(O,{bold:!0,children:[g("floor.plan.editor.tile.height"),": ",n]}),i.jsx(Xs,{className:"nitro-slider",min:NQ,max:CQ,step:1,value:n,onChange:I=>u(I),renderThumb:({style:I,...p},T)=>i.jsx("div",{style:{backgroundColor:`#${IQ[T.valueNow.toString(33)]}`,...I},...p,children:T.valueNow})})]}),i.jsxs(N,{size:6,children:[i.jsx(O,{bold:!0,children:g("floor.plan.editor.room.options")}),i.jsxs(x,{className:"align-items-center",children:[i.jsxs("select",{className:"form-control form-control-sm",value:t.thicknessWall,onChange:I=>d(parseInt(I.target.value)),children:[i.jsx("option",{value:0,children:g("navigator.roomsettings.wall_thickness.thinnest")}),i.jsx("option",{value:1,children:g("navigator.roomsettings.wall_thickness.thin")}),i.jsx("option",{value:2,children:g("navigator.roomsettings.wall_thickness.normal")}),i.jsx("option",{value:3,children:g("navigator.roomsettings.wall_thickness.thick")})]}),i.jsxs("select",{className:"form-control form-control-sm",value:t.thicknessFloor,onChange:I=>h(parseInt(I.target.value)),children:[i.jsx("option",{value:0,children:g("navigator.roomsettings.floor_thickness.thinnest")}),i.jsx("option",{value:1,children:g("navigator.roomsettings.floor_thickness.thin")}),i.jsx("option",{value:2,children:g("navigator.roomsettings.floor_thickness.normal")}),i.jsx("option",{value:3,children:g("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},yQ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(!1),[n,o]=_.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[l,c]=_.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),u=()=>{H(new _S(Zs.instance.getCurrentTilemapString(),Zs.instance.doorLocation.x,Zs.instance.doorLocation.y,l.entryPointDir,Pg(l.thicknessWall),Pg(l.thicknessFloor),l.wallHeight-1))},h=()=>{c({wallHeight:n.wallHeight,thicknessWall:n.thicknessWall,thicknessFloor:n.thicknessFloor,entryPointDir:n.entryPointDir}),Zs.instance.doorLocation={x:n.entryPoint[0],y:n.entryPoint[1]},Zs.instance.setTilemap(n.tilemap,n.reservedTiles),Zs.instance.renderTiles()};return ft(Ne.DISPOSED,d=>e(!1)),z(J_,d=>{const f=d.getParser();o(E=>{const m={...E};return m.tilemap=f.model,m.wallHeight=f.wallHeight+1,m}),c(E=>{const m={...E};return m.wallHeight=f.wallHeight+1,m})}),z($_,d=>{const f=d.getParser();o(E=>{const m={...E};return m.thicknessFloor=e_(f.thicknessFloor),m.thicknessWall=e_(f.thicknessWall),m}),c(E=>{const m={...E};return m.thicknessFloor=e_(f.thicknessFloor),m.thicknessWall=e_(f.thicknessWall),m})}),_.useEffect(()=>{const d={linkReceived:f=>{const E=f.split("/");if(!(E.length<2))switch(E[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(m=>!m);return}},eventUrlPrefix:"floor-editor/"};return As(d),()=>Ns(d)},[]),i.jsxs(pQ,{value:{originalFloorplanSettings:n,setOriginalFloorplanSettings:o,visualizationSettings:l,setVisualizationSettings:c},children:[t&&i.jsxs(Ct,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("floor.plan.editor.title"),onCloseClick:()=>e(!1)}),i.jsxs(It,{overflow:"hidden",children:[i.jsx(xQ,{}),i.jsx(OQ,{overflow:"hidden"}),i.jsxs(x,{justifyContent:"between",children:[i.jsx(W,{onClick:h,children:g("floor.plan.editor.reload")}),i.jsxs(ua,{children:[i.jsx(W,{disabled:!0,children:g("floor.plan.editor.preview")}),i.jsx(W,{onClick:d=>r(!0),children:g("floor.plan.editor.import.export")}),i.jsx(W,{onClick:u,children:g("floor.plan.editor.save")})]})]})]})]}),s&&i.jsx(AQ,{onCloseClick:()=>r(!1)})]})},MQ=a=>{const{friend:t=null}=a,[e,s]=_.useState(!1),{followFriend:r=null}=gr(),n=_.useRef();return _.useEffect(()=>{const o=l=>{const c=n.current;c&&l.target!==c&&!c.contains(l.target)&&s(!1)};return document.addEventListener(lt.MOUSE_CLICK,o),()=>document.removeEventListener(lt.MOUSE_CLICK,o)},[]),t?i.jsxs("div",{ref:n,className:"btn btn-friendsgensuccess friend-bar-item "+(e?"friend-bar-item-active":""),onClick:o=>s(l=>!l),children:[i.jsxs("div",{className:`friend-bar-item-head position-absolute ${t.id>0?"avatar":"group"}`,children:[t.id>0&&i.jsx(os,{headOnly:!e,figure:t.figure,direction:e?2:3}),i.jsx(os,{headOnly:!e,figure:t.id>0?t.figure:t.id<=0&&t.figure==="ADM"?"ha-3409-1413-70.lg-285-89.ch-3032-1334-109.sh-3016-110.hd-185-1359.ca-3225-110-62.wa-3264-62-62.fa-1206-90.hr-3322-1403":t.figure,isgroup:t.id<=0?1:0,direction:e?2:3})]}),i.jsx("div",{className:"text-truncate",children:t.name}),e&&i.jsxs("div",{className:"d-flex justify-content-between",children:[i.jsx(V,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:o=>Qm(t.id)}),t.followingAllowed&&i.jsx(V,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:o=>r(t)}),i.jsx(V,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:o=>Ki(t.id)})]})]}):i.jsxs("div",{ref:n,className:"btn btn-friendsgen friend-bar-item friend-bar-search "+(e?"friend-bar-search-item-active":""),onClick:o=>s(l=>!l),children:[i.jsx("div",{className:"friend-bar-item-head position-absolute"}),i.jsx("div",{className:"friend-bar-text",children:g("friend.bar.find.title")}),e&&i.jsxs("div",{className:"search-content mt-3",children:[i.jsx("div",{className:"bg-white text-black px-1 py-1 font-size-friend",children:g("friend.bar.find.text")}),i.jsx(W,{className:"mt-2 mb-4",variant:"white",onClick:()=>H(new Pb),children:g("friend.bar.find.button")})]})]})},yE=3,bQ=a=>{const{onlineFriends:t=null}=a,[e,s]=_.useState(0),r=_.useRef();return i.jsxs(x,{innerRef:r,alignItems:"center",className:"friend-bar",children:[i.jsx(W,{variant:"black",className:"friend-bar-button",disabled:e<=0,onClick:n=>s(e-1),children:i.jsx(lr,{className:"fa-icon"})}),Array.from(Array(yE),(n,o)=>i.jsx(MQ,{friend:t[e+o]||null},o)),i.jsx(W,{variant:"black",className:"friend-bar-button",disabled:!(t.length>yE&&e+yE<=t.length-1),onClick:n=>s(e+1),children:i.jsx(cr,{className:"fa-icon"})})]})},DQ=a=>{const{friend:t=null,selected:e=!1,selectFriend:s=null}=a,[r,n]=_.useState(!1),{followFriend:o=null,updateRelationship:l=null}=gr(),c=E=>{E.stopPropagation(),o(t)},u=E=>{E.stopPropagation(),Qm(t.id)},h=E=>{E.stopPropagation(),n(!0)},d=(E,m)=>{E.stopPropagation(),l(t,m),n(!1)},f=()=>{if(!t)return"none";switch(t.relationshipStatus){case Wi.RELATIONSHIP_HEART:return"heart";case Wi.RELATIONSHIP_SMILE:return"smile";case Wi.RELATIONSHIP_BOBBA:return"bobba";default:return"none"}};return t?i.jsxs(Dg,{justifyContent:"between",className:`px-2 py-1 ${e&&"bg-primary text-white"}`,onClick:E=>s(t.id),children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(V,{onClick:E=>E.stopPropagation(),children:i.jsx(br,{userId:t.id})}),i.jsx("div",{children:t.name})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[!r&&i.jsxs(i.Fragment,{children:[t.followingAllowed&&i.jsx(V,{pointer:!0,onClick:c,className:"nitro-friends-spritesheet icon-follow",title:g("friendlist.tip.follow")}),t.online&&i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-chat",onClick:u,title:g("friendlist.tip.im")}),t.id>0&&i.jsx(V,{className:`nitro-friends-spritesheet icon-${f()} cursor-pointer`,onClick:h,title:g("infostand.link.relationship")})]}),r&&i.jsxs(i.Fragment,{children:[i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:E=>d(E,Wi.RELATIONSHIP_HEART)}),i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:E=>d(E,Wi.RELATIONSHIP_SMILE)}),i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:E=>d(E,Wi.RELATIONSHIP_BOBBA)}),i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:E=>d(E,Wi.RELATIONSHIP_NONE)})]})]})]}):null},jA=a=>{const{list:t=null,selectedFriendsIds:e=null,selectFriend:s=null}=a;return!t||!t.length?null:i.jsx(i.Fragment,{children:t.map((r,n)=>i.jsx(DQ,{friend:r,selected:e&&e.indexOf(r.id)>=0,selectFriend:s},n))})},vQ=a=>{const{request:t=null}=a,{requestResponse:e=null}=gr();return t?i.jsxs(Dg,{justifyContent:"between",className:"px-2 py-1",children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:t.id}),i.jsx("div",{children:t.name})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(V,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:s=>e(t.id,!0)}),i.jsx(V,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:s=>e(t.id,!1)})]})]}):null},PQ=a=>{const{children:t=null,...e}=a,{requests:s=[],requestResponse:r=null}=gr();return s.length?i.jsxs(vg,{...e,children:[i.jsxs(N,{fullHeight:!0,justifyContent:"between",gap:1,children:[i.jsx(N,{gap:0,children:s.map((n,o)=>i.jsx(vQ,{request:n},o))}),i.jsx(x,{justifyContent:"center",className:"px-2 py-1",children:i.jsx(W,{onClick:n=>r(-1,!1),children:g("friendlist.requests.dismissall")})})]}),t]}):null},LQ=a=>{const{selectedFriendsIds:t=null,removeFriendsText:e=null,removeSelectedFriends:s=null,onCloseClick:r=null}=a;return i.jsxs(Ct,{className:"nitro-friends-remove-confirmation",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("friendlist.removefriendconfirm.title"),onCloseClick:r}),i.jsxs(It,{className:"text-black",children:[i.jsx("div",{children:e}),i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"danger",disabled:t.length===0,onClick:s,children:g("generic.ok")}),i.jsx(W,{fullWidth:!0,onClick:r,children:g("generic.cancel")})]})]})]})},UQ=a=>{const{selectedFriendsIds:t=null,onCloseClick:e=null,sendRoomInvite:s=null}=a,[r,n]=_.useState("");return i.jsxs(Ct,{className:"nitro-friends-room-invite",uniqueKey:"nitro-friends-room-invite",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("friendlist.invite.title"),onCloseClick:e}),i.jsxs(It,{className:"text-black",children:[g("friendlist.invite.summary",["count"],[t.length.toString()]),i.jsx("textarea",{className:"form-control",value:r,maxLength:255,onChange:o=>n(o.target.value)}),i.jsx(O,{center:!0,className:"bg-muted rounded p-1",children:g("friendlist.invite.note")}),i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"success",disabled:r.length===0||t.length===0,onClick:()=>s(r),children:g("friendlist.invite.send")}),i.jsx(W,{fullWidth:!0,onClick:e,children:g("generic.cancel")})]})]})]})},jQ=a=>{const{...t}=a,[e,s]=_.useState(""),[r,n]=_.useState(null),[o,l]=_.useState(null),{canRequestFriend:c=null,requestFriend:u=null}=gr();return z(HC,h=>{const d=h.getParser();n(d.friends),l(d.others)}),_.useEffect(()=>{if(!e||!e.length)return;const h=setTimeout(()=>{!e||!e.length||H(new jb(e))},500);return()=>clearTimeout(h)},[e]),i.jsxs(vg,{...t,children:[i.jsx("input",{type:"text",className:"search-input form-control form-control-sm w-100 rounded-0",placeholder:g("generic.search"),value:e,maxLength:50,onChange:h=>s(h.target.value)}),i.jsxs(N,{children:[r&&i.jsxs(i.Fragment,{children:[r.length===0&&i.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:g("friendlist.search.nofriendsfound")}),r.length>0&&i.jsxs(N,{gap:0,children:[i.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:g("friendlist.search.friendscaption",["cnt"],[r.length.toString()])}),i.jsx("hr",{className:"mx-2 mt-0 mb-1 text-black"}),i.jsx(N,{gap:0,children:r.map(h=>i.jsxs(Dg,{justifyContent:"between",className:"px-2 py-1",children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:h.avatarId}),i.jsx("div",{children:h.avatarName})]}),i.jsx(x,{alignItems:"center",gap:1,children:h.isAvatarOnline&&i.jsx(V,{className:"nitro-friends-spritesheet icon-chat cursor-pointer",onClick:d=>Qm(h.avatarId),title:g("friendlist.tip.im")})})]},h.avatarId))})]})]}),o&&i.jsxs(i.Fragment,{children:[o.length===0&&i.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:g("friendlist.search.noothersfound")}),o.length>0&&i.jsxs(N,{gap:0,children:[i.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:g("friendlist.search.otherscaption",["cnt"],[o.length.toString()])}),i.jsx("hr",{className:"mx-2 mt-0 mb-1 text-black"}),i.jsx(N,{gap:0,children:o.map(h=>i.jsxs(Dg,{justifyContent:"between",className:"px-2 py-1",children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:h.avatarId}),i.jsx("div",{children:h.avatarName})]}),i.jsx(x,{alignItems:"center",gap:1,children:c(h.avatarId)&&i.jsx(V,{className:"nitro-friends-spritesheet icon-add cursor-pointer",onClick:d=>u(h.avatarId,h.avatarName),title:g("friendlist.tip.addfriend")})})]},h.avatarId))})]})]})]})]})},wQ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState([]),[n,o]=_.useState(!1),[l,c]=_.useState(!1),{onlineFriends:u=[],offlineFriends:h=[],requests:d=[],requestFriend:f=null}=gr(),E=_.useMemo(()=>{if(!s||!s.length)return"";const T=[];for(const R of s){let S=u.find(L=>L.id===R);S||(S=h.find(L=>L.id===R)),S&&T.push(S.name)}return g("friendlist.removefriendconfirm.userlist",["user_names"],[T.join(", ")])},[h,u,s]),m=_.useCallback(T=>{T<0||r(R=>{const S=[...R],L=S.indexOf(T);return L>-1?S.splice(L,1):S.push(T),S})},[r]),I=T=>{!s.length||!T||!T.length||T.length>255||(H(new kb(T,s)),o(!1))},p=()=>{s.length!==0&&(r(T=>(H(new Fb(...T)),[])),c(!1))};return _.useEffect(()=>{const T={linkReceived:R=>{const S=R.split("/");if(!(S.length<2))switch(S[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(L=>!L);return;case"request":if(S.length<4)return;f(parseInt(S[2]),S[3])}},eventUrlPrefix:"friends/"};return As(T),()=>Ns(T)},[f]),t?i.jsxs(i.Fragment,{children:[i.jsxs(Ct,{className:"nitro-friends",uniqueKey:"nitro-friends",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("friendlist.friends"),onCloseClick:T=>e(!1)}),i.jsxs(It,{overflow:"hidden",gap:1,className:"text-black p-0",children:[i.jsxs($8,{fullHeight:!0,overflow:"hidden",children:[i.jsx(vg,{headerText:g("friendlist.friends")+` (${u.length})`,isExpanded:!0,children:i.jsx(jA,{list:u,selectedFriendsIds:s,selectFriend:m})}),i.jsx(vg,{headerText:g("friendlist.friends.offlinecaption")+` (${h.length})`,children:i.jsx(jA,{list:h,selectedFriendsIds:s,selectFriend:m})}),i.jsx(PQ,{headerText:g("friendlist.tab.friendrequests")+` (${d.length})`,isExpanded:!0}),i.jsx(jQ,{headerText:g("people.search.title")})]}),s&&s.length>0&&i.jsxs(x,{gap:1,className:"p-1",children:[i.jsx(W,{fullWidth:!0,onClick:()=>o(!0),children:g("friendlist.tip.invite")}),i.jsx(W,{fullWidth:!0,variant:"danger",onClick:T=>c(!0),children:g("generic.delete")})]})]})]}),n&&i.jsx(UQ,{selectedFriendsIds:s,onCloseClick:()=>o(!1),sendRoomInvite:I}),l&&i.jsx(LQ,{selectedFriendsIds:s,removeFriendsText:E,onCloseClick:()=>c(!1),removeSelectedFriends:p})]}):null},FQ=a=>{const{thread:t=null,group:e=null}=a,s=_.useMemo(()=>e.type===jl.GROUP_CHAT&&rU(e.chats[0].extraData),[e]),r=_.useMemo(()=>!t||!e?!1:!!(e.type===jl.PRIVATE_CHAT&&e.userId===tt().userId||s&&e.chats.length&&s.userId===tt().userId),[t,e,s]);return!t||!e?null:e.userId?i.jsxs(x,{fullWidth:!0,justifyContent:r?"end":"start",gap:2,children:[i.jsxs(V,{shrink:!0,className:"message-avatar",children:[e.type===jl.PRIVATE_CHAT&&!r&&i.jsx(os,{figure:t.participant.figure,direction:2}),s&&!r&&i.jsx(os,{figure:s.figure,direction:2})]}),i.jsxs(V,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(r?"right":"left"),children:[i.jsxs(V,{className:"fw-bold",children:[r&&tt().userName,!r&&(s?s.username:t.participant.name)]}),e.chats.map((n,o)=>i.jsx(V,{className:"text-break",children:n.message},o))]}),r&&i.jsx(V,{shrink:!0,className:"message-avatar",children:i.jsx(os,{figure:tt().figure,direction:4})})]}):i.jsx(i.Fragment,{children:e.chats.map((n,o)=>i.jsx(x,{fullWidth:!0,gap:2,justifyContent:"start",children:i.jsxs(V,{className:"w-100 text-break",children:[n.type===Qa.SECURITY_NOTIFICATION&&i.jsxs(x,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-muted",children:[i.jsx(V,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0"}),i.jsx(V,{children:n.message})]}),n.type===Qa.ROOM_INVITE&&i.jsxs(x,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-black",children:[i.jsx(V,{className:"messenger-notification-icon flex-shrink-0"}),i.jsxs(V,{children:[g("messenger.invitation")+" ",n.message]})]})]})},o))})},GQ=a=>{const{thread:t=null}=a;return t.setRead(),i.jsx(i.Fragment,{children:t.groups.length>0&&t.groups.map((e,s)=>i.jsx(FQ,{thread:t,group:e},s))})},kQ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(-1),[n,o]=_.useState(""),{visibleThreads:l=[],activeThread:c=null,getMessageThread:u=null,sendMessage:h=null,setActiveThreadId:d=null,closeThread:f=null}=IU(),{report:E=null}=en(),m=_.useRef(),I=()=>c&&c.participant&&H(new Ym(c.participant.id)),p=()=>c&&c.participant&&Ki(c.participant.id),T=()=>{!c||!n.length||(h(c,tt().userId,n),o(""))},R=S=>{S.key==="Enter"&&T()};return _.useEffect(()=>{const S={linkReceived:L=>{const M=L.split("/");if(M.length===2){if(M[1]==="open"){e(!0);return}if(M[1]==="toggle"){e(k=>!k);return}const P=u(parseInt(M[1]));if(!P)return;d(P.threadId),e(!0)}},eventUrlPrefix:"friends-messenger/"};return As(S),()=>Ns(S)},[u,d]),_.useEffect(()=>{!t||!c||(m.current.scrollTop=m.current.scrollHeight)},[t,c]),_.useEffect(()=>{if(t&&!c){s>0?d(s):l.length>0&&d(l[0].threadId);return}!t&&c&&(r(c.threadId),d(-1))},[t,c,s,l,d]),t?i.jsxs(Ct,{className:"nitro-friends-messenger",uniqueKey:"nitro-friends-messenger",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("messenger.window.title",["OPEN_CHAT_COUNT"],[l.length.toString()]),onCloseClick:S=>e(!1)}),i.jsx(It,{children:i.jsxs(pt,{overflow:"hidden",children:[i.jsxs(N,{size:4,overflow:"hidden",children:[i.jsx(O,{bold:!0,children:g("toolbar.icon.label.messenger")}),i.jsx(N,{fit:!0,overflow:"auto",children:i.jsx(N,{children:l&&l.length>0&&l.map(S=>i.jsxs($t,{itemActive:c===S,onClick:L=>d(S.threadId),children:[S.unread&&i.jsx(ko,{count:S.unreadCount}),i.jsxs(x,{fullWidth:!0,alignItems:"center",gap:1,children:[i.jsx(x,{alignItems:"center",className:"friend-head px-2",children:i.jsx(os,{figure:S.participant.id>0?S.participant.figure:S.participant.id<=0&&S.participant.figure==="ADM"?"ha-3409-1413-70.lg-285-89.ch-3032-1334-109.sh-3016-110.hd-185-1359.ca-3225-110-62.wa-3264-62-62.fa-1206-90.hr-3322-1403":S.participant.figure,headOnly:!0,direction:S.participant.id>0?2:3})}),i.jsx(O,{truncate:!0,grow:!0,children:S.participant.name})]})]},S.threadId))})})]}),i.jsx(N,{size:8,overflow:"hidden",children:c&&i.jsxs(i.Fragment,{children:[i.jsx(O,{bold:!0,center:!0,children:g("messenger.window.separator",["FRIEND_NAME"],[c.participant.name])}),i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[c&&c.participant.id>0&&i.jsxs(x,{gap:1,children:[i.jsxs(ua,{children:[i.jsx(W,{onClick:I,children:i.jsx(V,{className:"nitro-friends-spritesheet icon-follow"})}),i.jsx(W,{onClick:p,children:i.jsx(V,{className:"nitro-friends-spritesheet icon-profile-sm"})})]}),i.jsx(W,{variant:"danger",onClick:()=>E(ns.IM,{reportedUserId:c.participant.id}),children:g("messenger.window.button.report")})]}),i.jsx(W,{onClick:S=>f(c.threadId),children:i.jsx(Dr,{className:"fa-icon"})})]}),i.jsx(N,{fit:!0,className:"bg-muted p-2 rounded chat-messages",children:i.jsx(N,{innerRef:m,overflow:"auto",children:i.jsx(GQ,{thread:c})})}),i.jsxs(x,{gap:1,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:255,placeholder:g("messenger.window.input.default",["FRIEND_NAME"],[c.participant.name]),value:n,onChange:S=>o(S.target.value),onKeyDown:R}),i.jsx(W,{variant:"success",onClick:T,children:g("widgets.chatinput.say")})]})]})})]})})]}):null},BQ=a=>{const{settings:t=null,onlineFriends:e=[]}=gr();return t?i.jsxs(i.Fragment,{children:[cR.createPortal(i.jsx(bQ,{onlineFriends:e}),document.getElementById("toolbar-friend-bar-container")),i.jsx(wQ,{}),i.jsx(kQ,{})]}):null},VQ=()=>{const{games:a,selectedGame:t,setSelectedGame:e}=$m(),s=n=>{let o=["game-icon"];return t===n&&o.push("selected"),o.join(" ")},r=n=>`url(${n.assetUrl}${n.gameNameId}_icon.png)`;return i.jsxs(V,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[g("gamecenter.game_list_title"),i.jsx(x,{gap:3,children:a&&a.map((n,o)=>i.jsx(V,{className:s(n),onClick:l=>e(n),style:{backgroundImage:r(n)}},o))})]})},HQ=()=>{const{gameURL:a,setGameURL:t}=$m(),[e,s]=_.useState(0),r=_.useRef();return _.useEffect(()=>{if(!r||r&&!r.current)return;s(0);let n=document.createElement("iframe");n.src=a,n.classList.add("game-center-stage"),n.classList.add("h-100"),n.onload=()=>{s(o=>o+=1)},r.current.innerHTML="",r.current.appendChild(n)},[r,a]),_.useEffect(()=>{e>1&&(t(null),H(new Bb))},[e,t]),a?i.jsx(V,{innerRef:r,className:"game-center-stage"}):null},WQ=()=>{const{selectedGame:a,accountStatus:t}=$m();_.useEffect(()=>{a&&(H(new Wb(a.gameId)),H(new Vb(a.gameId)))},[a]);const e=()=>zi.uintHexColor(a.bgColor),s=()=>`url(${a.assetUrl}${a.gameNameId}_theme.png)`,r=()=>zi.uintHexColor(a.textColor),n=()=>{H(new zb(a.gameId))};return i.jsxs(x,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:e(),backgroundImage:s(),color:r()},children:[i.jsxs(x,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[i.jsx(O,{bold:!0,children:g(`gamecenter.${a.gameNameId}.description_title`)}),i.jsx("img",{src:a.assetUrl+a.gameNameId+"_logo.png"}),(t.hasUnlimitedGames||t.freeGamesLeft>0)&&i.jsx(i.Fragment,{children:i.jsxs(W,{variant:"light",position:"relative",className:"px-4",onClick:n,children:[g("gamecenter.play_now"),!t.hasUnlimitedGames&&i.jsx(ko,{className:"me-n1 mt-n1",count:t.freeGamesLeft})]})}),i.jsx(O,{bold:!0,className:"w-50",center:!0,children:g(`gamecenter.${a.gameNameId}.description_content`)})]}),i.jsx(V,{className:"w-25"})]})},YQ=()=>{const{isVisible:a,setIsVisible:t,games:e,accountStatus:s}=$m();if(_.useEffect(()=>{const r=()=>{t(o=>!o)},n={linkReceived:o=>{switch(o.split("/")[1]){case"toggle":r();break}},eventUrlPrefix:"games/"};return As(n),()=>Ns(n)},[t]),!(!a||!e||!s))return i.jsxs(x,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[i.jsxs(x,{className:"game-center-main",column:!0,children:[i.jsx(WQ,{}),i.jsx(VQ,{})]}),i.jsx(HQ,{})]})},zQ=[0,1,2,3,4,5,6,7,8],KQ=a=>{const{badgeParts:t=[],setBadgeParts:e=null}=a,[s,r]=_.useState(-1),{groupCustomize:n=null}=wd(),o=(l,c,u)=>{const h=[...t];h[l][c]=u,e(h),c==="key"&&r(-1)};return!t||!t.length?null:i.jsxs(i.Fragment,{children:[s<0&&t&&t.length>0&&t.map((l,c)=>i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[i.jsxs(x,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>r(c),children:[t[c].code&&t[c].code.length>0&&i.jsx(Xe,{badgeCode:t[c].code,isGroup:!0}),(!t[c].code||!t[c].code.length)&&i.jsx(x,{center:!0,className:"badge-image group-badge",children:i.jsx(Cd,{className:"fa-icon"})})]}),l.type!==Ni.BASE&&i.jsx(pt,{gap:1,columnCount:3,children:zQ.map((u,h)=>i.jsx(V,{pointer:!0,className:`group-badge-position-swatch ${t[c].position===u?"active":""}`,onClick:d=>o(c,"position",u)},h))}),i.jsx(pt,{gap:1,columnCount:8,children:n.badgePartColors.length>0&&n.badgePartColors.map((u,h)=>i.jsx(V,{pointer:!0,className:`group-badge-color-swatch ${t[c].color===h+1?"active":""}`,style:{backgroundColor:"#"+u.color},onClick:d=>o(c,"color",h+1)},h))})]},c)),s>=0&&i.jsxs(pt,{gap:1,columnCount:5,children:[t[s].type===Ni.SYMBOL&&i.jsx(N,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:l=>o(s,"key",0),children:i.jsx(x,{center:!0,className:"badge-image group-badge",children:i.jsx(Dr,{className:"fa-icon"})})}),(t[s].type===Ni.BASE?n.badgeBases:n.badgeSymbols).map((l,c)=>i.jsx(N,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>o(s,"key",l.id),children:i.jsx(Xe,{badgeCode:Ni.getCode(t[s].type,l.id,t[s].color,4),isGroup:!0})},c))]})]})},zU=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null,skipDefault:r=null}=a,[n,o]=_.useState(null),{groupCustomize:l=null}=wd(),c=()=>{if(!n||!n.length)return"";let h="";return n.forEach(d=>d.code&&(h+=d.code)),h},u=_.useCallback(()=>{if(!t||!n||!n.length)return!1;if(t.groupBadgeParts===n)return!0;if(t.groupId<=0)return e(d=>{const f={...d};return f.groupBadgeParts=n,f}),!0;const h=[];return n.forEach(d=>{d.code&&(h.push(d.key),h.push(d.color),h.push(d.position))}),H(new rD(t.groupId,h)),!0},[t,n,e]);return _.useEffect(()=>{if(t.groupBadgeParts)return;const h=[new Ni(Ni.BASE,l.badgeBases[0].id,l.badgePartColors[0].id),new Ni(Ni.SYMBOL,0,l.badgePartColors[0].id),new Ni(Ni.SYMBOL,0,l.badgePartColors[0].id),new Ni(Ni.SYMBOL,0,l.badgePartColors[0].id),new Ni(Ni.SYMBOL,0,l.badgePartColors[0].id)];e(d=>({...d,groupBadgeParts:h}))},[t.groupBadgeParts,l,e]),_.useEffect(()=>{if(t.groupId<=0){o(t.groupBadgeParts?[...t.groupBadgeParts]:null);return}o(t.groupBadgeParts)},[t]),_.useEffect(()=>(s({action:u}),()=>s(null)),[s,u]),i.jsxs(pt,{overflow:"hidden",gap:1,children:[i.jsx(N,{size:2,children:i.jsx(x,{center:!0,className:"bg-muted rounded p-1",children:i.jsx(Xe,{badgeCode:c(),isGroup:!0})})}),i.jsx(N,{size:10,overflow:"auto",children:i.jsx(KQ,{badgeParts:n,setBadgeParts:o})})]})},KU=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null}=a,[r,n]=_.useState(null),{groupCustomize:o=null}=wd(),l=h=>h===0?o.groupColorsA.find(d=>d.id===r[h]).color:o.groupColorsB.find(d=>d.id===r[h]).color,c=(h,d)=>{n(f=>{const E=[...f];return E[h]=d,E})},u=_.useCallback(()=>!t||!r||!r.length?!1:t.groupColors===r?!0:t.groupId<=0?(e(h=>{const d={...h};return d.groupColors=[...r],d}),!0):(H(new nD(t.groupId,r[0],r[1])),!0),[t,r,e]);return _.useEffect(()=>{if(!o.groupColorsA||!o.groupColorsB||t.groupColors)return;const h=[o.groupColorsA[0].id,o.groupColorsB[0].id];e(d=>({...d,groupColors:h}))},[o,t.groupColors,e]),_.useEffect(()=>{if(t.groupId<=0){n(t.groupColors?[...t.groupColors]:null);return}n(t.groupColors)},[t]),_.useEffect(()=>(s({action:u}),()=>s(null)),[s,u]),r?i.jsxs(pt,{overflow:"hidden",children:[i.jsxs(N,{size:2,gap:1,children:[i.jsx(O,{bold:!0,children:g("group.edit.color.guild.color")}),t.groupColors&&t.groupColors.length>0&&i.jsxs(x,{overflow:"hidden",className:"rounded border",children:[i.jsx(V,{className:"group-color-swatch",style:{backgroundColor:"#"+l(0)}}),i.jsx(V,{className:"group-color-swatch",style:{backgroundColor:"#"+l(1)}})]})]}),i.jsxs(N,{size:5,gap:1,overflow:"hidden",children:[i.jsx(O,{bold:!0,children:g("group.edit.color.primary.color")}),i.jsx(Fe,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:t.groupColors&&o.groupColorsA&&o.groupColorsA.map((h,d)=>i.jsx("div",{className:fi("group-badge-color-swatch cursor-pointer",t.groupColors[0]===h.id&&"active"),style:{backgroundColor:"#"+h.color},onClick:()=>c(0,h.id)},d))})]}),i.jsxs(N,{size:5,gap:1,overflow:"hidden",children:[i.jsx(O,{bold:!0,children:g("group.edit.color.secondary.color")}),i.jsx(Fe,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:t.groupColors&&o.groupColorsB&&o.groupColorsB.map((h,d)=>i.jsx("div",{className:fi("group-badge-color-swatch cursor-pointer",t.groupColors[1]===h.id&&"active"),style:{backgroundColor:"#"+h.color},onClick:()=>c(1,h.id)},d))})]})]}):null},XQ=a=>{const{groupData:t=null,setGroupData:e=null,purchaseCost:s=0}=a,{groupCustomize:r=null}=wd(),n=()=>{if(!t||!t.groupBadgeParts||!t.groupBadgeParts.length)return"";let l="";return t.groupBadgeParts.forEach(c=>c.code&&(l+=c.code)),l},o=l=>l===0?r.groupColorsA.find(c=>c.id===t.groupColors[l]).color:r.groupColorsB.find(c=>c.id===t.groupColors[l]).color;return t?i.jsxs(pt,{overflow:"hidden",gap:1,children:[i.jsxs(N,{size:3,children:[i.jsxs(N,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[i.jsx(O,{bold:!0,center:!0,children:g("group.create.confirm.guildbadge")}),i.jsx(Xe,{badgeCode:n(),isGroup:!0})]}),i.jsxs(N,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[i.jsx(O,{bold:!0,center:!0,children:g("group.edit.color.guild.color")}),i.jsxs(x,{overflow:"hidden",className:"rounded border",children:[i.jsx(V,{className:"group-color-swatch",style:{backgroundColor:"#"+o(0)}}),i.jsx(V,{className:"group-color-swatch",style:{backgroundColor:"#"+o(1)}})]})]})]}),i.jsxs(N,{size:9,justifyContent:"between",children:[i.jsxs(N,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:t.groupName}),i.jsx(O,{children:t.groupDescription})]}),i.jsx(O,{overflow:"auto",children:g("group.create.confirm.info")})]}),i.jsx(O,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:g("group.create.confirm.buyinfo",["amount"],[s.toString()])})]})]}):null},XU=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null,onClose:r=null,isCreator:n=!1,availableRooms:o=[]}=a,[l,c]=_.useState(""),[u,h]=_.useState(""),[d,f]=_.useState(-1),{showConfirm:E=null}=Ye(),m=()=>{!t||t.groupId<=0||E(g("group.deleteconfirm.desc"),()=>{H(new $b(t.groupId)),r&&r()},null,null,null,g("group.deleteconfirm.title"))},I=_.useCallback(()=>!t||!l||!l.length?!1:l===t.groupName&&u===t.groupDescription?!0:t.groupId<=0?d<=0?!1:(e(p=>{const T={...p};return T.groupName=l,T.groupDescription=u,T.groupHomeroomId=d,T}),!0):(H(new aD(t.groupId,l,u||"")),!0),[t,l,u,d,e]);return _.useEffect(()=>{c(t.groupName||""),h(t.groupDescription||""),f(t.groupHomeroomId)},[t]),_.useEffect(()=>(s({action:I}),()=>s(null)),[s,I]),t?i.jsxs(N,{justifyContent:"between",overflow:"auto",children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{center:!0,className:"col-3",children:g("group.edit.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:29,onChange:p=>c(p.target.value)})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{center:!0,className:"col-3",children:g("group.edit.desc")}),i.jsx("textarea",{className:"form-control form-control-sm",value:u,maxLength:254,onChange:p=>h(p.target.value)})]}),n&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{center:!0,className:"col-3",children:g("group.edit.base")}),i.jsx(N,{fullWidth:!0,gap:1,children:i.jsxs("select",{className:"form-select form-select-sm",value:d,onChange:p=>f(parseInt(p.target.value)),children:[i.jsx("option",{value:-1,disabled:!0,children:g("group.edit.base.select.room")}),o&&o.map((p,T)=>i.jsx("option",{value:p.id,children:p.name},T))]})})]}),i.jsxs(x,{gap:1,children:[i.jsx(V,{className:"col-3",children:""}),i.jsx(O,{small:!0,children:g("group.edit.base.warning")})]})]})]}),!n&&i.jsx(W,{variant:"danger",onClick:m,children:g("group.delete")}),n&&i.jsx(O,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:p=>ht("navigator/create"),children:g("group.createroom")})]}):null},qQ=[1,2,3,4],QQ=a=>{const{onClose:t=null}=a,[e,s]=_.useState(1),[r,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(null),[h,d]=_.useState(0),f=()=>{n(null),l(null),t&&t()},E=()=>{if(!o)return;const p=[];o.groupBadgeParts.forEach(T=>{T.code&&(p.push(T.key),p.push(T.color),p.push(T.position))}),H(new Qb(o.groupName,o.groupDescription,o.groupHomeroomId,o.groupColors[0],o.groupColors[1],p))},m=()=>{if(!(r&&r.action&&!r.action())){if(e===1){t();return}s(p=>p-1)}},I=()=>{if(!(r&&r.action&&!r.action())){if(e===4){E();return}s(p=>p===4?p:p+1)}};return z(qC,p=>{const T=p.getParser(),R=[];T.availableRooms.forEach((S,L)=>R.push({id:L,name:S})),u(R),d(T.groupCost)}),_.useEffect(()=>{s(1),l({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),H(new Jb)},[l]),o?i.jsxs(Ct,{className:"nitro-group-creator",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("group.create.title"),onCloseClick:f}),i.jsxs(It,{children:[i.jsx(x,{center:!0,className:"creator-tabs",children:qQ.map((p,T)=>i.jsx(x,{center:!0,className:`tab tab-${p===1?"blue-flat":p===4?"yellow":"blue-arrow"} ${e===p?"active":""}`,children:i.jsx(O,{variant:"white",children:g(`group.create.steplabel.${p}`)})},T))}),i.jsxs(N,{overflow:"hidden",children:[i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsx(V,{className:`nitro-group-tab-image tab-${e}`}),i.jsxs(N,{grow:!0,gap:0,children:[i.jsx(O,{bold:!0,fontSize:4,children:g(`group.create.stepcaption.${e}`)}),i.jsx(O,{children:g(`group.create.stepdesc.${e}`)})]})]}),i.jsxs(N,{overflow:"hidden",children:[e===1&&i.jsx(XU,{groupData:o,setGroupData:l,setCloseAction:n,onClose:null,isCreator:!0,availableRooms:c}),e===2&&i.jsx(zU,{groupData:o,setGroupData:l,setCloseAction:n}),e===3&&i.jsx(KU,{groupData:o,setGroupData:l,setCloseAction:n}),e===4&&i.jsx(XQ,{groupData:o,setGroupData:l,purchaseCost:h})]}),i.jsxs(x,{justifyContent:"between",children:[i.jsx(W,{variant:"link",className:"text-black",onClick:m,children:g(e===1?"generic.cancel":"group.create.previousstep")}),i.jsx(W,{disabled:e===4&&!Pl(),variant:e===4?Pl()?"success":"danger":"primary",onClick:I,children:g(e===4?Pl()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},JQ=["regular","exclusive","private"],qU=a=>{const{groupInformation:t=null,onClose:e=null,overflow:s="hidden",...r}=a,{showConfirm:n=null}=Ye(),o=t&&t.ownerName===tt().userName,l=()=>t&&bS(t.id),c=()=>{n(g("group.leaveconfirm.desc"),()=>{H(new zm(t.id,tt().userId)),e&&e()},null)},u=()=>t.membershipType===zs.NOT_MEMBER||t.membershipType===zs.REQUEST_PENDING?null:o?i.jsx("i",{className:"icon icon-group-owner",title:g("group.youareowner")}):t.isAdmin?i.jsx("i",{className:"icon icon-group-admin",title:g("group.youareadmin")}):i.jsx("i",{className:"icon icon-group-member",title:g("group.youaremember")}),h=()=>{if(o)return"group.youareowner";if(t.type===Ar.PRIVATE&&t.membershipType!==zs.MEMBER)return"";if(t.membershipType===zs.MEMBER)return"group.leave";if(t.membershipType===zs.NOT_MEMBER&&t.type===Ar.REGULAR)return"group.join";if(t.membershipType===zs.REQUEST_PENDING)return"group.membershippending";if(t.membershipType===zs.NOT_MEMBER&&t.type===Ar.EXCLUSIVE)return"group.requestmembership"},d=()=>{if(!(t.type===Ar.PRIVATE&&t.membershipType===zs.NOT_MEMBER)){if(t.membershipType===zs.MEMBER){c();return}l()}},f=E=>{switch(E){case"members":lA(t.id);break;case"members_pending":lA(t.id,2);break;case"manage":nU(t.id);break;case"homeroom":Li(t.roomId);break;case"furniture":ht("catalog/open/"+Sg.GUILD_CUSTOM_FURNI);break;case"popular_groups":ht("navigator/search/groups");break}};return t?i.jsxs(pt,{overflow:s,...r,children:[i.jsxs(N,{center:!0,size:3,overflow:"hidden",children:[i.jsx(x,{alignItems:"center",overflow:"hidden",className:"group-badge",children:i.jsx(Xe,{badgeCode:t.badge,isGroup:!0,scale:2})}),i.jsxs(N,{alignItems:"center",gap:1,children:[i.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>f("members"),children:g("group.membercount",["totalMembers"],[t.membersCount.toString()])}),t.pendingRequestsCount>0&&i.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>f("members_pending"),children:g("group.pendingmembercount",["amount"],[t.pendingRequestsCount.toString()])}),t.isOwner&&i.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>f("manage"),children:g("group.manage")})]}),u()]}),i.jsxs(N,{size:9,justifyContent:"between",overflow:"auto",children:[i.jsxs(N,{overflow:"hidden",children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsx(O,{bold:!0,children:t.title}),i.jsxs(x,{gap:1,children:[i.jsx("i",{className:"icon icon-group-type-"+t.type,title:g(`group.edit.settings.type.${JQ[t.type]}.help`)}),t.canMembersDecorate&&i.jsx("i",{className:"icon icon-group-decorate",title:g("group.memberscandecorate")})]})]}),i.jsx(O,{small:!0,children:g("group.created",["date","owner"],[t.createdAt,t.ownerName])})]}),i.jsx(O,{small:!0,overflow:"auto",className:"group-description",children:t.description})]}),i.jsxs(N,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>f("homeroom"),children:g("group.linktobase")}),i.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>f("furniture"),children:g("group.buyfurni")}),i.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>f("popular_groups"),children:g("group.showgroups")})]}),(t.type!==Ar.PRIVATE||t.type===Ar.PRIVATE&&t.membershipType===zs.MEMBER)&&i.jsx(W,{disabled:t.membershipType===zs.REQUEST_PENDING||o,onClick:d,children:g(h())})]})]})]}):null},ZQ=a=>{const[t,e]=_.useState(null);return z(Du,s=>{const r=s.getParser();(t&&t.id===r.id||r.flag)&&e(r)}),t?i.jsxs(Ct,{className:"nitro-group-information-standalone",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("group.window.title"),onCloseClick:s=>e(null)}),i.jsx(It,{children:i.jsx(qU,{groupInformation:t,onClose:()=>e(null)})})]}):null},$Q=["regular","exclusive","private"],tJ=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null}=a,[r,n]=_.useState(t.groupState),[o,l]=_.useState(t.groupCanMembersDecorate),c=_.useCallback(()=>t?r===t.groupState&&o===t.groupCanMembersDecorate?!0:t.groupId<=0?(e(u=>{const h={...u};return h.groupState=r,h.groupCanMembersDecorate=o,h}),!0):(H(new oD(t.groupId,r,o?0:1)),!0):!1,[t,r,o,e]);return _.useEffect(()=>{n(t.groupState),l(t.groupCanMembersDecorate)},[t]),_.useEffect(()=>(s({action:c}),()=>s(null)),[s,c]),i.jsxs(N,{overflow:"auto",children:[i.jsx(N,{children:$Q.map((u,h)=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"groupState",checked:r===h,onChange:d=>n(h)}),i.jsxs(N,{gap:0,children:[i.jsxs(x,{gap:1,children:[i.jsx("i",{className:`icon icon-group-type-${h}`}),i.jsx(O,{bold:!0,children:g(`group.edit.settings.type.${u}.label`)})]}),i.jsx(O,{children:g(`group.edit.settings.type.${u}.help`)})]})]},h))}),i.jsx(Wq,{}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:o,onChange:u=>l(h=>!h)}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("group.edit.settings.rights.caption")}),i.jsx(O,{children:g("group.edit.settings.rights.members.help")})]})]})]})},eJ=[1,2,3,5],sJ=a=>{const[t,e]=_.useState(1),[s,r]=_.useState(null),[n,o]=_.useState(null),l=()=>{r(u=>(u&&u.action&&u.action(),null)),o(null)},c=u=>{s&&s.action&&s.action(),e(u)};return z(Du,u=>{const h=u.getParser();!n||n.groupId!==h.id||o(d=>{const f={...d};return f.groupName=h.title,f.groupDescription=h.description,f.groupState=h.type,f.groupCanMembersDecorate=h.canMembersDecorate,f})}),z($C,u=>{const h=u.getParser(),d=[];h.badgeParts.forEach((f,E)=>{d.push(new lu(f.isBase?lu.BASE:lu.SYMBOL,f.key,f.color,f.position))}),o({groupId:h.id,groupName:h.title,groupDescription:h.description,groupHomeroomId:h.roomId,groupState:h.state,groupCanMembersDecorate:h.canMembersDecorate,groupColors:[h.colorA,h.colorB],groupBadgeParts:d})}),!n||n.groupId<=0?null:i.jsxs(Ct,{className:"nitro-group-manager",children:[i.jsx(Nt,{headerText:g("group.window.title"),onCloseClick:l}),i.jsx(eo,{children:eJ.map(u=>i.jsx(Ia,{isActive:t===u,onClick:()=>c(u),children:g(`group.edit.tab.${u}`)},u))}),i.jsxs(It,{children:[i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsx(V,{className:`nitro-group-tab-image tab-${t}`}),i.jsxs(N,{grow:!0,gap:0,children:[i.jsx(O,{bold:!0,fontSize:4,children:g(`group.edit.tabcaption.${t}`)}),i.jsx(O,{children:g(`group.edit.tabdesc.${t}`)})]})]}),i.jsxs(N,{grow:!0,overflow:"hidden",children:[t===1&&i.jsx(XU,{groupData:n,setGroupData:o,setCloseAction:r,onClose:l}),t===2&&i.jsx(zU,{groupData:n,setGroupData:o,setCloseAction:r,skipDefault:!0}),t===3&&i.jsx(KU,{groupData:n,setGroupData:o,setCloseAction:r}),t===5&&i.jsx(tJ,{groupData:n,setGroupData:o,setCloseAction:r})]})]})]})},iJ=a=>{const[t,e]=_.useState(-1),[s,r]=_.useState(-1),[n,o]=_.useState(null),[l,c]=_.useState(-1),[u,h]=_.useState(0),[d,f]=_.useState(""),[E,m]=_.useState(null),{showConfirm:I=null}=Ye(),p=M=>{if(M.rank===ci.OWNER)return"group.members.owner";if(n.admin){if(M.rank===ci.ADMIN)return"group.members.removerights";if(M.rank===ci.MEMBER)return"group.members.giverights"}return""},T=_.useCallback(()=>{t===-1||s===-1||l===-1||H(new jI(t,l,d,s))},[t,s,l,d]),R=M=>{!n.admin||M.rank===ci.OWNER||(M.rank!==ci.ADMIN?H(new Kb(n.groupId,M.id)):H(new Xb(n.groupId,M.id)),T())},S=M=>{!n.admin||M.rank!==ci.REQUESTED||(H(new sD(n.groupId,M.id)),T())},L=M=>{if(n.admin){if(M.rank===ci.REQUESTED){H(new iD(n.groupId,M.id)),T();return}m(M.name),H(new Zb(n.groupId,M.id))}};return z(JC,M=>{const P=M.getParser();o(P),r(P.level),h(Math.ceil(P.totalMembersCount/P.pageSize))}),z(QC,M=>{const P=M.getParser();I(g(P.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[E,P.furnitureCount.toString()]),()=>{H(new zm(n.groupId,P.userId)),T()},null),m(null)}),_.useEffect(()=>{const M={linkReceived:P=>{const k=P.split("/");if(k.length<2)return;const G=parseInt(k[1])||-1,j=parseInt(k[2])||3;e(G),r(j),c(0)},eventUrlPrefix:"group-members/"};return As(M),()=>Ns(M)},[]),_.useEffect(()=>{c(0)},[t,s,d]),_.useEffect(()=>{t===-1||s===-1||l===-1||H(new jI(t,l,d,s))},[t,s,l,d]),_.useEffect(()=>{t!==-1&&(r(-1),o(null),h(0),f(""),m(null))},[t]),t===-1||!n?null:i.jsxs(Ct,{className:"nitro-group-members",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("group.members.title",["groupName"],[n?n.groupTitle:""]),onCloseClick:M=>e(-1)}),i.jsxs(It,{overflow:"hidden",children:[i.jsxs(x,{gap:2,children:[i.jsx(x,{center:!0,className:"group-badge",children:i.jsx(Xe,{badgeCode:n.badge,isGroup:!0,className:"mx-auto d-block"})}),i.jsxs(N,{fullWidth:!0,gap:1,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:g("group.members.searchinfo"),value:d,onChange:M=>f(M.target.value)}),i.jsxs("select",{className:"form-select form-select-sm w-100",value:s,onChange:M=>r(parseInt(M.target.value)),children:[i.jsx("option",{value:"0",children:g("group.members.search.all")}),i.jsx("option",{value:"1",children:g("group.members.search.admins")}),i.jsx("option",{value:"2",children:g("group.members.search.pending")})]})]})]}),i.jsx(pt,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:n.result.map((M,P)=>i.jsxs(x,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[i.jsx("div",{className:"avatar-head cursor-pointer",onClick:()=>Ki(M.id),children:i.jsx(os,{figure:M.figure,headOnly:!0,direction:2})}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{bold:!0,small:!0,pointer:!0,onClick:k=>Ki(M.id),children:M.name}),M.rank!==ci.REQUESTED&&i.jsx(O,{small:!0,italics:!0,variant:"muted",children:g("group.members.since",["date"],[M.joinedAt])})]}),i.jsxs(N,{gap:1,children:[M.rank!==ci.REQUESTED&&i.jsx(x,{center:!0,children:i.jsx(V,{pointer:n.admin,className:`icon icon-group-small-${M.rank===ci.OWNER?"owner":M.rank===ci.ADMIN?"admin":n.admin&&M.rank===ci.MEMBER?"not-admin":""}`,title:g(p(M)),onClick:k=>R(M)})}),n.admin&&M.rank===ci.REQUESTED&&i.jsx(x,{alignItems:"center",children:i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:g("group.members.accept"),onClick:k=>S(M)})}),n.admin&&M.rank!==ci.OWNER&&M.id!==tt().userId&&i.jsx(x,{alignItems:"center",children:i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:g(M.rank===ci.REQUESTED?"group.members.reject":"group.members.kick"),onClick:k=>L(M)})})]})]},P))}),i.jsxs(x,{gap:1,justifyContent:"between",alignItems:"center",children:[i.jsx(W,{disabled:n.pageIndex===0,onClick:M=>c(P=>P-1),children:i.jsx(lr,{className:"fa-icon"})}),i.jsx(O,{small:!0,children:g("group.members.pageinfo",["amount","page","totalPages"],[n.totalMembersCount.toString(),(n.pageIndex+1).toString(),u.toString()])}),i.jsx(W,{disabled:n.pageIndex===u-1,onClick:M=>c(P=>P+1),children:i.jsx(cr,{className:"fa-icon"})})]})]})]})},rJ=a=>{const[t,e]=_.useState(!1);return wd(),z(ZC,s=>{const r=s.getParser();e(!1),Li(r.roomId)}),_.useEffect(()=>{const s={linkReceived:r=>{const n=r.split("/");if(!(n.length<2))switch(n[1]){case"create":e(!0);return;case"manage":if(!n[2])return;e(!1),H(new lD(Number(n[2])));return}},eventUrlPrefix:"groups/"};return As(s),()=>Ns(s)},[]),i.jsxs(i.Fragment,{children:[t&&i.jsx(QQ,{onClose:()=>e(!1)}),!t&&i.jsx(sJ,{}),i.jsx(iJ,{}),i.jsx(ZQ,{})]})},nJ=a=>{const{helpRequestDescription:t=null,helpRequestAverageTime:e=0}=a,s=r=>H(new CD(r));return i.jsxs(N,{children:[i.jsxs(N,{gap:0,className:"bg-muted p-2 rounded",children:[i.jsx(O,{bold:!0,children:g("guide.help.request.guide.accept.request.title")}),i.jsx(O,{variant:"muted",children:g("guide.help.request.type.1")}),i.jsx(O,{wrap:!0,textBreak:!0,children:t})]}),i.jsxs(N,{gap:1,children:[i.jsx(W,{variant:"success",onClick:r=>s(!0),children:g("guide.help.request.guide.accept.accept.button")}),i.jsx(W,{variant:"danger",onClick:r=>s(!1),children:g("guide.help.request.guide.accept.skip.link")})]})]})},aJ=a=>{const{isOnDuty:t=!1,isHandlingGuideRequests:e=!1,setIsHandlingGuideRequests:s=null,isHandlingHelpRequests:r=!1,setIsHandlingHelpRequests:n=null,isHandlingBullyReports:o=!1,setIsHandlingBullyReports:l=null,guidesOnDuty:c=0,helpersOnDuty:u=0,guardiansOnDuty:h=0,processAction:d=null}=a;return i.jsxs(N,{children:[i.jsxs(x,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[i.jsx(V,{className:"duty-switch"+(t?"":" off"),onClick:f=>d("toggle_duty")}),i.jsxs(N,{gap:0,children:[i.jsx(O,{bold:!0,children:g("guide.help.guide.tool.yourstatus")}),i.jsx(O,{children:g(`guide.help.guide.tool.duty.${t?"on":"off"}`)})]})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("guide.help.guide.tool.tickettypeselection.caption")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",disabled:t,type:"checkbox",checked:e,onChange:f=>s(f.target.checked)}),i.jsx(O,{children:g("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",disabled:t,type:"checkbox",checked:r,onChange:f=>n(f.target.checked)}),i.jsx(O,{children:g("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",disabled:t,type:"checkbox",checked:o,onChange:f=>l(f.target.checked)}),i.jsx(O,{children:g("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),i.jsx("hr",{className:"bg-dark m-0"}),i.jsxs(x,{center:!0,gap:2,children:[i.jsx(V,{className:"info-icon"}),i.jsxs(N,{gap:1,children:[i.jsx(V,{dangerouslySetInnerHTML:{__html:g("guide.help.guide.tool.guidesonduty",["amount"],[c.toString()])}}),i.jsx(V,{dangerouslySetInnerHTML:{__html:g("guide.help.guide.tool.helpersonduty",["amount"],[u.toString()])}}),i.jsx(V,{dangerouslySetInnerHTML:{__html:g("guide.help.guide.tool.guardiansonduty",["amount"],[h.toString()])}})]})]}),i.jsx("hr",{className:"bg-dark m-0"}),i.jsxs(x,{justifyContent:"between",gap:2,children:[i.jsx(W,{disabled:!0,onClick:f=>d("forum_link"),children:g("guide.help.guide.tool.forum.link")}),i.jsx(W,{disabled:!0,children:g("guide.help.guide.tool.skill.link")})]})]})},oJ=a=>{const t=_.useRef(null),{isGuide:e=!1,userId:s=0,userName:r=null,userFigure:n=null,isTyping:o=!1,messageGroups:l=[]}=a,[c,u]=_.useState("");_.useEffect(()=>{var p;(p=t.current)==null||p.scrollIntoView({block:"end",behavior:"smooth"})},[l]);const h=_.useCallback(()=>{H(new ND)},[]),d=_.useCallback(()=>{H(new xD)},[]),f=_.useCallback(()=>{H(new bD)},[]);z(_x,p=>{const T=p.getParser();Li(T.requesterRoomId)});const E=_.useCallback(()=>{!c||!c.length||(H(new yD(c)),u(""))},[c]),m=_.useCallback(p=>{p.key==="Enter"&&E()},[E]),I=_.useCallback(p=>p===tt().userId,[]);return i.jsxs(N,{fullHeight:!0,children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[e&&i.jsxs(ua,{children:[i.jsx(W,{onClick:h,children:g("guide.help.request.guide.ongoing.visit.button")}),i.jsx(W,{onClick:d,children:g("guide.help.request.guide.ongoing.invite.button")})]}),!e&&i.jsxs(N,{gap:0,children:[i.jsx(O,{bold:!0,children:r}),i.jsx(O,{children:g("guide.help.request.user.ongoing.guide.desc")})]}),i.jsx(W,{variant:"danger",disabled:!0,children:g("guide.help.common.report.link")})]}),i.jsx(N,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:i.jsxs(N,{overflow:"auto",children:[l.map((p,T)=>i.jsxs(x,{fullWidth:!0,justifyContent:I(p.userId)?"end":"start",gap:2,children:[i.jsx(V,{shrink:!0,className:"message-avatar",children:!I(p.userId)&&i.jsx(os,{figure:n,direction:2})}),i.jsxs(V,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(I(p.userId)?"right":"left"),children:[i.jsxs(O,{bold:!0,children:[I(p.userId)&&tt().userName,!I(p.userId)&&r]}),p.messages.map((R,S)=>i.jsx(V,{pointer:!!R.roomId,className:R.roomId?"text-break text-underline":"text-break",onClick:()=>R.roomId?Li(R.roomId):null,children:R.message},S))]}),I(p.userId)&&i.jsx(V,{className:"message-avatar flex-shrink-0",children:i.jsx(os,{figure:tt().figure,direction:4})})]},T)),i.jsx("div",{ref:t})]})}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{gap:1,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("guide.help.request.guide.ongoing.input.empty",["name"],[r]),value:c,onChange:p=>u(p.target.value),onKeyDown:m}),i.jsx(W,{variant:"success",onClick:E,children:g("widgets.chatinput.say")})]}),o&&i.jsx(O,{variant:"muted",children:g("guide.help.common.typing")})]}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:f,children:g("guide.help.request."+(e?"guide":"user")+".ongoing.close.link")})]})},lJ=15,cJ=a=>{const{userRequest:t="",setUserRequest:e=null}=a,[s,r]=_.useState(!1),n=()=>{r(!0),H(new OD(1,t))};return i.jsxs(N,{children:[i.jsx(O,{children:g("guide.help.request.user.create.help")}),i.jsx("textarea",{className:"request-message",maxLength:140,value:t,onChange:o=>e(o.target.value),placeholder:g("guide.help.request.user.create.input.help")}),i.jsx(W,{fullWidth:!0,variant:"success",disabled:t.length<lJ||s,onClick:n,children:g("guide.help.request.user.create.input.button")})]})},uJ=a=>{const{userName:t=null}=a,e=s=>H(new AD(s));return i.jsxs(N,{children:[i.jsxs(x,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[i.jsxs(N,{gap:0,children:[i.jsx(O,{bold:!0,children:t}),i.jsx(O,{children:g("guide.help.request.user.feedback.guide.desc")})]}),i.jsx(W,{variant:"danger",disabled:!0,children:g("guide.help.common.report.link")})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("guide.help.request.user.feedback.closed.title")}),i.jsx(O,{children:g("guide.help.request.user.feedback.closed.desc")})]}),t&&t.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"bg-dark m-0 mt-auto"}),i.jsxs(N,{children:[i.jsx(O,{center:!0,bold:!0,children:g("guide.help.request.user.feedback.question")}),i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"success",onClick:s=>e(!0),children:g("guide.help.request.user.feedback.positive.button")}),i.jsx(W,{fullWidth:!0,variant:"danger",onClick:s=>e(!1),children:g("guide.help.request.user.feedback.negative.button")})]})]})]})]})},hJ=a=>i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("guide.help.request.no_tour_guides.title")}),i.jsx(O,{children:g("guide.help.request.no_tour_guides.message")})]}),dJ=a=>{const{helpRequestDescription:t=null,helpRequestAverageTime:e=0}=a,s=()=>H(new MD);return i.jsxs(N,{children:[i.jsxs(N,{gap:0,className:"bg-muted rounded p-2",children:[i.jsx(O,{bold:!0,children:g("guide.help.request.guide.accept.request.title")}),i.jsx(O,{variant:"muted",children:g("guide.help.request.type.1")}),i.jsx(O,{wrap:!0,textBreak:!0,children:t})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("guide.help.request.user.pending.info.title")}),i.jsx(O,{children:g("guide.help.request.user.pending.info.message")}),i.jsx(O,{children:g("guide.help.request.user.pending.info.waiting",["waitingtime"],[e.toString()])})]}),i.jsx(W,{variant:"danger",onClick:s,children:g("guide.help.request.user.pending.cancel.button")})]})},_J=a=>i.jsx(N,{gap:1,children:i.jsx(O,{children:g("guide.help.request.user.guide.disconnected.error.desc")})}),gJ=a=>i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("guide.help.request.user.thanks.info.title")}),i.jsx(O,{children:g("guide.help.request.user.thanks.info.desc")})]}),fJ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(g("guide.help.guide.tool.title")),[n,o]=_.useState(!1),[l,c]=_.useState(xe.GUIDE_TOOL_MENU),[u,h]=_.useState(!1),[d,f]=_.useState(!1),[E,m]=_.useState(!1),[I,p]=_.useState(!1),[T,R]=_.useState(0),[S,L]=_.useState(0),[M,P]=_.useState(0),[k,G]=_.useState(""),[j,F]=_.useState(null),[U,K]=_.useState(0),[B,J]=_.useState(0),[Z,Q]=_.useState(null),[ut,Bt]=_.useState(null),[te,de]=_.useState(!1),[He,le]=_.useState([]),{simpleAlert:qe=null}=Ye(),vt=_.useCallback((ie,Ft)=>{switch(ie){case xe.GUIDE_TOOL_MENU:r(g("guide.help.guide.tool.title")),o(!1);break;case xe.GUIDE_ACCEPT:r(g("guide.help.request.guide.accept.title")),o(!0);break;case xe.GUIDE_ONGOING:r(g("guide.help.request.guide.ongoing.title",["name"],[Ft])),o(!0);break;case xe.USER_CREATE:r(g("guide.help.request.user.create.title")),o(!1);break;case xe.USER_PENDING:r(g("guide.help.request.user.pending.title")),o(!0);break;case xe.USER_ONGOING:r(g("guide.help.request.user.ongoing.title",["name"],[Ft])),o(!0);break;case xe.USER_FEEDBACK:r(g("guide.help.request.user.feedback.title")),o(!0);break;case xe.USER_THANKS:r(g("guide.help.request.user.thanks.title")),o(!1);break;case xe.USER_NO_HELPERS:r(g("guide.help.request.no_tour_guides.heading")),o(!1);break;case xe.USER_SOMETHING_WRONG:r(g("guide.help.request.user.guide.disconnected.error.heading")),o(!1);break}c(ie),e(!0)},[]),Vt=_.useCallback(ie=>{switch(ie.type){case or.SHOW_GUIDE_TOOL:e(!0);return;case or.HIDE_GUIDE_TOOL:e(!1);return;case or.TOGGLE_GUIDE_TOOL:e(Ft=>!Ft);return;case or.CREATE_HELP_REQUEST:vt(xe.USER_CREATE);return}},[vt]);_s(or.SHOW_GUIDE_TOOL,Vt),_s(or.HIDE_GUIDE_TOOL,Vt),_s(or.TOGGLE_GUIDE_TOOL,Vt),_s(or.CREATE_HELP_REQUEST,Vt),z(zR,ie=>{!ie.getParser().isAllowed(Y_.USE_GUIDE_TOOL)&&u&&(h(!1),H(new wI(!1,!1,!1,!1)))}),z(ox,ie=>{const Ft=ie.getParser();h(Ft.onDuty),L(Ft.guidesOnDuty),R(Ft.helpersOnDuty),P(Ft.guardiansOnDuty)}),z(lx,ie=>{const Ft=ie.getParser();F(Ft.helpRequestDescription),K(Ft.roleSpecificWaitTime),Ft.asGuide&&u&&vt(xe.GUIDE_ACCEPT),Ft.asGuide||vt(xe.USER_PENDING)}),z(kR,ie=>{const Ft=ie.getParser();u?(J(Ft.requesterUserId),Q(Ft.requesterName),Bt(Ft.requesterFigure),vt(xe.GUIDE_ONGOING,Ft.requesterName)):(J(Ft.guideUserId),Q(Ft.guideName),Bt(Ft.guideFigure),vt(xe.USER_ONGOING,Ft.guideName))}),z(dx,ie=>{const Ft=ie.getParser();de(Ft.isTyping)}),z(hx,ie=>{const Ft=ie.getParser(),De=[...He];let Rs=De[De.length-1];(!Rs||Rs.userId!==Ft.senderId)&&(Rs=new uA(Ft.senderId),De.push(Rs)),Rs.addChat(new cA(Ft.chatMessage)),le(De)}),z(ux,ie=>{const Ft=ie.getParser();if(Ft.roomId!==0){const De=[...He];let Rs=De[De.length-1];const wt=u?tt().userId:B;(!Rs||Rs.userId!==wt)&&(Rs=new uA(wt),De.push(Rs)),Rs.addChat(new cA(Ft.roomName,Ft.roomId)),le(De)}}),z(FR,ie=>{u?(J(0),Q(null),Bt(null),de(!1),le([]),vt(xe.GUIDE_TOOL_MENU)):vt(xe.USER_FEEDBACK)}),z(GR,ie=>{switch(ie.getParser().errorCode){case 0:vt(xe.USER_SOMETHING_WRONG);break;case 1:case 2:vt(xe.USER_NO_HELPERS);break}}),z(cx,ie=>{J(0),Q(null),Bt(null),de(!1),le([]),vt(u?xe.GUIDE_TOOL_MENU:xe.USER_THANKS)}),_.useEffect(()=>{const ie={linkReceived:Ft=>{const De=Ft.split("/");if(!(De.length<2))switch(De[1]){case"tour":return}},eventUrlPrefix:"help/"};return As(ie),()=>Ns(ie)},[]);const xs=_.useCallback(ie=>{switch(ie){case"close":e(!1),G(""),c(xe.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!d&&!E&&!I){qe(g("guide.help.guide.tool.noqueueselected.message"),null,null,null,g("guide.help.guide.tool.noqueueselected.caption"),null);return}h(De=>(H(new wI(!De,De?!1:E,De?!1:I,De?!1:d)),!De));return;case"forum_link":const Ft=ct("group.homepage.url","").replace("%groupid%",ct("guide.help.alpha.groupid","0"));window.open(Ft);return}},[d,E,I,qe]);return t?i.jsxs(Ct,{className:"nitro-guide-tool",theme:"primary-slim",children:[i.jsx(Nt,{headerText:s,onCloseClick:ie=>xs("close"),noCloseButton:n}),i.jsxs(It,{className:"text-black",children:[l===xe.GUIDE_TOOL_MENU&&i.jsx(aJ,{isOnDuty:u,isHandlingGuideRequests:E,setIsHandlingGuideRequests:m,isHandlingHelpRequests:I,setIsHandlingHelpRequests:p,isHandlingBullyReports:d,setIsHandlingBullyReports:f,guidesOnDuty:S,helpersOnDuty:T,guardiansOnDuty:M,processAction:xs}),l===xe.GUIDE_ACCEPT&&i.jsx(nJ,{helpRequestDescription:j,helpRequestAverageTime:U}),[xe.GUIDE_ONGOING,xe.USER_ONGOING].includes(l)&&i.jsx(oJ,{isGuide:u,userId:B,userName:Z,userFigure:ut,isTyping:te,messageGroups:He}),l===xe.USER_CREATE&&i.jsx(cJ,{userRequest:k,setUserRequest:G}),l===xe.USER_PENDING&&i.jsx(dJ,{helpRequestDescription:j,helpRequestAverageTime:U}),l===xe.USER_FEEDBACK&&i.jsx(uJ,{userName:Z}),l===xe.USER_THANKS&&i.jsx(gJ,{}),l===xe.USER_NO_HELPERS&&i.jsx(hJ,{}),l===xe.USER_SOMETHING_WRONG&&i.jsx(_J,{})]})]}):null},mJ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(null),[n,o]=_.useState(0),[l,c]=_.useState(null),{userFigure:u=null}=to(),{purse:h=null,clubStatus:d=null}=ec(),{badgeCodes:f=[],activate:E=null,deactivate:m=null}=eE(),I=()=>h.clubDays<=0?g("purse.clubdays.zero.amount.text"):h.minutesUntilExpiration>-1&&h.minutesUntilExpiration<60*24?xr.shortFormat(h.minutesUntilExpiration*60):xr.shortFormat((h.clubPeriods*31+h.clubDays)*86400),p=()=>{switch(d){case ea.ACTIVE:return g(`hccenter.status.${d}.info`,["timeleft","joindate","streakduration"],[I(),s==null?void 0:s.firstSubscriptionDate,xr.shortFormat((s==null?void 0:s.currentHcStreak)*86400)]);case ea.EXPIRED:return g(`hccenter.status.${d}.info`,["joindate"],[s==null?void 0:s.firstSubscriptionDate]);default:return g(`hccenter.status.${d}.info`)}},T=()=>!s||s.timeUntilPayday<60?g("hccenter.special.time.soon"):xr.shortFormat(s.timeUntilPayday*60),R=()=>g("hccenter.special.sum",["credits"],[((s==null?void 0:s.creditRewardForStreakBonus)+(s==null?void 0:s.creditRewardForMonthlySpent)).toString()]);if(z(vR,L=>{const M=L.getParser();o(M.giftsAvailable)}),z($M,L=>{const M=L.getParser();r(M.data)}),_.useEffect(()=>{const L={linkReceived:M=>{const P=M.split("/");if(!(P.length<2))switch(P[1]){case"open":if(P.length>2)switch(P[2]){case"hccenter":e(!0);break}return}},eventUrlPrefix:"habboUI/"};return As(L),()=>Ns(L)},[]),_.useEffect(()=>{c(fq(f))},[f]),_.useEffect(()=>{if(!t)return;const L=E();return()=>m(L)},[t,E,m]),_.useEffect(()=>{H(new eS),H(new uL)},[]),!t)return null;const S=i.jsx(_u,{id:"popover-basic",children:i.jsxs(_u.Body,{className:"text-black py-2 px-3",children:[i.jsx("h5",{children:g("hccenter.breakdown.title")}),i.jsx("div",{children:g("hccenter.breakdown.creditsspent",["credits"],[s==null?void 0:s.totalCreditsSpent.toString()])}),i.jsx("div",{children:g("hccenter.breakdown.paydayfactor.percent",["percent"],[((s==null?void 0:s.kickbackPercentage)*100).toString()])}),i.jsx("div",{children:g("hccenter.breakdown.streakbonus",["credits"],[s==null?void 0:s.creditRewardForStreakBonus.toString()])}),i.jsx("hr",{className:"w-100 text-black my-1"}),i.jsx("div",{children:g("hccenter.breakdown.total",["credits","actual"],[R(),(((s==null?void 0:s.kickbackPercentage)*(s==null?void 0:s.totalCreditsSpent)+(s==null?void 0:s.creditRewardForStreakBonus))*100/100).toString()])}),i.jsx("div",{className:"btn btn-link text-primary p-0",onClick:()=>ht("habbopages/"+ct("hc.center")["payday.habbopage"]),children:g("hccenter.special.infolink")})]})});return i.jsxs(Ct,{theme:"primary-slim",className:"nitro-hc-center",children:[i.jsx(Nt,{headerText:g("generic.hccenter"),onCloseClick:()=>e(!1)}),i.jsxs(x,{position:"relative",className:"bg-muted p-2",children:[i.jsxs(N,{gap:1,children:[i.jsx("div",{className:"hc-logo"}),i.jsx(x,{children:i.jsx(W,{variant:"success",onClick:L=>ht("catalog/open/"+ct("catalog.links")["hc.buy_hc"]),children:g(d===ea.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})]}),i.jsx(V,{position:"absolute",className:"end-0 p-4 top-0 habbo-avatar",children:i.jsx(os,{figure:u,direction:4,scale:2})})]}),i.jsxs(It,{children:[i.jsxs(x,{gap:2,children:[i.jsx(Xe,{badgeCode:l,className:"align-self-center flex-shrink-0 me-1"}),i.jsxs(N,{size:5,className:"streak-info",gap:0,children:[i.jsx(O,{children:g("hccenter.status."+d)}),i.jsx(O,{dangerouslySetInnerHTML:{__html:p()}})]})]}),ct("hc.center")["payday.info"]&&i.jsxs(x,{alignItems:"center",children:[i.jsxs(N,{className:"rounded-start bg-primary p-2 payday-special mb-1",children:[i.jsx("h4",{className:"mb-1",children:g("hccenter.special.title")}),i.jsx("div",{children:g("hccenter.special.info")}),i.jsx("div",{className:"btn btn-link text-white p-0 mt-auto align-self-baseline",onClick:()=>ht("habbopages/"+ct("hc.center")["payday.habbopage"]),children:g("hccenter.special.infolink")})]}),i.jsxs("div",{className:"payday flex-shrink-0 p-2",children:[i.jsx("h5",{className:"mb-2 ms-2",children:g("hccenter.special.time.title")}),i.jsxs("div",{className:"d-flex flex-row mb-2",children:[i.jsx("div",{className:"clock me-2"}),i.jsx("h6",{className:"mb-0 align-self-center",children:T()})]}),d===ea.ACTIVE&&i.jsxs("div",{className:"pe-3",children:[i.jsx("h5",{className:"ms-2 mb-1 bolder",children:g("hccenter.special.amount.title")}),i.jsxs("div",{className:"d-flex flex-column",children:[i.jsx("div",{className:"w-100 text-center ms-4n",children:R()}),i.jsx(wN,{trigger:["hover","focus"],placement:"left",overlay:S,children:i.jsx("div",{className:"btn btn-link align-self-end text-primary",children:g("hccenter.breakdown.infolink")})})]})]})]})]}),ct("hc.center")["gift.info"]&&i.jsxs("div",{className:"rounded bg-success p-2 d-flex flex-row mb-0",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"mb-1",children:g("hccenter.gift.title")}),i.jsx("div",{dangerouslySetInnerHTML:{__html:n>0?g("hccenter.unclaimedgifts",["unclaimedgifts"],[n.toString()]):g("hccenter.gift.info")}})]}),i.jsx("button",{className:"btn btn-primary btn-lg align-self-center ms-auto",onClick:()=>ht("catalog/open/"+ct("catalog.links")["hc.hc_gifts"]),children:g(d===ea.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),ct("hc.center")["benefits.info"]&&i.jsxs("div",{className:"benefits text-black py-2",children:[i.jsx("h5",{className:"mb-1 text-primary",children:g("hccenter.general.title")}),i.jsx("div",{className:"mb-2",dangerouslySetInnerHTML:{__html:g("hccenter.general.info")}}),i.jsx("button",{className:"btn btn-link p-0 text-primary",onClick:()=>ht("habbopages/"+ct("hc.center")["benefits.habbopage"]),children:g("hccenter.general.infolink")})]})]})]})},EJ=a=>{const[t,e]=_.useState(""),{activeReport:s=null,setActiveReport:r=null}=en(),n=()=>{t.length<15||r(l=>{const c=Ii.REPORT_SUMMARY;return{...l,message:t,currentStep:c}})},o=()=>{r(l=>({...l,currentStep:l.currentStep-1}))};return i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontSize:4,children:g("help.emergency.chat_report.subtitle")}),i.jsx(O,{children:g("help.cfh.input.text")})]}),i.jsx("textarea",{className:"form-control h-100",value:t,onChange:l=>e(l.target.value)}),i.jsxs(x,{gap:2,justifyContent:"between",children:[i.jsx(W,{variant:"secondary",disabled:!(s.reportType===ns.BULLY||s.reportType===ns.EMERGENCY),onClick:o,children:g("generic.back")}),i.jsx(W,{disabled:t.length<15,onClick:n,children:g("help.emergency.main.submit.button")})]})]})},pJ=a=>{const{setActiveReport:t=null}=en(),e=()=>{t(s=>{const r=Ii.SELECT_USER,n=ns.BULLY;return{...s,currentStep:r,reportType:n}})};return i.jsxs(i.Fragment,{children:[i.jsxs(N,{grow:!0,center:!0,gap:1,children:[i.jsx(O,{fontSize:3,children:g("help.main.frame.title")}),i.jsx(O,{children:g("help.main.self.description")})]}),i.jsxs(N,{gap:1,children:[i.jsx(W,{onClick:e,children:g("help.main.bully.subtitle")}),i.jsx(W,{onClick:()=>Ps(new or(or.CREATE_HELP_REQUEST)),disabled:!ct("guides.enabled"),children:g("help.main.help.title")}),i.jsx(W,{disabled:!0,children:g("help.main.self.tips.title")})]}),i.jsx(W,{variant:"link",textColor:"black",onClick:()=>H(new RD(!1)),children:g("help.main.my.sanction.status")})]})},IJ=a=>{const{activeReport:t=null,setActiveReport:e=null}=en(),s=()=>{const r=[];switch(t.reportType){case ns.BULLY:case ns.EMERGENCY:case ns.ROOM:{const n=t.roomId<=0?t.reportedChats[0].roomId:t.roomId;t.reportedChats.forEach(o=>r.push(o.webId,o.message)),H(new ID(t.message,t.cfhTopic,t.reportedUserId,n,r));break}case ns.IM:t.reportedChats.forEach(n=>r.push(n.webId,n.message)),H(new ED(t.message,t.cfhTopic,t.reportedUserId,r));break;case ns.THREAD:H(new mD(t.groupId,t.threadId,t.cfhTopic,t.message));break;case ns.MESSAGE:H(new fD(t.groupId,t.threadId,t.messageId,t.cfhTopic,t.message));break;case ns.PHOTO:H(new pD(t.extraData,t.roomId,t.reportedUserId,t.cfhTopic,t.roomObjectId));break}e(null)};return i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontSize:4,children:g("help.cfh.button.send")}),i.jsx(O,{children:g("help.main.summary")})]}),i.jsx(W,{variant:"success",onClick:s,children:g("guide.help.request.emergency.submit.button")})]})},TJ=a=>{const{sanctionInfo:t=null,setSanctionInfo:e=null}=en(),s=(r,n,o)=>{let l=`help.sanction.${r}`;switch(n){case"ALERT":l=l+".alert";break;case"MUTE":l=l+".mute";break;case"BAN_PERMANENT":l=l+".permban";break;default:if(l=l+".ban",o>24)return l=l+".days",g(l,["days"],[(o/24).toString()])}return g(l,["hours"],[o.toString()])};return t?i.jsxs(Ct,{className:"nitro-help",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("help.sanction.info.title"),onCloseClick:()=>e(null)}),i.jsx(It,{className:"text-black",children:i.jsxs(pt,{children:[i.jsx(N,{center:!0,size:5,overflow:"hidden",children:i.jsx(V,{className:"index-image"})}),i.jsxs(N,{justifyContent:"between",size:7,overflow:"hidden",children:[t.sanctionReason==="cfh.reason.EMPTY"?i.jsx("div",{className:"col-12 fw-bold",children:g("help.sanction.current.none")}):i.jsxs(i.Fragment,{children:[(t.probationHoursLeft>0||t.isSanctionActive)&&i.jsx("div",{className:"col-12 fw-bold",children:g("help.sanction.probation.reminder")}),i.jsxs("div",{className:`col-12 fw-bold ${t.isSanctionNew?"text-danger":""}`,children:[g("help.sanction.last.sanction")," ",s("current",t.sanctionName,t.sanctionLengthHours)]}),i.jsxs("div",{className:"col-12",children:[g("generic.start.time")," ",t.sanctionCreationTime]}),i.jsxs("div",{className:"col-12",children:[g("generic.reason")," ",t.sanctionReason]}),i.jsxs("div",{className:"col-12",children:[g("help.sanction.probation.days.left")," ",Math.trunc(t.probationHoursLeft/24)+1]})]}),t.hasCustomMute&&!t.isSanctionActive&&i.jsx("div",{className:"col-12 fw-bold",children:g("help.sanction.custom.mute")}),t.tradeLockExpiryTime&&t.tradeLockExpiryTime.length>0&&i.jsxs("div",{className:"col-12 fw-bold",children:[g("trade.locked.until")," ",t.tradeLockExpiryTime]}),i.jsx("div",{className:"col-12",children:s("next",t.nextSanctionName,t.nextSanctionLengthHours)}),i.jsx(W,{variant:"success",onClick:r=>e(null),children:g("habbo.way.ok.button")})]})]})})]}):null},RJ=a=>{const[t,e]=_.useState([]),{activeReport:s=null,setActiveReport:r=null}=en(),{chatHistory:n=[],messengerHistory:o=[]}=jd(),l=_.useMemo(()=>{switch(s.reportType){case ns.BULLY:case ns.EMERGENCY:return n.filter(d=>d.type===On.TYPE_CHAT&&d.webId===s.reportedUserId&&d.entityType===Pe.USER);case ns.IM:return o.filter(d=>d.webId===s.reportedUserId&&d.type===On.TYPE_IM)}return[]},[s,n,o]),c=d=>{e(f=>{const E=[...f],m=E.indexOf(d);return m>=0?E.splice(m,1):E.push(d),E})},u=()=>{!t||t.length<=0||r(d=>({...d,reportedChats:t,currentStep:Ii.SELECT_TOPICS}))},h=()=>{r(d=>({...d,currentStep:d.currentStep-1}))};return i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontSize:4,children:g("help.emergency.chat_report.subtitle")}),i.jsx(O,{children:g("help.emergency.chat_report.description")})]}),i.jsxs(N,{gap:1,overflow:"hidden",children:[!l||!l.length&&i.jsx(O,{children:g("help.cfh.error.no_user_data")}),l.length>0&&i.jsx(Fe,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:l.map((d,f)=>i.jsx($t,{onClick:E=>c(d),itemActive:t.indexOf(d)>=0,children:i.jsx(O,{children:d.message})},d.id))})]}),i.jsxs(x,{gap:2,justifyContent:"between",children:[i.jsx(W,{variant:"secondary",onClick:h,disabled:s.reportType===ns.IM,children:g("generic.back")}),i.jsx(W,{disabled:t.length<=0,onClick:u,children:g("help.emergency.main.submit.button")})]})]})},SJ=a=>{const[t,e]=_.useState(-1),{chatHistory:s=[]}=jd(),{activeReport:r=null,setActiveReport:n=null}=en(),o=_.useMemo(()=>{const h=new Map;return s.forEach(d=>{d.type===On.TYPE_CHAT&&d.entityType===Pe.USER&&d.webId!==tt().userId&&!h.has(d.webId)&&h.set(d.webId,{id:d.webId,username:d.name})}),Array.from(h.values())},[s]),l=h=>{h<=0||n(d=>({...d,reportedUserId:h,currentStep:Ii.SELECT_CHATS}))},c=h=>{e(d=>h===d?-1:h)},u=()=>{n(h=>({...h,currentStep:h.currentStep-1}))};return i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontSize:4,children:g("help.emergency.main.step.two.title")}),o.length>0&&i.jsx(O,{children:g("report.user.pick.user")})]}),i.jsxs(N,{gap:1,overflow:"hidden",children:[!o.length&&i.jsx(O,{children:g("report.user.error.nolist")}),o.length>0&&i.jsx(Fe,{columnCount:1,columnMinHeight:25,gap:1,children:o.map((h,d)=>i.jsx($t,{onClick:f=>c(h.id),itemActive:t===h.id,children:i.jsx("span",{dangerouslySetInnerHTML:{__html:h.username}})},h.id))})]}),i.jsxs(x,{gap:2,justifyContent:"between",children:[i.jsx(W,{variant:"secondary",onClick:u,children:g("generic.back")}),i.jsx(W,{disabled:t<=0,onClick:()=>l(t),children:g("help.emergency.main.submit.button")})]})]})},OJ=a=>{const[t,e]=_.useState(-1),[s,r]=_.useState(-1),{setActiveReport:n=null}=en(),{cfhCategories:o=[]}=vu(),l=()=>{t<0||s<0||n(u=>({...u,cfhCategory:t,cfhTopic:o[t].topics[s].id,currentStep:Ii.INPUT_REPORT_MESSAGE}))},c=()=>{n(u=>({...u,currentStep:u.currentStep-1}))};return i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontSize:4,children:g("help.emergency.chat_report.subtitle")}),i.jsx(O,{children:g("help.cfh.pick.topic")})]}),i.jsxs(N,{gap:1,overflow:"auto",children:[t<0&&o.map((u,h)=>i.jsx(W,{variant:"danger",onClick:d=>e(h),children:g(`help.cfh.reason.${u.name}`)},h)),t>=0&&o[t].topics.map((u,h)=>i.jsx(W,{variant:"danger",onClick:d=>r(h),active:s===h,children:g(`help.cfh.topic.${u.id}`)},h))]}),i.jsxs(x,{gap:2,justifyContent:"between",children:[i.jsx(W,{variant:"secondary",onClick:c,children:g("generic.back")}),i.jsx(W,{disabled:s<0,onClick:l,children:g("help.emergency.main.submit.button")})]})]})},AJ=a=>{const{username:t="",onAction:e=null}=a,[s,r]=_.useState(!1),n=()=>{s||(r(!0),H(new sb(t)))};return z(Wm,o=>{const l=o.getParser();l&&l.webId===tt().userId&&e("close")}),i.jsxs("div",{className:"d-flex flex-column gap-4 h-100",children:[i.jsx("div",{className:"bg-muted rounded p-2 text-center",children:g("tutorial.name_change.info.confirm")}),i.jsxs("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[i.jsx("div",{children:g("tutorial.name_change.confirm")}),i.jsx("div",{className:"fw-bold",children:t})]}),i.jsxs("div",{className:"d-flex gap-2",children:[i.jsx("button",{className:"btn btn-success w-100",disabled:s,onClick:n,children:g("generic.ok")}),i.jsx("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:g("cancel")})]})]})},NJ=a=>{const{onAction:t=null}=a;return i.jsxs("div",{className:"d-flex flex-column gap-4 h-100",children:[i.jsx("div",{className:"bg-muted rounded p-2 text-center",children:g("tutorial.name_change.info.main")}),i.jsx("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:g("tutorial.name_change.current",["name"],[tt().userName])}),i.jsxs("div",{className:"d-flex gap-2",children:[i.jsx("button",{className:"btn btn-success w-100",onClick:()=>t("start"),children:g("tutorial.name_change.change")}),i.jsx("button",{className:"btn btn-primary w-100",onClick:()=>t("confirmation",tt().userName),children:g("tutorial.name_change.keep")})]})]})},CJ=0,xJ=2,yJ=3,MJ=4,bJ=5,DJ=6,vJ=a=>{const{onAction:t=null}=a,[e,s]=_.useState(""),[r,n]=_.useState(!1),[o,l]=_.useState(!1),[c,u]=_.useState(null),[h,d]=_.useState([]),f=()=>{e!==""&&(n(!1),d([]),u(null),l(!0),H(new ib(e)))},E=m=>{n(!1),d([]),u(null),s(m)};return z(eC,m=>{l(!1);const I=m.getParser();if(I)switch(I.resultCode){case CJ:n(!0);break;case xJ:u("short");break;case yJ:u("long");break;case MJ:u("invalid");break;case bJ:d(I.nameSuggestions),u("taken");break;case DJ:u("change_not_allowed")}}),i.jsxs("div",{className:"d-flex flex-column gap-3 h-100",children:[i.jsx("div",{children:g("tutorial.name_change.info.select")}),i.jsxs("div",{className:"d-flex gap-2",children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:m=>E(m.target.value)}),i.jsx("button",{className:"btn btn-primary",disabled:e===""||o,onClick:f,children:g("tutorial.name_change.check")})]}),!c&&!r&&i.jsx("div",{className:"bg-muted rounded p-2 text-center",children:g("help.tutorial.name.info")}),c&&i.jsx("div",{className:"bg-danger rounded p-2 text-center text-white",children:g(`help.tutorial.name.${c}`,["name"],[e])}),r&&i.jsx("div",{className:"bg-success rounded p-2 text-center text-white",children:g("help.tutorial.name.available",["name"],[e])}),h&&i.jsx("div",{className:"d-flex flex-column gap-2",children:h.map((m,I)=>i.jsx("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>E(m),children:m},I))}),i.jsxs("div",{className:"d-flex gap-2",children:[i.jsx("button",{className:"btn btn-success w-100",disabled:!r,onClick:()=>t("confirmation",e),children:g("tutorial.name_change.pick")}),i.jsx("button",{className:"btn btn-primary w-100",onClick:()=>t("close"),children:g("cancel")})]})]})},i_="INIT",ME="INPUT",bE="CONFIRMATION",PJ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(i_),[n,o]=_.useState(""),l=(u,h)=>{switch(u){case"start":r(ME);break;case"confirmation":o(h),r(bE);break;case"close":o(""),e(!1);break}},c=_.useMemo(()=>{switch(s){case i_:return"tutorial.name_change.title.main";case ME:return"tutorial.name_change.title.select";case bE:return"tutorial.name_change.title.confirm"}},[s]);return _s(Od.INIT,u=>{r(i_),e(!0)}),t?i.jsxs(Ct,{className:"nitro-change-username",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g(c),onCloseClick:()=>l("close")}),i.jsxs(It,{className:"text-black",children:[s===i_&&i.jsx(NJ,{onAction:l}),s===ME&&i.jsx(vJ,{onAction:l}),s===bE&&i.jsx(AJ,{username:n,onAction:l})]})]}):null},LJ=a=>{const[t,e]=_.useState(!1),{activeReport:s=null,setActiveReport:r=null,report:n=null}=en(),o=()=>{r(null),e(!1)};_.useEffect(()=>{const c={linkReceived:u=>{const h=u.split("/");if(!(h.length<2))switch(h[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(d=>!d);return;case"tour":return;case"report":h.length>=5&&h[2]==="room"&&(parseInt(h[3]),unescape(h.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return As(c),()=>Ns(c)},[]),_.useEffect(()=>{s&&e(!0)},[s]);const l=()=>{if(s)switch(s.currentStep){case Ii.SELECT_USER:return i.jsx(SJ,{});case Ii.SELECT_CHATS:return i.jsx(RJ,{});case Ii.SELECT_TOPICS:return i.jsx(OJ,{});case Ii.INPUT_REPORT_MESSAGE:return i.jsx(EJ,{});case Ii.REPORT_SUMMARY:return i.jsx(IJ,{})}return i.jsx(pJ,{})};return i.jsxs(i.Fragment,{children:[t&&i.jsxs(Ct,{className:"nitro-help",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("help.button.cfh"),onCloseClick:o}),i.jsx(It,{className:"text-black",children:i.jsxs(pt,{children:[i.jsx(N,{center:!0,size:5,overflow:"hidden",children:i.jsx(V,{className:"index-image"})}),i.jsx(N,{justifyContent:"between",size:7,overflow:"hidden",children:i.jsx(l,{})})]})})]}),i.jsx(TJ,{}),i.jsx(PJ,{})]})},UJ=[{id:"room.rooftop",className:"rooftop-night"},{id:"room.rooftop.pool",className:"rooftop-pool-night"},{id:"room.picnic",className:"picnic-night"},{id:"room.peaceful",className:"peaceful-night"},{id:"room.pool",className:"pool-night"},{id:"room.infobus",className:"infobus-night"},{id:"room.lobby",className:"lobby-night"}],Lg=()=>{const a=jt(),t=e=>{ht(`navigator/goto/${e}`)};return i.jsx(x,{children:UJ.map(e=>i.jsx(V,{className:`position-absolute ${e.className}`,onClick:()=>t(a[e.id]),children:i.jsx("i",{className:"active-arrow arrow"})},e.id))})},mi=a=>{const t=ct("hotelview")["room.pool"],e=ct("hotelview")["room.picnic"],s=ct("hotelview")["room.rooftop"],r=ct("hotelview")["room.rooftop.pool"],n=ct("hotelview")["room.peaceful"],o=ct("hotelview")["room.infobus"],l=ct("hotelview")["room.lobby"];return i.jsxs(x,{children:[i.jsx(V,{className:"rooftop position-absolute",onClick:c=>ht("navigator/goto/"+s),children:i.jsx("i",{className:"active-arrow arrow"})}),i.jsx(V,{className:"rooftop-pool position-absolute",onClick:c=>ht("navigator/goto/"+r),children:i.jsx("i",{className:"active-arrow arrow"})}),i.jsx(V,{className:"pool position-absolute",onClick:c=>ht("navigator/goto/"+t),children:i.jsx("i",{className:"active-arrow arrow"})}),i.jsx(V,{className:"picnic position-absolute",onClick:c=>ht("navigator/goto/"+e),children:i.jsx("i",{className:"active-arrow arrow"})}),i.jsx(V,{className:"peaceful position-absolute",onClick:c=>ht("navigator/goto/"+n),children:i.jsx("i",{className:"active-arrow arrow"})}),i.jsx(V,{className:"infobus position-absolute",onClick:c=>ht("navigator/goto/"+o),children:i.jsx("i",{className:"active-arrow arrow"})}),i.jsx(V,{className:"lobby position-absolute",onClick:c=>ht("navigator/goto/"+l),children:i.jsx("i",{className:"active-arrow arrow"})})]})},jJ=()=>{const a=ct("hotelview").images["background.colour"],t=new Date,e=t.getHours(),s=t.getMinutes(),r=a&&a?{background:a}:{},n=o=>i.jsx("div",{className:"nitro-hotel-view",style:r,children:o});return i.jsxs(i.Fragment,{children:[e===6&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-a position-absolute"}),i.jsx("div",{className:"back-a position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-night position-relative"}),i.jsx(Lg,{}),i.jsx("div",{className:"light-a position-absolute"}),i.jsx("div",{className:"light-a position-absolute"})]})})]})),e===6&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-a-alt position-absolute"}),i.jsx("div",{className:"back-b position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-a position-absolute"}),i.jsx("div",{className:"light-a position-absolute"})]})})]})),e===7&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-a-alt position-absolute"}),i.jsx("div",{className:"back-c-alt position-absolute"}),i.jsx("div",{className:"back-b position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"front-b position-absolute"}),i.jsx("div",{className:"light-b position-absolute"})]})})]})),e===7&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue position-relative"}),i.jsx("div",{className:"back-d position-absolute"}),i.jsx("div",{className:"back-c position-absolute"}),i.jsx("div",{className:"back-b position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"front-b position-absolute"}),i.jsx("div",{className:"light-d position-absolute"})]})})]})),e===8&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue position-relative"}),i.jsx("div",{className:"back-d position-absolute"}),i.jsx("div",{className:"back-e-alt-ii position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"light-e  position-absolute"})]})})]})),e===8&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue position-relative"}),i.jsx("div",{className:"back-e-alt-iii position-absolute"}),i.jsx("div",{className:"back-d position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"front-c position-absolute"}),i.jsx("div",{className:"light-f position-absolute"})]})})]})),e===9&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue position-relative"}),i.jsx("div",{className:"back-e-alt-iv position-absolute"}),i.jsx("div",{className:"back-d position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-d position-absolute"}),i.jsx("div",{className:"light-gg-alt position-absolute"}),i.jsx("div",{className:"light-g position-absolute"}),i.jsx("div",{className:"light-g position-absolute"})]})})]})),e===9&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue position-relative"}),i.jsx("div",{className:"back-e position-absolute"}),i.jsx("div",{className:"back-e-alt-v position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"light-gg-alt position-absolute"}),i.jsx("div",{className:"light-g position-absolute"})]})})]})),e===10&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue position-relative"}),i.jsx("div",{className:"back-e-alt-ii position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"light-i position-absolute"})]})})]}))]})},wJ=()=>{const a=ct("hotelview").images["background.colour"],t=new Date;t.getHours(),t.getMinutes();const e=a?{background:a}:{};return(r=>i.jsx("div",{className:"nitro-hotel-view",style:e,children:r}))(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue position-relative"}),i.jsx("div",{className:"back-e-alt-ii position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{})]})})]}))},FJ=()=>{const a=ct("hotelview").images["background.colour"],t=new Date,e=t.getHours(),s=t.getMinutes(),r=a&&a?{background:a}:{},n=o=>i.jsx("div",{className:"nitro-hotel-view",style:r,children:o});return i.jsxs(i.Fragment,{children:[e===16&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-af-1 position-relative"}),i.jsx("div",{className:"back-f-alt position-absolute"}),i.jsx("div",{className:"back-f position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"light-j position-absolute"}),i.jsx("div",{className:"light-j position-absolute"})]})})]})),e===16&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-af-2 position-relative"}),i.jsx("div",{className:"back-g-alt position-absolute"}),i.jsx("div",{className:"back-g position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"light-l position-absolute"}),i.jsx("div",{className:"light-l-alt position-absolute"})]})})]})),e===17&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-af-3 position-relative"}),i.jsx("div",{className:"back-h-alt position-absolute"}),i.jsx("div",{className:"back-h position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"light-m position-absolute"}),i.jsx("div",{className:"light-m-alt position-absolute"})]})})]})),e===17&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-af-4 position-relative"}),i.jsx("div",{className:"back-h position-absolute"})]})}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"light-n position-absolute"}),i.jsx("div",{className:"light-n-alt position-absolute"})]})})]})),e===18&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-af-5 position-relative"}),i.jsx("div",{className:"back-h position-absolute"}),i.jsx("div",{className:"back-n position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-k position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"light-n position-absolute"}),i.jsx("div",{className:"light-n-alt-iii position-absolute"})]})})]})),e===18&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-af-6 position-relative"}),i.jsx("div",{className:"back-h position-absolute"}),i.jsx("div",{className:"back-n position-absolute"}),i.jsx("div",{className:"back-k-final position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-k position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"light-o position-absolute"}),i.jsx("div",{className:"light-o-alt position-absolute"}),i.jsx("div",{className:"light-o-alt-ii position-absolute"})]})})]})),e===19&&s<=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-c-alt position-absolute"}),i.jsx("div",{className:"back-c-alt position-absolute"}),i.jsx("div",{className:"back-h position-absolute"}),i.jsx("div",{className:"back-k-alt position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-m position-absolute"}),i.jsx("div",{className:"front-m position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"front-j position-absolute"}),i.jsx("div",{className:"light-p position-absolute"}),i.jsx("div",{className:"light-p-alt position-absolute"}),i.jsx("div",{className:"light-p-alt-ii position-absolute"})]})})]})),e===19&&s>=30&&n(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-e position-absolute"}),i.jsx("div",{className:"back-k-final position-absolute"}),i.jsx("div",{className:"back-l position-absolute"}),i.jsx("div",{className:"back-l position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-orange position-relative"}),i.jsx(mi,{}),i.jsx("div",{className:"front-a position-absolute"}),i.jsx("div",{className:"light-q position-absolute"}),i.jsx("div",{className:"light-q-alt-ii position-absolute"})]})})]}))]})},GJ=a=>{const t=ct("hotelview").images["background.colour"],[e,s]=_.useState(!1),[r,n]=_.useState(!1);_.useEffect(()=>{setTimeout(()=>s(!0),7e3),setTimeout(()=>n(!0),0)},[]);const o=new Date,l=o.getHours()*60+o.getMinutes();return[{start:18*60,end:18*60+30},{start:19*60,end:19*60+30},{start:20*60,end:20*60+30},{start:21*60,end:21*60+30},{start:22*60,end:22*60+30},{start:23*60,end:23*60+30}].some(h=>l>=h.start&&l<=h.end)?i.jsxs("div",{className:"nitro-hotel-view",style:t&&t?{background:t}:{},children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-c-alt position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-night position-relative"}),i.jsx(Lg,{}),i.jsx("div",{className:"light-i position-absolute"}),i.jsx("div",{className:"door position-absolute"}),i.jsx("div",{className:"door-b position-absolute"})]})})]}):i.jsxs("div",{className:"nitro-hotel-view",style:t&&t?{background:t}:{},children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-c-alt position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-night position-relative"}),i.jsx(Lg,{}),i.jsx("div",{className:"light-i position-absolute"}),i.jsx("div",{className:"door position-absolute"}),i.jsx("div",{className:"door-b position-absolute"})]})})]})},kJ=a=>{const[t,e]=_.useState(!1),s=ct("hotelview").images["background.colour"];return _.useEffect(()=>{setTimeout(()=>e(!0),15e3)},[]),i.jsxs("div",{className:"nitro-hotel-view",style:s&&s?{background:s}:{},children:[i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview-back position-relative",children:[i.jsx("div",{className:"stretch-blue-night position-relative"}),i.jsx("div",{className:"back-c-alt position-absolute"})]})}),i.jsx("div",{className:"drape position-absolute"}),i.jsx("div",{className:"left position-absolute",children:i.jsxs("div",{className:"hotelview position-relative",children:[i.jsx("div",{className:"hotelview-night position-relative"}),i.jsx(Lg,{}),i.jsx("div",{className:"light-i position-absolute"}),i.jsx("div",{className:"door position-absolute"})]})})]})},BJ=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(null),[n,o]=_.useState(null),[l,c]=_.useState(null);return z(gC,u=>{const h=u.getParser();e(h.productType),r(h.productClassId),o(h.totalCoinsForBonus),c(h.coinsStillRequiredToBuy)}),_.useEffect(()=>{H(new gb)},[]),t?i.jsxs("div",{className:"bonus-rare widget d-flex",children:[t,i.jsxs("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[i.jsx("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:n-l+"/"+n}),i.jsx("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(n-l)/n*100+"%"}})]})]}):null},VJ=a=>{const{data:t=null,level:e=0}=a;return i.jsxs("div",{className:"hof-user-container",children:[i.jsxs("div",{className:"hof-tooltip",children:[i.jsxs("div",{className:"hof-header",children:[e,". ",t.userName," ",i.jsx(br,{userId:t.userId})]}),i.jsx("div",{className:"small text-center text-white",children:g("landing.view.competition.hof.points",["points"],[Ag(t.currentScore).toString()])})]}),i.jsx(os,{figure:t.figure,direction:2})]})},HJ=a=>{const{slot:t=-1,conf:e=null}=a,[s,r]=_.useState(null);return z(zy,n=>{const o=n.getParser();r(o.data)}),_.useEffect(()=>{const n=e?e.campaign:"";H(new vv(n))},[e]),s?i.jsx("div",{className:"hall-of-fame d-flex",children:s.hof&&s.hof.length>0&&s.hof.map((n,o)=>i.jsx(VJ,{data:n,level:o+1},o))}):null},WJ=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(0);return z(Fx,n=>{const o=n.getParser();e(o.articles)}),_.useEffect(()=>{H(new YD)},[]),t?i.jsxs("div",{className:"promo-articles widget mb-2",children:[i.jsxs("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[i.jsx("small",{className:"flex-shrink-0 pe-1",children:g("landing.view.promo.article.header")}),i.jsx("hr",{className:"w-100 my-0"})]}),i.jsx("div",{className:"d-flex flex-row mb-1",children:t&&t.length>0&&t.map((n,o)=>i.jsx("div",{className:"promo-articles-bullet cursor-pointer "+(n===t[s]?"promo-articles-bullet-active":""),onClick:l=>r(o)},n.id))}),t&&t[s]&&i.jsxs("div",{className:"promo-article d-flex flex-row row mx-0",children:[i.jsx("div",{className:"promo-article-image",style:{backgroundImage:`url(${t[s].imageUrl})`}}),i.jsxs("div",{className:"col-3 d-flex flex-column h-100",children:[i.jsx("h3",{className:"my-0",children:t[s].title}),i.jsx("b",{children:t[s].bodyText}),i.jsx("button",{className:"btn btn-sm mt-auto btn-gainsboro",onClick:n=>Jl(t[s].linkContent),children:t[s].buttonText})]})]})]}):null},YJ=a=>{const{conf:t=null}=a,e=s=>{const r=t[s];if(!r)return null;switch(s){case"image":return jt().interpolate(r)}return r};return i.jsxs("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[i.jsx("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${e("image")})`}}),i.jsxs("div",{className:"d-flex flex-column align-self-center",children:[i.jsx("h3",{className:"my-0",children:g(`landing.view.${e("texts")}.header`)}),i.jsx("i",{children:g(`landing.view.${e("texts")}.body`)}),i.jsx("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:s=>Jl(e("btnLink")),children:g(`landing.view.${e("texts")}.button`)})]})]})},zJ=a=>{switch(a.widgetType){case"promoarticle":return i.jsx(WJ,{});case"achievementcompetition_hall_of_fame":return i.jsx(HJ,{slot:a.slot,conf:a.widgetConf});case"bonusrare":return i.jsx(BJ,{});case"widgetcontainer":return i.jsx(YJ,{conf:a.widgetConf});default:return null}},KJ=a=>{const{widgetType:t=null,widgetSlot:e=0,widgetConf:s=null,className:r="",...n}=a;return i.jsx("div",{className:`widget-slot slot-${e} ${r||""}`,...n,children:i.jsx(zJ,{widgetType:t,slot:e,widgetConf:s})})},XJ=()=>{const[a,t]=_.useState(!0);if(ft([yt.CREATED,yt.ENDED],n=>{switch(n.type){case yt.CREATED:t(!1);return;case yt.ENDED:t(n.openLandingView);return}}),!a)return null;const e=ct("hotelview").images["background.colour"],s=n=>i.jsx(KJ,{widgetSlot:n,widgetType:ct("hotelview").widgets[`slot.${n}.widget`],widgetConf:ct("hotelview").widgets[`slot.${n}.conf`],className:n===6?"mt-auto":n%2===0?"col-5":"col-7"},n),r=[1,2,3,4,5,6,7].map(n=>s(n));return i.jsx("div",{className:"nitro-hotel-view",style:e?{background:e}:{},children:i.jsx("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:i.jsxs("div",{className:"row h-100",children:[i.jsx("div",{className:"col-9 h-100 d-flex flex-column",children:r.slice(0,6)}),i.jsx("div",{className:"col-3 h-100",children:r[6]})]})})})},qJ=a=>{const[t,e]=_.useState(!0);to();const r=new Date().getHours(),n=r>5&&r<=9,o=r>9&&r<=16,l=r>16&&r<=19,c=r>19&&r<=23,u=r>23||r<=5;return ft([yt.CREATED,yt.ENDED],h=>{switch(h.type){case yt.CREATED:e(!1);return;case yt.ENDED:e(h.openLandingView);return}}),t?i.jsxs("div",{children:[i.jsx(XJ,{}),n&&i.jsx(jJ,{}),o&&i.jsx(wJ,{}),l&&i.jsx(FJ,{}),c&&i.jsx(GJ,{}),u&&i.jsx(kJ,{})]}):null},wA=a=>{const{badgeCode:t=null,children:e=null,...s}=a,{selectedBadgeCode:r=null,setSelectedBadgeCode:n=null,toggleBadge:o=null,getBadgeId:l=null}=eE(),{isUnseen:c=null}=vr(),u=c(as.BADGE,l(t));return i.jsxs($t,{itemActive:r===t,itemUnseen:u,onMouseDown:h=>n(t),onDoubleClick:h=>o(r),...s,children:[i.jsx(Xe,{badgeCode:t}),e]})},QJ=a=>{const[t,e]=_.useState(!1),{badgeCodes:s=[],activeBadgeCodes:r=[],selectedBadgeCode:n=null,isWearingBadge:o=null,canWearBadges:l=null,toggleBadge:c=null,getBadgeId:u=null,activate:h=null,deactivate:d=null}=eE(),{isUnseen:f=null,removeUnseen:E=null}=vr();return _.useEffect(()=>{!n||!f(as.BADGE,u(n))||E(as.BADGE,u(n))},[n,f,E,u]),_.useEffect(()=>{if(!t)return;const m=h();return()=>d(m)},[t,h,d]),_.useEffect(()=>(e(!0),()=>e(!1)),[]),i.jsxs(pt,{children:[i.jsx(N,{size:7,overflow:"hidden",children:i.jsx(Fe,{columnCount:4,children:s&&s.length>0&&s.map((m,I)=>o(m)?null:i.jsx(wA,{badgeCode:m},I))})}),i.jsxs(N,{className:"justify-content-between",size:5,overflow:"auto",children:[i.jsxs(N,{overflow:"hidden",gap:2,children:[i.jsx(O,{children:g("inventory.badges.activebadges")}),i.jsx(Fe,{columnCount:3,children:r&&r.length>0&&r.map((m,I)=>i.jsx(wA,{badgeCode:m},I))})]}),!!n&&i.jsxs(N,{grow:!0,justifyContent:"end",gap:2,children:[i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsx(Xe,{shrink:!0,badgeCode:n}),i.jsx(O,{children:vd(n)})]}),i.jsx(W,{variant:o(n)?"danger":"success",disabled:!o(n)&&!l(),onClick:m=>c(n),children:g(o(n)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},KS=a=>{const{title:t="",desc:e="",children:s=null,...r}=a;return i.jsxs(pt,{...r,children:[i.jsx(N,{center:!0,size:5,overflow:"hidden",children:i.jsx("div",{className:"empty-image"})}),i.jsxs(N,{justifyContent:"center",size:7,overflow:"hidden",children:[i.jsx(O,{fontWeight:"bold",fontSize:5,overflow:"unset",truncate:!0,children:t}),i.jsx(O,{overflow:"auto",children:e})]}),s]})},JJ=a=>{const{botItem:t=null,children:e=null,...s}=a,[r,n]=_.useState(!1),{selectedBot:o=null,setSelectedBot:l=null}=TU(),{isUnseen:c=null}=vr(),u=c(as.BOT,t.botData.id),h=d=>{switch(d.type){case lt.MOUSE_DOWN:l(t),n(!0);return;case lt.MOUSE_UP:n(!1);return;case lt.ROLL_OUT:if(!r||o!==t)return;JT(t);return;case"dblclick":JT(t);return}};return i.jsxs($t,{itemActive:o===t,itemUnseen:u,onMouseDown:h,onMouseUp:h,onMouseOut:h,onDoubleClick:h,...s,children:[i.jsx(os,{figure:t.botData.figure,direction:3,headOnly:!0}),e]})},ZJ=a=>{const{roomSession:t=null,roomPreviewer:e=null}=a,[s,r]=_.useState(!1),{botItems:n=[],selectedBot:o=null,activate:l=null,deactivate:c=null}=TU(),{isUnseen:u=null,removeUnseen:h=null}=vr();return _.useEffect(()=>{if(!o||!e)return;const d=o.botData,f=rt();let E=f.getRoomInstanceVariable(f.activeRoomId,A.ROOM_WALL_TYPE),m=f.getRoomInstanceVariable(f.activeRoomId,A.ROOM_FLOOR_TYPE),I=f.getRoomInstanceVariable(f.activeRoomId,A.ROOM_LANDSCAPE_TYPE);E=E&&E.length?E:"101",m=m&&m.length?m:"101",I=I&&I.length?I:"1.1",e.reset(!1),e.updateRoomWallsAndFloorVisibility(!0,!0),e.updateObjectRoom(m,E,I),e.addAvatarIntoRoom(d.figure,0)},[e,o]),_.useEffect(()=>{!o||!u(as.BOT,o.botData.id)||h(as.BOT,o.botData.id)},[o,u,h]),_.useEffect(()=>{if(!s)return;const d=l();return()=>c(d)},[s,l,c]),_.useEffect(()=>(r(!0),()=>r(!1)),[]),!n||!n.length?i.jsx(KS,{title:g("inventory.empty.bots.title"),desc:g("inventory.empty.bots.desc")}):i.jsxs(pt,{children:[i.jsx(N,{size:7,overflow:"hidden",children:i.jsx(Fe,{columnCount:5,children:n&&n.length>0&&n.map(d=>i.jsx(JJ,{botItem:d},d.botData.id))})}),i.jsxs(N,{size:5,overflow:"auto",children:[i.jsx(N,{overflow:"hidden",position:"relative",children:i.jsx(rE,{roomPreviewer:e,height:140})}),o&&i.jsxs(N,{grow:!0,justifyContent:"between",gap:2,children:[i.jsx(O,{grow:!0,truncate:!0,children:o.botData.name}),!!t&&i.jsx(W,{variant:"success",onClick:d=>JT(o),children:g("inventory.furni.placetoroom")})]})]})]})},$J=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(1),[n,o]=_.useState("1"),[l,c]=_.useState(1),u=m=>{let I=parseInt(m);isNaN(I)||I===s||(I=Math.max(I,1),I=Math.min(I,l),I!==s&&(o(I.toString()),r(I)))},{showConfirm:h=null}=Ye();if(_s(bg.DELETE_ITEM_CONFIRM,m=>{e(m.item),c(m.amount)}),!t)return null;const d=t?g(t.isWallItem?"wallItem.name."+t.type:"roomItem.name."+t.type):"",f=t?g(t.isWallItem?"wallItem.desc."+t.type:"roomItem.desc."+t.type):"",E=()=>{t&&h(g("inventory.delete.confirm_delete.info",["furniname","amount"],[d,s.toString()]),()=>{H(new PD(t.id,s)),e(null),r(1),c(1),o("1")},()=>{e(null),r(1),c(1),o("1")},null,null,g("inventory.delete.confirm_delete.title"))};return i.jsxs(Ct,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("inventory.delete.confirm_delete.title"),onCloseClick:m=>{e(null),r(1),c(1),o("1")}}),i.jsx(It,{overflow:"hidden",children:i.jsxs(pt,{fullHeight:!0,children:[i.jsx(N,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:i.jsx(iE,{productType:t.isWallItem?kt.WALL:kt.FLOOR,productClassId:t.type,extraData:t.extra.toString()})}),i.jsxs(N,{size:8,justifyContent:"between",overflow:"hidden",children:[i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{fontWeight:"bold",children:d}),i.jsx(O,{truncate:!0,shrink:!0,children:f})]}),i.jsxs(N,{overflow:"auto",children:[i.jsx(O,{children:g("inventory.delete.amount")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(dR,{className:"text-black cursor-pointer fa-icon",onClick:m=>u((s-1).toString())}),i.jsx("input",{className:"form-control form-control-sm quantity-input",type:"number",min:1,max:l,value:n,onChange:m=>u(m.target.value),placeholder:g("inventory.delete.amount")}),i.jsx(_R,{className:"text-black cursor-pointer fa-icon",onClick:m=>u((s+1).toString())}),i.jsx(W,{onClick:m=>u(l.toString()),children:g("inventory.delete.max_amount.button")})]}),i.jsx(W,{disabled:s>l,onClick:E,children:g("inventory.delete.confirm_delete.button")})]})]})]})})]})},tZ=a=>{const{groupItem:t=null,...e}=a,[s,r]=_.useState(!1),{selectedItem:n=null,setSelectedItem:o=null}=tc(),l=u=>{switch(u.type){case lt.MOUSE_DOWN:o(t),r(!0);return;case lt.MOUSE_UP:r(!1);return;case lt.ROLL_OUT:if(!s||t!==n)return;Mu(t);return;case"dblclick":Mu(t);return}},c=t.getUnlockedCount();return i.jsx($t,{className:c?"":"opacity-0-5 ",itemImage:t.iconUrl,itemCount:t.getUnlockedCount(),itemActive:t===n,itemUniqueNumber:t.stuffData.uniqueNumber,itemUnseen:t.hasUnseenItems,onMouseDown:l,onMouseUp:l,onMouseOut:l,onDoubleClick:l,...e})},QU=a=>{const{groupItems:t=[],setGroupItems:e=null}=a,[s,r]=_.useState("");return _.useEffect(()=>{let n=[...t];if(s&&s.length){const o=s.toLocaleLowerCase();n=t.filter(l=>o&&o.length&&l.name.toLocaleLowerCase().includes(o)?l:null)}e(n)},[t,e,s]),i.jsxs(x,{gap:1,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:s,onChange:n=>r(n.target.value)}),i.jsx(W,{variant:"primary",children:i.jsx(hR,{className:"fa-icon"})})]})},DE="inventory.filter.option.everything",FA="inventory.furni.tab.floor",GA="inventory.furni.tab.wall",kA="inventory.furni.tab.wired",eZ=a=>{const t=a.getLastItem();if(!t||!t.sellable)return!1;Ps(new Mg(t))},sZ=a=>{const t=a.getLastItem();if(!t)return!1;Ps(new bg(t,a.getTotalCount()))},iZ=a=>{const{roomSession:t=null,roomPreviewer:e=null}=a,[s,r]=_.useState(!1),[n,o]=_.useState([]),{groupItems:l=[],selectedItem:c=null,activate:u=null,deactivate:h=null}=tc(),{resetItems:d=null}=vr(),[f=string,E]=_.useState(DE);return _.useEffect(()=>{const m=l.filter(I=>{const p=I.isWallItem,T=!p,R=I.name.startsWith("WIRED");switch(f){case GA:return p;case FA:return T;case kA:return R;case DE:default:return!0}});o(m)},[l,f]),_.useEffect(()=>{if(!c||!e)return;const m=c.getLastItem();if(!m)return;const I=rt();let p=I.getRoomInstanceVariable(I.activeRoomId,A.ROOM_WALL_TYPE),T=I.getRoomInstanceVariable(I.activeRoomId,A.ROOM_FLOOR_TYPE),R=I.getRoomInstanceVariable(I.activeRoomId,A.ROOM_LANDSCAPE_TYPE);if(p=p&&p.length?p:"101",T=T&&T.length?T:"101",R=R&&R.length?R:"1.1",e.reset(!1),e.updateObjectRoom(T,p,R),e.updateRoomWallsAndFloorVisibility(!0,!0),m.category===Dt.WALL_PAPER||m.category===Dt.FLOOR||m.category===Dt.LANDSCAPE){if(T=m.category===Dt.FLOOR?c.stuffData.getLegacyString():T,p=m.category===Dt.WALL_PAPER?c.stuffData.getLegacyString():p,R=m.category===Dt.LANDSCAPE?c.stuffData.getLegacyString():R,e.updateObjectRoom(T,p,R),m.category===Dt.LANDSCAPE){const S=tt().getWallItemDataByName("window_double_default");S&&e.addWallItemIntoRoom(S.id,new w(90,0,0),S.customParams)}}else c.isWallItem?e.addWallItemIntoRoom(c.type,new w(90),m.stuffData.getLegacyString()):e.addFurnitureIntoRoom(c.type,new w(90),c.stuffData,m.extra.toString())},[e,c]),_.useEffect(()=>{!c||!c.hasUnseenItems||(d(as.FURNI,c.items.map(m=>m.id)),c.hasUnseenItems=!1)},[c,d]),_.useEffect(()=>{if(!s)return;const m=u();return()=>h(m)},[s,u,h]),_.useEffect(()=>(r(!0),()=>r(!1)),[]),!l||!l.length?i.jsx(KS,{title:g("inventory.empty.title"),desc:g("inventory.empty.desc")}):i.jsxs(pt,{children:[i.jsxs(N,{size:7,overflow:"hidden",children:[i.jsx(QU,{groupItems:l,setGroupItems:o}),i.jsx("select",{className:"form-select form-select-sm",value:f,onChange:m=>E(m.target.value),children:[DE,FA,GA,kA].map(m=>i.jsx("option",{value:m,children:g(m)},m))}),i.jsx(Fe,{columnCount:5,children:n&&n.length>0&&n.map((m,I)=>i.jsx(tZ,{groupItem:m},I))})]}),i.jsxs(N,{size:5,overflow:"auto",children:[i.jsxs(N,{overflow:"hidden",position:"relative",children:[i.jsx(rE,{roomPreviewer:e,height:140}),c&&i.jsx(W,{variant:"danger",className:"bottom-2 end-2",position:"absolute",onClick:m=>sZ(c),children:i.jsx(D0,{className:"fa-icon"})}),c&&c.stuffData.isUnique&&i.jsx(DU,{className:"top-2 end-2",position:"absolute",uniqueNumber:c.stuffData.uniqueNumber,uniqueSeries:c.stuffData.uniqueSeries}),c&&c.stuffData.rarityLevel>-1&&i.jsx(HS,{className:"top-2 end-2",position:"absolute",level:c.stuffData.rarityLevel})]}),c&&i.jsxs(N,{grow:!0,justifyContent:"between",gap:2,children:[i.jsx(O,{grow:!0,children:c.name}),i.jsxs(N,{gap:1,children:[!!t&&i.jsx(W,{variant:"success",onClick:m=>Mu(c),children:g("inventory.furni.placetoroom")}),c&&c.isSellable&&i.jsx(W,{onClick:m=>eZ(c),children:g("inventory.marketplace.sell")})]})]})]})]})},vE=9,rZ=a=>{const{cancelTrade:t=null}=a,[e,s]=_.useState(null),[r,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(null),[h,d]=_.useState(3),[f,E]=_.useState(1),{ownUser:m=null,otherUser:I=null,groupItems:p=[],tradeState:T=Fs.TRADING_STATE_READY,progressTrade:R=null,removeItem:S=null,setTradeState:L=null}=SU(),{simpleAlert:M=null}=Ye(),P=(U,K,B,J,Z)=>{if(!m||m.accepts||!m.userItems)return!1;if(m.userItems.length<vE)return!0;if(!J)return!1;let Q=K.toString();return B===Dt.POSTER?Q=Q+"poster"+Z.getLegacyString():B===Dt.GUILD_FURNI?Q=bq(K,Z):Q=(U?"I":"S")+Q,!!m.userItems.getValue(Q)},k=U=>{if(!e)return;const K=e.getTradeItems(U);if(!K||!K.length)return;let B=null;const J=[];for(const Q of K)J.push(Q.id),B||(B=Q);if(m.userItems.length+J.length<=1500)if(!B.isGroupable&&J.length)H(new kI(J.pop()));else{const Q=[];for(const ut of J)P(B.isWallItem,B.type,B.category,B.isGroupable,B.stuffData)&&Q.push(ut);Q.length&&(Q.length===1?H(new kI(Q.pop())):H(new GD(...Q)))}else M(g("trading.items.too_many_items.desc"),Yt.DEFAULT,null,null,g("trading.items.too_many_items.title"))},G=U=>U?i.jsx(PN,{className:"text-success fa-icon"}):i.jsx(v0,{className:"text-danger fa-icon"}),j=(U,K)=>{(isNaN(Number(U))||Number(U)<0||!U)&&(U=1),U=Math.max(Number(U),1),U=Math.min(Number(U),K),U!==f&&E(U)},F=U=>{j(f,U),k(f)};return _.useEffect(()=>{E(1)},[e]),_.useEffect(()=>{if(T!==Fs.TRADING_STATE_COUNTDOWN)return;d(3);const U=setInterval(()=>{d(K=>{const B=K-1;return B===0&&clearInterval(U),B})},1e3);return()=>clearInterval(U)},[T,L]),_.useEffect(()=>{h===0&&L(Fs.TRADING_STATE_CONFIRMING)},[h,L]),T===Fs.TRADING_STATE_READY||!m||!I?null:i.jsxs(pt,{children:[i.jsxs(N,{size:4,overflow:"hidden",children:[i.jsx(QU,{groupItems:p,setGroupItems:u}),i.jsxs(x,{column:!0,fullHeight:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[i.jsx(Fe,{columnCount:3,children:c&&c.length>0&&c.map((U,K)=>{const B=U.getUnlockedCount();return i.jsx($t,{className:B?"":"opacity-0-5 ",itemImage:U.iconUrl,itemCount:B,itemActive:e===U,itemUniqueNumber:U.stuffData.uniqueNumber,onClick:J=>B&&s(U),onDoubleClick:J=>k(1),children:B>0&&e===U&&i.jsx(W,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:J=>k(1),children:i.jsx(cr,{className:"fa-icon"})})},K)})}),i.jsxs(N,{gap:1,alignItems:"end",children:[i.jsxs(pt,{overflow:"hidden",children:[i.jsx(N,{size:6,overflow:"hidden",children:i.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:g("catalog.bundlewidget.spinner.select.amount"),disabled:!e,value:f,onChange:U=>E(U.target.valueAsNumber)})}),i.jsx(N,{size:6,overflow:"hidden",children:i.jsx(W,{variant:"secondary",disabled:!e,onClick:U=>F(e.getUnlockedCount()),children:g("inventory.trading.areoffering")})})]}),i.jsx(V,{fullWidth:!0,className:"badge bg-muted",children:e?e.name:g("catalog_selectproduct")})]})]})]}),i.jsxs(N,{size:8,overflow:"hidden",children:[i.jsxs(pt,{overflow:"hidden",children:[i.jsxs(N,{size:6,overflow:"hidden",children:[i.jsxs(x,{justifyContent:"between",alignItems:"center",children:[i.jsxs(O,{children:[g("inventory.trading.you")," ",g("inventory.trading.areoffering"),":"]}),G(m.accepts)]}),i.jsx(Fe,{columnCount:3,children:Array.from(Array(vE),(U,K)=>{const B=m.userItems.getWithIndex(K)||null;return B?i.jsx($t,{itemActive:r===B,itemImage:B.iconUrl,itemCount:B.getTotalCount(),itemUniqueNumber:B.stuffData.uniqueNumber,onClick:J=>n(B),onDoubleClick:J=>S(B),children:r===B&&i.jsx(W,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:J=>S(B),children:i.jsx(lr,{className:"fa-icon"})})},K):i.jsx($t,{},K)})}),i.jsx(V,{fullWidth:!0,className:"badge bg-muted",children:r?r.name:g("catalog_selectproduct")})]}),i.jsxs(N,{size:6,overflow:"hidden",children:[i.jsxs(x,{justifyContent:"between",alignItems:"center",children:[i.jsxs(O,{children:[I.userName," ",g("inventory.trading.isoffering"),":"]}),G(I.accepts)]}),i.jsx(Fe,{columnCount:3,children:Array.from(Array(vE),(U,K)=>{const B=I.userItems.getWithIndex(K)||null;return B?i.jsx($t,{itemActive:o===B,itemImage:B.iconUrl,itemCount:B.getTotalCount(),itemUniqueNumber:B.stuffData.uniqueNumber,onClick:J=>l(B)},K):i.jsx($t,{},K)})}),i.jsx(V,{fullWidth:!0,className:"badge bg-muted w-100",children:o?o.name:g("catalog_selectproduct")})]})]}),i.jsxs(x,{grow:!0,justifyContent:"between",children:[i.jsx(W,{variant:"danger",onClick:t,children:g("generic.cancel")}),T===Fs.TRADING_STATE_READY&&i.jsx(W,{variant:"secondary",disabled:!m.itemCount&&!I.itemCount,onClick:R,children:g("inventory.trading.accept")}),T===Fs.TRADING_STATE_RUNNING&&i.jsx(W,{variant:"secondary",disabled:!m.itemCount&&!I.itemCount,onClick:R,children:g(m.accepts?"inventory.trading.modify":"inventory.trading.accept")}),T===Fs.TRADING_STATE_COUNTDOWN&&i.jsx(W,{variant:"secondary",disabled:!0,children:g("inventory.trading.countdown",["counter"],[h.toString()])}),T===Fs.TRADING_STATE_CONFIRMING&&i.jsx(W,{variant:"secondary",onClick:R,children:g("inventory.trading.button.restore")}),T===Fs.TRADING_STATE_CONFIRMED&&i.jsx(W,{variant:"secondary",children:g("inventory.trading.info.waiting")})]})]})]})},nZ=a=>{const{petItem:t=null,children:e=null,...s}=a,[r,n]=_.useState(!1),{selectedPet:o=null,setSelectedPet:l=null}=RU(),{isUnseen:c}=vr(),u=c(as.PET,t.petData.id),h=d=>{switch(d.type){case lt.MOUSE_DOWN:l(t),n(!0);return;case lt.MOUSE_UP:n(!1);return;case lt.ROLL_OUT:if(!r||t!==o)return;QT(t);return;case"dblclick":QT(t);return}};return i.jsxs($t,{itemActive:t===o,itemUnseen:u,onMouseDown:h,onMouseUp:h,onMouseOut:h,onDoubleClick:h,...s,children:[i.jsx(ia,{figure:t.petData.figureData.figuredata,direction:3,headOnly:!0}),e]})},aZ=a=>{const{roomSession:t=null,roomPreviewer:e=null}=a,[s,r]=_.useState(!1),{petItems:n=null,selectedPet:o=null,activate:l=null,deactivate:c=null}=RU(),{isUnseen:u=null,removeUnseen:h=null}=vr();return _.useEffect(()=>{if(!o||!e)return;const d=o.petData,f=rt();let E=f.getRoomInstanceVariable(f.activeRoomId,A.ROOM_WALL_TYPE),m=f.getRoomInstanceVariable(f.activeRoomId,A.ROOM_FLOOR_TYPE),I=f.getRoomInstanceVariable(f.activeRoomId,A.ROOM_LANDSCAPE_TYPE);E=E&&E.length?E:"101",m=m&&m.length?m:"101",I=I&&I.length?I:"1.1",e.reset(!1),e.updateRoomWallsAndFloorVisibility(!0,!0),e.updateObjectRoom(m,E,I),e.addPetIntoRoom(d.figureString)},[e,o]),_.useEffect(()=>{!o||!u(as.PET,o.petData.id)||h(as.PET,o.petData.id)},[o,u,h]),_.useEffect(()=>{if(!s)return;const d=l();return()=>c(d)},[s,l,c]),_.useEffect(()=>(r(!0),()=>r(!1)),[]),!n||!n.length?i.jsx(KS,{title:g("inventory.empty.pets.title"),desc:g("inventory.empty.pets.desc")}):i.jsxs(pt,{children:[i.jsx(N,{size:7,overflow:"hidden",children:i.jsx(Fe,{columnCount:5,children:n&&n.length>0&&n.map(d=>i.jsx(nZ,{petItem:d},d.petData.id))})}),i.jsxs(N,{size:5,overflow:"auto",children:[i.jsx(N,{overflow:"hidden",position:"relative",children:i.jsx(rE,{roomPreviewer:e,height:140})}),o&&o.petData&&i.jsxs(N,{grow:!0,justifyContent:"between",gap:2,children:[i.jsx(O,{grow:!0,truncate:!0,children:o.petData.name}),!!t&&i.jsx(W,{variant:"success",onClick:d=>QT(o),children:g("inventory.furni.placetoroom")})]})]})]})},JU="inventory.furni",ZU="inventory.bots",$U="inventory.furni.tab.pets",t0="inventory.badges",BA=[JU,ZU,$U,t0],oZ=[as.FURNI,as.BOT,as.PET,as.BADGE],lZ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(BA[0]),[n,o]=_.useState(null),[l,c]=_.useState(null),{isTrading:u=!1,stopTrading:h=null}=SU(),{getCount:d=null,resetCategory:f=null}=vr(),E=()=>{u&&h(),e(!1)};return ft(Ot.PLACED,m=>{Cq()&&(Pd(!1),m.placedInRoom||e(!0))}),ft([yt.CREATED,yt.ENDED],m=>{switch(m.type){case yt.CREATED:o(m.session);return;case yt.ENDED:o(null),e(!1);return}}),z(BR,m=>{const I=m.getParser();for(const p of I.data)Tn().setBadgePointLimit(p.badgeId,p.limit)}),_.useEffect(()=>{const m={linkReceived:I=>{const p=I.split("/");if(!(p.length<2))switch(p[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(T=>!T);return}},eventUrlPrefix:"inventory/"};return As(m),()=>Ns(m)},[]),_.useEffect(()=>(c(new xu(rt(),++xu.PREVIEW_COUNTER)),()=>{c(m=>(m.dispose(),null))}),[]),_.useEffect(()=>{!t&&u&&e(!0)},[t,u]),t?i.jsxs(Ct,{uniqueKey:"inventory",className:"nitro-inventory",theme:u?"primary-slim":"",children:[i.jsx(Nt,{headerText:g("inventory.title"),onCloseClick:E}),!u&&i.jsxs(i.Fragment,{children:[i.jsx(eo,{children:BA.map((m,I)=>i.jsx(Ia,{isActive:s===m,onClick:p=>r(m),count:d(oZ[I]),children:g(m)},I))}),i.jsxs(It,{children:[s===JU&&i.jsx(iZ,{roomSession:n,roomPreviewer:l}),s===ZU&&i.jsx(ZJ,{roomSession:n,roomPreviewer:l}),s===$U&&i.jsx(aZ,{roomSession:n,roomPreviewer:l}),s===t0&&i.jsx(QJ,{})]}),i.jsx($J,{})]}),u&&i.jsx(It,{children:i.jsx(rZ,{cancelTrade:E})})]}):null},XS=a=>{const{records:t=null}=a,{openRoomInfo:e=null}=vu(),s=_.useMemo(()=>{const n=[];return t.forEach(o=>{n.push({isRoomInfo:!0,roomId:o.roomId,roomName:o.roomName}),o.chatlog.forEach(l=>{n.push({timestamp:l.timestamp,habboId:l.userId,username:l.userName,hasHighlighting:l.hasHighlighting,message:l.message,isRoomInfo:!1})})}),n},[t]),r=n=>i.jsxs(x,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted rounded p-1",children:[i.jsxs(x,{gap:1,children:[i.jsx(O,{bold:!0,children:"Room name:"}),i.jsx(O,{children:n.roomName})]}),i.jsxs(x,{gap:1,children:[i.jsx(W,{onClick:o=>Li(n.roomId),children:"Visit Room"}),i.jsx(W,{onClick:o=>e(n.roomId),children:"Room Tools"})]})]});return i.jsx(i.Fragment,{children:i.jsxs(N,{fit:!0,gap:0,overflow:"hidden",children:[i.jsx(N,{gap:2,children:i.jsxs(pt,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[i.jsx(V,{className:"g-col-2",children:"Time"}),i.jsx(V,{className:"g-col-3",children:"User"}),i.jsx(V,{className:"g-col-7",children:"Message"})]})}),t&&t.length>0&&i.jsx(sE,{rows:s,rowRender:n=>i.jsxs(i.Fragment,{children:[n.isRoomInfo&&i.jsx(r,{roomId:n.roomId,roomName:n.roomName}),!n.isRoomInfo&&i.jsxs(pt,{fullHeight:!1,gap:1,alignItems:"center",className:"log-entry py-1 border-bottom",children:[i.jsx(O,{className:"g-col-2",children:n.timestamp}),i.jsx(O,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:o=>ht(`mod-tools/open-user-info/${n.habboId}`),children:n.username}),i.jsx(O,{textBreak:!0,wrap:!0,className:"g-col-7",children:n.message})]})]})})]})})},cZ=a=>{const{roomId:t=null,onCloseClick:e=null}=a,[s,r]=_.useState(null);return z(sy,n=>{const o=n.getParser();!o||o.data.roomId!==t||r(o.data)}),_.useEffect(()=>{H(new sv(t))},[t]),s?i.jsxs(Ct,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:oi.TOP_LEFT,children:[i.jsx(Nt,{headerText:`Room Chatlog ${s.roomName}`,onCloseClick:e}),i.jsx(It,{className:"text-black",overflow:"hidden",children:s&&i.jsx(XS,{records:[s]})})]}):null},uZ=a=>{const{roomId:t=null,onCloseClick:e=null}=a,[s,r]=_.useState(!1),[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(null),[d,f]=_.useState(null),[E,m]=_.useState(!1),[I,p]=_.useState(0),[T,R]=_.useState(!1),[S,L]=_.useState(!1),[M,P]=_.useState(!1),[k,G]=_.useState(""),j=(F,U)=>{if(F)switch(F){case"alert_only":if(k.trim().length===0)return;H(new bl(bl.ACTION_ALERT,k,"")),H(new VI(t,S?1:0,M?1:0,T?1:0));return;case"send_message":if(k.trim().length===0)return;H(new bl(bl.ACTION_MESSAGE,k,"")),H(new VI(t,S?1:0,M?1:0,T?1:0));return}};return z($x,F=>{const U=F.getParser();!U||U.data.flatId!==t||(o(U.data.flatId),c(U.data.room.name),h(U.data.ownerId),f(U.data.ownerName),m(U.data.ownerInRoom),p(U.data.userCount))}),_.useEffect(()=>{s||(H(new tv(t)),r(!0))},[t,s,r]),i.jsxs(Ct,{className:"nitro-mod-tools-room",theme:"primary-slim",windowPosition:oi.TOP_LEFT,children:[i.jsx(Nt,{headerText:"Room Info"+(l?": "+l:""),onCloseClick:F=>e()}),i.jsxs(It,{className:"text-black",children:[i.jsxs(x,{gap:2,children:[i.jsxs(N,{justifyContent:"center",grow:!0,gap:1,children:[i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsx(O,{bold:!0,align:"end",className:"col-7",children:"Room Owner:"}),i.jsx(O,{underline:!0,pointer:!0,truncate:!0,children:d})]}),i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsx(O,{bold:!0,align:"end",className:"col-7",children:"Users in room:"}),i.jsx(O,{children:I})]}),i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsx(O,{bold:!0,align:"end",className:"col-7",children:"Owner in room:"}),i.jsx(O,{children:E?"Yes":"No"})]})]}),i.jsxs(N,{gap:1,children:[i.jsx(W,{onClick:F=>Li(t),children:"Visit Room"}),i.jsx(W,{onClick:F=>ht(`mod-tools/open-room-chatlog/${t}`),children:"Chatlog"})]})]}),i.jsxs(N,{className:"bg-muted rounded p-2",gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:T,onChange:F=>R(F.target.checked)}),i.jsx(O,{small:!0,children:"Kick everyone out"})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:S,onChange:F=>L(F.target.checked)}),i.jsx(O,{small:!0,children:"Enable the doorbell"})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:M,onChange:F=>P(F.target.checked)}),i.jsx(O,{small:!0,children:"Change room name"})]})]}),i.jsx("textarea",{className:"form-control",placeholder:"Type a mandatory message to the users in this text box...",value:k,onChange:F=>G(F.target.value)}),i.jsxs(x,{justifyContent:"between",children:[i.jsx(W,{variant:"danger",onClick:F=>j("send_message"),children:"Send Caution"}),i.jsx(W,{onClick:F=>j("alert_only"),children:"Send Alert only"})]})]})]})},hZ=a=>{const{onCloseClick:t=null,issueId:e=null}=a,[s,r]=_.useState(null);return z(Yx,n=>{const o=n.getParser();!o||o.data.issueId!==e||r(o.data)}),_.useEffect(()=>{H(new $D(e))},[e]),i.jsxs(Ct,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",children:[i.jsx(Nt,{headerText:"Issue Chatlog",onCloseClick:t}),i.jsx(It,{className:"text-black",children:s&&i.jsx(XS,{records:[s.chatRecord]})})]})},dZ=a=>{const{issueId:t=null,onIssueInfoClosed:e=null}=a,[s,r]=_.useState(!1),{tickets:n=[],openUserInfo:o=null}=vu(),l=n.find(h=>h.issueId===t),c=h=>{H(new nS([h])),e(h)},u=h=>{H(new Ml([t],h)),e(t)};return i.jsxs(i.Fragment,{children:[i.jsxs(Ct,{className:"nitro-mod-tools-handle-issue",theme:"primary-slim",children:[i.jsx(Nt,{headerText:"Resolving issue "+t,onCloseClick:()=>e(t)}),i.jsxs(It,{className:"text-black",children:[i.jsx(O,{fontSize:4,children:"Issue Information"}),i.jsxs(pt,{overflow:"auto",children:[i.jsx(N,{size:8,children:i.jsx("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("th",{children:"Source"}),i.jsx("td",{children:Dq(l.categoryId)})]}),i.jsxs("tr",{children:[i.jsx("th",{children:"Category"}),i.jsx("td",{className:"text-break",children:g("help.cfh.topic."+l.reportedCategoryId)})]}),i.jsxs("tr",{children:[i.jsx("th",{children:"Description"}),i.jsx("td",{className:"text-break",children:l.message})]}),i.jsxs("tr",{children:[i.jsx("th",{children:"Caller"}),i.jsx("td",{children:i.jsx(O,{bold:!0,underline:!0,pointer:!0,onClick:h=>o(l.reporterUserId),children:l.reporterUserName})})]}),i.jsxs("tr",{children:[i.jsx("th",{children:"Reported User"}),i.jsx("td",{children:i.jsx(O,{bold:!0,underline:!0,pointer:!0,onClick:h=>o(l.reportedUserId),children:l.reportedUserName})})]})]})})}),i.jsxs(N,{size:4,gap:1,children:[i.jsx(W,{variant:"secondary",onClick:()=>r(!s),children:"Chatlog"}),i.jsx(W,{onClick:h=>u(Ml.RESOLUTION_USELESS),children:"Close as useless"}),i.jsx(W,{variant:"danger",onClick:h=>u(Ml.RESOLUTION_ABUSIVE),children:"Close as abusive"}),i.jsx(W,{variant:"success",onClick:h=>u(Ml.RESOLUTION_RESOLVED),children:"Close as resolved"}),i.jsx(W,{variant:"secondary",onClick:h=>c(t),children:"Release"})]})]})]})]}),s&&i.jsx(hZ,{issueId:t,onCloseClick:()=>r(!1)})]})},_Z=a=>{const{myIssues:t=null,handleIssue:e=null}=a;return i.jsxs(N,{gap:0,overflow:"hidden",children:[i.jsx(N,{gap:2,children:i.jsxs(pt,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[i.jsx(V,{className:"g-col-2",children:"Type"}),i.jsx(V,{className:"g-col-3",children:"Room/Player"}),i.jsx(V,{className:"g-col-3",children:"Opened"}),i.jsx(V,{className:"g-col-2"}),i.jsx(V,{className:"g-col-2"})]})}),i.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:t&&t.length>0&&t.map(s=>i.jsxs(pt,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[i.jsx(V,{className:"g-col-2",children:s.categoryId}),i.jsx(V,{className:"g-col-3",children:s.reportedUserName}),i.jsx(V,{className:"g-col-3",children:new Date(Date.now()-s.issueAgeInMilliseconds).toLocaleTimeString()}),i.jsx(V,{className:"g-col-2",children:i.jsx(W,{variant:"primary",onClick:r=>e(s.issueId),children:"Handle"})}),i.jsx(V,{className:"g-col-2",children:i.jsx(W,{variant:"danger",onClick:r=>H(new nS([s.issueId])),children:"Release"})})]},s.issueId))})]})},gZ=a=>{const{openIssues:t=null}=a;return i.jsxs(N,{gap:0,overflow:"hidden",children:[i.jsx(N,{gap:2,children:i.jsxs(pt,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[i.jsx(V,{className:"g-col-2",children:"Type"}),i.jsx(V,{className:"g-col-3",children:"Room/Player"}),i.jsx(V,{className:"g-col-4",children:"Opened"}),i.jsx(V,{className:"g-col-3"})]})}),i.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:t&&t.length>0&&t.map(e=>i.jsxs(pt,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[i.jsx(V,{className:"g-col-2",children:e.categoryId}),i.jsx(V,{className:"g-col-3",children:e.reportedUserName}),i.jsx(V,{className:"g-col-4",children:new Date(Date.now()-e.issueAgeInMilliseconds).toLocaleTimeString()}),i.jsx(V,{className:"g-col-3",children:i.jsx(W,{variant:"success",onClick:s=>H(new cv([e.issueId],!1,0,"pick issue button")),children:"Pick Issue"})})]},e.issueId))})]})},fZ=a=>{const{pickedIssues:t=null}=a;return i.jsxs(N,{gap:0,overflow:"hidden",children:[i.jsx(N,{gap:2,children:i.jsxs(pt,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[i.jsx(V,{className:"g-col-2",children:"Type"}),i.jsx(V,{className:"g-col-3",children:"Room/Player"}),i.jsx(V,{className:"g-col-4",children:"Opened"}),i.jsx(V,{className:"g-col-3",children:"Picker"})]})}),i.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:t&&t.length>0&&t.map(e=>i.jsxs(pt,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[i.jsx(V,{className:"g-col-2",children:e.categoryId}),i.jsx(V,{className:"g-col-3",children:e.reportedUserName}),i.jsx(V,{className:"g-col-4",children:new Date(Date.now()-e.issueAgeInMilliseconds).toLocaleTimeString()}),i.jsx(V,{className:"g-col-3",children:e.pickerUserName})]},e.issueId))})]})},mZ=["Open Issues","My Issues","Picked Issues"],EZ=a=>{const{onCloseClick:t=null}=a,[e,s]=_.useState(0),[r,n]=_.useState([]),{tickets:o=[]}=vu(),l=o.filter(E=>E.state===Ul.STATE_OPEN),c=o.filter(E=>E.state===Ul.STATE_PICKED&&E.pickerUserId===tt().userId),u=o.filter(E=>E.state===Ul.STATE_PICKED),h=E=>{n(m=>{const I=[...m],p=I.indexOf(E);return p>=0&&I.splice(p,1),I})},d=E=>{n(m=>{const I=[...m],p=I.indexOf(E);return p===-1?I.push(E):I.splice(p,1),I})},f=()=>{switch(e){case 0:return i.jsx(gZ,{openIssues:l});case 1:return i.jsx(_Z,{myIssues:c,handleIssue:d});case 2:return i.jsx(fZ,{pickedIssues:u})}return null};return i.jsxs(i.Fragment,{children:[i.jsxs(Ct,{className:"nitro-mod-tools-tickets",children:[i.jsx(Nt,{headerText:"Tickets",onCloseClick:t}),i.jsx(eo,{children:mZ.map((E,m)=>i.jsx(Ia,{isActive:e===m,onClick:I=>s(m),children:E},m))}),i.jsx(It,{gap:1,children:i.jsx(f,{})})]}),r&&r.length>0&&r.map(E=>i.jsx(dZ,{issueId:E,onIssueInfoClosed:h},E))]})},pZ=a=>{const{userId:t=null,onCloseClick:e=null}=a,[s,r]=_.useState(null),[n,o]=_.useState(null);return z(ny,l=>{const c=l.getParser();!c||c.data.userId!==t||(o(c.data.username),r(c.data.roomChatlogs))}),_.useEffect(()=>{H(new rv(t))},[t]),i.jsxs(Ct,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:oi.TOP_LEFT,children:[i.jsx(Nt,{headerText:`User Chatlog: ${n||""}`,onCloseClick:e}),i.jsx(It,{className:"text-black h-100",children:s&&i.jsx(XS,{records:s})})]})},VA=[new ke(1,"Alert",ke.ALERT,1,0),new ke(2,"Mute 1h",ke.MUTE,2,0),new ke(3,"Ban 18h",ke.BAN,3,0),new ke(4,"Ban 7 days",ke.BAN,4,0),new ke(5,"Ban 30 days (step 1)",ke.BAN,5,0),new ke(7,"Ban 30 days (step 2)",ke.BAN,7,0),new ke(6,"Ban 100 years",ke.BAN,6,0),new ke(106,"Ban avatar-only 100 years",ke.BAN,6,0),new ke(101,"Kick",ke.KICK,0,0),new ke(102,"Lock trade 1 week",ke.TRADE_LOCK,0,168),new ke(104,"Lock trade permanent",ke.TRADE_LOCK,0,876e3),new ke(105,"Message",ke.MESSAGE,0,0)],IZ=a=>{const{user:t=null,onCloseClick:e=null}=a,[s,r]=_.useState(-1),[n,o]=_.useState(-1),[l,c]=_.useState(""),{cfhCategories:u=null,settings:h=null}=vu(),{simpleAlert:d=null}=Ye(),f=_.useMemo(()=>{const p=[];if(u&&u.length)for(const T of u)for(const R of T.topics)p.push(R);return p},[u]),E=p=>d(p,Yt.DEFAULT,null,null,"Error"),m=()=>{let p=null;const T=f[s];if(s===-1&&(p="You must select a CFH topic"),p)return E(p);const R=l.trim().length===0?g(`help.cfh.topic.${T.id}`):l;H(new ZD(t.userId,s,R)),e()},I=()=>{let p=null;const T=f[s],R=VA[n];if(s===-1||n===-1?p="You must select a CFH topic and Sanction":!h||!h.cfhPermission?p="You do not have permission to do this":T?R||(p="You must select a sanction"):p="You must select a CFH topic",p){E(p);return}const S=l.trim().length===0?g(`help.cfh.topic.${T.id}`):l;switch(R.actionType){case ke.ALERT:{if(!h.alertPermission){E("You have insufficient permissions");return}H(new nv(t.userId,S,T.id));break}case ke.MUTE:H(new ov(t.userId,S,T.id));break;case ke.BAN:{if(!h.banPermission){E("You have insufficient permissions");return}H(new _a(t.userId,S,T.id,n,R.actionId===106));break}case ke.KICK:{if(!h.kickPermission){E("You have insufficient permissions");return}H(new av(t.userId,S,T.id));break}case ke.TRADE_LOCK:{const L=R.actionLengthHours*60;H(new lv(t.userId,S,L,T.id));break}case ke.MESSAGE:{if(l.trim().length===0){E("Please write a message to user");return}H(new rS(t.userId,l,T.id));break}}e()};return t?i.jsxs(Ct,{className:"nitro-mod-tools-user-action",theme:"primary-slim",windowPosition:oi.TOP_LEFT,children:[i.jsx(Nt,{headerText:"Mod Action: "+(t?t.username:""),onCloseClick:()=>e()}),i.jsxs(It,{className:"text-black",children:[i.jsxs("select",{className:"form-select form-select-sm",value:s,onChange:p=>r(parseInt(p.target.value)),children:[i.jsx("option",{value:-1,disabled:!0,children:"CFH Topic"}),f.map((p,T)=>i.jsx("option",{value:T,children:g("help.cfh.topic."+p.id)},T))]}),i.jsxs("select",{className:"form-select form-select-sm",value:n,onChange:p=>o(parseInt(p.target.value)),children:[i.jsx("option",{value:-1,disabled:!0,children:"Sanction Type"}),VA.map((p,T)=>i.jsx("option",{value:T,children:p.name},T))]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{small:!0,children:"Optional message type, overrides default"}),i.jsx("textarea",{className:"form-control",value:l,onChange:p=>c(p.target.value)})]}),i.jsxs(x,{justifyContent:"between",gap:1,children:[i.jsx(W,{variant:"primary",onClick:m,children:"Default Sanction"}),i.jsx(W,{variant:"success",onClick:I,children:"Sanction"})]})]})]}):null},TZ=a=>{const{userId:t=null,onCloseClick:e=null}=a,[s,r]=_.useState(null);return z(iy,n=>{const o=n.getParser();o.data.userId===t&&r(o.data)}),_.useEffect(()=>{H(new iv(t))},[t]),t?i.jsxs(Ct,{className:"nitro-mod-tools-user-visits",theme:"primary-slim",windowPosition:oi.TOP_LEFT,children:[i.jsx(Nt,{headerText:"User Visits",onCloseClick:e}),i.jsx(It,{className:"text-black",gap:1,children:i.jsxs(N,{fullHeight:!0,gap:0,overflow:"hidden",children:[i.jsx(N,{gap:2,children:i.jsxs(pt,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[i.jsx(V,{className:"g-col-2",children:"Time"}),i.jsx(V,{className:"g-col-7",children:"Room name"}),i.jsx(V,{className:"g-col-3",children:"Visit"})]})}),i.jsx(sE,{rows:(s==null?void 0:s.rooms)??[],rowRender:n=>i.jsxs(pt,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[i.jsxs(O,{className:"g-col-2",children:[n.enterHour.toString().padStart(2,"0"),": ",n.enterMinute.toString().padStart(2,"0")]}),i.jsx(O,{className:"g-col-7",children:n.roomName}),i.jsx(O,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:o=>Li(n.roomId),children:"Visit Room"})]})})]})})]}):null},RZ=a=>{const{user:t=null,onCloseClick:e=null}=a,[s,r]=_.useState(""),{simpleAlert:n=null}=Ye();if(!t)return null;const o=()=>{if(s.trim().length===0){n("Please write a message to user.",null,null,null,"Error",null);return}H(new rS(t.userId,s,-999)),e()};return i.jsxs(Ct,{className:"nitro-mod-tools-user-message",theme:"primary-slim",windowPosition:oi.TOP_LEFT,children:[i.jsx(Nt,{headerText:"Send Message",onCloseClick:()=>e()}),i.jsxs(It,{className:"text-black",children:[i.jsxs(O,{children:["Message To: ",t.username]}),i.jsx("textarea",{className:"form-control",value:s,onChange:l=>r(l.target.value)}),i.jsx(W,{fullWidth:!0,onClick:o,children:"Send message"})]})]})},SZ=a=>{const{onCloseClick:t=null,userId:e=null}=a,[s,r]=_.useState(null),[n,o]=_.useState(!1),[l,c]=_.useState(!1),[u,h]=_.useState(!1),d=_.useMemo(()=>s?[{localeKey:"modtools.userinfo.userName",value:s.userName,showOnline:!0},{localeKey:"modtools.userinfo.cfhCount",value:s.cfhCount.toString()},{localeKey:"modtools.userinfo.abusiveCfhCount",value:s.abusiveCfhCount.toString()},{localeKey:"modtools.userinfo.cautionCount",value:s.cautionCount.toString()},{localeKey:"modtools.userinfo.banCount",value:s.banCount.toString()},{localeKey:"modtools.userinfo.lastSanctionTime",value:s.lastSanctionTime},{localeKey:"modtools.userinfo.tradingLockCount",value:s.tradingLockCount.toString()},{localeKey:"modtools.userinfo.tradingExpiryDate",value:s.tradingExpiryDate},{localeKey:"modtools.userinfo.minutesSinceLastLogin",value:xr.format(s.minutesSinceLastLogin*60,".ago",2)},{localeKey:"modtools.userinfo.lastPurchaseDate",value:s.lastPurchaseDate},{localeKey:"modtools.userinfo.primaryEmailAddress",value:s.primaryEmailAddress},{localeKey:"modtools.userinfo.identityRelatedBanCount",value:s.identityRelatedBanCount.toString()},{localeKey:"modtools.userinfo.registrationAgeInMinutes",value:xr.format(s.registrationAgeInMinutes*60,".ago",2)},{localeKey:"modtools.userinfo.userClassification",value:s.userClassification}]:null,[s]);return z(ey,f=>{const E=f.getParser();!E||E.data.userId!==e||r(E.data)}),_.useEffect(()=>{H(new ev(e))},[e]),s?i.jsxs(i.Fragment,{children:[i.jsxs(Ct,{className:"nitro-mod-tools-user",theme:"primary-slim",windowPosition:oi.TOP_LEFT,children:[i.jsx(Nt,{headerText:g("modtools.userinfo.title",["username"],[s.userName]),onCloseClick:()=>t()}),i.jsx(It,{className:"text-black",children:i.jsxs(pt,{overflow:"hidden",children:[i.jsx(N,{size:8,overflow:"auto",children:i.jsx("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:i.jsx("tbody",{children:d.map((f,E)=>i.jsxs("tr",{children:[i.jsx("th",{scope:"row",children:g(f.localeKey)}),i.jsxs("td",{children:[f.value,f.showOnline&&i.jsx("i",{className:`icon icon-pf-${s.online?"online":"offline"} ms-2`})]})]},E))})})}),i.jsxs(N,{size:4,gap:1,children:[i.jsx(W,{onClick:f=>ht(`mod-tools/open-user-chatlog/${e}`),children:"Room Chat"}),i.jsx(W,{onClick:f=>o(!n),children:"Send Message"}),i.jsx(W,{onClick:f=>h(!u),children:"Room Visits"}),i.jsx(W,{onClick:f=>c(!l),children:"Mod Action"})]})]})})]}),n&&i.jsx(RZ,{user:{userId:e,username:s.userName},onCloseClick:()=>o(!1)}),l&&i.jsx(IZ,{user:{userId:e,username:s.userName},onCloseClick:()=>c(!1)}),u&&i.jsx(TZ,{userId:e,onCloseClick:()=>h(!1)})]}):null},OZ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(-1),[n,o]=_.useState(null),[l,c]=_.useState(!1),{openRooms:u=[],openRoomChatlogs:h=[],openUserChatlogs:d=[],openUserInfos:f=[],openRoomInfo:E=null,closeRoomInfo:m=null,toggleRoomInfo:I=null,openRoomChatlog:p=null,closeRoomChatlog:T=null,toggleRoomChatlog:R=null,openUserInfo:S=null,closeUserInfo:L=null,toggleUserInfo:M=null,openUserChatlog:P=null,closeUserChatlog:k=null,toggleUserChatlog:G=null}=vu(),j=_.useRef(null);return ft([Ne.INITIALIZED,Ne.DISPOSED],F=>{if(!pn.isRoomPreviewerId(F.roomId))switch(F.type){case Ne.INITIALIZED:r(F.roomId);return;case Ne.DISPOSED:r(-1);return}}),FS(F=>{if(F.category!==Y.UNIT)return;const U=Se();if(!U)return;const K=U.userDataManager.getUserDataByIndex(F.id);!K||K.type!==Pe.USER||o({userId:K.webID,username:K.name})}),_.useEffect(()=>{const F={linkReceived:U=>{const K=U.split("/");if(!(K.length<2))switch(K[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(B=>!B);return;case"open-room-info":E(Number(K[2]));return;case"close-room-info":m(Number(K[2]));return;case"toggle-room-info":I(Number(K[2]));return;case"open-room-chatlog":p(Number(K[2]));return;case"close-room-chatlog":T(Number(K[2]));return;case"toggle-room-chatlog":R(Number(K[2]));return;case"open-user-info":S(Number(K[2]));return;case"close-user-info":L(Number(K[2]));return;case"toggle-user-info":M(Number(K[2]));return;case"open-user-chatlog":P(Number(K[2]));return;case"close-user-chatlog":k(Number(K[2]));return;case"toggle-user-chatlog":G(Number(K[2]));return}},eventUrlPrefix:"mod-tools/"};return As(F),()=>Ns(F)},[E,m,I,p,T,R,S,L,M,P,k,G]),i.jsxs(i.Fragment,{children:[t&&i.jsxs(Ct,{uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:oi.TOP_LEFT,theme:"primary-slim",children:[i.jsx(Nt,{headerText:"Mod Tools",onCloseClick:F=>e(!1)}),i.jsxs(It,{className:"text-black",gap:1,children:[i.jsxs(W,{gap:1,onClick:F=>ht(`mod-tools/toggle-room-info/${s}`),disabled:s<=0,className:"position-relative",children:[i.jsx(V,{className:"icon icon-small-room position-absolute start-1"})," Room Tool"]}),i.jsxs(W,{innerRef:j,gap:1,onClick:F=>ht(`mod-tools/toggle-room-chatlog/${s}`),disabled:s<=0,className:"position-relative",children:[i.jsx(V,{className:"icon icon-chat-history position-absolute start-1"})," Chatlog Tool"]}),i.jsxs(W,{gap:1,onClick:()=>ht(`mod-tools/toggle-user-info/${n.userId}`),disabled:!n,className:"position-relative",children:[i.jsx(V,{className:"icon icon-user position-absolute start-1"})," User: ",n?n.username:""]}),i.jsxs(W,{gap:1,onClick:()=>c(F=>!F),className:"position-relative",children:[i.jsx(V,{className:"icon icon-tickets position-absolute start-1"})," Report Tool"]})]})]}),u.length>0&&u.map(F=>i.jsx(uZ,{roomId:F,onCloseClick:()=>ht(`mod-tools/close-room-info/${F}`)},F)),h.length>0&&h.map(F=>i.jsx(cZ,{roomId:F,onCloseClick:()=>ht(`mod-tools/close-room-chatlog/${F}`)},F)),f.length>0&&f.map(F=>i.jsx(SZ,{userId:F,onCloseClick:()=>ht(`mod-tools/close-user-info/${F}`)},F)),d.length>0&&d.map(F=>i.jsx(pZ,{userId:F,onCloseClick:()=>ht(`mod-tools/close-user-chatlog/${F}`)},F)),l&&i.jsx(EZ,{onCloseClick:()=>c(!1)})]})},AZ=[We.START_DOORBELL,We.STATE_WAITING,We.STATE_NO_ANSWER,We.START_PASSWORD,We.STATE_WRONG_PASSWORD],NZ=[We.START_DOORBELL,We.STATE_WAITING,We.STATE_NO_ANSWER],CZ=a=>{const[t,e]=_.useState(""),{doorData:s=null,setDoorData:r=null}=sn(),n=()=>{s&&s.state===We.STATE_WAITING&&zT(),r(null)},o=()=>{!s||!s.roomInfo||(vl(s.roomInfo.roomId),r(u=>{const h={...u};return h.state=We.STATE_PENDING_SERVER,h}))},l=()=>{!s||!s.roomInfo||(vl(s.roomInfo.roomId,t),r(u=>{const h={...u};return h.state=We.STATE_PENDING_SERVER,h}))};if(_.useEffect(()=>{!s||s.state!==We.STATE_NO_ANSWER||zT()},[s]),!s||s.state===We.NONE||AZ.indexOf(s.state)===-1)return null;const c=NZ.indexOf(s.state)>=0;return i.jsxs(Ct,{className:"nitro-navigator-doorbell",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g(c?"navigator.doorbell.title":"navigator.password.title"),onCloseClick:n}),i.jsxs(It,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:s&&s.roomInfo&&s.roomInfo.roomName}),s.state===We.START_DOORBELL&&i.jsx(O,{children:g("navigator.doorbell.info")}),s.state===We.STATE_WAITING&&i.jsx(O,{children:g("navigator.doorbell.waiting")}),s.state===We.STATE_NO_ANSWER&&i.jsx(O,{children:g("navigator.doorbell.no.answer")}),s.state===We.START_PASSWORD&&i.jsx(O,{children:g("navigator.password.info")}),s.state===We.STATE_WRONG_PASSWORD&&i.jsx(O,{children:g("navigator.password.retryinfo")})]}),c&&i.jsxs(N,{gap:1,children:[s.state===We.START_DOORBELL&&i.jsx(W,{variant:"success",onClick:o,children:g("navigator.doorbell.button.ring")}),i.jsx(W,{variant:"danger",onClick:n,children:g("generic.cancel")})]}),!c&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("navigator.password.enter")}),i.jsx("input",{type:"password",className:"form-control form-control-sm",onChange:u=>e(u.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsx(W,{variant:"success",onClick:l,children:g("navigator.password.button.try")}),i.jsx(W,{variant:"danger",onClick:n,children:g("generic.cancel")})]})]})]})]})},xZ=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(null),[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(null),[d,f]=_.useState(0),[E,m]=_.useState([]),[I,p]=_.useState(""),{categories:T=null}=sn(),R=ct("hc.disabled",!1),S=P=>ct("images.url")+`/navigator/models/model_${P}.png`,L=(P,k)=>{!P||P.clubLevel>pi()||p(E[k].name)},M=()=>{H(new dv(s,n,"model_"+I,Number(l),Number(u),d))};return _.useEffect(()=>{if(!t){const P=[];for(let k=10;k<=100;k=k+10)P.push(k);e(P),h(P[0])}},[t]),_.useEffect(()=>{T&&T.length&&c(T[0].id)},[T]),_.useEffect(()=>{const P=ct("navigator.room.models");P&&P.length&&(m(P),p(P[0].name))},[]),i.jsxs(N,{overflow:"hidden",children:[i.jsxs(pt,{overflow:"hidden",children:[i.jsxs(N,{size:6,gap:1,overflow:"auto",children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("navigator.createroom.roomnameinfo")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:60,onChange:P=>r(P.target.value),placeholder:g("navigator.createroom.roomnameinfo")})]}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{children:g("navigator.createroom.roomdescinfo")}),i.jsx("textarea",{className:"flex-grow-1 form-control form-control-sm w-100",maxLength:255,onChange:P=>o(P.target.value),placeholder:g("navigator.createroom.roomdescinfo")})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("navigator.category")}),i.jsx("select",{className:"form-select form-select-sm",onChange:P=>c(Number(P.target.value)),children:T&&T.length>0&&T.map(P=>i.jsx("option",{value:P.id,children:g(P.name)},P.id))})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("navigator.maxvisitors")}),i.jsx("select",{className:"form-select form-select-sm",onChange:P=>h(Number(P.target.value)),children:t&&t.map(P=>i.jsx("option",{value:P,children:P},P))})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("navigator.tradesettings")}),i.jsxs("select",{className:"form-select form-select-sm",onChange:P=>f(Number(P.target.value)),children:[i.jsx("option",{value:"0",children:g("navigator.roomsettings.trade_not_allowed")}),i.jsx("option",{value:"1",children:g("navigator.roomsettings.trade_not_with_Controller")}),i.jsx("option",{value:"2",children:g("navigator.roomsettings.trade_allowed")})]})]})]}),i.jsx(N,{size:6,gap:1,overflow:"auto",children:E.map((P,k)=>i.jsxs($t,{fullHeight:!0,onClick:()=>L(P,k),itemActive:I===P.name,overflow:"unset",gap:0,className:"p-1",disabled:pi()<P.clubLevel,children:[i.jsx(x,{fullHeight:!0,center:!0,overflow:"hidden",children:i.jsx("img",{alt:"",src:S(P.name)})}),i.jsxs(O,{bold:!0,children:[P.tileSize," ",g("navigator.createroom.tilesize")]}),!R&&P.clubLevel>Pi.NO_CLUB&&i.jsx(ps,{position:"absolute",className:"top-1 end-1",type:"hc"})]},P.name))})]}),i.jsx(W,{fullWidth:!0,variant:!s||s.length<3?"danger":"success",onClick:M,disabled:!s||s.length<3,children:g("navigator.createroom.create")})]})},yZ=a=>{const{onCloseClick:t=null}=a,[e,s]=_.useState(!1),[r,n]=_.useState(!1),{report:o=null}=en(),{navigatorData:l=null}=sn(),c=h=>{switch(h){case"settings":return tt().userId===l.enteredGuestRoom.ownerId||tt().isModerator;case"staff_pick":return tt().securityLevel>=kl.COMMUNITY;default:return!1}},u=(h,d)=>{if(!(!l||!l.enteredGuestRoom))switch(h){case"set_home_room":let f=-1;l.homeRoomId!==l.enteredGuestRoom.roomId&&(f=l.enteredGuestRoom.roomId),f>0&&H(new Iv(f));return;case"navigator_search_tag":ht(`navigator/search/${d}`),H(new Vl("hotel_view",`tag:${d}`));return;case"open_room_thumbnail_camera":Ps(new ta(ta.TOGGLE_THUMBNAIL));return;case"open_group_info":Dd(l.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":ht("navigator/toggle-room-link");return;case"open_room_settings":H(new cS(l.enteredGuestRoom.roomId));return;case"toggle_pick":s(E=>!E),H(new pv(l.enteredGuestRoom.roomId));return;case"toggle_mute":n(E=>!E),H(new HP);return;case"room_filter":H(new gv(l.enteredGuestRoom.roomId));return;case"open_floorplan_editor":ht("floor-editor/toggle");return;case"report_room":o(ns.ROOM,{roomId:l.enteredGuestRoom.roomId,roomName:l.enteredGuestRoom.roomName});return;case"close":t();return}};return _.useEffect(()=>{l&&(s(l.currentRoomIsStaffPick),l.enteredGuestRoom&&n(l.enteredGuestRoom.allInRoomMuted))},[l]),l.enteredGuestRoom?i.jsxs(Ct,{className:"nitro-room-info",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("navigator.roomsettings.roominfo"),onCloseClick:()=>u("close")}),i.jsx(It,{className:"text-black",children:l.enteredGuestRoom&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{gap:2,overflow:"hidden",children:[i.jsx(nE,{roomId:l.enteredGuestRoom.roomId,customUrl:l.enteredGuestRoom.officialRoomPicRef,children:c("settings")&&i.jsx("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>u("open_room_thumbnail_camera")})}),i.jsxs(N,{grow:!0,gap:1,overflow:"hidden",children:[i.jsxs(x,{gap:1,children:[i.jsxs(N,{grow:!0,gap:1,children:[i.jsxs(x,{gap:1,children:[i.jsx("i",{onClick:()=>u("set_home_room"),className:fi("flex-shrink-0 icon icon-house-small cursor-pointer",l.homeRoomId!==l.enteredGuestRoom.roomId&&"gray")}),i.jsx(O,{bold:!0,children:l.enteredGuestRoom.roomName})]}),l.enteredGuestRoom.showOwner&&i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"muted",children:g("navigator.roomownercaption")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:l.enteredGuestRoom.ownerId}),i.jsx(O,{children:l.enteredGuestRoom.ownerName})]})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"muted",children:g("navigator.roomrating")}),i.jsx(O,{children:l.currentRoomRating})]}),l.enteredGuestRoom.tags.length>0&&i.jsx(x,{alignItems:"center",gap:1,children:l.enteredGuestRoom.tags.map(h=>i.jsxs(O,{pointer:!0,className:"bg-muted rounded p-1",onClick:d=>u("navigator_search_tag",h),children:["#",h]},h))})]}),i.jsxs(N,{alignItems:"center",gap:1,children:[c("settings")&&i.jsx("i",{className:"icon icon-cog cursor-pointer",title:g("navigator.room.popup.info.room.settings"),onClick:h=>u("open_room_settings")}),i.jsx(P0,{title:g("navigator.embed.caption"),className:"cursor-pointer fa-icon",onClick:h=>ht("navigator/toggle-room-link")})]})]}),i.jsx(O,{overflow:"auto",style:{maxHeight:50},children:l.enteredGuestRoom.description}),l.enteredGuestRoom.habboGroupId>0&&i.jsxs(x,{pointer:!0,alignItems:"center",gap:1,onClick:()=>u("open_group_info"),children:[i.jsx(Xe,{className:"flex-none",badgeCode:l.enteredGuestRoom.groupBadgeCode,isGroup:!0}),i.jsx(O,{underline:!0,children:g("navigator.guildbase",["groupName"],[l.enteredGuestRoom.groupName])})]})]})]}),i.jsxs(N,{gap:1,children:[c("staff_pick")&&i.jsx(W,{onClick:()=>u("toggle_pick"),children:g(e?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),i.jsx(W,{variant:"danger",onClick:()=>u("report_room"),children:g("help.emergency.main.report.room")}),c("settings")&&i.jsxs(i.Fragment,{children:[i.jsx(W,{onClick:()=>u("toggle_mute"),children:g(r?"navigator.muteall_on":"navigator.muteall_off")}),i.jsx(W,{onClick:()=>u("room_filter"),children:g("navigator.roomsettings.roomfilter")}),i.jsx(W,{onClick:()=>u("open_floorplan_editor"),children:g("open.floor.plan.editor")})]})]})]})})]}):null},MZ=a=>{const{onCloseClick:t=null}=a,{navigatorData:e=null}=sn();return e.enteredGuestRoom?i.jsxs(Ct,{className:"nitro-room-link",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("navigator.embed.title"),onCloseClick:t}),i.jsx(It,{className:"text-black d-flex align-items-center",children:i.jsxs(x,{gap:2,children:[i.jsx(nE,{roomId:e.enteredGuestRoom.roomId,customUrl:e.enteredGuestRoom.officialRoomPicRef}),i.jsxs(N,{children:[i.jsx(O,{bold:!0,fontSize:5,children:g("navigator.embed.headline")}),i.jsx(O,{children:g("navigator.embed.info")}),i.jsx("input",{type:"text",readOnly:!0,className:"form-control form-control-sm",value:g("navigator.embed.src",["roomId"],[e.enteredGuestRoom.roomId.toString()]).replace("${url.prefix}",ct("url.prefix",""))})]})]})})]}):null},bZ=a=>{const{roomData:t=null,handleChange:e=null}=a,[s,r]=_.useState(""),[n,o]=_.useState(""),[l,c]=_.useState(!1),u=()=>{!l||s.length<=0||n.length<=0||s!==n||e("password",s)};return _.useEffect(()=>{r(""),o(""),c(!1)},[t]),i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.roomaccess.caption")}),i.jsx(O,{children:g("navigator.roomsettings.roomaccess.info")})]}),i.jsxs(N,{overflow:"auto",children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.doormode")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===je.OPEN_STATE&&!l,onChange:h=>e("lock_state",je.OPEN_STATE)}),i.jsx(O,{children:g("navigator.roomsettings.doormode.open")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===je.DOORBELL_STATE&&!l,onChange:h=>e("lock_state",je.DOORBELL_STATE)}),i.jsx(O,{children:g("navigator.roomsettings.doormode.doorbell")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===je.INVISIBLE_STATE&&!l,onChange:h=>e("lock_state",je.INVISIBLE_STATE)}),i.jsx(O,{children:g("navigator.roomsettings.doormode.invisible")})]}),i.jsxs(x,{fullWidth:!0,gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===je.PASSWORD_STATE||l,onChange:h=>c(h.target.checked)}),!l&&t.lockState!==je.PASSWORD_STATE&&i.jsx(O,{children:g("navigator.roomsettings.doormode.password")}),(l||t.lockState===je.PASSWORD_STATE)&&i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("navigator.roomsettings.doormode.password")}),i.jsx("input",{type:"password",className:"form-control form-control-sm col-4",value:s,onChange:h=>r(h.target.value),placeholder:g("navigator.roomsettings.password"),onFocus:h=>c(!0)}),l&&s.length<=0&&i.jsx(O,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.passwordismandatory")}),i.jsx("input",{type:"password",className:"form-control form-control-sm col-4",value:n,onChange:h=>o(h.target.value),onBlur:u,placeholder:g("navigator.roomsettings.passwordconfirm")}),l&&s.length>0&&s!==n&&i.jsx(O,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.invalidconfirm")})]})]})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.pets")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.allowPets,onChange:h=>e("allow_pets",h.target.checked)}),i.jsx(O,{children:g("navigator.roomsettings.allowpets")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.allowPetsEat,onChange:h=>e("allow_pets_eat",h.target.checked)}),i.jsx(O,{children:g("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},HA=3,WA=60,YA=255,r_=15,DZ=a=>{const{roomData:t=null,handleChange:e=null,onClose:s=null}=a,[r,n]=_.useState(""),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(""),[f,E]=_.useState(0),[m,I]=_.useState(""),{showConfirm:p=null}=Ye(),{categories:T=null}=sn();z(bM,P=>{const k=P.getParser();if(k)switch(k.code){case ed.ERROR_INVALID_TAG:I("navigator.roomsettings.unacceptablewords");case ed.ERROR_NON_USER_CHOOSABLE_TAG:I("navigator.roomsettings.nonuserchoosabletag");break;default:I("");break}});const R=()=>{p(g("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[t.roomName]),()=>{H(new Fv(t.roomId)),s&&s(),ht("navigator/search/myworld_view")},null,null,null,g("navigator.roomsettings.deleteroom.confirm.title"))},S=()=>{r===t.roomName||r.length<HA||r.length>WA||e("name",r)},L=()=>{o===t.roomDescription||o.length>YA||e("description",o)},M=P=>{P===0&&c===t.tags[0]||c.length>r_||P===1&&h===t.tags[1]||h.length>r_||(c===""&&h!==""&&d(""),I(""),E(P),e("tags",c===""&&h!==""?[h]:[c,h]))};return _.useEffect(()=>{n(t.roomName),l(t.roomDescription),u(t.tags.length>0&&t.tags[0]?t.tags[0]:""),d(t.tags.length>0&&t.tags[1]?t.tags[1]:"")},[t]),i.jsxs(i.Fragment,{children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("navigator.roomname")}),i.jsxs(N,{fullWidth:!0,gap:0,children:[i.jsx("input",{className:"form-control form-control-sm",value:r,maxLength:WA,onChange:P=>n(P.target.value),onBlur:S}),r.length<HA&&i.jsx(O,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.roomnameismandatory")})]})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("navigator.roomsettings.desc")}),i.jsx("textarea",{className:"form-control form-control-sm",value:o,maxLength:YA,onChange:P=>l(P.target.value),onBlur:L})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("navigator.category")}),i.jsx("select",{className:"form-select form-select-sm",value:t.categoryId,onChange:P=>e("category",P.target.value),children:T&&T.map(P=>i.jsx("option",{value:P.id,children:g(P.name)},P.id))})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("navigator.maxvisitors")}),i.jsx("select",{className:"form-select form-select-sm",value:t.userCount,onChange:P=>e("max_visitors",P.target.value),children:mA&&mA.map(P=>i.jsx("option",{value:P,children:P},P))})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("navigator.tradesettings")}),i.jsxs("select",{className:"form-select form-select-sm",value:t.tradeState,onChange:P=>e("trade_state",P.target.value),children:[i.jsx("option",{value:"0",children:g("navigator.roomsettings.trade_not_allowed")}),i.jsx("option",{value:"1",children:g("navigator.roomsettings.trade_not_with_Controller")}),i.jsx("option",{value:"2",children:g("navigator.roomsettings.trade_allowed")})]})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{className:"col-3",children:g("navigator.tags")}),i.jsxs(N,{fullWidth:!0,gap:0,children:[i.jsx("input",{className:"form-control form-control-sm",value:c,onChange:P=>u(P.target.value),onBlur:()=>M(0)}),c.length>r_&&i.jsx(O,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.toomanycharacters")}),f===0&&m!=""&&i.jsx(O,{bold:!0,small:!0,variant:"danger",children:g(m)})]}),i.jsxs(N,{fullWidth:!0,gap:0,children:[i.jsx("input",{className:"form-control form-control-sm",value:h,onChange:P=>d(P.target.value),onBlur:()=>M(1)}),h.length>r_&&i.jsx(O,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.toomanycharacters")}),f===1&&m!=""&&i.jsx(O,{bold:!0,small:!0,variant:"danger",children:g(m)})]})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(V,{className:"col-3"}),i.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.allowWalkthrough,onChange:P=>e("allow_walkthrough",P.target.checked)}),i.jsx(O,{children:g("navigator.roomsettings.allow_walk_through")})]}),i.jsxs(O,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:R,children:[i.jsx(Dr,{className:"fa-icon"}),g("navigator.roomsettings.delete")]})]})},vZ=a=>{var c;const{roomData:t=null,handleChange:e=null}=a,[s,r]=_.useState(-1),[n,o]=_.useState([]),l=u=>{o(h=>{const d=[...h],f=d.findIndex(E=>E.userId===u);return f>=0&&d.splice(f,1),d}),H(new Vv(u,t.roomId)),r(-1)};return z(NM,u=>{const h=u.getParser();!t||t.roomId!==h.roomId||o(h.bannedUsers)}),_.useEffect(()=>{H(new lS(t.roomId))},[t.roomId]),i.jsxs(pt,{overflow:"auto",children:[i.jsxs(N,{size:6,children:[i.jsxs(O,{bold:!0,children:[g("navigator.roomsettings.moderation.banned.users")," (",n.length,")"]}),i.jsx(x,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:i.jsx(N,{fullWidth:!0,overflow:"auto",gap:1,children:n&&n.length>0&&n.map((u,h)=>i.jsxs(x,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[i.jsx(br,{userName:u.userName}),i.jsxs(O,{pointer:!0,grow:!0,onClick:d=>r(u.userId),children:[" ",u.userName]})]},h))})}),i.jsxs(W,{disabled:s<=0,onClick:u=>l(s),children:[g("navigator.roomsettings.moderation.unban")," ",s>0&&((c=n.find(u=>u.userId===s))==null?void 0:c.userName)]})]}),i.jsxs(N,{size:6,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.moderation.mute.header")}),i.jsx(x,{alignItems:"center",gap:1,children:i.jsxs("select",{className:"form-select form-select-sm",value:t.moderationSettings.allowMute,onChange:u=>e("moderation_mute",u.target.value),children:[i.jsx("option",{value:Hi.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),i.jsx("option",{value:Hi.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.moderation.kick.header")}),i.jsx(x,{alignItems:"center",gap:1,children:i.jsxs("select",{className:"form-select form-select-sm",value:t.moderationSettings.allowKick,onChange:u=>e("moderation_kick",u.target.value),children:[i.jsx("option",{value:Hi.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),i.jsx("option",{value:Hi.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")}),i.jsx("option",{value:Hi.MODERATION_LEVEL_ALL,children:g("navigator.roomsettings.moderation.all")})]})})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.moderation.ban.header")}),i.jsx(x,{alignItems:"center",gap:1,children:i.jsxs("select",{className:"form-select form-select-sm",value:t.moderationSettings.allowBan,onChange:u=>e("moderation_ban",u.target.value),children:[i.jsx("option",{value:Hi.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),i.jsx("option",{value:Hi.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]})]})]})},PZ=a=>{const{roomData:t=null}=a,[e,s]=_.useState(new Map);return z(yM,r=>{const n=r.getParser();!t||t.roomId!==n.roomId||s(n.users)}),z(CM,r=>{const n=r.getParser();!t||t.roomId!==n.roomId||s(o=>{const l=new Map(o);return l.set(n.data.userId,n.data.userName),l})}),z(xM,r=>{const n=r.getParser();!t||t.roomId!==n.roomId||s(o=>{const l=new Map(o);return l.delete(n.userId),l})}),_.useEffect(()=>{H(new Wv(t.roomId))},[t.roomId]),i.jsxs(pt,{children:[i.jsxs(N,{size:6,children:[i.jsx(O,{bold:!0,children:g("navigator.flatctrls.userswithrights",["displayed","total"],[e.size.toString(),e.size.toString()])}),i.jsx(x,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:i.jsx(N,{fullWidth:!0,overflow:"auto",gap:1,children:Array.from(e.entries()).map(([r,n],o)=>i.jsxs(x,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[i.jsx(br,{userName:n}),i.jsxs(O,{pointer:!0,grow:!0,onClick:l=>H(new oS(r)),children:[" ",n]})]},o))})})]}),i.jsx(N,{size:6,justifyContent:"end",children:i.jsx(W,{variant:"danger",disabled:!e.size,onClick:r=>H(new Uv(t.roomId)),children:g("navigator.flatctrls.clear")})})]})},LZ=a=>{const{roomData:t=null,handleChange:e=null}=a,[s,r]=_.useState(0);return _.useEffect(()=>{r(t.chatSettings.distance)},[t.chatSettings]),i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.vip.caption")}),i.jsx(O,{children:g("navigator.roomsettings.vip.info")})]}),i.jsxs(pt,{overflow:"auto",children:[i.jsxs(N,{size:6,gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.chat_settings")}),i.jsx(O,{children:g("navigator.roomsettings.chat_settings.info")}),i.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.mode,onChange:n=>e("bubble_mode",n.target.value),children:[i.jsx("option",{value:ss.CHAT_MODE_FREE_FLOW,children:g("navigator.roomsettings.chat.mode.free.flow")}),i.jsx("option",{value:ss.CHAT_MODE_LINE_BY_LINE,children:g("navigator.roomsettings.chat.mode.line.by.line")})]}),i.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.weight,onChange:n=>e("chat_weight",n.target.value),children:[i.jsx("option",{value:ss.CHAT_BUBBLE_WIDTH_NORMAL,children:g("navigator.roomsettings.chat.bubbles.width.normal")}),i.jsx("option",{value:ss.CHAT_BUBBLE_WIDTH_THIN,children:g("navigator.roomsettings.chat.bubbles.width.thin")}),i.jsx("option",{value:ss.CHAT_BUBBLE_WIDTH_WIDE,children:g("navigator.roomsettings.chat.bubbles.width.wide")})]}),i.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.speed,onChange:n=>e("bubble_speed",n.target.value),children:[i.jsx("option",{value:ss.CHAT_SCROLL_SPEED_FAST,children:g("navigator.roomsettings.chat.speed.fast")}),i.jsx("option",{value:ss.CHAT_SCROLL_SPEED_NORMAL,children:g("navigator.roomsettings.chat.speed.normal")}),i.jsx("option",{value:ss.CHAT_SCROLL_SPEED_SLOW,children:g("navigator.roomsettings.chat.speed.slow")})]}),i.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.protection,onChange:n=>e("flood_protection",n.target.value),children:[i.jsx("option",{value:ss.FLOOD_FILTER_LOOSE,children:g("navigator.roomsettings.chat.flood.loose")}),i.jsx("option",{value:ss.FLOOD_FILTER_NORMAL,children:g("navigator.roomsettings.chat.flood.normal")}),i.jsx("option",{value:ss.FLOOD_FILTER_STRICT,children:g("navigator.roomsettings.chat.flood.strict")})]}),i.jsx(O,{children:g("navigator.roomsettings.chat_settings.hearing.distance")}),i.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",value:s,onChange:n=>r(n.target.valueAsNumber),onBlur:n=>e("chat_distance",s)})]}),i.jsxs(N,{size:6,gap:1,children:[i.jsx(O,{bold:!0,children:g("navigator.roomsettings.vip_settings")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.hideWalls,onChange:n=>e("hide_walls",n.target.checked)}),i.jsx(O,{children:g("navigator.roomsettings.hide_walls")})]}),i.jsxs("select",{className:"form-select form-select-sm",value:t.wallThickness,onChange:n=>e("wall_thickness",n.target.value),children:[i.jsx("option",{value:"0",children:g("navigator.roomsettings.wall_thickness.normal")}),i.jsx("option",{value:"1",children:g("navigator.roomsettings.wall_thickness.thick")}),i.jsx("option",{value:"-1",children:g("navigator.roomsettings.wall_thickness.thin")}),i.jsx("option",{value:"-2",children:g("navigator.roomsettings.wall_thickness.thinnest")})]}),i.jsxs("select",{className:"form-select form-select-sm",value:t.floorThickness,onChange:n=>e("floor_thickness",n.target.value),children:[i.jsx("option",{value:"0",children:g("navigator.roomsettings.floor_thickness.normal")}),i.jsx("option",{value:"1",children:g("navigator.roomsettings.floor_thickness.thick")}),i.jsx("option",{value:"-1",children:g("navigator.roomsettings.floor_thickness.thin")}),i.jsx("option",{value:"-2",children:g("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},ro=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.5"],UZ=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(ro[0]);z(MM,l=>{const c=l.getParser();if(!c)return;const u=c.data;e({roomId:u.roomId,roomName:u.name,roomDescription:u.description,categoryId:u.categoryId,userCount:u.maximumVisitorsLimit,tags:u.tags,tradeState:u.tradeMode,allowWalkthrough:u.allowWalkThrough,lockState:u.doorMode,password:null,allowPets:u.allowPets,allowPetsEat:u.allowFoodConsume,hideWalls:u.hideWalls,wallThickness:u.wallThickness,floorThickness:u.floorThickness,chatSettings:{mode:u.chatSettings.mode,weight:u.chatSettings.weight,speed:u.chatSettings.speed,distance:u.chatSettings.distance,protection:u.chatSettings.protection},moderationSettings:{allowMute:u.roomModerationSettings.allowMute,allowKick:u.roomModerationSettings.allowKick,allowBan:u.roomModerationSettings.allowBan}}),H(new lS(u.roomId))});const n=()=>{e(null),r(ro[0])},o=(l,c)=>{e(u=>{const h={...u};switch(l){case"name":h.roomName=String(c);break;case"description":h.roomDescription=String(c);break;case"category":h.categoryId=Number(c);break;case"max_visitors":h.userCount=Number(c);break;case"trade_state":h.tradeState=Number(c);break;case"tags":h.tags=c;break;case"allow_walkthrough":h.allowWalkthrough=!!c;break;case"allow_pets":h.allowPets=!!c;break;case"allow_pets_eat":h.allowPetsEat=!!c;break;case"hide_walls":h.hideWalls=!!c;break;case"wall_thickness":h.wallThickness=Number(c);break;case"floor_thickness":h.floorThickness=Number(c);break;case"lock_state":h.lockState=Number(c);break;case"password":h.lockState=je.PASSWORD_STATE,h.password=String(c);break;case"moderation_mute":h.moderationSettings.allowMute=Number(c);break;case"moderation_kick":h.moderationSettings.allowKick=Number(c);break;case"moderation_ban":h.moderationSettings.allowBan=Number(c);break;case"bubble_mode":h.chatSettings.mode=Number(c);break;case"chat_weight":h.chatSettings.weight=Number(c);break;case"bubble_speed":h.chatSettings.speed=Number(c);break;case"flood_protection":h.chatSettings.protection=Number(c);break;case"chat_distance":h.chatSettings.distance=Number(c);break}return H(new Yv(h.roomId,h.roomName,h.roomDescription,h.lockState,h.password,h.userCount,h.categoryId,h.tags.length,h.tags,h.tradeState,h.allowPets,h.allowPetsEat,h.allowWalkthrough,h.hideWalls,h.wallThickness,h.floorThickness,h.moderationSettings.allowMute,h.moderationSettings.allowKick,h.moderationSettings.allowBan,h.chatSettings.mode,h.chatSettings.weight,h.chatSettings.speed,h.chatSettings.distance,h.chatSettings.protection)),h})};return t?i.jsxs(Ct,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[i.jsx(Nt,{headerText:g("navigator.roomsettings"),onCloseClick:n}),i.jsx(eo,{children:ro.map(l=>i.jsx(Ia,{isActive:s===l,onClick:c=>r(l),children:g(l)},l))}),i.jsxs(It,{children:[s===ro[0]&&i.jsx(DZ,{roomData:t,handleChange:o,onClose:n}),s===ro[1]&&i.jsx(bZ,{roomData:t,handleChange:o}),s===ro[2]&&i.jsx(PZ,{roomData:t,handleChange:o}),s===ro[3]&&i.jsx(LZ,{roomData:t,handleChange:o}),s===ro[4]&&i.jsx(vZ,{roomData:t,handleChange:o})]})]}):null},zA=a=>{const{roomData:t=null}=a,[e,s]=_.useState(!1),r=_.useRef(),n=()=>{const o=100*(t.userCount/t.maxUserCount);let l="bg-primary";return o>=92?l="bg-danger":o>=50?l="bg-warning":o>0&&(l="bg-success"),l};return i.jsxs(i.Fragment,{children:[i.jsx(V,{pointer:!0,innerRef:r,className:"icon icon-navigator-info",onMouseOver:o=>s(!0),onMouseLeave:o=>s(!1)}),i.jsx(wm,{show:e,target:r.current,placement:"right",children:i.jsx(_u,{children:i.jsx(It,{overflow:"hidden",className:"room-info image-rendering-pixelated bg-transparent",children:i.jsxs(x,{gap:2,overflow:"hidden",children:[i.jsxs(nE,{roomId:t.roomId,customUrl:t.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[t.habboGroupId>0&&i.jsx(Xe,{badgeCode:t.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1 "}),t.doorMode!==je.OPEN_STATE&&i.jsx("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(t.doorMode===je.DOORBELL_STATE?"locked":t.doorMode===je.PASSWORD_STATE?"password":t.doorMode===je.INVISIBLE_STATE?"invisible":"")})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,truncate:!0,className:"flex-grow-1",style:{maxHeight:13},children:t.roomName}),i.jsxs(x,{gap:2,children:[i.jsx(O,{italics:!0,variant:"muted",children:g("navigator.roomownercaption")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:t.ownerId}),i.jsx(O,{italics:!0,children:t.ownerName})]})]}),i.jsx(O,{className:"flex-grow-1",children:t.description}),i.jsxs(x,{className:"badge p-1 position-absolute m-1 bottom-0 end-0 m-2 "+n(),gap:1,children:[i.jsx(qE,{className:"fa-icon"}),t.userCount]})]})]})})})})]})},KA=a=>{const{roomData:t=null,children:e=null,thumbnail:s=!1,...r}=a,{setDoorData:n=null}=sn(),o=()=>{const c=100*(t.userCount/t.maxUserCount);let u="bg-primary";return c>=92?u="bg-danger":c>=50?u="bg-warning":c>0&&(u="bg-success"),u},l=c=>{if(t.ownerId!==tt().userId){if(t.habboGroupId!==0){Li(t.roomId);return}switch(t.doorMode){case je.DOORBELL_STATE:n(u=>{const h={...u};return h.roomInfo=t,h.state=We.START_DOORBELL,h});return;case je.PASSWORD_STATE:n(u=>{const h={...u};return h.roomInfo=t,h.state=We.START_PASSWORD,h});return}}vl(t.roomId)};return s?i.jsxs(N,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:l,gap:0,className:"navigator-item p-1 bg-light rounded-3 small mb-1 flex-column border border-muted",...r,children:[i.jsxs(nE,{roomId:t.roomId,customUrl:t.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[t.habboGroupId>0&&i.jsx(Xe,{badgeCode:t.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),i.jsxs(x,{center:!0,className:"badge p-1 position-absolute m-1 "+o(),gap:1,children:[i.jsx(qE,{className:"fa-icon"}),t.userCount]}),t.doorMode!==je.OPEN_STATE&&i.jsx("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(t.doorMode===je.DOORBELL_STATE?"locked":t.doorMode===je.PASSWORD_STATE?"password":t.doorMode===je.INVISIBLE_STATE?"invisible":"")})]}),i.jsxs(x,{className:"w-100",children:[i.jsx(O,{truncate:!0,className:"flex-grow-1",children:t.roomName}),i.jsx(x,{reverse:!0,alignItems:"center",gap:1,children:i.jsx(zA,{roomData:t})}),e]})]}):i.jsxs(x,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:l,gap:2,className:"navigator-item px-2 py-1 small",...r,children:[i.jsxs(x,{center:!0,className:"badge p-1 "+o(),gap:1,children:[i.jsx(qE,{className:"fa-icon"}),t.userCount]}),i.jsx(O,{truncate:!0,grow:!0,children:t.roomName}),i.jsxs(x,{reverse:!0,alignItems:"center",gap:1,children:[i.jsx(zA,{roomData:t}),t.habboGroupId>0&&i.jsx("i",{className:"icon icon-navigator-room-group"}),t.doorMode!==je.OPEN_STATE&&i.jsx("i",{className:"icon icon-navigator-room-"+(t.doorMode===je.DOORBELL_STATE?"locked":t.doorMode===je.PASSWORD_STATE?"password":t.doorMode===je.INVISIBLE_STATE?"invisible":"")})]}),e]})},jZ=a=>{const{searchResult:t=null,...e}=a,[s,r]=_.useState(!0),[n,o]=_.useState(0),{topLevelContext:l=null}=sn(),c=()=>{let f=t.code;return!f||!f.length||g("navigator.searchcode.title."+f)=="navigator.searchcode.title."+f?t.data:f.startsWith("${")?f.slice(2,f.length-1):"navigator.searchcode.title."+f},u=()=>{o(f=>f===ao.LIST?ao.THUMBNAILS:ao.LIST)},h=()=>{t.action==1?H(new Vl(t.code,"")):t.action==2&&l&&H(new Vl(l.code,""))};_.useEffect(()=>{t&&(r(!t.closed),o(t.mode))},[t]);const d=n>=ao.THUMBNAILS;return i.jsxs(N,{className:"bg-white rounded border border-muted",gap:0,children:[i.jsxs(x,{fullWidth:!0,alignItems:"center",justifyContent:"between",className:"px-2 py-1",children:[i.jsxs(x,{grow:!0,pointer:!0,alignItems:"center",gap:1,onClick:f=>r(E=>!E),children:[s&&i.jsx(L0,{className:"text-secondary fa-icon"}),!s&&i.jsx(Cd,{className:"text-secondary fa-icon"}),i.jsx(O,{children:g(c())})]}),i.jsxs(x,{gap:2,children:[n===ao.LIST&&i.jsx(U0,{className:"text-secondary fa-icon",onClick:u}),n>=ao.THUMBNAILS&&i.jsx(j0,{className:"text-secondary fa-icon",onClick:u}),t.action>0&&t.action===1&&i.jsx(w0,{className:"text-secondary fa-icon",onClick:h}),t.action>0&&t.action!==1&&i.jsx(F0,{className:"text-secondary fa-icon",onClick:h})]})]})," ",s&&i.jsx(i.Fragment,{children:d?i.jsx(Fe,{columnCount:3,...e,columnMinWidth:110,columnMinHeight:130,className:"mx-2",children:t.rooms.length>0&&t.rooms.map((f,E)=>i.jsx(KA,{roomData:f,thumbnail:!0},E))}):i.jsx(pt,{columnCount:1,className:"navigator-grid",gap:0,children:t.rooms.length>0&&t.rooms.map((f,E)=>i.jsx(KA,{roomData:f},E))})})]})},wZ=a=>{const{sendSearch:t=null}=a,[e,s]=_.useState(0),[r,n]=_.useState(""),{topLevelContext:o=null,searchResult:l=null}=sn(),c=()=>{if(!o)return;let h=nc[e];h||(h=nc[0]);const d=(h.query?h.query+":":"")+r;t(d||"",o.code)},u=h=>{h.key==="Enter"&&c()};return _.useEffect(()=>{if(!l)return;const h=l.data.split(":");let d=null,f="";if(h.length>=2){const[E,...m]=h;d=nc.find(I=>I.query===E),f=m.join(":")}else f=l.data;d||(d=nc[0]),s(nc.findIndex(E=>E===d)),n(f)},[l]),i.jsxs(x,{fullWidth:!0,gap:1,children:[i.jsx(x,{shrink:!0,children:i.jsx("select",{className:"form-select form-select-sm",value:e,onChange:h=>s(parseInt(h.target.value)),children:nc.map((h,d)=>i.jsx("option",{value:d,children:g("navigator.filter."+h.name)},d))})}),i.jsxs(x,{fullWidth:!0,gap:1,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("navigator.filter.input.placeholder"),value:r,onChange:h=>n(h.target.value),onKeyDown:h=>u(h)}),i.jsx(W,{variant:"primary",onClick:c,children:i.jsx(hR,{className:"fa-icon"})})]})]})},FZ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(!1),[n,o]=_.useState(!1),[l,c]=_.useState(!1),[u,h]=_.useState(!1),[d,f]=_.useState(!1),[E,m]=_.useState(!0),[I,p]=_.useState(!1),{searchResult:T=null,topLevelContext:R=null,topLevelContexts:S=null,navigatorData:L=null}=sn(),M=_.useRef(null),P=_.useRef();ft(yt.CREATED,j=>{e(!1),o(!1)});const k=_.useCallback((j,F)=>{o(!1),H(new Vl(F,j)),f(!0)},[]),G=_.useCallback(()=>{if(!s){p(!0);return}if(M.current){k(M.current.value,M.current.code),M.current=null;return}if(T){k(T.data,T.code);return}R&&k("",R.code)},[s,T,R,k]);return _.useEffect(()=>{const j={linkReceived:F=>{const U=F.split("/");if(!(U.length<2))switch(U[1]){case"show":{e(!0),p(!0);return}case"hide":e(!1);return;case"toggle":{if(t){e(!1);return}e(!0),p(!0);return}case"toggle-room-info":c(K=>!K);return;case"toggle-room-link":h(K=>!K);return;case"goto":if(U.length<=2)return;switch(U[2]){case"home":if(L.homeRoomId<=0)return;Li(L.homeRoomId);break;default:{const K=parseInt(U[2]);Li(K)}}return;case"create":e(!0),o(!0);return;case"search":if(U.length>2){const K=U[2];let B="";U.length>3&&(B=U[3]),M.current={value:B,code:K},e(!0),p(!0)}return}},eventUrlPrefix:"navigator/"};return As(j),()=>Ns(j)},[t,L]),_.useEffect(()=>{T&&(f(!1),P&&P.current&&(P.current.scrollTop=0))},[T]),_.useEffect(()=>{!t||!s||!I||(G(),p(!1))},[t,s,I,G]),_.useEffect(()=>{s||!R||r(!0)},[s,R]),_.useEffect(()=>{!t||!E||(H(new mv),m(!1))},[t,E]),_.useEffect(()=>{re.addCallback(Nn.OPENROOM,(j,F=!1,U=null)=>H(new hv(j)))},[]),i.jsxs(i.Fragment,{children:[t&&i.jsxs(Ct,{uniqueKey:"navigator",className:"nitro-navigator",children:[i.jsx(Nt,{headerText:g(n?"navigator.createroom.title":"navigator.title"),onCloseClick:j=>e(!1)}),i.jsxs(eo,{children:[S&&S.length>0&&S.map((j,F)=>i.jsx(Ia,{isActive:R===j&&!n,onClick:U=>k("",j.code),children:g("navigator.toplevelview."+j.code)},F)),i.jsx(Ia,{isActive:n,onClick:j=>o(!0),children:i.jsx(Cd,{className:"fa-icon"})})]}),i.jsxs(It,{position:"relative",children:[d&&i.jsx(V,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),!n&&i.jsxs(i.Fragment,{children:[i.jsx(wZ,{sendSearch:k}),i.jsx(N,{innerRef:P,overflow:"auto",children:T&&T.results.map((j,F)=>i.jsx(jZ,{searchResult:j},F))})]}),n&&i.jsx(xZ,{})]})]}),i.jsx(CZ,{}),l&&i.jsx(yZ,{onCloseClick:()=>c(!1)}),u&&i.jsx(MZ,{onCloseClick:()=>h(!1)}),i.jsx(UZ,{})]})},GZ=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(""),{chatHistory:n=[]}=jd(),o=_.useRef(null);if(_.useMemo(()=>{if(s.length===0)return n;let c=s.toLowerCase();return n.filter(u=>u.message&&u.message.toLowerCase().includes(c)||u.name&&u.name.toLowerCase().includes(c))},[n,s]),_.useEffect(()=>{o&&o.current&&t&&(o.current.scrollTop=o.current.scrollHeight)},[t]),_.useEffect(()=>{const c={linkReceived:u=>{const h=u.split("/");if(!(h.length<2))switch(h[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(d=>!d);return}},eventUrlPrefix:"nitrobubblehidden/"};return As(c),()=>Ns(c)},[]),!t)return null;var l="<style>.newbubblehe { visibility: hidden !important; }</style>";return i.jsx("div",{dangerouslySetInnerHTML:{__html:l}})},kZ=/\n\r|\n|\r/mg,BZ=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(""),[n,o]=_.useState(null),l=_.useRef(null);return _.useEffect(()=>{const c=async h=>{try{const d=await fetch(h);if(!d)return;const E=(await d.text()).split(kZ),m=E.shift().split("|");r(m[0]),o(I=>m[1]&&m[1].split(";").length===2?{width:parseInt(m[1].split(";")[0]),height:parseInt(m[1].split(";")[1])}:null),e(E.join(""))}catch{Lt.error(`Failed to fetch ${h}`)}},u={linkReceived:h=>{const d=h.split("/");d.length<2||(d.shift(),c(ct("habbopages.url")+d.join("/")))},eventUrlPrefix:"habbopages/"};return As(u),()=>Ns(u)},[]),_.useEffect(()=>{const c=u=>{if(!(u.target instanceof HTMLAnchorElement))return;u.preventDefault();const h=u.target.href;!h||!h.length||Jl(h)};return document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}},[]),t?i.jsxs(Ct,{className:"nitropedia",theme:"primary-slim",style:n?{width:n.width,height:n.height}:{},children:[i.jsx(Nt,{headerText:s,onCloseClick:()=>e(null)}),i.jsx(It,{children:i.jsx(V,{fit:!0,innerRef:l,className:"text-black",dangerouslySetInnerHTML:{__html:t}})})]}):null},VZ=a=>{const{offer:t=null,setOpen:e=null}=a;if(t)return i.jsxs(VS,{fadesOut:!1,onClose:null,onClick:s=>e(!0),gap:2,children:[i.jsx(V,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${ct("image.library.url")+t.iconImageUrl})`}}),i.jsx(O,{variant:"light",className:"ubuntu-bold",children:t.title})]})},HZ=a=>{const{offer:t=null,setOpen:e=null}=a,{getCurrencyAmount:s}=ec(),[r,n]=_.useState(1),o=_.useMemo(()=>{let u=!1,h=!1,d=!1;return t.priceInCredits>0&&(u=s(-1)>=t.priceInCredits),t.priceInActivityPoints>0?h=s(t.activityPointType)>=t.priceInActivityPoints:h=!0,t.purchaseLimit>0&&(d=!0),u&&h&&d},[t,s]),l=()=>{let u=Math.max(0,(t.expirationTime-Date.now())/1e3);return xr.format(u)},c=()=>{H(new Ab(t.id,r)),H(new sS)};if(t)return i.jsxs(Ct,{theme:"primary-slim",uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[i.jsx(Nt,{headerText:g(t.title),onCloseClick:u=>e(!1)}),i.jsx(yU,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:g("targeted.offer.timeleft",["timeleft"],[l()])}),i.jsxs(It,{gap:1,children:[i.jsxs(x,{gap:1,fullHeight:!0,children:[i.jsxs(x,{gap:1,column:!0,className:"w-75 text-black",children:[i.jsxs(N,{className:"bg-warning p-2",fullHeight:!0,children:[i.jsx("h4",{children:g(t.title)}),i.jsx(V,{dangerouslySetInnerHTML:{__html:t.description}})]}),i.jsxs(x,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[t.purchaseLimit>1&&i.jsxs(x,{gap:1,children:[i.jsx(O,{variant:"muted",children:g("catalog.bundlewidget.quantity")}),i.jsx("input",{type:"number",value:r,onChange:u=>n(parseInt(u.target.value)),min:1,max:t.purchaseLimit})]}),i.jsx(W,{variant:"primary",disabled:!o,onClick:()=>c(),children:g("targeted.offer.button.buy")})]})]}),i.jsx(V,{className:"w-50",fullHeight:!0,style:{background:`url(${ct("image.library.url")+t.imageUrl}) no-repeat center`}})]}),i.jsxs(x,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[i.jsx(O,{children:g("targeted.offer.price.label")}),t.priceInCredits>0&&i.jsxs(x,{gap:1,children:[i.jsx(O,{variant:"light",children:t.priceInCredits}),i.jsx(ps,{type:-1})]}),t.priceInActivityPoints>0&&i.jsxs(x,{gap:1,children:[i.jsxs(O,{className:"ubuntu-bold",variant:"light",children:["+",t.priceInActivityPoints]})," ",i.jsx(ps,{type:t.activityPointType})]})]})]})]})},WZ=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(!1);if(z(DC,r=>{let n=r.getParser();n&&t(n.data)}),wS(()=>{H(new sS)}),!!a)return i.jsx(i.Fragment,{children:e?i.jsx(HZ,{offer:a,setOpen:s}):i.jsx(VZ,{offer:a,setOpen:s})})},YZ=a=>{const[t,e]=_.useState(0),[s,r]=_.useState(null),[n,o]=_.useState(!0),{showConfirm:l=null}=Ye();z(nd,f=>{e(0),r(null)}),z(KR,f=>{e(0),r(null)}),z($a,f=>{const E=f.getParser();E.roomEnter&&(E.data.habboGroupId>0?(e(E.data.habboGroupId),H(new Ou(E.data.habboGroupId,!1))):(e(0),r(null)))}),z(tx,f=>{const E=f.getParser();!s||E.groupId!==s.id&&E.groupId!==t||(e(0),r(null))}),z(Du,f=>{const E=f.getParser();E.id===t&&r(E)});const c=()=>{l(g("group.leaveconfirm.desc"),()=>{H(new zm(s.id,tt().userId))},null)},u=s&&s.ownerName===tt().userName,h=()=>{if(u)return"group.manage";if(s.type===Ar.PRIVATE)return"";if(s.membershipType===zs.MEMBER)return"group.leave";if(s.membershipType===zs.NOT_MEMBER&&s.type===Ar.REGULAR)return"group.join";if(s.membershipType===zs.REQUEST_PENDING)return"group.membershippending";if(s.membershipType===zs.NOT_MEMBER&&s.type===Ar.EXCLUSIVE)return"group.requestmembership"},d=()=>{if(u)return nU(s.id);if(!(s.type===Ar.PRIVATE&&s.membershipType===zs.NOT_MEMBER)){if(s.membershipType===zs.MEMBER){c();return}bS(s.id)}};return s?i.jsx(V,{className:"nitro-notification-bubble rounded",children:i.jsxs(N,{children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:f=>o(E=>!E),children:[i.jsx(O,{variant:"white",children:g("group.homeroominfo.title")}),n&&i.jsx(gR,{className:"fa-icon"}),!n&&i.jsx(fR,{className:"fa-icon"})]}),n&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{pointer:!0,alignItems:"center",gap:2,onClick:f=>Dd(s.id),children:[i.jsx(V,{className:"group-badge",children:i.jsx(Xe,{badgeCode:s.badge,isGroup:!0})}),i.jsx(O,{variant:"white",children:s.title})]}),(s.type!==Ar.PRIVATE||u)&&i.jsx(W,{fullWidth:!0,variant:"success",disabled:s.membershipType===zs.REQUEST_PENDING,onClick:d,children:g(h())})]})]})}):null},zZ=a=>{const{title:t="Nitro CoolUI Edit",onClose:e=null,...s}=a;return i.jsx(n9,{title:t,onClose:e,...s,children:i.jsxs(pt,{children:[i.jsxs(N,{size:12,children:[i.jsxs(N,{alignItems:"center",gap:0,children:[i.jsx(O,{bold:!0,fontSize:4,children:"Nitro React"}),i.jsxs(O,{children:["v",ZL()]})]}),i.jsxs(N,{alignItems:"center",children:[i.jsxs(O,{children:[i.jsx("b",{children:"Renderer:"})," v",kX()]}),i.jsx(N,{fullWidth:!0,gap:1,children:i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"success",onClick:r=>window.open("https://discord.nitrodev.co"),children:"Nitro Discord"}),i.jsx(W,{fullWidth:!0,onClick:r=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Nitro Git"})]})})]})]}),i.jsx("div",{className:"nitro-coolui-logo"}),i.jsx(N,{size:10,children:i.jsxs(N,{alignItems:"left",gap:0,children:[i.jsx(O,{center:!0,bold:!0,fontSize:5,children:"Cool UI"}),i.jsx(O,{children:"Was created by Wassehk"}),i.jsx(O,{children:"- DuckieTM (Re-Design)"}),i.jsx(O,{children:"- Jonas (Contributing)"}),i.jsx(O,{children:"- Ohlucas (Sunset resources)"}),i.jsx(O,{center:!0,bold:!0,small:!0,children:"v2.2.0"}),i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"success",onClick:r=>window.open("https://discord.nitrodev.co"),children:"CoolUI Discord"}),i.jsx(W,{fullWidth:!0,onClick:r=>window.open("https://github.com/duckietm/Nitro-Cool-UI"),children:"CoolUI Git"})]})]})})]})})},KZ=a=>{const{item:t=null,title:e=a.item&&a.item.title||"",onClose:s=null,...r}=a,[n,o]=_.useState(!1),l=()=>{Jl(t.clickUrl),s()},c=t.alertType===Yt.DEFAULT;return i.jsxs(BS,{title:e,onClose:s,...r,type:c?Yt.DEFAULT:t.alertType,children:[i.jsxs(x,{fullHeight:!0,overflow:"auto",gap:c||t.imageUrl&&!n?2:0,children:[c&&!t.imageUrl&&i.jsx(V,{className:"notification-frank flex-shrink-0"}),t.imageUrl&&!n&&i.jsx("img",{src:t.imageUrl,alt:t.title,onError:()=>{o(!0)},className:"align-self-baseline"}),i.jsxs(V,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",t.clickUrl&&!c?"justify-content-center":""],children:[t.messages.length>0&&t.messages.map((u,h)=>{const d=u.replace(/\r\n|\r|\n/g,"<br />");return i.jsx(V,{dangerouslySetInnerHTML:{__html:d}},h)}),t.clickUrl&&t.clickUrl.length>0&&t.imageUrl&&!n&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"my-2 w-100"}),i.jsx(W,{onClick:l,className:"align-self-center px-3",children:g(t.clickUrlText)})]})]})]}),(!t.imageUrl||t.imageUrl&&n)&&i.jsx(i.Fragment,{children:i.jsxs(N,{alignItems:"center",center:!0,gap:0,children:[i.jsx("hr",{className:"my-2 w-100"}),!t.clickUrl&&i.jsx(W,{onClick:s,children:g("generic.close")}),t.clickUrl&&t.clickUrl.length>0&&i.jsx(W,{onClick:l,children:g(t.clickUrlText)})]})})]})},XZ=a=>{const{item:t=null,title:e=a.item&&a.item.title||"",onClose:s=null,...r}=a,[n,o]=_.useState(""),[l,c]=_.useState([]),u=()=>{Jl(t.clickUrl),s()},h=f=>{let E=JSON.parse(t.messages[0]);c(E.filter(m=>m.includes(f))),o(f)};_.useEffect(()=>{c(JSON.parse(t.messages[0]))},[t]);const d=t.clickUrl&&t.clickUrl.startsWith("event:");return i.jsxs(BS,{title:e,onClose:s,...r,children:[i.jsx(x,{fullWidth:!0,alignItems:"center",position:"relative",children:i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:n,onChange:f=>h(f.target.value)})}),i.jsx(N,{fullHeight:!0,className:"py-1",overflow:"hidden",children:i.jsx(Fe,{gap:1,columnCount:1,children:l&&l.map((f,E)=>i.jsx("span",{children:f},E))})}),i.jsx("hr",{className:"my-2"}),i.jsxs(N,{alignItems:"center",center:!0,gap:1,children:[!d&&!t.clickUrl&&i.jsx(W,{onClick:s,children:g("generic.close")}),t.clickUrl&&t.clickUrl.length>0&&i.jsx(W,{onClick:u,children:g(t.clickUrlText)})]})]})},qZ=(a,t)=>{if(!a)return null;const e={key:a.id,item:a,onClose:t};switch(a.alertType){case Yt.NITRO:return i.jsx(zZ,{...e});case Yt.SEARCH:return i.jsx(XZ,{...e});default:return i.jsx(KZ,{...e})}},QZ=a=>{const{item:t=null,onClose:e=null,...s}=a;return i.jsxs(VS,{fadesOut:!1,className:"flex-column club-gift",onClose:e,...s,children:[i.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[i.jsx(ps,{type:"hc",className:"flex-shrink-0"}),i.jsx("span",{className:"ms-1",children:g("notifications.text.club_gift")})]}),i.jsxs("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[i.jsx("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>Jl(t.linkUrl),children:g("notifications.button.show_gift_list")}),i.jsx("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:e,children:g("notifications.button.later")})]})]})},JZ=a=>{const{item:t=null,onClose:e=null,...s}=a,r=t.message.replace(/\r\n|\r|\n/g,"<br />");return i.jsxs(VS,{onClose:e,gap:2,alignItems:"center",onClick:n=>t.linkUrl&&t.linkUrl.length&&Jl(t.linkUrl),...s,children:[i.jsx(x,{center:!0,className:"bubble-image-container",children:t.iconUrl&&t.iconUrl.length&&i.jsx("img",{className:"no-select",src:t.iconUrl,alt:""})}),i.jsx(O,{wrap:!0,variant:"white",dangerouslySetInnerHTML:{__html:r}})]})},ZZ=(a,t)=>{if(!a)return null;const e={item:a,onClose:t};switch(a.notificationType){case Ci.CLUBGIFT:return i.jsx(QZ,{...e},a.id);default:return i.jsx(JZ,{...e},a.id)}},$Z=a=>{const{item:t=null,onClose:e=null,...s}=a,{message:r=null,onConfirm:n=null,onCancel:o=null,confirmText:l=null,cancelText:c=null,title:u=null}=t,h=()=>{n&&n(),e()},d=()=>{o&&o(),e()};return i.jsxs(BS,{title:u,onClose:e,...s,type:Yt.ALERT,children:[i.jsx(x,{grow:!0,center:!0,children:i.jsx(O,{children:r})}),i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"danger",onClick:d,children:c}),i.jsx(W,{fullWidth:!0,onClick:h,children:l})]})]})},t$=(a,t)=>{if(!a)return null;const e={key:a.id,item:a,onClose:t};switch(a.confirmType){default:return i.jsx($Z,{...e})}},e$=a=>{const{alerts:t=[],bubbleAlerts:e=[],confirms:s=[],closeAlert:r=null,closeBubbleAlert:n=null,closeConfirm:o=null}=Ye(),l=_.useMemo(()=>{if(!t||!t.length)return null;const h=[];for(const d of t){const f=qZ(d,()=>r(d));h.push(f)}return h},[t,r]),c=_.useMemo(()=>{if(!e||!e.length)return null;const h=[];for(const d of e){const f=ZZ(d,()=>n(d));if(d.notificationType===Ci.CLUBGIFT){h.unshift(f);continue}h.push(f)}return h},[e,n]),u=_.useMemo(()=>{if(!s||!s.length)return null;const h=[];for(const d of s){const f=t$(d,()=>o(d));h.push(f)}return h},[s,o]);return i.jsxs(i.Fragment,{children:[i.jsx(N,{gap:1,children:c}),u,l]})},XA=a=>{const{type:t=-1,amount:e=-1,short:s=!1}=a,r=_.useMemo(()=>i.jsxs(x,{justifyContent:"end",pointer:!0,gap:1,className:`nitro-purse-button rounded allcurrencypurse nitro-purse-button currency-${t}`,children:[i.jsx(O,{truncate:!0,textEnd:!0,variant:"white",grow:!0,children:s?pq(e):Ag(e)}),i.jsx(ps,{type:t})]}),[e,s,t]);return s?i.jsx(wN,{placement:"left",overlay:i.jsx(G0,{id:`tooltip-${t}`,children:Ag(e)}),children:r}):r},s$=a=>{const{type:t=-1,amount:e=-1}=a;return i.jsxs(x,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency p-2 rounded",children:[i.jsx(O,{variant:"white",children:g(`purse.seasonal.currency.${t}`)}),i.jsxs(x,{gap:1,children:[i.jsx(O,{variant:"white",children:Ag(e)}),i.jsx(ps,{type:t})]})]})},i$=a=>{const{purse:t=null,hcDisabled:e=!1}=ec(),s=_.useMemo(()=>ct("system.currency.types",[]),[]),r=_.useMemo(()=>ct("currency.display.number.short",!1),[]),n=(()=>{if(!t)return null;const l=t.clubPeriods*31+t.clubDays,c=t.minutesUntilExpiration;return t.clubLevel===Pi.NO_CLUB?g("purse.clubdays.zero.amount.text"):c>-1&&c<60*24?xr.shortFormat(c*60):xr.shortFormat(l*86400)})(),o=(l,c=-1,u=!1)=>{if(!t||!t.activityPoints||!t.activityPoints.size)return null;const h=Array.from(t.activityPoints.keys()).filter(E=>s.indexOf(E)>=0);let d=0;for(;d<l;)h.shift(),d++;d=0;const f=[];for(const E of h){if(c>-1&&d===c)break;u?f.push(i.jsx(s$,{type:E,amount:t.activityPoints.get(E)},E)):f.push(i.jsx(XA,{type:E,amount:t.activityPoints.get(E),short:r},E)),d++}return f};return t?i.jsxs(N,{alignItems:"end",className:"nitro-purse-container",gap:1,children:[i.jsx(x,{className:"nitro-purse rounded-bottom p-1",children:i.jsxs(pt,{fullWidth:!0,gap:1,children:[i.jsxs(N,{justifyContent:"center",size:e?10:6,gap:0,children:[i.jsx(XA,{type:-1,amount:t.credits,short:r}),o(0,2)]}),!e&&i.jsxs(N,{center:!0,pointer:!0,size:4,gap:1,className:"nitro-purse-subscription rounded borderhccontent",onClick:l=>ht("habboUI/open/hccenter"),children:[i.jsx(ps,{type:"hc"}),i.jsx(O,{variant:"white",children:n})]}),i.jsxs(N,{justifyContent:"center",size:2,gap:0,children:[i.jsx(x,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded coffecurrencybutton",onClick:l=>ht("help/show"),children:i.jsx("i",{className:"icon icon-help"})}),i.jsx(x,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded coffecurrencybutton",onClick:l=>ht("user-settings/toggle"),children:i.jsx("i",{className:"icon icon-cog"})})]})]})}),o(2,-1,!0)]}):null},r$={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},n$=a=>{const[t,e]=_.useState(!0),[s,r]=_.useState(""),[n,o]=_.useState("");ft(C_.MYSTERY_BOX_KEYS_UPDATE,c=>{r(c.keyColor),o(c.boxColor)});const l=c=>{const u=r$[c];return zi.int2rgb(u)};return s===""&&n===""?null:i.jsx(V,{className:"nitro-notification-bubble rounded mysterybox-extension",children:i.jsxs(N,{children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:c=>e(u=>!u),children:[i.jsx(O,{variant:"white",children:g("mysterybox.tracker.title")}),t&&i.jsx(gR,{className:"fa-icon"}),!t&&i.jsx(fR,{className:"fa-icon"})]}),t&&i.jsxs(i.Fragment,{children:[i.jsx(O,{variant:"white",children:g("mysterybox.tracker.description")}),i.jsxs(x,{justifyContent:"center",alignItems:"center",gap:2,children:[i.jsx($t,{className:"mysterybox-container",children:i.jsx("div",{className:"box-image flex-shrink-0",style:{backgroundColor:l(n)},children:i.jsx("div",{className:"chain-overlay-image"})})}),i.jsx($t,{className:"mysterybox-container",children:i.jsx("div",{className:"key-image flex-shrink-0",style:{backgroundColor:l(s)},children:i.jsx("div",{className:"key-overlay-image"})})})]})]})]})})},a$=a=>{const{eventId:t=-1,eventName:e="",eventDescription:s="",setIsEditingPromote:r=null}=a,[n,o]=_.useState(e),[l,c]=_.useState(s),u=()=>{H(new _v(t,n,l)),r(!1)};return i.jsxs(Ct,{className:"nitro-guide-tool",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("navigator.eventsettings.editcaption"),onCloseClick:()=>r(!1)}),i.jsxs(It,{className:"text-black",children:[i.jsxs(N,{children:[i.jsx(O,{bold:!0,children:g("navigator.eventsettings.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("navigator.eventsettings.name"),maxLength:64,value:n,onChange:h=>o(h.target.value)})]}),i.jsxs(N,{children:[i.jsx(O,{bold:!0,children:g("navigator.eventsettings.desc")}),i.jsx("textarea",{className:"form-control form-control-sm",placeholder:g("navigator.eventsettings.desc"),maxLength:64,value:l,onChange:h=>c(h.target.value)})]}),i.jsx(N,{children:i.jsx(W,{fullWidth:!0,disabled:!n||!l,variant:!n||!l?"danger":"success",onClick:h=>u(),children:g("navigator.eventsettings.edit")})})]})]})},o$=a=>{const{eventDescription:t="",setIsEditingPromote:e=null}=a,{setIsExtended:s}=GS(),r=()=>{s(!0),ht("catalog/open/room_event")};return i.jsxs(i.Fragment,{children:[i.jsx(x,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:i.jsx(O,{variant:"white",children:t})}),i.jsx("br",{}),i.jsx("br",{}),i.jsxs(pt,{className:"d-flex align-items-center justify-content-end gap-2",children:[i.jsx(W,{className:"btn btn-primary w-100 btn-sm",onClick:n=>e(!0),children:g("navigator.roominfo.editevent")}),i.jsx(W,{className:"btn btn-success w-100 btn-sm",onClick:n=>r(),children:g("roomad.extend.event")})]})]})},l$=a=>{const{eventDescription:t=""}=a;return i.jsxs(i.Fragment,{children:[i.jsx(x,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:i.jsx(O,{variant:"white",children:t})}),i.jsx("br",{}),i.jsx("br",{}),i.jsx(N,{alignItems:"center",gap:1,children:i.jsxs(V,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[i.jsx(x,{fit:!0,center:!0,position:"absolute",children:i.jsx(O,{variant:"white",center:!0,children:g("navigator.eventinprogress")})}),i.jsx(O,{children:""})]})})]})},c$=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(!0),{promoteInformation:n,setPromoteInformation:o}=GS();return z(nd,l=>{o(null)}),n?i.jsx(i.Fragment,{children:n.data.adId!==-1&&i.jsx(V,{className:"nitro-notification-bubble rounded",children:i.jsxs(N,{children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:l=>r(c=>!c),children:[i.jsx(O,{variant:"white",overflow:"hidden",children:n.data.eventName}),s&&i.jsx(gR,{className:"fa-icon"}),!s&&i.jsx(fR,{className:"fa-icon"})]}),s&&tt().userId!==n.data.ownerAvatarId&&i.jsx(l$,{eventDescription:n.data.eventDescription}),s&&tt().userId===n.data.ownerAvatarId&&i.jsx(o$,{eventDescription:n.data.eventDescription,setIsEditingPromote:()=>e(!0)}),t&&i.jsx(a$,{eventId:n.data.adId,eventName:n.data.eventName,eventDescription:n.data.eventDescription,setIsEditingPromote:()=>e(!1)})]})})}):null},u$=a=>i.jsx("div",{className:"nitro-right-side",children:i.jsxs(N,{position:"relative",gap:1,children:[i.jsx(i$,{}),i.jsx(YZ,{}),i.jsx(n$,{}),i.jsx(WZ,{}),i.jsx(c$,{}),i.jsx(e$,{})]})}),h$=a=>i.jsx("div",{className:"room-spectator"}),d$=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(null),{chatStyleId:n=0}=to(),{roomSession:o=null}=Le();z(wy,c=>{const u=c.getParser();if(!u)return;const h=o.userDataManager.getPetData(u.petId);h&&(e(h),r(u))});const l=(c,u)=>{!c||!u||o==null||o.sendChatMessage(`${c} ${u}`,n)};return!t||!s?null:i.jsxs(Ct,{uniqueKey:"user-settings",className:"user-settings-window no-resize",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("widgets.pet.commands.title"),onCloseClick:()=>r(null)}),i.jsxs(It,{className:"text-black",children:[i.jsx(x,{alignItems:"center",justifyContent:"center",gap:2,children:i.jsxs(pt,{columnCount:2,children:[i.jsx(N,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:i.jsx(ia,{figure:t.figure,posture:"std",direction:2})}),i.jsx(O,{variant:"black",small:!0,wrap:!0,children:t.name})]})}),i.jsx(pt,{columnCount:2,children:s.commands&&s.commands.length>0&&s.commands.map((c,u)=>i.jsx(W,{disabled:!s.enabledCommands.includes(c),onClick:()=>l(t.name,g(`pet.command.${c}`)),children:g(`pet.command.${c}`)},u))})]})]})},yi=a=>{const{justifyContent:t="center",alignItems:e="center",classNames:s=[],...r}=a,n=_.useMemo(()=>{const o=["menu-header","p-1"];return s.length&&o.push(...s),o},[s]);return i.jsx(x,{justifyContent:t,alignItems:e,classNames:n,...r})},_$=a=>{const{chatEvent:t=null,onClose:e=null}=a,[s,r]=_.useState(t.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":t.chat),[n,o]=_.useState(t.automaticChat),[l,c]=_.useState(t.mixSentences),[u,h]=_.useState(t.chatDelay),d=_.useMemo(()=>MS(Se().roomId,t.objectId,t.category,1),[t]),f=m=>m.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),E=()=>{const m=f(s)+";#;"+n+";#;"+u+";#;"+l;H(new Dn(t.botId,Ke.SETUP_CHAT,m)),e()};return i.jsx(qo,{windowPosition:oi.NOTHING,handleSelector:".drag-handler",dragStyle:{top:d.y,left:d.x},children:i.jsxs(V,{className:"nitro-context-menu bot-chat",children:[i.jsx(yi,{className:"drag-handler",children:g("bot.skill.chatter.configuration.title")}),i.jsxs(N,{className:"p-1",children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{variant:"white",children:g("bot.skill.chatter.configuration.chat.text")}),i.jsx("textarea",{className:"form-control form-control-sm",placeholder:g("bot.skill.chatter.configuration.text.placeholder"),value:s,rows:7,onChange:m=>r(m.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[i.jsx(O,{fullWidth:!0,variant:"white",children:g("bot.skill.chatter.configuration.automatic.chat")}),i.jsx("input",{type:"checkbox",className:"form-check-input",checked:n,onChange:m=>o(m.target.checked)})]}),i.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[i.jsx(O,{fullWidth:!0,variant:"white",children:g("bot.skill.chatter.configuration.markov")}),i.jsx("input",{type:"checkbox",className:"form-check-input",checked:l,onChange:m=>c(m.target.checked)})]}),i.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[i.jsx(O,{fullWidth:!0,variant:"white",children:g("bot.skill.chatter.configuration.chat.delay")}),i.jsx("input",{type:"number",className:"form-control form-control-sm",value:u,onChange:m=>h(m.target.valueAsNumber)})]})]}),i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"primary",onClick:e,children:g("cancel")}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:E,children:g("save")})]})]})]})})},qA=-1,QA=0,JA=1,ZA=2,$A=3,tN=4,eN=5,sN=6,g$=a=>{const{item:t=null,onClose:e=null}=a,[s,r]=_.useState(qA),[n,o]=_.useState(null),[l,c]=_.useState(null),{roomSession:u=null}=Le(),h=()=>{n&&rt().selectRoomObject(u.roomId,n.roomIndex,Y.UNIT)},d=()=>{u.usePetProduct(t.requestRoomObjectId,n.webID),e()},f=_.useMemo(()=>{if(!n||!l)return null;const E=new da(n.figure),m=l.customParams.split(" "),I=parseInt(m[0]);switch(l.specialType){case Dt.PET_SHAMPOO:{if(m.length<2)return null;const p=rt().getPetColorResult(I,E.paletteId),T=rt().getPetColorResultsForTag(I,m[1]);let R=-1;for(const S of T)if(S.breed===p.breed){R=parseInt(S.id);break}return i.jsx(ia,{typeId:E.typeId,paletteId:R,petColor:E.color,customParts:E.customParts,direction:2})}case Dt.PET_CUSTOM_PART:{if(m.length<4)return null;const p=[],T=m[1].split(",").map(M=>parseInt(M)),R=m[2].split(",").map(M=>parseInt(M)),S=m[3].split(",").map(M=>parseInt(M));let L=0;for(;L<T.length;){const M=T[L],P=E.getCustomPart(M);let k=S[L];P!=null&&(k=P.paletteId),p.push(new Gu(M,R[L],k)),L++}return i.jsx(ia,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case Dt.PET_CUSTOM_PART_SHAMPOO:{if(m.length<3)return null;const p=[],T=m[1].split(",").map(L=>parseInt(L)),R=m[2].split(",").map(L=>parseInt(L));let S=0;for(;S<T.length;){const L=T[S],M=E.getCustomPart(L);let P=-1;M!=null&&(P=M.partId),p.push(new Gu(T[S],P,R[S])),S++}return i.jsx(ia,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case Dt.PET_SADDLE:{if(m.length<4)return null;const p=[],T=m[1].split(",").map(M=>parseInt(M)),R=m[2].split(",").map(M=>parseInt(M)),S=m[3].split(",").map(M=>parseInt(M));let L=0;for(;L<T.length;)p.push(new Gu(T[L],R[L],S[L])),L++;for(const M of E.customParts)T.indexOf(M.layerId)===-1&&p.push(M);return i.jsx(ia,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case Dt.MONSTERPLANT_REBREED:case Dt.MONSTERPLANT_REVIVAL:case Dt.MONSTERPLANT_FERTILIZE:{let p="rip";const T=rt().getRoomObject(u.roomId,n.roomIndex,Y.UNIT);if(T&&(p=T.model.getValue(A.FIGURE_POSTURE),p==="rip")){const R=n.petLevel;R<7?p=`grw${R}`:p="std"}return i.jsx(ia,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:E.customParts,posture:p,direction:2})}}},[n,l,u]);return _.useEffect(()=>{const E=u.userDataManager.getUserDataByIndex(t.id);o(E);const m=qm(u.roomId,t.requestRoomObjectId,Y.FLOOR);if(!m)return;c(m);let I=qA;switch(m.specialType){case Dt.PET_SHAMPOO:I=QA;break;case Dt.PET_CUSTOM_PART:I=JA;break;case Dt.PET_CUSTOM_PART_SHAMPOO:I=ZA;break;case Dt.PET_SADDLE:I=$A;break;case Dt.MONSTERPLANT_REVIVAL:I=tN;break;case Dt.MONSTERPLANT_REBREED:I=eN;break;case Dt.MONSTERPLANT_FERTILIZE:I=sN;break}r(I)},[u,t]),n?i.jsxs(Ct,{className:"nitro-use-product-confirmation",children:[i.jsx(Nt,{headerText:g("useproduct.widget.title",["name"],[n.name]),onCloseClick:e}),i.jsx(It,{center:!0,children:i.jsxs(x,{gap:2,overflow:"hidden",children:[i.jsx(N,{children:i.jsx(V,{pointer:!0,className:"product-preview",onClick:h,children:f})}),i.jsxs(N,{justifyContent:"between",overflow:"auto",children:[i.jsxs(N,{gap:2,children:[s===QA&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("useproduct.widget.text.shampoo",["productName"],[l.name])}),i.jsx(O,{children:g("useproduct.widget.info.shampoo")})]}),s===JA&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("useproduct.widget.text.custompart",["productName"],[l.name])}),i.jsx(O,{children:g("useproduct.widget.info.custompart")})]}),s===ZA&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("useproduct.widget.text.custompartshampoo",["productName"],[l.name])}),i.jsx(O,{children:g("useproduct.widget.info.custompartshampoo")})]}),s===$A&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("useproduct.widget.text.saddle",["productName"],[l.name])}),i.jsx(O,{children:g("useproduct.widget.info.saddle")})]}),s===tN&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("useproduct.widget.text.revive_monsterplant",["productName"],[l.name])}),i.jsx(O,{children:g("useproduct.widget.info.revive_monsterplant")})]}),s===eN&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("useproduct.widget.text.rebreed_monsterplant",["productName"],[l.name])}),i.jsx(O,{children:g("useproduct.widget.info.rebreed_monsterplant")})]}),s===sN&&i.jsxs(i.Fragment,{children:[i.jsx(O,{children:g("useproduct.widget.text.fertilize_monsterplant",["productName"],[l.name])}),i.jsx(O,{children:g("useproduct.widget.info.fertilize_monsterplant")})]})]}),i.jsxs(x,{alignItems:"center",justifyContent:"between",children:[i.jsx(W,{variant:"danger",onClick:e,children:g("useproduct.widget.cancel")}),i.jsx(W,{variant:"success",onClick:d,children:g("useproduct.widget.use")})]})]})]})})]}):null},st=a=>{const{disabled:t=!1,fullWidth:e=!0,justifyContent:s="center",alignItems:r="center",classNames:n=[],onClick:o=null,...l}=a,c=h=>{t||o&&o(h)},u=_.useMemo(()=>{const h=["menu-item","list-item"];return t&&h.push("disabled"),n.length&&h.push(...n),h},[t,n]);return i.jsx(x,{fullWidth:e,justifyContent:s,alignItems:r,classNames:u,onClick:c,...l})},f$=a=>{const{justifyContent:t="center",alignItems:e="center",classNames:s=[],collapsed:r=!0,...n}=a,o=_.useMemo(()=>{const l=["menu-footer"];return s.length&&l.push(...s),l},[s]);return i.jsxs(x,{justifyContent:t,alignItems:e,classNames:o,...n,children:[!r&&i.jsx(lR,{className:"fa-icon align-self-center"}),r&&i.jsx(oR,{className:"fa-icon align-self-center"})]})},m$=25,iN=3,E$=5e3,p$=75,lc=10;let PE=!1,n_=null,a_=-1e6,LE=1;const Ra=a=>{const{objectId:t=-1,category:e=-1,userType:s=-1,fades:r=!1,onClose:n=null,position:o="absolute",classNames:l=[],style:c={},children:u=null,collapsable:h=!1,...d}=a,[f,E]=_.useState({x:null,y:null}),[m,I]=_.useState(1),[p,T]=_.useState(!1),[R,S]=_.useState(PE),L=_.useRef(),M=_.useCallback(j=>{if(!p)return;LE+=j;let F=(1-LE/p$)*1;if(F<=0)return n(),!1;I(F)},[p,n]),P=_.useCallback((j,F)=>{if(!j||!F||!n_)return;let U=-L.current.offsetHeight;s>-1&&(s===Pe.USER||s===Pe.BOT||s===Pe.RENTABLE_BOT)?U=U+(j.height>50?15:0):U=U-14,n_.addValue(F.y-j.top);let K=n_.getMax();K<a_-iN&&(K=a_-iN),a_=K;const B=F.y-K;let J=~~(F.x-L.current.offsetWidth/2),Z=~~(B+U);const Q=Yh().width-L.current.offsetWidth-lc,ut=Yh().height-L.current.offsetHeight-lc;J<lc?J=lc:J>Q&&(J=Q),Z<lc?Z=lc:Z>ut&&(Z=ut),E({x:J,y:Z})},[s]),k=_.useMemo(()=>{const j=["nitro-context-menu"];return R&&j.push("menu-hidden"),j.push(f.x!==null?"visible":"invisible"),l.length&&j.push(...l),j},[f,l,R]),G=_.useMemo(()=>{let j={};return j.left=f.x||0,j.top=f.y||0,j.opacity=m,Object.keys(c).length&&(j={...j,...c}),j},[f,m,c]);return _.useEffect(()=>{if(!L.current)return;const j=F=>{if(!L.current)return;M(F.lastTime);const U=MS(Se().roomId,t,e),K=eU(Se().roomId,t,e);P(U,K)};return Ti().add(j),()=>{Ti().remove(j)}},[t,e,M,P]),_.useEffect(()=>{if(!r)return;const j=setTimeout(()=>T(!0),E$);return()=>clearTimeout(j)},[r]),_.useEffect(()=>{PE=R},[R]),_.useEffect(()=>{n_=new Eq(m$),a_=-1e6,LE=1},[]),i.jsxs(V,{innerRef:L,position:o,classNames:k,style:G,...d,children:[!(h&&PE)&&u,h&&i.jsx(f$,{onClick:()=>S(!R),collapsed:R})]})},rN=0,nN=1,aN=2,oN=3,lN=4,cN=5,uN=6,hN=7,I$=a=>{const{item:t=null,updateConfirmingProduct:e=null,onClose:s=null}=a,[r,n]=_.useState(0),{roomSession:o=null}=Le(),l=c=>{if(c)switch(c){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":e(t);break}};return _.useEffect(()=>{if(!t)return;const c=qm(o.roomId,t.requestRoomObjectId,Y.FLOOR);if(!c)return;let u=rN;switch(c.specialType){case Dt.PET_SHAMPOO:u=nN;break;case Dt.PET_CUSTOM_PART:u=aN;break;case Dt.PET_CUSTOM_PART_SHAMPOO:u=oN;break;case Dt.PET_SADDLE:u=lN;break;case Dt.MONSTERPLANT_REVIVAL:u=cN;break;case Dt.MONSTERPLANT_REBREED:u=uN;break;case Dt.MONSTERPLANT_FERTILIZE:u=hN;break}n(u)},[o,t]),i.jsxs(Ra,{objectId:t.id,category:Y.UNIT,userType:Pe.PET,onClose:s,collapsable:!0,children:[i.jsx(yi,{children:t.name}),r===rN&&i.jsx(st,{onClick:c=>l("use_product"),children:g("infostand.button.useproduct")}),r===nN&&i.jsx(st,{onClick:c=>l("use_product_shampoo"),children:g("infostand.button.useproduct_shampoo")}),r===aN&&i.jsx(st,{onClick:c=>l("use_product_custom_part"),children:g("infostand.button.useproduct_custom_part")}),r===oN&&i.jsx(st,{onClick:c=>l("use_product_custom_part_shampoo"),children:g("infostand.button.useproduct_custom_part_shampoo")}),r===lN&&i.jsxs(i.Fragment,{children:[t.replace&&i.jsx(st,{onClick:c=>l("replace_product_saddle"),children:g("infostand.button.replaceproduct_saddle")}),!t.replace&&i.jsx(st,{onClick:c=>l("use_product_saddle"),children:g("infostand.button.useproduct_saddle")})]}),r===cN&&i.jsx(st,{onClick:c=>l("revive_monsterplant"),children:g("infostand.button.revive_monsterplant")}),r===uN&&i.jsx(st,{onClick:c=>l("rebreed_monsterplant"),children:g("infostand.button.rebreed_monsterplant")}),r===hN&&i.jsx(st,{onClick:c=>l("fertilize_monsterplant"),children:g("infostand.button.fertilize_monsterplant")})]})},T$=a=>{const{avatarInfo:t=null,onClose:e=null}=a;return t?i.jsx(N,{className:"nitro-infostand rounded",children:i.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[i.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),i.jsx(Dr,{className:"cursor-pointer fa-icon",onClick:e})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{gap:1,children:[i.jsx(N,{fullWidth:!0,className:"body-image bot",children:i.jsx(os,{figure:t.figure,direction:4})}),i.jsx(N,{grow:!0,center:!0,gap:0,children:t.badges.length>0&&t.badges.map(s=>i.jsx(Xe,{badgeCode:s,showInfo:!0},s))})]}),i.jsx("hr",{className:"m-0"})]}),i.jsx(x,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:i.jsx(O,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:t.motto})}),t.carryItem>0&&i.jsxs(N,{gap:1,children:[i.jsx("hr",{className:"m-0"}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.handitem",["item"],[g("handitem"+t.carryItem)])})]})]})}):null},UE=0,dN=1,_N=2,R$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,{roomSession:s=null}=Le(),[r,n]=_.useState(0),[o,l]=_.useState(!1),[c,u]=_.useState(!1),[h,d]=_.useState(!1),[f,E]=_.useState([]),[m,I]=_.useState([]),[p,T]=_.useState([]),[R,S]=_.useState([]),[L,M]=_.useState(!1),[P,k]=_.useState(0),[G,j]=_.useState(0),[F,U]=_.useState(!1),[K,B]=_.useState(!1),[J,Z]=_.useState(null),[Q,ut]=_.useState(!1),[Bt,te]=_.useState(!1),[de,He]=_.useState(-1),[le,qe]=_.useState(""),[vt,Vt]=_.useState("");ft(aa.NPE_SONG_CHANGED,wt=>{He(wt.id)},Q||Bt),ft(Bl.SIR_TRAX_SONG_INFO_RECEIVED,wt=>{if(wt.id!==de)return;const pe=Os().musicController.getSongInfo(wt.id);pe&&(qe(pe.name),Vt(pe.creator))},Q||Bt),_.useEffect(()=>{let wt=UE,pe=!1,ls=!1,qi=!1,Kt=[],Ae=[],Lr=[],Jo=[],Qi=!1,Gd=0,Pu=0,Zo=!1,$o=!1,sc=!1,Lu=!1,io=-1;const tl=t.roomControllerLevel>=Ce.GUEST;if((tl||t.isOwner||t.isRoomOwner||t.isAnyRoomController)&&(pe=!0,ls=!t.isWallItem,t.roomControllerLevel>=Ce.MODERATOR&&(Zo=!0)),t.isAnyRoomController&&($o=!0),(t.usagePolicy===T_.EVERYBODY||t.usagePolicy===T_.CONTROLLER&&tl||t.extraParam===vs.JUKEBOX&&tl||t.extraParam===vs.USABLE_PRODUCT&&tl)&&(qi=!0),t.extraParam){if(t.extraParam===vs.CRACKABLE_FURNI){const li=t.stuffData;qi=!0,Qi=!0,Gd=li.hits,Pu=li.target}else if(t.extraParam===vs.JUKEBOX){const li=Os().musicController.getRoomItemPlaylist();li&&(io=li.currentSongId),sc=!0}else t.extraParam.indexOf(vs.SONGDISK)===0&&(io=parseInt(t.extraParam.substr(vs.SONGDISK.length)),Lu=!0);if(Zo){const li=t.extraParam.substr(vs.BRANDING_OPTIONS.length);if(li){const yn=li.split("	");for(const ic of yn){const Mn=ic.split("=");Mn&&Mn.length===2&&(Kt.push(Mn[0]),Ae.push(Mn[1]))}}}}if(Zo){const li=rt().getRoomObject(s.roomId,t.id,t.isWallItem?Y.WALL:Y.FLOOR);if(li){const yn=li.model.getValue(A.FURNITURE_CUSTOM_VARIABLES),ic=li.model.getValue(A.FURNITURE_DATA);if(yn&&yn.length)for(const Mn of yn)Lr.push(Mn),Jo.push(ic[Mn]||"")}}t.isOwner||t.isAnyRoomController?wt=_N:(t.isRoomOwner||t.roomControllerLevel>=Ce.GUILD_ADMIN)&&(wt=dN),t.isStickie&&(wt=UE),n(wt),l(pe),u(ls),d(qi),E(Kt),I(Ae),T(Lr),S(Jo),M(Qi),k(Gd),j(Pu),U(Zo),B($o),Z(null),ut(sc),te(Lu),He(io),t.groupId&&H(new Ou(t.groupId,!1))},[s,t]),z(Du,wt=>{const pe=wt.getParser();!t||t.groupId!==pe.id||pe.flag||(J&&Z(null),Z(pe.title))}),_.useEffect(()=>{const wt=Os().musicController.getSongInfo(de);qe((wt==null?void 0:wt.name)??""),Vt((wt==null?void 0:wt.creator)??"")},[de]);const xs=_.useCallback((wt,pe)=>{const ls=Array.from(m);ls[wt]=pe,I(ls)},[m]),ie=_.useCallback((wt,pe)=>{const ls=Array.from(R);ls[wt]=pe,S(ls)},[R]),Ft=_.useCallback(()=>{if(f.length===0||m.length===0)return"";let wt="",pe=0;for(;pe<f.length;){const ls=f[pe],qi=m[pe];wt=wt+(ls+"="+qi+"	"),pe++}return wt},[f,m]),De=_.useCallback(wt=>{if(!(!wt||wt===""))switch(wt){case"buy_one":ht(`catalog/open/offerId/${t.purchaseOfferId}`);return;case"move":rt().processRoomObjectOperation(t.id,t.category,Gt.OBJECT_MOVE);break;case"rotate":rt().processRoomObjectOperation(t.id,t.category,Gt.OBJECT_ROTATE_POSITIVE);break;case"pickup":r===_N?rt().processRoomObjectOperation(t.id,t.category,Gt.OBJECT_PICKUP):rt().processRoomObjectOperation(t.id,t.category,Gt.OBJECT_EJECT);break;case"use":rt().useRoomObject(t.id,t.category);break;case"save_branding_configuration":{const pe=new Map,ls=Ft().split("	");if(ls)for(const qi of ls){const[Kt,Ae]=qi.split("=",2);pe.set(Kt,Ae)}rt().modifyRoomObjectDataWithMap(t.id,t.category,Gt.OBJECT_SAVE_STUFF_DATA,pe);break}case"save_custom_variables":{const pe=new Map;for(let ls=0;ls<p.length;ls++){const qi=p[ls],Kt=R[ls];qi&&qi.length&&Kt&&Kt.length&&pe.set(qi,Kt)}H(new uS(t.id,pe));break}}},[t,r,p,R,Ft]),Rs=_.useCallback(()=>{const wt=t.stuffData;return!wt||!(wt instanceof An)?null:wt.getValue(2)},[t]);return t?i.jsxs(N,{gap:1,alignItems:"end",children:[i.jsx(N,{className:"nitro-infostand rounded",children:i.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[i.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),i.jsx(Dr,{className:"cursor-pointer fa-icon",onClick:e})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{position:"relative",gap:1,children:[t.stuffData.isUnique&&i.jsx("div",{className:"position-absolute end-0",children:i.jsx(DU,{uniqueNumber:t.stuffData.uniqueNumber,uniqueSeries:t.stuffData.uniqueSeries})}),t.stuffData.rarityLevel>-1&&i.jsx("div",{className:"position-absolute end-0",children:i.jsx(HS,{level:t.stuffData.rarityLevel})}),i.jsx(x,{fullWidth:!0,center:!0,children:i.jsx(a9,{roomId:s.roomId,objectId:t.id,category:t.category})})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,children:t.description}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:t.ownerId}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("furni.owner",["name"],[t.ownerName])})]}),t.purchaseOfferId>0&&i.jsx(x,{children:i.jsx(O,{variant:"white",small:!0,underline:!0,pointer:!0,onClick:wt=>De("buy_one"),children:g("infostand.button.buy")})})]}),(Q||Bt)&&i.jsxs(N,{gap:1,children:[i.jsx("hr",{className:"m-0"}),de===-1&&i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.jukebox.text.not.playing")}),!!le.length&&i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(V,{className:"icon disk-icon"}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:le})]}),!!vt.length&&i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(V,{className:"icon disk-creator"}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:vt})]})]}),i.jsxs(N,{gap:1,children:[L&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0"}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.crackable_furni.hits_remaining",["hits","target"],[P.toString(),G.toString()])})]}),t.groupId>0&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0"}),i.jsxs(x,{pointer:!0,alignItems:"center",gap:2,onClick:()=>Dd(t.groupId),children:[i.jsx(Xe,{badgeCode:Rs(),isGroup:!0}),i.jsx(O,{variant:"white",underline:!0,children:J})]})]}),F&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0"}),K&&i.jsxs(O,{small:!0,wrap:!0,variant:"white",children:["ID: ",t.id]}),f.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0"}),i.jsx(N,{gap:1,children:f.map((wt,pe)=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:wt}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:m[pe],onChange:ls=>xs(pe,ls.target.value)})]},pe))})]})]}),p.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0 my-1"}),i.jsx(N,{gap:1,children:p.map((wt,pe)=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(O,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:wt}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:R[pe],onChange:ls=>ie(pe,ls.target.value)})]},pe))})]})]})]})}),i.jsxs(x,{gap:1,justifyContent:"end",children:[o&&i.jsx(W,{variant:"dark",onClick:wt=>De("move"),children:g("infostand.button.move")}),c&&i.jsx(W,{variant:"dark",onClick:wt=>De("rotate"),children:g("infostand.button.rotate")}),r!==UE&&i.jsx(W,{variant:"dark",onClick:wt=>De("pickup"),children:g(r===dN?"infostand.button.eject":"infostand.button.pickup")}),h&&i.jsx(W,{variant:"dark",onClick:wt=>De("use"),children:g("infostand.button.use")}),f.length>0&&m.length>0&&f.length===m.length&&i.jsx(W,{variant:"dark",onClick:()=>De("save_branding_configuration"),children:g("save")}),p.length>0&&R.length>0&&p.length===R.length&&i.jsx(W,{variant:"dark",onClick:()=>De("save_custom_variables"),children:g("save")})]})]}):null},S$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,r]=_.useState(0),[n,o]=_.useState(0),{roomSession:l=null}=Le(),{petRespectRemaining:c=0,respectPet:u=null}=to();if(_.useEffect(()=>{r(t.remainingGrowTime),o(t.remainingTimeToLive)},[t]),_.useEffect(()=>{if(t.petType!==Ds.MONSTERPLANT||t.dead)return;const d=setInterval(()=>{r(f=>f-1),o(f=>f-1)},1e3);return()=>clearInterval(d)},[t]),!t)return null;const h=d=>{let f=!0;if(!(!d||d=="")){switch(d){case"respect":u(t.id),c-1>=1&&(f=!1);break;case"buyfood":ht("catalog/open/"+ct("catalog.links")["pets.buy_food"]);break;case"train":l==null||l.requestPetCommands(t.id);break;case"treat":H(new bd(t.id));break;case"compost":l==null||l.compostPlant(t.id);break;case"pick_up":l==null||l.pickupPet(t.id);break}f&&e()}};return i.jsxs(N,{gap:1,alignItems:"end",children:[i.jsx(N,{className:"nitro-infostand rounded",children:i.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[i.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),i.jsx(Dr,{className:"cursor-pointer fa-icon",onClick:e})]}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g(`pet.breed.${t.petType}.${t.petBreed}`)}),i.jsx("hr",{className:"m-0"})]}),t.petType===Ds.MONSTERPLANT&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{center:!0,gap:1,children:[i.jsx(ia,{figure:t.petFigure,posture:t.posture,direction:4}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:2,children:[!t.dead&&i.jsx(N,{alignItems:"center",gap:1,children:i.jsx(O,{variant:"white",center:!0,small:!0,wrap:!0,children:g("pet.level",["level","maxlevel"],[t.level.toString(),t.maximumLevel.toString()])})}),i.jsxs(N,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.wellbeing")}),i.jsxs(V,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[i.jsx(x,{fit:!0,center:!0,position:"absolute",children:i.jsx(O,{variant:"white",small:!0,children:t.dead?"00:00:00":el(n==0?t.remainingTimeToLive:n).split(":")[1]+":"+el(n==null||n==null?0:n).split(":")[2]+":"+el(n==null||n==null?0:n).split(":")[3]})}),i.jsx(V,{className:"bg-success rounded pet-stats",style:{width:t.dead?"0":Math.round(t.maximumTimeToLive*100/n).toString()}})]})]}),s!=0&&s>0&&i.jsxs(N,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.growth")}),i.jsx(s9,{className:"top-2 end-2",day:el(s).split(":")[0],hour:el(s).split(":")[1],minutes:el(s).split(":")[2],seconds:el(s).split(":")[3]})]}),i.jsxs(N,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.raritylevel",["level"],[g(`infostand.pet.raritylevel.${t.rarityLevel}`)])}),i.jsx(HS,{className:"top-2 end-2",level:t.rarityLevel})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("pet.age",["age"],[t.age.toString()])}),i.jsx("hr",{className:"m-0"})]})]}),t.petType!==Ds.MONSTERPLANT&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{gap:1,children:[i.jsx(N,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:i.jsx(ia,{figure:t.petFigure,posture:t.posture,direction:4})}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsx(O,{variant:"white",center:!0,small:!0,wrap:!0,children:g("pet.level",["level","maxlevel"],[t.level.toString(),t.maximumLevel.toString()])}),i.jsxs(N,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.happiness")}),i.jsxs(V,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[i.jsx(x,{fit:!0,center:!0,position:"absolute",children:i.jsx(O,{variant:"white",small:!0,children:t.happyness+"/"+t.maximumHappyness})}),i.jsx(V,{className:"bg-info rounded pet-stats",style:{width:t.happyness/t.maximumHappyness*100+"%"}})]})]}),i.jsxs(N,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.experience")}),i.jsxs(V,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[i.jsx(x,{fit:!0,center:!0,position:"absolute",children:i.jsx(O,{variant:"white",small:!0,children:t.experience+"/"+t.levelExperienceGoal})}),i.jsx(V,{className:"bg-purple rounded pet-stats",style:{width:t.experience/t.levelExperienceGoal*100+"%"}})]})]}),i.jsxs(N,{alignItems:"center",gap:1,children:[i.jsx(O,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.energy")}),i.jsxs(V,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[i.jsx(x,{fit:!0,center:!0,position:"absolute",children:i.jsx(O,{variant:"white",small:!0,children:t.energy+"/"+t.maximumEnergy})}),i.jsx(V,{className:"bg-success rounded pet-stats",style:{width:t.energy/t.maximumEnergy*100+"%"}})]})]})]})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[t.petType!==Ds.MONSTERPLANT&&i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.petrespect",["count"],[t.respect.toString()])}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("pet.age",["age"],[t.age.toString()])}),i.jsx("hr",{className:"m-0"})]})]}),i.jsx(N,{gap:1,children:i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:t.ownerId}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.petowner",["name"],[t.ownerName])})]})})]})}),i.jsxs(x,{gap:1,justifyContent:"end",children:[t.petType!==Ds.MONSTERPLANT&&i.jsx(W,{variant:"dark",onClick:d=>h("buyfood"),children:g("infostand.button.buyfood")}),t.isOwner&&t.petType!==Ds.MONSTERPLANT&&i.jsx(W,{variant:"dark",onClick:d=>h("train"),children:g("infostand.button.train")}),!t.dead&&t.energy/t.maximumEnergy<.98&&t.petType===Ds.MONSTERPLANT&&i.jsx(W,{variant:"dark",onClick:d=>h("treat"),children:g("infostand.button.pettreat")}),(l==null?void 0:l.isRoomOwner)&&t.petType===Ds.MONSTERPLANT&&i.jsx(W,{variant:"dark",onClick:d=>h("compost"),children:g("infostand.button.compost")}),t.isOwner&&i.jsx(W,{variant:"dark",onClick:d=>h("pick_up"),children:g("inventory.pets.pickup")}),c>0&&t.petType!==Ds.MONSTERPLANT&&i.jsx(W,{variant:"dark",onClick:d=>h("respect"),children:g("infostand.button.petrespect",["count"],[c.toString()])})]})]})},O$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,s=_.useMemo(()=>!(t.botSkills.indexOf(Ke.NO_PICK_UP)>=0||!t.amIOwner&&!t.amIAnyRoomController),[t]),r=()=>H(new Km(t.webID));if(t)return i.jsxs(N,{gap:1,children:[i.jsx(N,{className:"nitro-infostand rounded",children:i.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[i.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),i.jsx(Dr,{className:"cursor-pointer fa-icon",onClick:e})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{gap:1,children:[i.jsx(N,{fullWidth:!0,className:"body-image bot",children:i.jsx(os,{figure:t.figure,direction:4})}),i.jsx(N,{grow:!0,center:!0,gap:0,children:t.badges.length>0&&t.badges.map(n=>i.jsx(Xe,{badgeCode:n,showInfo:!0},n))})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsx(x,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:i.jsx(O,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:t.motto})}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:t.ownerId}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.botowner",["name"],[t.ownerName])})]}),t.carryItem>0&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0"}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.handitem",["item"],[g("handitem"+t.carryItem)])})]})]})]})}),s&&i.jsx(x,{justifyContent:"end",children:i.jsx(W,{variant:"dark",onClick:r,children:g("infostand.button.pickup")})})]})},jE=a=>{const{type:t=-1,relationship:e=null}=a;if(!e)return null;const s=ur.RELATIONSHIP_NAMES[t].toLocaleLowerCase();return i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("i",{className:`nitro-friends-spritesheet icon-${s}`}),i.jsx(x,{alignItems:"center",gap:0,children:i.jsxs(O,{small:!0,variant:"white",onClick:r=>Ki(e.randomFriendId),children:[i.jsx("u",{children:e.randomFriendName}),e.friendCount>1&&" "+g(`extendedprofile.relstatus.others.${s}`,["count"],[(e.friendCount-1).toString()])]})})]})},A$=a=>{const{relationships:t=null}=a;return!t||!t.relationshipStatusMap.length?null:i.jsxs(i.Fragment,{children:[i.jsx(jE,{type:ur.HEART,relationship:t.relationshipStatusMap.getValue(ur.HEART)}),i.jsx(jE,{type:ur.SMILE,relationship:t.relationshipStatusMap.getValue(ur.SMILE)}),i.jsx(jE,{type:ur.BOBBA,relationship:t.relationshipStatusMap.getValue(ur.BOBBA)})]})},N$=a=>{ht(`navigator/search/${a}`),H(new Vl("hotel_view",`tag:${a}`))},C$=a=>{const{tags:t=null}=a;return!t||!t.length?null:i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0"}),i.jsx(x,{className:"flex-tags",children:t&&t.length>0&&t.map((e,s)=>i.jsx(O,{variant:"white",className:"text-tags",onClick:r=>N$(e),children:e},s))})]})},x$=a=>{const{avatarInfo:t=null,setAvatarInfo:e=null,onClose:s=null}=a,[r,n]=_.useState(null),[o,l]=_.useState(!1),[c,u]=_.useState(null),{roomSession:h=null}=Le(),d=m=>{!o||m.length>ct("motto.max.length",38)||(h.sendMottoMessage(m),l(!1))},f=m=>d(m.target.value),E=m=>{switch(m.stopPropagation(),m.key){case"Enter":d(m.target.value);return}};return ft(P_.RSUBE_BADGES,m=>{!t||t.webID!==m.userId||t.badges.join("")===m.badges.join("")||e(p=>{const T=bi(p);return T.badges=m.badges,T})}),ft(U_.USER_FIGURE,m=>{!t||t.roomIndex!==m.roomIndex||e(I=>{const p=bi(I);return p.figure=m.figure,p.motto=m.customInfo,p.achievementScore=m.activityPoints,p})}),ft(y_.FAVOURITE_GROUP_UPDATE,m=>{!t||t.roomIndex!==m.roomIndex||e(I=>{const p=bi(I),T=m.status===-1||m.habboGroupId<=0;return p.groupId=T?-1:m.habboGroupId,p.groupName=T?null:m.habboGroupName,p.groupBadgeId=T?null:tt().getGroupBadge(m.habboGroupId),p})}),z(QR,m=>{const I=m.getParser();!t||t.webID!==I.userId||u(I)}),_.useEffect(()=>(l(!1),n(t.motto),H(new IS(t.webID)),()=>{l(!1),n(null),u(null)}),[t]),t?i.jsx(N,{className:"nitro-infostand rounded",children:i.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(br,{userId:t.webID}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name})]}),i.jsx(Dr,{className:"cursor-pointer fa-icon",onClick:s})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{gap:1,children:[i.jsx(N,{fullWidth:!0,className:"body-image",onClick:m=>Ki(t.webID),children:i.jsx(os,{figure:t.figure,direction:4})}),i.jsxs(N,{grow:!0,alignItems:"center",gap:0,children:[i.jsxs(x,{gap:1,children:[i.jsx(x,{center:!0,className:"badge-image",children:t.badges[0]&&i.jsx(Xe,{badgeCode:t.badges[0],showInfo:!0})}),i.jsx(x,{center:!0,pointer:t.groupId>0,className:"badge-image",onClick:m=>Dd(t.groupId),children:t.groupId>0&&i.jsx(Xe,{badgeCode:t.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:t.groupName})})]}),i.jsxs(x,{center:!0,gap:1,children:[i.jsx(x,{center:!0,className:"badge-image",children:t.badges[1]&&i.jsx(Xe,{badgeCode:t.badges[1],showInfo:!0})}),i.jsx(x,{center:!0,className:"badge-image",children:t.badges[2]&&i.jsx(Xe,{badgeCode:t.badges[2],showInfo:!0})})]}),i.jsxs(x,{center:!0,gap:1,children:[i.jsx(x,{center:!0,className:"badge-image",children:t.badges[3]&&i.jsx(Xe,{badgeCode:t.badges[3],showInfo:!0})}),i.jsx(x,{center:!0,className:"badge-image",children:t.badges[4]&&i.jsx(Xe,{badgeCode:t.badges[4],showInfo:!0})})]})]})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:[t.type!==ws.OWN_USER&&i.jsx(x,{grow:!0,alignItems:"center",className:"motto-content",children:i.jsx(O,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",children:r})}),t.type===ws.OWN_USER&&i.jsxs(x,{grow:!0,alignItems:"center",gap:2,children:[i.jsx(k0,{className:"small fa-icon"}),i.jsxs(x,{grow:!0,alignItems:"center",className:"motto-content",children:[!o&&i.jsxs(O,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",onClick:m=>l(!0),children:[r,""]}),o&&i.jsx("input",{type:"text",className:"motto-input",maxLength:ct("motto.max.length",38),value:r,onChange:m=>n(m.target.value),onBlur:f,onKeyDown:E,autoFocus:!0})]})]})]}),i.jsx("hr",{className:"m-0"})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.achievement_score")+" "+t.achievementScore}),t.carryItem>0&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0"}),i.jsx(O,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.handitem",["item"],[g("handitem"+t.carryItem)])})]})]}),i.jsx(N,{gap:1,children:i.jsx(A$,{relationships:c})}),ct("user.tags.enabled")&&i.jsx(N,{gap:1,className:"mt-1",children:i.jsx(C$,{tags:tt().tags})})]})}):null},o_=0,wE=1,gN=2,fN=3,FE=4,mN=5,EN=6,y$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,r]=_.useState(o_),{canRequestFriend:n=null}=gr(),{report:o=null}=en(),{roomSession:l=null}=Le(),{userRespectRemaining:c=0,respectUser:u=null}=to(),h=_.useMemo(()=>t.amIOwner&&t.targetRoomControllerLevel<Ce.GUEST&&!t.isGuildRoom,[t]),d=_.useMemo(()=>t.amIOwner&&t.targetRoomControllerLevel===Ce.GUEST&&!t.isGuildRoom,[t]),f=_.useMemo(()=>t.canBeKicked||t.canBeBanned||t.canBeMuted||h||d,[h,d,t]),E=_.useMemo(()=>{let I=!1;const p=Zl();if(p){const T=p.model.getValue(A.FIGURE_CARRY_OBJECT);T>0&&T<999999&&(I=!0)}return I},[]),m=I=>{let p=!0;if(I)switch(I){case"moderate":p=!1,r(wE);break;case"ban":p=!1,r(gN);break;case"mute":p=!1,r(fN);break;case"ambassador":p=!1,r(FE);break;case"ambassador_mute":p=!1,r(mN);break;case"back_moderate":p=!1,r(wE);break;case"back_ambassador":p=!1,r(FE);break;case"back":p=!1,r(o_);break;case"whisper":Ps(new wl(wl.WHISPER,t.name));break;case"friend":ht(`friends/request/${t.webID}/${t.name}`);break;case"relationship":p=!1,r(EN);break;case"respect":{u(t.webID),c-1>=1&&(p=!1);break}case"ignore":tt().ignoreUser(t.name);break;case"unignore":tt().unignoreUser(t.name);break;case"kick":l.sendKickMessage(t.webID);break;case"ban_hour":l.sendBanMessage(t.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":l.sendBanMessage(t.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":l.sendBanMessage(t.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":l.sendMuteMessage(t.webID,2);break;case"mute_5min":l.sendMuteMessage(t.webID,5);break;case"mute_10min":l.sendMuteMessage(t.webID,10);break;case"give_rights":l.sendGiveRightsMessage(t.webID);break;case"remove_rights":l.sendTakeRightsMessage(t.webID);break;case"trade":H(new BD(t.roomIndex));break;case"report":o(ns.BULLY,{reportedUserId:t.webID});break;case"pass_hand_item":H(new wP(t.webID));break;case"ambassador_alert":l.sendAmbassadorAlertMessage(t.webID);break;case"ambassador_kick":l.sendKickMessage(t.webID);break;case"ambassador_mute_2min":l.sendMuteMessage(t.webID,2);break;case"ambassador_mute_10min":l.sendMuteMessage(t.webID,10);break;case"ambassador_mute_60min":l.sendMuteMessage(t.webID,60);break;case"ambassador_mute_18hour":l.sendMuteMessage(t.webID,1080);break;case"rship_heart":H(new mc(t.webID,Wi.RELATIONSHIP_HEART));break;case"rship_smile":H(new mc(t.webID,Wi.RELATIONSHIP_SMILE));break;case"rship_bobba":H(new mc(t.webID,Wi.RELATIONSHIP_BOBBA));break;case"rship_none":H(new mc(t.webID,Wi.RELATIONSHIP_NONE));break}p&&e()};return _.useEffect(()=>{r(o_)},[t]),i.jsxs(Ra,{objectId:t.roomIndex,category:Y.UNIT,userType:t.userType,onClose:e,collapsable:!0,children:[i.jsx(yi,{className:"cursor-pointer",onClick:I=>Ki(t.webID),children:t.name}),s===o_&&i.jsxs(i.Fragment,{children:[n(t.webID)&&i.jsx(st,{onClick:I=>m("friend"),children:g("infostand.button.friend")}),i.jsx(st,{onClick:I=>m("trade"),children:g("infostand.button.trade")}),i.jsx(st,{onClick:I=>m("whisper"),children:g("infostand.button.whisper")}),c>0&&i.jsx(st,{onClick:I=>m("respect"),children:g("infostand.button.respect",["count"],[c.toString()])}),!n(t.webID)&&i.jsxs(st,{onClick:I=>m("relationship"),children:[g("infostand.link.relationship"),i.jsx(cr,{className:"right fa-icon"})]}),!t.isIgnored&&i.jsx(st,{onClick:I=>m("ignore"),children:g("infostand.button.ignore")}),t.isIgnored&&i.jsx(st,{onClick:I=>m("unignore"),children:g("infostand.button.unignore")}),i.jsx(st,{onClick:I=>m("report"),children:g("infostand.button.report")}),f&&i.jsxs(st,{onClick:I=>m("moderate"),children:[i.jsx(cr,{className:"right fa-icon"}),g("infostand.link.moderate")]}),t.isAmbassador&&i.jsxs(st,{onClick:I=>m("ambassador"),children:[i.jsx(cr,{className:"right fa-icon"}),g("infostand.link.ambassador")]}),E&&i.jsx(st,{onClick:I=>m("pass_hand_item"),children:g("avatar.widget.pass_hand_item")})]}),s===wE&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:I=>m("kick"),children:g("infostand.button.kick")}),i.jsxs(st,{onClick:I=>m("mute"),children:[i.jsx(cr,{className:"right fa-icon"}),g("infostand.button.mute")]}),i.jsxs(st,{onClick:I=>m("ban"),children:[i.jsx(cr,{className:"right fa-icon"}),g("infostand.button.ban")]}),h&&i.jsx(st,{onClick:I=>m("give_rights"),children:g("infostand.button.giverights")}),d&&i.jsx(st,{onClick:I=>m("remove_rights"),children:g("infostand.button.removerights")}),i.jsxs(st,{onClick:I=>m("back"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]}),s===gN&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:I=>m("ban_hour"),children:g("infostand.button.ban_hour")}),i.jsx(st,{onClick:I=>m("ban_day"),children:g("infostand.button.ban_day")}),i.jsx(st,{onClick:I=>m("perm_ban"),children:g("infostand.button.perm_ban")}),i.jsxs(st,{onClick:I=>m("back_moderate"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]}),s===fN&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:I=>m("mute_2min"),children:g("infostand.button.mute_2min")}),i.jsx(st,{onClick:I=>m("mute_5min"),children:g("infostand.button.mute_5min")}),i.jsx(st,{onClick:I=>m("mute_10min"),children:g("infostand.button.mute_10min")}),i.jsxs(st,{onClick:I=>m("back_moderate"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]}),s===FE&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:I=>m("ambassador_alert"),children:g("infostand.button.alert")}),i.jsx(st,{onClick:I=>m("ambassador_kick"),children:g("infostand.button.kick")}),i.jsxs(st,{onClick:I=>m("ambassador_mute"),children:[g("infostand.button.mute"),i.jsx(cr,{className:"right fa-icon"})]}),i.jsxs(st,{onClick:I=>m("back"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]}),s===mN&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:I=>m("ambassador_mute_2min"),children:g("infostand.button.mute_2min")}),i.jsx(st,{onClick:I=>m("ambassador_mute_10min"),children:g("infostand.button.mute_10min")}),i.jsx(st,{onClick:I=>m("ambassador_mute_60min"),children:g("infostand.button.mute_60min")}),i.jsx(st,{onClick:I=>m("ambassador_mute_18hr"),children:g("infostand.button.mute_18hour")}),i.jsxs(st,{onClick:I=>m("back_ambassador"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]}),s===EN&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:I=>m("rship_heart"),children:i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),i.jsx(st,{onClick:I=>m("rship_smile"),children:i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),i.jsx(st,{onClick:I=>m("rship_bobba"),children:i.jsx(V,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})})]}),i.jsx(st,{onClick:I=>m("rship_none"),children:g("avatar.widget.clear_relationship")}),i.jsxs(st,{onClick:I=>m("back"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]})]})},e0=a=>{const{classNames:t=[],...e}=a,s=_.useMemo(()=>{const r=["menu-list"];return t.length&&r.push(...t),r},[t]);return i.jsx(N,{classNames:s,...e})},M$=a=>{const{userId:t=-1,userName:e="",roomIndex:s=-1,setIsDecorating:r=null}=a;return i.jsx(Ra,{objectId:s,category:Y.UNIT,onClose:null,children:i.jsx(e0,{children:i.jsx(st,{onClick:n=>r(!1),children:g("widget.avatar.stop_decorating")})})})},b$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,s=r=>{if(r)switch(r){case"move":Ic(t.id,t.category,Gt.OBJECT_MOVE);break;case"rotate":Ic(t.id,t.category,Gt.OBJECT_ROTATE_POSITIVE);break;case"pickup":Ic(t.id,t.category,Gt.OBJECT_PICKUP);break;case"eject":Ic(t.id,t.category,Gt.OBJECT_EJECT);break}};return i.jsxs(Ra,{objectId:t.id,category:t.category,onClose:e,collapsable:!0,children:[i.jsx(yi,{children:t.name}),i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:r=>s("move"),children:i.jsx(B0,{className:"center fa-icon"})}),i.jsx(st,{onClick:r=>s("rotate"),disabled:t.isWallItem,children:i.jsx(V0,{className:"center fa-icon"})}),(t.isOwner||t.isAnyRoomController)&&i.jsx(st,{onClick:r=>s("pickup"),children:i.jsx(DO,{className:"center fa-icon"})}),!t.isOwner&&!t.isAnyRoomController&&(t.isRoomOwner||t.roomControllerLevel>=Ce.GUILD_ADMIN)&&i.jsx(st,{onClick:r=>s("eject"),children:i.jsx(DO,{className:"center fa-icon"})})]})]})},pN=a=>{const{nameInfo:t=null,onClose:e=null}=a,s=_.useMemo(()=>{const r=["name-only"];return t.isFriend&&r.push("is-friend"),r},[t]);return i.jsx(Ra,{objectId:t.roomIndex,category:t.category,userType:t.userType,fades:t.id!==tt().userId,classNames:s,onClose:e,children:i.jsx("div",{className:"text-shadow",children:t.name})})},GE=0,kE=1,IN=3,TN=4,D$=a=>{const{avatarInfo:t=null,isDancing:e=!1,setIsDecorating:s=null,onClose:r=null}=a,[n,o]=_.useState(e&&Pl()?kE:GE),{roomSession:l=null}=Le(),c=d=>{let f=!0;if(d)if(d.startsWith("sign_")){const E=parseInt(d.split("_")[1]);l.sendSignMessage(E)}else switch(d){case"decorate":s(!0);break;case"change_name":Ps(new Od(Od.INIT));break;case"change_looks":ht("avatar-editor/show");break;case"expressions":f=!1,o(IN);break;case"sit":l.sendPostureMessage(xg.POSTURE_SIT);break;case"stand":l.sendPostureMessage(xg.POSTURE_STAND);break;case"wave":l.sendExpressionMessage(Qr.WAVE.ordinal);break;case"blow":l.sendExpressionMessage(Qr.BLOW.ordinal);break;case"laugh":l.sendExpressionMessage(Qr.LAUGH.ordinal);break;case"idle":l.sendExpressionMessage(Qr.IDLE.ordinal);break;case"dance_menu":f=!1,o(kE);break;case"dance":l.sendDanceMessage(1);break;case"dance_stop":l.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":l.sendDanceMessage(parseInt(d.charAt(d.length-1)));break;case"signs":f=!1,o(TN);break;case"back":f=!1,o(GE);break;case"drop_carry_item":H(new jP);break}f&&r()},u=()=>t.amIOwner||t.amIAnyRoomController||t.roomControllerLevel>Ce.GUEST,h=eq();return i.jsxs(Ra,{objectId:t.roomIndex,category:Y.UNIT,userType:t.userType,onClose:r,collapsable:!0,children:[i.jsx(yi,{className:"cursor-pointer",onClick:d=>Ki(t.webID),children:t.name}),n===GE&&i.jsxs(i.Fragment,{children:[t.allowNameChange&&i.jsx(st,{onClick:d=>c("change_name"),children:g("widget.avatar.change_name")}),u()&&i.jsx(st,{onClick:d=>c("decorate"),children:g("widget.avatar.decorate")}),i.jsx(st,{onClick:d=>c("change_looks"),children:g("widget.memenu.myclothes")}),Pl()&&!h&&i.jsxs(st,{onClick:d=>c("dance_menu"),children:[i.jsx(cr,{className:"right fa-icon"}),g("widget.memenu.dance")]}),!e&&!Pl()&&!h&&i.jsx(st,{onClick:d=>c("dance"),children:g("widget.memenu.dance")}),e&&!Pl()&&!h&&i.jsx(st,{onClick:d=>c("dance_stop"),children:g("widget.memenu.dance.stop")}),i.jsxs(st,{onClick:d=>c("expressions"),children:[i.jsx(cr,{className:"right fa-icon"}),g("infostand.link.expressions")]}),i.jsxs(st,{onClick:d=>c("signs"),children:[i.jsx(cr,{className:"right fa-icon"}),g("infostand.show.signs")]}),t.carryItem>0&&i.jsx(st,{onClick:d=>c("drop_carry_item"),children:g("avatar.widget.drop_hand_item")})]}),n===kE&&i.jsxs(i.Fragment,{children:[e&&i.jsx(st,{onClick:d=>c("dance_stop"),children:g("widget.memenu.dance.stop")}),i.jsx(st,{onClick:d=>c("dance_1"),children:g("widget.memenu.dance1")}),i.jsx(st,{onClick:d=>c("dance_2"),children:g("widget.memenu.dance2")}),i.jsx(st,{onClick:d=>c("dance_3"),children:g("widget.memenu.dance3")}),i.jsx(st,{onClick:d=>c("dance_4"),children:g("widget.memenu.dance4")}),i.jsxs(st,{onClick:d=>c("back"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]}),n===IN&&i.jsxs(i.Fragment,{children:[$X()===St.POSTURE_STAND&&i.jsx(st,{onClick:d=>c("sit"),children:g("widget.memenu.sit")}),BX()&&i.jsx(st,{onClick:d=>c("stand"),children:g("widget.memenu.stand")}),OE()&&i.jsx(st,{onClick:d=>c("wave"),children:g("widget.memenu.wave")}),OE()&&i.jsxs(st,{disabled:!Xd(),onClick:d=>c("laugh"),children:[!Xd()&&i.jsx(ps,{type:"hc"}),g("widget.memenu.laugh")]}),OE()&&i.jsxs(st,{disabled:!Xd(),onClick:d=>c("blow"),children:[!Xd()&&i.jsx(ps,{type:"hc"}),g("widget.memenu.blow")]}),i.jsx(st,{onClick:d=>c("idle"),children:g("widget.memenu.idle")}),i.jsxs(st,{onClick:d=>c("back"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]}),n===TN&&i.jsxs(i.Fragment,{children:[i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:d=>c("sign_1"),children:"1"}),i.jsx(st,{onClick:d=>c("sign_2"),children:"2"}),i.jsx(st,{onClick:d=>c("sign_3"),children:"3"})]}),i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:d=>c("sign_4"),children:"4"}),i.jsx(st,{onClick:d=>c("sign_5"),children:"5"}),i.jsx(st,{onClick:d=>c("sign_6"),children:"6"})]}),i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:d=>c("sign_7"),children:"7"}),i.jsx(st,{onClick:d=>c("sign_8"),children:"8"}),i.jsx(st,{onClick:d=>c("sign_9"),children:"9"})]}),i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:d=>c("sign_10"),children:"10"}),i.jsx(st,{onClick:d=>c("sign_11"),children:i.jsx("i",{className:"icon icon-sign-heart"})}),i.jsx(st,{onClick:d=>c("sign_12"),children:i.jsx("i",{className:"icon icon-sign-skull"})})]}),i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:d=>c("sign_0"),children:"0"}),i.jsx(st,{onClick:d=>c("sign_13"),children:i.jsx("i",{className:"icon icon-sign-exclamation"})}),i.jsx(st,{onClick:d=>c("sign_15"),children:i.jsx("i",{className:"icon icon-sign-smile"})})]}),i.jsxs(x,{className:"menu-list-split-3",children:[i.jsx(st,{onClick:d=>c("sign_14"),children:i.jsx("i",{className:"icon icon-sign-soccer"})}),i.jsx(st,{onClick:d=>c("sign_17"),children:i.jsx("i",{className:"icon icon-sign-yellow"})}),i.jsx(st,{onClick:d=>c("sign_16"),children:i.jsx("i",{className:"icon icon-sign-red"})})]}),i.jsxs(st,{onClick:d=>c("back"),children:[i.jsx(lr,{className:"left fa-icon"}),g("generic.back")]})]})]})},BE=0,RN=1,SN=2,ON=3,v$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,r]=_.useState(BE),{roomSession:n=null}=Le(),{petRespectRemaining:o=0,respectPet:l=null}=to(),c=_.useMemo(()=>{let h=!1;const d=Zl();if(d){const f=d.model.getValue(A.FIGURE_CARRY_OBJECT);f>0&&f<999999&&(h=!0)}return h},[]),u=h=>{let d=!0;if(h)switch(h){case"respect":l(t.id),o-1>=1&&(d=!1);break;case"treat":H(new bd(t.id));break;case"pass_handitem":H(new fS(t.id));break;case"train":n.requestPetCommands(t.id);break;case"pick_up":n.pickupPet(t.id);break;case"mount":n.mountPet(t.id);break;case"toggle_riding_permission":n.togglePetRiding(t.id);break;case"toggle_breeding_permission":n.togglePetBreeding(t.id);break;case"dismount":n.dismountPet(t.id);break;case"saddle_off":n.removePetSaddle(t.id);break;case"breed":break;case"harvest":n.harvestPet(t.id);break;case"revive":break;case"compost":n.compostPlant(t.id);break;case"buy_saddle":ht("catalog/open/"+ct("catalog.links")["pets.buy_saddle"]);break}d&&e()};return _.useEffect(()=>{r(h=>t.petType===Ds.MONSTERPLANT?ON:t.saddle&&!t.rider?RN:t.rider?SN:BE)},[t]),i.jsxs(Ra,{objectId:t.roomIndex,category:Y.UNIT,userType:Pe.PET,onClose:e,collapsable:!0,children:[i.jsx(yi,{children:t.name}),s===BE&&i.jsxs(i.Fragment,{children:[o>0&&i.jsx(st,{onClick:h=>u("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])}),i.jsx(st,{onClick:h=>u("train"),children:g("infostand.button.train")}),i.jsx(st,{onClick:h=>u("pick_up"),children:g("infostand.button.pickup")}),t.petType===Ds.HORSE&&i.jsx(st,{onClick:h=>u("buy_saddle"),children:g("infostand.button.buy_saddle")}),[Ds.BEAR,Ds.TERRIER,Ds.CAT,Ds.DOG,Ds.PIG].indexOf(t.petType)>-1&&i.jsx(st,{onClick:h=>u("breed"),children:g("infostand.button.breed")})]}),s===RN&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:h=>u("mount"),children:g("infostand.button.mount")}),i.jsxs(st,{onClick:h=>u("toggle_riding_permission"),gap:1,children:[i.jsx("input",{type:"checkbox",checked:!!t.publiclyRideable,readOnly:!0}),g("infostand.button.toggle_riding_permission")]}),o>0&&i.jsx(st,{onClick:h=>u("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])}),i.jsx(st,{onClick:h=>u("train"),children:g("infostand.button.train")}),i.jsx(st,{onClick:h=>u("pick_up"),children:g("infostand.button.pickup")}),i.jsx(st,{onClick:h=>u("saddle_off"),children:g("infostand.button.saddleoff")})]}),s===SN&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:h=>u("dismount"),children:g("infostand.button.dismount")}),o>0&&i.jsx(st,{onClick:h=>u("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])})]}),s===ON&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:h=>u("pick_up"),children:g("infostand.button.pickup")}),t.dead&&i.jsx(st,{onClick:h=>u("revive"),children:g("infostand.button.revive")}),n.isRoomOwner&&i.jsx(st,{onClick:h=>u("compost"),children:g("infostand.button.compost")}),!t.dead&&t.energy/t.maximumEnergy<.98&&i.jsx(st,{onClick:h=>u("treat"),children:g("infostand.button.pettreat")}),!t.dead&&t.level===t.maximumLevel&&t.breedable&&i.jsxs(i.Fragment,{children:[i.jsxs(st,{onClick:h=>u("toggle_breeding_permission"),gap:1,children:[i.jsx("input",{type:"checkbox",checked:t.publiclyBreedable,readOnly:!0}),g("infostand.button.toggle_breeding_permission")]}),i.jsx(st,{onClick:h=>u("breed"),children:g("infostand.button.breed")})]})]}),c&&i.jsx(st,{onClick:h=>u("pass_hand_item"),children:g("infostand.button.pass_hand_item")})]})},VE=0,AN=1,NN=2,CN=3,P$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,r]=_.useState(VE),{roomSession:n=null}=Le(),{petRespectRemaining:o=0,respectPet:l=null}=to(),c=_.useMemo(()=>n.isRoomOwner||n.controllerLevel>=Ce.GUEST||tt().isModerator,[n]),u=_.useMemo(()=>{let d=!1;const f=Zl();if(f){const E=f.model.getValue(A.FIGURE_CARRY_OBJECT);E>0&&E<999999&&(d=!0)}return d},[]),h=d=>{let f=!0;if(d)switch(d){case"respect":l(t.id),o-1>=1&&(f=!1);break;case"treat":H(new bd(t.id));break;case"pass_handitem":H(new fS(t.id));break;case"pick_up":n.pickupPet(t.id);break;case"mount":n.mountPet(t.id);break;case"dismount":n.dismountPet(t.id);break}f&&e()};return _.useEffect(()=>{r(d=>t.petType===Ds.MONSTERPLANT?CN:t.saddle&&!t.rider?AN:t.rider?NN:VE)},[t]),i.jsxs(Ra,{objectId:t.roomIndex,category:Y.UNIT,userType:Pe.PET,onClose:e,collapsable:!0,children:[i.jsx(yi,{children:t.name}),s===VE&&o>0&&i.jsx(st,{onClick:d=>h("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])}),s===AN&&i.jsxs(i.Fragment,{children:[!!t.publiclyRideable&&i.jsx(st,{onClick:d=>h("mount"),children:g("infostand.button.mount")}),o>0&&i.jsx(st,{onClick:d=>h("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])})]}),s===NN&&i.jsxs(i.Fragment,{children:[i.jsx(st,{onClick:d=>h("dismount"),children:g("infostand.button.dismount")}),o>0&&i.jsx(st,{onClick:d=>h("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])})]}),s===CN&&!t.dead&&t.energy/t.maximumEnergy<.98&&i.jsx(st,{onClick:d=>h("treat"),children:g("infostand.button.pettreat")}),c&&i.jsx(st,{onClick:d=>h("pick_up"),children:g("infostand.button.pickup")}),u&&i.jsx(st,{onClick:d=>h("pass_hand_item"),children:g("infostand.button.pass_hand_item")})]})},HE=0,xN=1,yN=2,L$=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,r]=_.useState(HE),[n,o]=_.useState(""),[l,c]=_.useState("");z(qy,f=>{const E=f.getParser();if(E.botId===t.webID)switch(E.commandId){case Ke.CHANGE_BOT_NAME:o(E.data),r(xN);return;case Ke.CHANGE_BOT_MOTTO:c(E.data),r(yN);return;case Ke.SETUP_CHAT:{const m=E.data,I=m.split(m.indexOf(";#;")===-1?";":";#;");(I.length===3||I.length===4)&&(Ps(new Cg(t.roomIndex,Y.UNIT,t.webID,I[0],I[1].toLowerCase()==="true"||I[1]==="1",parseInt(I[2]),I[3]?I[3].toLowerCase()==="true"||I[3]==="1":!1)),e());return}}});const u=f=>H(new Hv(t.webID,f)),h=f=>{let E=!0;if(f)switch(f){case"donate_to_all":u(Ke.DONATE_TO_ALL),H(new Dn(t.webID,Ke.DONATE_TO_ALL,""));break;case"donate_to_user":u(Ke.DONATE_TO_USER),H(new Dn(t.webID,Ke.DONATE_TO_USER,""));break;case"change_bot_name":u(Ke.CHANGE_BOT_NAME),E=!1;break;case"save_bot_name":H(new Dn(t.webID,Ke.CHANGE_BOT_NAME,n));break;case"change_bot_motto":u(Ke.CHANGE_BOT_MOTTO),E=!1;break;case"save_bot_motto":H(new Dn(t.webID,Ke.CHANGE_BOT_MOTTO,l));break;case"dress_up":H(new Dn(t.webID,Ke.DRESS_UP,""));break;case"random_walk":H(new Dn(t.webID,Ke.RANDOM_WALK,""));break;case"setup_chat":u(Ke.SETUP_CHAT),E=!1;break;case"dance":H(new Dn(t.webID,Ke.DANCE,""));break;case"nux_take_tour":ht("help/tour"),H(new Dn(t.webID,Ke.NUX_TAKE_TOUR,""));break;case"pick":H(new Km(t.webID));break}E&&e()};_.useEffect(()=>{r(HE)},[t]);const d=t.amIOwner||t.amIAnyRoomController;return i.jsxs(Ra,{objectId:t.roomIndex,category:Y.UNIT,userType:Pe.RENTABLE_BOT,onClose:e,collapsable:!0,children:[i.jsx(yi,{children:t.name}),s===HE&&d&&i.jsxs(i.Fragment,{children:[t.botSkills.indexOf(Ke.DONATE_TO_ALL)>=0&&i.jsx(st,{onClick:f=>h("donate_to_all"),children:g("avatar.widget.donate_to_all")}),t.botSkills.indexOf(Ke.DONATE_TO_USER)>=0&&i.jsx(st,{onClick:f=>h("donate_to_user"),children:g("avatar.widget.donate_to_user")}),t.botSkills.indexOf(Ke.CHANGE_BOT_NAME)>=0&&i.jsx(st,{onClick:f=>h("change_bot_name"),children:g("avatar.widget.change_bot_name")}),t.botSkills.indexOf(Ke.CHANGE_BOT_MOTTO)>=0&&i.jsx(st,{onClick:f=>h("change_bot_motto"),children:g("avatar.widget.change_bot_motto")}),t.botSkills.indexOf(Ke.DRESS_UP)>=0&&i.jsx(st,{onClick:f=>h("dress_up"),children:g("avatar.widget.dress_up")}),t.botSkills.indexOf(Ke.RANDOM_WALK)>=0&&i.jsx(st,{onClick:f=>h("random_walk"),children:g("avatar.widget.random_walk")}),t.botSkills.indexOf(Ke.SETUP_CHAT)>=0&&i.jsx(st,{onClick:f=>h("setup_chat"),children:g("avatar.widget.setup_chat")}),t.botSkills.indexOf(Ke.DANCE)>=0&&i.jsx(st,{onClick:f=>h("dance"),children:g("avatar.widget.dance")}),t.botSkills.indexOf(Ke.NO_PICK_UP)===-1&&i.jsx(st,{onClick:f=>h("pick"),children:g("avatar.widget.pick_up")})]}),s===xN&&i.jsxs(N,{className:"menu-item",onClick:null,gap:1,children:[i.jsx(O,{variant:"white",children:g("bot.skill.name.configuration.new.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:n,maxLength:ct("bot.name.max.length",15),onChange:f=>o(f.target.value)}),i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"secondary",onClick:f=>h(null),children:g("cancel")}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:f=>h("save_bot_name"),children:g("save")})]})]}),s===yN&&i.jsxs(N,{className:"menu-item",onClick:null,gap:1,children:[i.jsx(O,{variant:"white",children:g("bot.skill.name.configuration.new.motto")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:ct("motto.max.length",38),onChange:f=>c(f.target.value)}),i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"secondary",onClick:f=>h(null),children:g("cancel")}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:f=>h("save_bot_motto"),children:g("save")})]})]})]})},U$=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(!1),[n,o]=_.useState(null),{avatarInfo:l=null,setAvatarInfo:c=null,activeNameBubble:u=null,setActiveNameBubble:h=null,nameBubbles:d=[],removeNameBubble:f=null,productBubbles:E=[],confirmingProduct:m=null,updateConfirmingProduct:I=null,removeProductBubble:p=null,isDecorating:T=!1,setIsDecorating:R=null}=y8(),{roomSession:S=null}=Le();ft(Ne.NORMAL_MODE,P=>{t&&e(!1)}),ft(Ne.GAME_MODE,P=>{t||e(!0)}),ft(x_.RSDE_DANCE,P=>{P.roomIndex===S.ownRoomIndex&&r(P.danceId!==0)}),_s(Cg.UPDATE_CHAT,P=>o(P));const L=()=>{if(!S||t)return null;if(u)return i.jsx(pN,{nameInfo:u,onClose:()=>h(null)});if(l)switch(l.type){case zl.FURNI:{const P=l;return T?i.jsx(b$,{avatarInfo:P,onClose:()=>c(null)}):null}case ws.OWN_USER:case ws.PEER:{const P=l;return ct("user.tags.enabled")&&tt().getUserTags(P.roomIndex),P.isSpectatorMode?null:P.isOwnUser?Cr.isRunning()?null:i.jsx(D$,{avatarInfo:P,isDancing:s,setIsDecorating:R,onClose:()=>c(null)}):i.jsx(y$,{avatarInfo:P,onClose:()=>c(null)})}case Kl.PET_INFO:{const P=l;return P.isOwner?i.jsx(v$,{avatarInfo:P,onClose:()=>c(null)}):i.jsx(P$,{avatarInfo:P,onClose:()=>c(null)})}case Xl.RENTABLE_BOT:return i.jsx(L$,{avatarInfo:l,onClose:()=>c(null)})}return null},M=()=>{if(!l)return null;switch(l.type){case zl.FURNI:return i.jsx(R$,{avatarInfo:l,onClose:()=>c(null)});case ws.OWN_USER:case ws.PEER:return i.jsx(x$,{avatarInfo:l,setAvatarInfo:c,onClose:()=>c(null)});case ws.BOT:return i.jsx(T$,{avatarInfo:l,onClose:()=>c(null)});case Xl.RENTABLE_BOT:return i.jsx(O$,{avatarInfo:l,onClose:()=>c(null)});case Kl.PET_INFO:return i.jsx(S$,{avatarInfo:l,onClose:()=>c(null)})}};return i.jsxs(i.Fragment,{children:[T&&i.jsx(M$,{userId:tt().userId,userName:tt().userName,roomIndex:S.ownRoomIndex,setIsDecorating:R}),L(),l&&i.jsx(N,{alignItems:"end",className:"nitro-infostand-container",children:M()}),d.length>0&&d.map((P,k)=>i.jsx(pN,{nameInfo:P,onClose:()=>f(k)},k)),E.length>0&&E.map((P,k)=>i.jsx(I$,{item:P,updateConfirmingProduct:I,onClose:()=>p(k)},P.id)),n&&i.jsx(_$,{chatEvent:n,onClose:()=>o(null)}),m&&i.jsx(g$,{item:m,onClose:()=>I(null)}),i.jsx(d$,{})]})},j$=a=>{const{chatStyleId:t=0,chatStyleIds:e=null,selectChatStyleId:s=null}=a,[r,n]=_.useState(null),[o,l]=_.useState(!1),c=h=>{s(h),l(!1)},u=h=>{let d=!1;l(f=>(d=!f,d)),d&&n(h.target)};return _.useEffect(()=>{o||n(null)},[o]),i.jsxs(i.Fragment,{children:[i.jsx(V,{pointer:!0,className:"icon chatstyles-icon",onClick:u}),i.jsx(wm,{show:o,target:r,placement:"top",children:i.jsx(_u,{className:"nitro-chat-style-selector-container",children:i.jsx(It,{overflow:"hidden",className:"bg-transparent bubble-window image-rendering-pixelated",children:i.jsx(pt,{gap:1,columnCount:3,overflow:"auto",children:e&&e.length>0&&e.map(h=>i.jsx(x,{center:!0,pointer:!0,className:"bubble-parent-container",onClick:d=>c(h),children:i.jsx(V,{className:"bubble-container",children:i.jsx(V,{className:`chat-bubble bubble-${h}`,children:""})},h)},h))})})})})]})},w$=a=>{const{addChatEmoji:t=null}=a,[e,s]=_.useState(!1),[r,n]=_.useState(null),o=_.useRef(null),l=_.useRef(null),c=d=>{t(d.native),s(!1)},u=d=>{l.current&&!l.current.contains(d.target)&&!d.target.classList.contains("emoji-icon")&&(s(!1),document.removeEventListener("mousedown",u),n(null))},h=d=>{s(f=>!f)};return _.useEffect(()=>{e?document.addEventListener("mousedown",u):n(null)},[l,e]),i.jsxs(i.Fragment,{children:[i.jsx(V,{pointer:!0,onClick:h,innerRef:o,children:""}),i.jsx(wm,{show:e,target:o,placement:"top-end",children:i.jsx(_u,{children:i.jsx(H0,{data:W0,onEmojiSelect:c})})})]})},F$=a=>{const{chatColour:t="black",selectColour:e=null}=a,[s,r]=_.useState(!1),[n,o]=_.useState(null),l=_.useRef(null);_.useEffect(()=>{const h=new Set(["r","b","g","y","w","o","c","br","pr","pk"]),d=new Map;at.forEach((f,E)=>{!h.has(E)&&!Array.from(d.values()).includes(f)&&d.set(E,f)}),o(d)},[]);const c=h=>{e(h),r(!1)},u=()=>{r(h=>!h)};return i.jsxs(i.Fragment,{children:[i.jsx(V,{pointer:!0,onClick:()=>u(),innerRef:l,style:{color:(n&&n.get(t))??"black"},children:i.jsx(Y0,{})}),i.jsx(wm,{show:s,target:l,placement:"top",children:i.jsx(_u,{className:"nitro-chat-style-selector-container",children:i.jsx(It,{overflow:"hidden",className:"bg-transparent colour-container image-rendering-pixelated",children:i.jsx(Fe,{gap:1,columnCount:6,columnMinWidth:20,columnMinHeight:20,children:n&&n.size>0&&Array.from(n).map(([h,d])=>i.jsx($t,{itemHighlight:!0,itemColor:d,itemActive:t===h,className:"clear-bg",onClick:f=>c(h)},h))})})})})]})},G$=a=>{const[t,e]=_.useState(""),{chatStyleId:s=0,updateChatStyleId:r=null,chatColour:n="",updateChatColour:o=null}=to(),{selectedUsername:l="",floodBlocked:c=!1,floodBlockedSeconds:u=0,setIsTyping:h=null,setIsIdle:d=null,sendChat:f=null}=b8(),[E,m]=_.useState(!1),{roomSession:I=null}=Le(),p=_.useRef(),T=_.useMemo(()=>g("widgets.chatinput.mode.whisper"),[]),R=_.useMemo(()=>g("widgets.chatinput.mode.shout"),[]),S=_.useMemo(()=>g("widgets.chatinput.mode.speak"),[]),L=_.useMemo(()=>ct("chat.input.maxlength",100),[]),M=_.useCallback(()=>{const B=document.activeElement;return!(!B||p&&p.current===B||!(B instanceof HTMLInputElement)&&!(B instanceof HTMLTextAreaElement))},[p]),P=_.useCallback(()=>{p.current.focus(),p.current.setSelectionRange(p.current.value.length*2,p.current.value.length*2)},[p]),k=_.useCallback(()=>{e(B=>B!==T||!l.length?B:`${B} ${l}`)},[l,T]),G=_.useCallback((B,J=!1)=>{if(!B||B==="")return;let Z=J?sa.CHAT_SHOUT:sa.CHAT_DEFAULT,Q=B;const ut=Q.split(" ");let Bt="",te="";switch(ut[0]){case T:Z=sa.CHAT_WHISPER,Bt=ut[1],te=T+" "+Bt+" ",ut.shift(),ut.shift();break;case R:Z=sa.CHAT_SHOUT,ut.shift();break;case S:Z=sa.CHAT_DEFAULT,ut.shift();break}Q=ut.join(" "),h(!1),d(!1),Q.length<=L&&(/%CC%/g.test(encodeURIComponent(Q))?e(""):(e(""),f(Q,Z,Bt,s,n))),e(te)},[T,R,S,L,s,h,d,f,n]),j=_.useCallback(B=>{!B||!B.length?h(!1):(h(!0),d(!0)),e(B)},[h,d]),F=_.useCallback(B=>{if(c||!p.current||M())return;document.activeElement!==p.current&&P();const J=B.target.value;switch(B.key){case" ":case"Space":k();return;case"NumpadEnter":case"Enter":G(J,B.shiftKey);return;case"Backspace":if(J){const Z=J.split(" ");Z[0]===T&&Z.length===3&&Z[2]===""&&e("")}return}},[c,p,T,M,P,k,G]);_s(wl.CHAT_INPUT_CONTENT,B=>{switch(B.chatMode){case wl.WHISPER:{e(`${T} ${B.userName} `);return}case wl.SHOUT:return}});const U=_.useMemo(()=>{let B=[];const J=ct("chat.styles");for(const Z of J)if(Z){if(Z.minRank>0){tt().hasSecurity(Z.minRank)&&B.push(Z.styleId);continue}if(Z.isSystemStyle&&tt().hasSecurity(Ce.MODERATOR)){B.push(Z.styleId);continue}if(!(ct("chat.styles.disabled").indexOf(Z.styleId)>=0)){if(Z.isHcOnly&&pi()>=Pi.CLUB){B.push(Z.styleId);continue}if(Z.isAmbassadorOnly&&tt().isAmbassador){B.push(Z.styleId);continue}!Z.isHcOnly&&!Z.isAmbassadorOnly&&B.push(Z.styleId)}}return B},[]),K=B=>{e(t+B),h(!0)};return _.useEffect(()=>(document.body.addEventListener("keydown",F),()=>{document.body.removeEventListener("keydown",F)}),[F]),_.useEffect(()=>{p.current&&(p.current.parentElement.dataset.value=t)},[t]),!I||I.isSpectator?null:cR.createPortal(i.jsxs("div",{className:"nitro-chat-input-container",onMouseEnter:()=>m(!0),onMouseLeave:()=>setTimeout(()=>m(!1),100),children:[i.jsxs("div",{className:"input-sizer align-items-center",children:[!c&&i.jsx("input",{ref:p,type:"text",className:"chat-input",placeholder:g("widgets.chatinput.default"),value:t,maxLength:L,onChange:B=>j(B.target.value),onMouseDown:B=>P()}),c&&i.jsxs(O,{variant:"danger",children:[g("chat.input.alert.flood",["time"],[u.toString()])," "]})]}),i.jsxs(x,{children:[i.jsx(w$,{addChatEmoji:K}),i.jsx(F$,{chatColour:n,selectColour:o}),i.jsx(j$,{chatStyleId:s,chatStyleIds:U,selectChatStyleId:r}),E&&i.jsx(V,{className:"info-habbopages",onClick:()=>ht("habbopages/chat/chatting")})]})]}),document.getElementById("toolbar-chat-input-container"))},k$=()=>{let a=null;self.onmessage=t=>{if(!t)return;const e=t.data;switch(e.action){case"START":a=setInterval(()=>postMessage(null),e.content);break;case"STOP":a&&(clearInterval(a),a=null);break}}};class B$ extends Worker{constructor(t){const e=t.toString(),s=new Blob([`(${e})()`]);super(URL.createObjectURL(s))}}const V$=a=>{const{chat:t=null,makeRoom:e=null,bubbleWidth:s=ss.CHAT_BUBBLE_WIDTH_NORMAL,selectedEmoji:r}=a,[n,o]=_.useState(!1),[l,c]=_.useState(!1),u=_.useRef(),h=_.useMemo(()=>{switch(s){case ss.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case ss.CHAT_BUBBLE_WIDTH_THIN:return 240;case ss.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[s]);return _.useEffect(()=>{o(!1);const d=u.current;if(!d)return;const f=d.offsetWidth,E=d.offsetHeight;t.width=f,t.height=E,t.elementRef=d;let m=t.left,I=t.top;return!m&&!I&&(m=t.location.x-f/2,I=d.parentElement.offsetHeight-E,t.left=m,t.top=I),c(!0),()=>{t.elementRef=null,c(!1)}},[t]),_.useEffect(()=>{!l||!t||n||(e&&e(t),o(!0))},[t,l,n,e]),i.jsxs("div",{ref:u,className:`bubble-container newbubblehe ${n?"visible":"invisible"}`,onClick:d=>rt().selectRoomObject(t.roomId,t.senderId,Y.UNIT),children:[r&&i.jsx("span",{children:DOMPurify.sanitize(r)}),t.styleId===0&&i.jsx("div",{className:"user-container-bg",style:{backgroundColor:t.color}}),i.jsxs("div",{className:`chat-bubble bubble-${t.styleId} type-${t.type}`,style:{maxWidth:h},children:[i.jsx("div",{className:"user-container",children:t.imageUrl&&t.imageUrl.length>0&&i.jsx("div",{className:"user-image",style:{backgroundImage:`url(${t.imageUrl})`}})}),i.jsxs("div",{className:"chat-content",children:[i.jsx("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${t.username}: `}}),i.jsx("span",{className:"message",style:{color:t.chatColours},dangerouslySetInnerHTML:{__html:`${t.formattedText}`},onClick:d=>onClickChat(d)})]}),i.jsx("div",{className:"pointer"})]})]})},H$=a=>{const{chatMessages:t=[],setChatMessages:e=null,chatSettings:s=null,getScrollSpeed:r=6e3}=v8(),n=_.useRef(),o=_.useCallback(()=>{e(u=>{if(u){const h=u.filter(d=>d.top>-d.height*2);if(h.length!==u.length)return h}return u})},[e]),l=_.useCallback((u,h,d)=>{for(let f=t.indexOf(u)-1;f>=0;f--){const E=t[f];if(!(!E||u===E||d.indexOf(E)>=0||E.top+E.height-h>u.top+u.height)&&Pq(u,E,-h,0)){const m=Math.abs(E.top+E.height-u.top);d.push(E),E.top-=m,E.skipMovement=!0,l(E,m,d)}}},[t]),c=_.useCallback(u=>{if(s.mode===ss.CHAT_MODE_FREE_FLOW)u.skipMovement=!0,l(u,0,[u]),o();else{const h=u.top+u.height,d=u.height,f=n.current.offsetHeight-h,E=d-f;f<d&&(e(m=>(m.forEach(I=>{I!==u&&(I.top-=E)}),m)),o())}},[s,l,o,e]);return _.useEffect(()=>{const u=(h=null)=>{if(!n||!n.current)return;const d=n.current.offsetHeight,f=Math.round(document.body.offsetHeight*ct("chat.viewer.height.percentage"));n.current.style.height=`${f}px`,e(E=>(E&&E.forEach(m=>m.top-=d-f),E))};return window.addEventListener("resize",u),u(),()=>{window.removeEventListener("resize",u)}},[e]),_.useEffect(()=>{const u=d=>{e(f=>(f.forEach(E=>{if(E.skipMovement){E.skipMovement=!1;return}E.top-=d}),f)),o()},h=new B$(k$);return h.onmessage=()=>u(15),h.postMessage({action:"START",content:r}),()=>{h.postMessage({action:"STOP"}),h.terminate()}},[r,o,e]),i.jsx("div",{ref:n,className:"nitro-chat-widget",children:t.map(u=>i.jsx(V$,{chat:u,makeRoom:c,bubbleWidth:s.weight},u.id))})},s0=a=>{const{title:t=null,items:e=[],selectItem:s=null,onClose:r=null}=a,[n,o]=_.useState(null),[l,c]=_.useState(""),u=tt().isModerator,h=_.useMemo(()=>{const d=l.toLocaleLowerCase();return e.filter(f=>{var E;return(E=f.name)==null?void 0:E.toLocaleLowerCase().includes(d)})},[e,l]);return _.useEffect(()=>{n&&s(n)},[n,s]),i.jsxs(Ct,{className:"nitro-chooser-widget",theme:"primary-slim",children:[i.jsx(Nt,{headerText:t,onCloseClick:r}),i.jsxs(It,{overflow:"hidden",gap:2,children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:l,onChange:d=>c(d.target.value)}),i.jsx(sE,{rows:h,rowRender:d=>i.jsx(x,{alignItems:"center",className:fi("rounded p-1",n===d&&"bg-muted"),pointer:!0,onClick:f=>o(d),children:i.jsxs(O,{truncate:!0,children:[d.name," ",u&&" - "+d.id]})})})]})]})},W$=a=>{const{items:t=null,onClose:e=null,selectItem:s=null,populateChooser:r=null}=k8();return _.useEffect(()=>{const n={linkReceived:o=>{o.split("/"),r()},eventUrlPrefix:"furni-chooser/"};return As(n),()=>Ns(n)},[r]),t?i.jsx(s0,{title:g("widget.chooser.furni.title"),items:t,selectItem:s,onClose:e}):null},Y$=a=>{const{items:t=null,onClose:e=null,selectItem:s=null,populateChooser:r=null}=z8();return _.useEffect(()=>{const n={linkReceived:o=>{o.split("/"),r()},eventUrlPrefix:"user-chooser/"};return As(n),()=>Ns(n)},[r]),t?i.jsx(s0,{title:g("widget.chooser.user.title"),items:t,selectItem:s,onClose:e}):null},z$=a=>{const[t,e]=_.useState(!1),{users:s=[],answer:r=null}=L8();return _.useEffect(()=>{e(!!s.length)},[s]),t?i.jsxs(Ct,{className:"nitro-widget-doorbell",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("navigator.doorbell.title"),onCloseClick:n=>e(!1)}),i.jsxs(It,{overflow:"hidden",gap:0,children:[i.jsx(N,{gap:2,children:i.jsxs(pt,{gap:1,className:"text-black fw-bold border-bottom px-1 pb-1",children:[i.jsx(V,{className:"g-col-6",children:g("generic.username")}),i.jsx(V,{className:"g-col-6"})]})}),i.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:s&&s.length>0&&s.map(n=>i.jsxs(pt,{gap:1,alignItems:"center",className:"text-black border-bottom p-1",children:[i.jsx(V,{className:"g-col-6",children:n}),i.jsx(V,{className:"g-col-6",children:i.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[i.jsx(W,{variant:"success",onClick:()=>r(n,!0),children:g("generic.accept")}),i.jsx(W,{variant:"danger",onClick:()=>r(n,!1),children:g("generic.deny")})]})})]},n))})]})]}):null},qS=a=>{const{objectId:t=-1,category:e=-1,noFollow:s=!1,position:r="absolute",...n}=a,[o,l]=_.useState({x:-1,y:-1}),c=_.useRef();return _.useEffect(()=>{let u=!1;const h=()=>{const f=Se();return MS(f.roomId,t,e,1)},d=()=>{const f=h();!f||!c.current||l({x:Math.round(f.left+f.width/2-c.current.offsetWidth/2),y:Math.round(f.top-c.current.offsetHeight+10)})};return s?d():(u=!0,Ti().add(d)),()=>{u&&Ti().remove(d)}},[t,e,s]),i.jsx(V,{innerRef:c,position:r,visible:o.x+(c.current?c.current.offsetWidth:0)>-1,className:"object-location",style:{left:o.x,top:o.y},...n})},K$=a=>{const{roomIndex:t=-1,request:e=null,hideFriendRequest:s=null,requestResponse:r=null}=a;return i.jsx(qS,{objectId:t,category:Y.UNIT,children:i.jsx(V,{className:"nitro-friend-request-dialog nitro-context-menu p-2",children:i.jsxs(N,{children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:2,children:[i.jsx(O,{variant:"white",fontSize:6,children:g("widget.friendrequest.from",["username"],[e.name])}),i.jsx(Dr,{className:"cursor-pointer fa-icon",onClick:n=>s(e.requesterUserId)})]}),i.jsxs(x,{justifyContent:"end",gap:1,children:[i.jsx(W,{variant:"danger",onClick:n=>r(e.requesterUserId,!1),children:g("widget.friendrequest.decline")}),i.jsx(W,{variant:"success",onClick:n=>r(e.requesterUserId,!0),children:g("widget.friendrequest.accept")})]})]})})})},X$=a=>{const{displayedRequests:t=[],hideFriendRequest:e=null}=F8(),{requestResponse:s=null}=gr();return t.length?i.jsx(i.Fragment,{children:t.map((r,n)=>i.jsx(K$,{roomIndex:r.roomIndex,request:r.request,hideFriendRequest:e,requestResponse:s},n))}):null},q$=a=>{const{productType:t=kt.FLOOR,classId:e=-1,extraParam:s=void 0}=a;switch(t){case kt.WALL:case kt.FLOOR:return i.jsx(iE,{productType:t,productClassId:e});case kt.BADGE:return i.jsx(Xe,{badgeCode:s});case kt.HABBO_CLUB:return i.jsx(ps,{type:"hc"})}return null},Q$=a=>{const{ownerId:t=-1}=a,[e,s]=_.useState(0),[r,n]=_.useState(void 0),o=()=>{e===1&&H(new uv(t)),s(0),n(void 0)};z(cy,c=>{s(1)}),z(ay,c=>{s(0),n(void 0)}),z(oy,c=>{const u=c.getParser();n({contentType:u.contentType,classId:u.classId}),s(2)});const l=tt().userId===t;return e===0?null:i.jsxs(Ct,{className:"nitro-mysterybox-dialog",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g(e===1?`mysterybox.dialog.${l?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:o}),i.jsxs(It,{children:[e===1&&i.jsxs(i.Fragment,{children:[i.jsxs(O,{variant:"primary",children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.subtitle`)," "]}),i.jsxs(O,{children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.description`)," "]}),i.jsxs(O,{children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.waiting`)]}),i.jsxs(W,{variant:"danger",onClick:o,className:"mt-auto",children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.cancel`)," "]})]}),e===2&&r&&i.jsxs(i.Fragment,{children:[i.jsxs(O,{variant:"black",children:[" ",g("mysterybox.reward.text")," "]}),i.jsx(x,{className:"prize-container justify-content-center mx-auto",children:i.jsx(q$,{classId:r.classId,productType:r.contentType})}),i.jsxs(W,{variant:"success",onClick:o,className:"mt-auto",children:[" ",g("mysterybox.reward.close")," "]})]})]})]})},J$=a=>{const{objectId:t=-1,onClose:e=null}=a,[s,r]=_.useState(""),n=()=>{H(new IP(t,s)),e()};return t===-1?null:i.jsxs(Ct,{className:"nitro-mysterytrophy-dialog no-resize",theme:"primary-slim",children:[i.jsx(Nt,{center:!0,headerText:g("mysterytrophy.header.title"),onCloseClick:e}),i.jsxs(It,{children:[i.jsxs(x,{className:"mysterytrophy-dialog-top p-3",children:[i.jsx("div",{className:"mysterytrophy-image flex-shrink-0"}),i.jsx("div",{className:"m-2",children:i.jsx(O,{variant:"white",className:"mysterytrophy-text-big",children:g("mysterytrophy.header.description")})})]}),i.jsx(x,{className:"mysterytrophy-dialog-bottom p-2",children:i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[i.jsx("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:s,onChange:o=>r(o.target.value)}),i.jsx("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),i.jsxs(x,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[i.jsx(O,{pointer:!0,className:"text-decoration",onClick:()=>e(),children:g("cancel")}),i.jsx(W,{variant:"success",onClick:()=>n(),children:g("generic.ok")})]})]})})]})]})},Z$=a=>{const{objectId:t=-1,onClose:e=null}=a,{roomSession:s=null}=Le(),r=()=>{s.useMultistateItem(t),e()};return i.jsxs(Ct,{className:"nitro-use-product-confirmation",children:[i.jsx(Nt,{headerText:g("effectbox.header.title"),onCloseClick:e}),i.jsx(It,{center:!0,children:i.jsx(x,{gap:2,children:i.jsxs(N,{justifyContent:"between",children:[i.jsx(O,{children:g("effectbox.header.description")}),i.jsxs(x,{alignItems:"center",justifyContent:"between",children:[i.jsx(W,{variant:"danger",onClick:e,children:g("generic.cancel")}),i.jsx(W,{variant:"success",onClick:r,children:g("generic.ok")})]})]})})})]})},l_=-1,$$=0,ttt=a=>{const{objectId:t=-1,onClose:e=null}=a,[s,r]=_.useState(null),[n,o]=_.useState(l_),{roomSession:l=null}=Le(),c=()=>{l.useMultistateItem(t),e()};return _.useEffect(()=>{if(!l||t===-1)return;const u=qm(l.roomId,t,Y.FLOOR);if(!u)return;r(u);let h=l_;switch(u.specialType){case Dt.MONSTERPLANT_SEED:h=$$;break}if(h===l_){e();return}o(h)},[l,t,e]),n===l_?null:i.jsxs(Ct,{className:"nitro-use-product-confirmation",children:[i.jsx(Nt,{headerText:g("useproduct.widget.title.plant_seed",["name"],[s.name]),onCloseClick:e}),i.jsx(It,{center:!0,children:i.jsxs(x,{gap:2,overflow:"hidden",children:[i.jsx(N,{children:i.jsx(V,{className:"product-preview",children:i.jsx(V,{className:"monsterplant-image"})})}),i.jsxs(N,{justifyContent:"between",overflow:"auto",children:[i.jsxs(N,{gap:2,children:[i.jsx(O,{children:g("useproduct.widget.text.plant_seed",["productName"],[s.name])}),i.jsx(O,{children:g("useproduct.widget.info.plant_seed")})]}),i.jsxs(x,{alignItems:"center",justifyContent:"between",children:[i.jsx(W,{variant:"danger",onClick:e,children:g("useproduct.widget.cancel")}),i.jsx(W,{variant:"success",onClick:c,children:g("widget.monsterplant_seed.button.use")})]})]})]})})]})},c_=-1,ett=0,stt=a=>{const{objectId:t=-1,onClose:e=null}=a,[s,r]=_.useState(c_),[n,o]=_.useState(At.MALE),[l,c]=_.useState(null),{roomSession:u=null}=Le(),h=()=>{H(new CP(t)),H(new pS(n,l)),e()};return _.useEffect(()=>{let d=c_;const f=tt().figure,E=tt().gender,m=[];if(u&&t>=0){const I=qm(u.roomId,t,Y.FLOOR);if(I)switch(I.specialType){case Dt.FIGURE_PURCHASABLE_SET:d=ett;const p=I.customParams.split(",").map(T=>parseInt(T));for(const T of p)is().isValidFigureSetForGender(T,E)&&m.push(T);break}}if(d===c_){e();return}o(E),c(is().getFigureStringWithFigureIds(f,E,m)),r(d)},[u,t,e]),s===c_?null:i.jsxs(Ct,{className:"nitro-use-product-confirmation",children:[i.jsx(Nt,{headerText:g("useproduct.widget.title.bind_clothing"),onCloseClick:e}),i.jsx(It,{center:!0,children:i.jsxs(x,{gap:2,overflow:"hidden",children:[i.jsx(N,{children:i.jsx(V,{className:"mannequin-preview",children:i.jsx(os,{figure:l,direction:2})})}),i.jsxs(N,{justifyContent:"between",overflow:"auto",children:[i.jsxs(N,{gap:2,children:[i.jsx(O,{children:g("useproduct.widget.text.bind_clothing")}),i.jsx(O,{children:g("useproduct.widget.info.bind_clothing")})]}),i.jsxs(x,{alignItems:"center",justifyContent:"between",children:[i.jsx(W,{variant:"danger",onClick:e,children:g("useproduct.widget.cancel")}),i.jsx(W,{variant:"success",onClick:h,children:g("useproduct.widget.bind_clothing")})]})]})]})})]})},itt=a=>{const{closeConfirm:t=null,processAction:e=null,onClose:s=null,objectId:r=-1,mode:n=null,confirmMode:o=null,confirmingObjectId:l=-1,groupData:c=null,isGroupMember:u=!1,objectOwnerId:h=-1}=w7(),{simpleAlert:d=null}=Ye();z($y,E=>{const m=E.getParser();if(m)switch(m.count){case 1:d(g("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",g("costumehopper.costumerequired.buy"),g("costumehopper.costumerequired.header"),null);break;case 2:d(g("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",g("viprequired.buy.vip"),g("viprequired.header"),null);break;case 3:d(g("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",g("viprequired.buy.vip"),g("gate.viprequired.title"),null);break}});const f=tt().userId===h;return i.jsxs(i.Fragment,{children:[o===eR&&i.jsx(ttt,{objectId:l,onClose:t}),o===sR&&i.jsx(stt,{objectId:l,onClose:t}),o===CU&&i.jsx(Z$,{objectId:l,onClose:t}),o===iR&&i.jsx(J$,{objectId:l,onClose:t}),i.jsx(Q$,{ownerId:h}),r>=0&&n&&i.jsxs(Ra,{objectId:r,category:Y.FLOOR,onClose:s,fades:!0,children:[n===es.FRIEND_FURNITURE&&i.jsxs(i.Fragment,{children:[i.jsx(yi,{children:g("friendfurni.context.title")}),i.jsx(st,{onClick:E=>e("use_friend_furni"),children:g("friendfurni.context.use")})]}),n===es.MONSTERPLANT_SEED&&i.jsxs(i.Fragment,{children:[i.jsx(yi,{children:g("furni.mnstr_seed.name")}),i.jsx(st,{onClick:E=>e("use_monsterplant_seed"),children:g("widget.monsterplant_seed.button.use")})]}),n===es.RANDOM_TELEPORT&&i.jsxs(i.Fragment,{children:[i.jsx(yi,{children:g("furni.random_teleport.name")}),i.jsx(st,{onClick:E=>e("use_random_teleport"),children:g("widget.random_teleport.button.use")})]}),n===es.PURCHASABLE_CLOTHING&&i.jsxs(i.Fragment,{children:[i.jsx(yi,{children:g("furni.generic_usable.name")}),i.jsx(st,{onClick:E=>e("use_purchaseable_clothing"),children:g("widget.generic_usable.button.use")})]}),n===es.MYSTERY_BOX&&i.jsxs(i.Fragment,{children:[i.jsx(yi,{children:g("mysterybox.context.title")}),i.jsx(st,{onClick:E=>e("use_mystery_box"),children:g("mysterybox.context."+(f?"owner":"other")+".use")})]}),n===es.MYSTERY_TROPHY&&i.jsxs(i.Fragment,{children:[i.jsx(yi,{children:g("mysterytrophy.header.title")}),i.jsx(st,{onClick:E=>e("use_mystery_trophy"),children:g("friendfurni.context.use")})]}),n===NU&&c&&i.jsxs(i.Fragment,{children:[i.jsx(yi,{className:"cursor-pointer text-truncate",onClick:()=>Dd(c.guildId),children:c.guildName}),!u&&i.jsx(st,{onClick:E=>e("join_group"),children:g("widget.furniture.button.join.group")}),i.jsx(st,{onClick:E=>e("go_to_group_homeroom"),children:g("widget.furniture.button.go.to.group.home.room")}),c.guildHasReadableForum&&i.jsx(st,{onClick:E=>e("open_forum"),children:g("widget.furniture.button.open_group_forum")})]})]})]})},rtt=a=>{const{objectId:t=-1,color:e=0,setColor:s=null,applyToner:r=null,toggleToner:n=null,onClose:o=null}=P7();return t===-1?null:i.jsxs(Ct,{theme:"primary-slim",className:"nitro-room-widget-toner",children:[i.jsx(Nt,{headerText:g("widget.backgroundcolor.title"),onCloseClick:o}),i.jsxs(It,{overflow:"hidden",justifyContent:"between",children:[i.jsx(N,{overflow:"auto",gap:1,children:i.jsx("input",{type:"color",className:"form-control",value:zi.makeColorNumberHex(e),onChange:l=>s(zi.convertFromHex(l.target.value))})}),i.jsxs(N,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"primary",onClick:n,children:g("widget.backgroundcolor.button.on")}),i.jsx(W,{fullWidth:!0,variant:"primary",onClick:r,children:g("widget.backgroundcolor.button.apply")})]})]})]})},ntt=a=>{const{objectId:t=-1,color:e="1",badgeName:s="",badgeDesc:r="",date:n="",senderName:o="",onClose:l=null}=U7();return t===-1?null:i.jsx(PU,{color:e,message:r,date:n,senderName:o,customTitle:s,onCloseClick:l})},att=a=>{const{objectId:t=-1,recipes:e=[],ingredients:s=[],selectedRecipe:r=null,requiredIngredients:n=null,isCrafting:o=!1,craft:l=null,selectRecipe:c=null,onClose:u=null}=G7(),{roomSession:h=null}=Le(),[d,f]=_.useState(!1),E=_.useMemo(()=>{if(!h)return!1;const p=rt().getRoomObject(h.roomId,t,Y.FLOOR);return Ei(p)},[t,h]),m=_.useMemo(()=>{if(!n||!n.length)return!1;for(const p of n){const T=s.find(R=>R.name===p.itemName);if(!T||T.count<p.count)return!1}return!0},[s,n]),I=()=>{if(!d){f(!0);return}l(),f(!1)};return _.useEffect(()=>{f(!1)},[r]),t===-1?null:i.jsxs(Ct,{className:"nitro-widget-crafting",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("crafting.title"),onCloseClick:u}),i.jsx(It,{children:i.jsxs(x,{grow:!0,overflow:"hidden",gap:2,children:[i.jsxs(x,{column:!0,fullWidth:!0,gap:2,children:[i.jsxs(N,{overflow:"hidden",fullHeight:!0,children:[i.jsx("div",{className:"bg-muted rounded py-1 text-center",children:g("crafting.title.products")}),i.jsx(Fe,{columnCount:5,children:e.length>0&&e.map(p=>i.jsx($t,{itemImage:p.iconUrl,itemActive:r&&r.name===p.name,onClick:()=>c(p)},p.name))})]}),i.jsxs(N,{overflow:"hidden",fullHeight:!0,children:[i.jsx("div",{className:"bg-muted rounded py-1 text-center",children:g("crafting.title.mixer")}),i.jsx(Fe,{columnCount:5,children:s.length>0&&s.map(p=>i.jsx($t,{itemImage:p.iconUrl,itemCount:p.count,itemCountMinimum:0,className:(p.count?"":"opacity-0-5 ")+"cursor-default"},p.name))})]})]}),i.jsxs(x,{column:!0,fullWidth:!0,gap:2,children:[!r&&i.jsx(N,{center:!0,fullHeight:!0,className:"text-black text-center",children:g("crafting.info.start")}),r&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{overflow:"hidden",fullHeight:!0,children:[i.jsx("div",{className:"bg-muted rounded py-1 text-center",children:g("crafting.current_recipe")}),i.jsx(Fe,{columnCount:5,children:!!n&&n.length>0&&n.map(p=>{const T=s.find(S=>S.name===p.itemName),R=[];for(let S=0;S<p.count;S++)R.push(i.jsx($t,{itemImage:T.iconUrl,className:(T.count-S<=0?"opacity-0-5 ":"")+"cursor-default"},S));return R})})]}),i.jsxs(x,{gap:2,column:!0,fullHeight:!0,children:[i.jsxs(x,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[i.jsx("div",{className:"py-1 text-center",children:g("crafting.result")}),i.jsxs(x,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[i.jsx(N,{fullHeight:!0,children:i.jsx("img",{src:r.iconUrl})}),i.jsx("div",{className:"text-black",children:r.localizedName})]})]}),i.jsxs(W,{variant:!E||!m?"danger":d?"warning":o?"primary":"success",disabled:!E||!m||o,onClick:I,children:[!o&&g(E?m?d?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),o&&i.jsx(kS,{})]})]})]})]})]})})]})},ott=a=>{const[t,e]=_.useState(!1),{presets:s=[],dimmerState:r=0,selectedPresetId:n=0,color:o=16777215,brightness:l=255,effectId:c=0,selectedColor:u=0,setSelectedColor:h=null,selectedBrightness:d=0,setSelectedBrightness:f=null,selectedEffectId:E=0,setSelectedEffectId:m=null,selectPresetId:I=null,applyChanges:p}=B7(),T=()=>{Kr.previewDimmer(o,l,c===2),e(!1)};ft(ot.REMOVE_DIMMER,S=>e(!1)),_.useEffect(()=>{!s||!s.length||e(!0)},[s]);const R=_.useMemo(()=>ct("widget.dimmer.colorwheel",!1),[]);return t?i.jsxs(Ct,{className:"nitro-room-widget-dimmer",children:[i.jsx(Nt,{headerText:g("widget.dimmer.title"),onCloseClick:T}),r===1&&i.jsx(eo,{children:s.map(S=>i.jsx(Ia,{isActive:n===S.id,onClick:L=>I(S.id),children:g(`widget.dimmer.tab.${S.id}`)},S.id))}),i.jsxs(It,{children:[r===0&&i.jsxs(N,{alignItems:"center",children:[i.jsx(V,{className:"dimmer-banner"}),i.jsx(O,{center:!0,className:"bg-muted rounded p-1",children:g("widget.dimmer.info.off")}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:()=>Kr.changeState(),children:g("widget.dimmer.button.on")})]}),r===1&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{fontWeight:"bold",children:g("widget.backgroundcolor.hue")}),R&&i.jsx("input",{type:"color",className:"form-control",value:zi.makeColorNumberHex(u),onChange:S=>h(zi.convertFromHex(S.target.value))}),!R&&i.jsx(pt,{gap:1,columnCount:7,children:Kr.AVAILABLE_COLORS.map((S,L)=>i.jsx(N,{fullWidth:!0,pointer:!0,className:fi("color-swatch rounded",S===u&&"active"),onClick:()=>h(S),style:{backgroundColor:Kr.HTML_COLORS[L]}},L))})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{fontWeight:"bold",children:g("widget.backgroundcolor.lightness")}),i.jsx(Xs,{className:"nitro-slider",min:Kr.MIN_BRIGHTNESS,max:Kr.MAX_BRIGHTNESS,value:d,onChange:S=>f(S),thumbClassName:"thumb percent",renderThumb:(S,L)=>i.jsx("div",{...S,children:Kr.scaleBrightness(L.valueNow)})})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:E===2,onChange:S=>m(S.target.checked?2:1)}),i.jsx(O,{children:g("widget.dimmer.type.checkbox")})]}),i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"danger",onClick:()=>Kr.changeState(),children:g("widget.dimmer.button.off")}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:p,children:g("widget.dimmer.button.apply")})]})]})]})]}):null},ltt=a=>{const{objectId:t=-1,value:e=0,onClose:s=null,redeem:r=null}=H7();return t===-1?null:i.jsxs(Ct,{className:"nitro-widget-exchange-credit",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("catalog.redeem.dialog.title"),onCloseClick:s}),i.jsx(It,{center:!0,children:i.jsxs(x,{overflow:"hidden",gap:2,children:[i.jsx(N,{center:!0,children:i.jsx(V,{className:"exchange-image"})}),i.jsxs(N,{grow:!0,justifyContent:"between",overflow:"hidden",children:[i.jsxs(N,{gap:1,overflow:"auto",children:[i.jsx(O,{fontWeight:"bold",children:g("creditfurni.description",["credits"],[e.toString()])}),i.jsx(O,{children:g("creditfurni.prompt")})]}),i.jsx(W,{variant:"success",onClick:r,children:g("catalog.redeem.dialog.button.exchange")})]})]})})]})},ctt=a=>{const{currentIndex:t=-1,currentPhotos:e=null}=a,[s,r]=_.useState(0),n=e&&e.length?e[s]:null,o=()=>{r(c=>{let u=c+1;return u>=e.length&&(u=0),u})},l=()=>{r(c=>{let u=c-1;return u<0&&(u=e.length-1),u})};return _.useEffect(()=>{r(t)},[t]),n?i.jsxs(pt,{style:{display:"flex",flexDirection:"column"},children:[i.jsx(x,{center:!0,className:"picture-preview border border-black",style:n.w?{backgroundImage:"url("+n.w+")"}:{},children:!n.w&&i.jsx(O,{bold:!0,children:g("camera.loading")})}),n.m&&n.m.length&&i.jsx(O,{center:!0,children:n.m}),i.jsxs(x,{alignItems:"center",justifyContent:"between",children:[i.jsx(O,{children:n.n||""}),i.jsx(O,{children:new Date(n.t*1e3).toLocaleDateString()})]}),e.length>1&&i.jsxs(x,{className:"picture-preview-buttons",children:[i.jsx(UN,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:l}),i.jsx(O,{underline:!0,className:"cursor-pointer",onClick:c=>Ki(n.oi),children:n.o}),i.jsx(jN,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:o})]})]}):null},utt=a=>{const{objectId:t=-1,currentPhotoIndex:e=-1,currentPhotos:s=null,onClose:r=null}=Y7(),{report:n=null}=en();return t===-1||e===-1?null:i.jsxs(Ct,{className:"nitro-external-image-widget",theme:"primary-slim",children:[i.jsx(Nt,{headerText:"",isGalleryPhoto:!0,onReportPhoto:()=>n(ns.PHOTO,{extraData:s[e].w,roomId:s[e].s,reportedUserId:tt().userId,roomObjectId:Number(s[e].u)}),onCloseClick:r}),i.jsx(It,{children:i.jsx(ctt,{currentIndex:e,currentPhotos:s})})]})},htt=a=>{const{objectId:t=-1,type:e=0,stage:s=0,usernames:r=[],figures:n=[],date:o=null,onClose:l=null,respond:c=null}=K7();if(t===-1)return null;if(s>0)return i.jsxs(Ct,{className:"nitro-engraving-lock",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("friend.furniture.confirm.lock.caption"),onCloseClick:l}),i.jsxs(It,{children:[i.jsx("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:g("friend.furniture.confirm.lock.subtitle")}),i.jsx("div",{className:"d-flex justify-content-center mb-2",children:i.jsx("div",{className:`engraving-lock-stage-${s}`})}),s===2&&i.jsx("div",{className:"text-small text-black text-center mb-2",children:g("friend.furniture.confirm.lock.other.locked")}),i.jsxs(x,{gap:1,children:[i.jsx(W,{fullWidth:!0,onClick:u=>c(!1),children:g("friend.furniture.confirm.lock.button.cancel")}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:u=>c(!0),children:g("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(r.length>0)return i.jsx(qo,{handleSelector:".nitro-engraving-lock-view",children:i.jsxs("div",{className:`nitro-engraving-lock-view engraving-lock-${e}`,children:[i.jsx("div",{className:"engraving-lock-close",onClick:l}),i.jsxs(x,{justifyContent:"center",children:[i.jsx("div",{className:"engraving-lock-avatar",children:i.jsx(os,{figure:n[0],direction:2})}),i.jsx("div",{className:"engraving-lock-avatar",children:i.jsx(os,{figure:n[1],direction:4})})]}),i.jsxs(N,{justifyContent:"between",className:"mt-1",children:[i.jsxs(N,{alignItems:"center",justifyContent:"center",gap:1,children:[i.jsxs("div",{children:[e===0&&g("lovelock.engraving.caption"),e===3&&g("wildwest.engraving.caption")]}),i.jsx("div",{children:o})]}),i.jsxs(x,{justifyContent:"center",gap:4,children:[i.jsx("div",{children:r[0]}),i.jsx("div",{children:r[1]})]})]})]})})},dtt=a=>{const{objectId:t=-1,classId:e=-1,itemType:s=null,text:r=null,isOwnerOfFurniture:n=!1,senderName:o=null,senderFigure:l=null,placedItemId:c=-1,placedItemType:u=null,placedInRoom:h=!1,imageUrl:d=null,openPresent:f=null,onClose:E=null}=l8(),{groupItems:m=[]}=tc();if(t===-1)return null;const I=p=>{const T=m.find(R=>{var S;return((S=R.getItemById(p))==null?void 0:S.id)===p});T&&Mu(T),E()};return i.jsxs(Ct,{className:"nitro-gift-opening",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g(o?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[o]),onCloseClick:E}),i.jsxs(It,{children:[c===-1&&i.jsxs(N,{overflow:"hidden",children:[i.jsx(x,{center:!0,overflow:"auto",children:i.jsx(bU,{userName:o,figure:l,message:r})}),n&&i.jsxs(x,{gap:1,children:[o&&i.jsx(W,{fullWidth:!0,onClick:p=>ht("catalog/open"),children:g("widget.furni.present.give_gift",["name"],[o])}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:f,children:g("widget.furni.present.open_gift")})]})]}),c>-1&&i.jsxs(x,{gap:2,overflow:"hidden",children:[i.jsx(N,{center:!0,className:"p-2",children:i.jsx(Ta,{imageUrl:d})}),i.jsxs(N,{grow:!0,children:[i.jsxs(N,{center:!0,gap:1,children:[i.jsx(O,{wrap:!0,small:!0,children:g("widget.furni.present.message_opened")}),i.jsx(O,{bold:!0,fontSize:5,children:r})]}),i.jsxs(N,{grow:!0,gap:1,children:[i.jsxs(x,{gap:1,children:[h&&i.jsx(W,{fullWidth:!0,onClick:null,children:g("widget.furni.present.put_in_inventory")}),i.jsx(W,{fullWidth:!0,variant:"success",onClick:p=>I(c),children:g(h?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),o&&o.length&&i.jsx(W,{fullWidth:!0,onClick:p=>ht("catalog/open"),children:g("widget.furni.present.give_gift",["name"],[o])})]})]})]})]})]})},_tt=a=>{const{stuffDatas:t=null,getScoreType:e=null,getClearType:s=null}=J7();return!t||!t.size?null:i.jsx(i.Fragment,{children:Array.from(t.entries()).map(([r,n],o)=>i.jsx(qS,{objectId:r,category:Y.FLOOR,children:i.jsxs(N,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[i.jsx(yi,{children:g("high.score.display.caption",["scoretype","cleartype"],[g(`high.score.display.scoretype.${e(n.scoreType)}`),g(`high.score.display.cleartype.${s(n.clearType)}`)])}),i.jsxs(e0,{overflow:"hidden",gap:1,className:"h-100",children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",children:[i.jsx(O,{center:!0,bold:!0,variant:"white",className:"col-8",children:g("high.score.display.users.header")}),i.jsx(O,{center:!0,bold:!0,variant:"white",className:"col-4",children:g("high.score.display.score.header")})]}),i.jsx("hr",{className:"m-0"})]}),i.jsx(N,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:n.entries.map((l,c)=>i.jsxs(x,{alignItems:"center",children:[i.jsx(O,{center:!0,variant:"white",className:"col-8",children:l.users.join(", ")}),i.jsx(O,{center:!0,variant:"white",className:"col-4",children:l.score})]},c))})]})]})},o))})},gtt=a=>(t8(),null),ftt=-1,u_=0,WE=1,YE=2,zE=3,KE=4,mtt=a=>{const[t,e]=_.useState(null),[s,r]=_.useState(ftt),{objectId:n=-1,figure:o=null,gender:l=null,clubLevel:c=Pi.NO_CLUB,name:u=null,setName:h=null,saveFigure:d=null,wearFigure:f=null,saveName:E=null,onClose:m=null}=s8();return _.useEffect(()=>{if(n===-1)return;const I=Se();if(I.isRoomOwner||I.controllerLevel>=Ce.GUEST||tt().isModerator){r(u_);return}if(tt().gender.toLowerCase()!==l.toLowerCase()){r(KE);return}if(pi()<c){r(zE);return}r(YE)},[n,l,c]),_.useEffect(()=>{switch(s){case u_:case KE:{const I=is().createFigureContainer(o);uu.transformAsMannequinFigure(I),e(I.getFigureString());break}case WE:{const I=is().createFigureContainer(tt().figure);uu.transformAsMannequinFigure(I),e(I.getFigureString());break}case YE:case zE:{const I=uu.getMergedMannequinFigureContainer(tt().figure,o);e(I.getFigureString());break}}},[s,o,c]),n===-1?null:i.jsxs(Ct,{className:"nitro-mannequin no-resize",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("mannequin.widget.title"),onCloseClick:m}),i.jsx(It,{center:!0,children:i.jsxs(x,{fullWidth:!0,gap:2,overflow:"hidden",children:[i.jsx(N,{children:i.jsxs(V,{position:"relative",className:"mannequin-preview",children:[i.jsx(os,{position:"absolute",figure:t,direction:2}),c>0&&i.jsx(ps,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),i.jsxs(N,{grow:!0,justifyContent:"between",overflow:"auto",children:[s===u_&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",value:u,onChange:I=>h(I.target.value),onBlur:E}),i.jsxs(N,{gap:1,children:[i.jsx(W,{variant:"success",onClick:I=>r(WE),children:g("mannequin.widget.style")}),i.jsx(W,{variant:"success",onClick:f,children:g("mannequin.widget.wear")})]})]}),s===WE&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:u}),i.jsx(O,{wrap:!0,children:g("mannequin.widget.savetext")})]}),i.jsxs(x,{alignItems:"center",justifyContent:"between",children:[i.jsx(O,{underline:!0,pointer:!0,onClick:I=>r(u_),children:g("mannequin.widget.back")}),i.jsx(W,{variant:"success",onClick:d,children:g("mannequin.widget.save")})]})]}),s===YE&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:u}),i.jsx(O,{children:g("mannequin.widget.weartext")})]}),i.jsx(W,{variant:"success",onClick:f,children:g("mannequin.widget.wear")})]}),s===zE&&i.jsx(x,{center:!0,grow:!0,children:i.jsx(O,{children:g("mannequin.widget.clubnotification")})}),s===KE&&i.jsx(O,{children:g("mannequin.widget.wronggender")})]})]})})]})},Ett=a=>(h8(),null),i0=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],ptt=["blue","pink","green","yellow"],Itt=a=>{let t=i0.indexOf(a);return t===-1&&(t=0),ptt[t]},Ttt=a=>{const{objectId:t=-1,color:e="0",setColor:s=null,text:r="",setText:n=null,canModify:o=!1,onClose:l=null}=_8();return t===-1?null:i.jsx(qo,{handleSelector:".drag-handler",windowPosition:oi.TOP_LEFT,children:i.jsxs("div",{className:"nitro-stickie nitro-stickie-image stickie-"+Itt(e),children:[i.jsxs("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[i.jsx("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:o&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:l}),i0.map(c=>i.jsx("div",{className:"stickie-color ms-1",onClick:u=>s(c),style:{backgroundColor:zi.makeColorHex(c)}},c))]})}),i.jsx("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:l})]}),i.jsx("div",{className:"stickie-context",children:i.jsx("textarea",{className:"context-text",value:r,onChange:c=>n(c.target.value),tabIndex:0,autoFocus:!0})})]})})},Rtt=a=>{const{objectId:t=-1,height:e=0,maxHeight:s=40,onClose:r=null,updateHeight:n=null}=f8(),[o,l]=_.useState(""),c=u=>{l(u);const h=parseFloat(u);isNaN(h)||h===e||n(h)};return _.useEffect(()=>{l(e.toString())},[e]),t===-1?null:i.jsxs(Ct,{className:"nitro-widget-custom-stack-height",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("widget.custom.stack.height.title"),onCloseClick:r}),i.jsxs(It,{justifyContent:"between",children:[i.jsx(O,{children:g("widget.custom.stack.height.text")}),i.jsxs(x,{gap:2,children:[i.jsx(Xs,{className:"nitro-slider",min:0,max:s,step:.01,value:e,onChange:u=>n(u),renderThumb:(u,h)=>i.jsx("div",{...u,children:h.valueNow})}),i.jsx("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:s,value:o,onChange:u=>c(u.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsx(W,{onClick:u=>H(new lg(t,-100)),children:g("furniture.above.stack")}),i.jsx(W,{onClick:u=>H(new lg(t,0)),children:g("furniture.floor.level")})]})]})]})},r0=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],Stt=["blue","pink","green","yellow"],Ott=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],Att=["post_it","shakesp","dreams","christmas","heart","juninas"],Ntt=a=>{let t=r0.indexOf(a);return t===-1&&(t=0),Stt[t]},Ctt=a=>{let t=Ott.indexOf(a);return t===-1&&(t=0),Att[t]},xtt=a=>{const{objectId:t=-1,color:e="0",text:s="",type:r="",canModify:n=!1,updateColor:o=null,updateText:l=null,trash:c=null,onClose:u=null}=E8(),[h,d]=_.useState(!1);return _.useEffect(()=>{d(!1)},[t,e,s,r]),t===-1?null:i.jsx(qo,{handleSelector:".drag-handler",windowPosition:oi.TOP_LEFT,children:i.jsxs("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(r=="post_it"?Ntt(e):Ctt(r)),children:[i.jsxs("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[i.jsx("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:n&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:c}),r=="post_it"&&i.jsx(i.Fragment,{children:r0.map(f=>i.jsx("div",{className:"stickie-color ms-1",onClick:E=>o(f),style:{backgroundColor:zi.makeColorHex(f)}},f))})]})}),i.jsx("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:u})]}),i.jsx("div",{className:"stickie-context",children:!h||!n?i.jsx("div",{className:"context-text",onClick:f=>n&&d(!0),children:s}):i.jsx("textarea",{className:"context-text",defaultValue:s,tabIndex:0,onBlur:f=>l(f.target.value),autoFocus:!0})})]})})},ytt=a=>{const{objectId:t=-1,color:e="1",senderName:s="",date:r="",message:n="",onClose:o=null}=I8();return t===-1?null:i.jsx(PU,{color:e,message:n,date:r,senderName:s,onCloseClick:o})},Mtt=a=>{const[t,e]=_.useState(null),{objectId:s=-1,videoId:r=null,videoStart:n=0,videoEnd:o=0,currentVideoState:l=null,selectedVideo:c=null,playlists:u=[],onClose:h=null,previous:d=null,next:f=null,pause:E=null,play:m=null,selectVideo:I=null}=N8(),p=R=>{if(e(R.target),s!==-1)switch(R.target.getPlayerState()){case-1:case 1:l!==1&&m();return;case 2:l!==2&&E()}};if(_.useEffect(()=>{if(!(l===null||!t)){if(l===Po.PLAYING&&t.getPlayerState()!==Po.PLAYING){t.playVideo();return}if(l===Po.PAUSED&&t.getPlayerState()!==Po.PAUSED){t.pauseVideo();return}}},[l,t]),s===-1)return null;const T={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:n,end:o}};return i.jsxs(Ct,{className:"youtube-tv-widget",children:[i.jsx(Nt,{headerText:g("catalog.page.youtube_tvs"),onCloseClick:h}),i.jsx(It,{children:i.jsxs("div",{className:"row w-100 h-100",children:[i.jsxs("div",{className:"youtube-video-container col-9 overflow-hidden",children:[r&&r.length>0&&i.jsx(z0,{videoId:r,opts:T,onReady:R=>e(R.target),onStateChange:p,containerClassName:"youtubeContainer"}),(!r||r.length===0)&&i.jsx("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:g("widget.furni.video_viewer.no_videos")})]}),i.jsxs("div",{className:"playlist-container col-3 d-flex flex-column",children:[i.jsxs("span",{className:"playlist-controls justify-content-center d-flex",children:[i.jsx("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:d}),i.jsx("i",{className:"icon icon-youtube-next cursor-pointer",onClick:f})]}),i.jsx("div",{className:"mb-1",children:g("widget.furni.video_viewer.playlists")}),i.jsx(Fe,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:u&&u.map((R,S)=>i.jsx($t,{onClick:L=>I(R.video),itemActive:R.video===c,children:i.jsx("b",{children:R.title})},S))})]})]})})]})},btt=a=>{const{diskInventory:t=null,addToPlaylist:e=null}=a,[s,r]=_.useState(-1),[n,o]=_.useState(-1),l=_.useCallback((h,d)=>{h.stopPropagation(),o(f=>f===d?-1:d)},[]),c=_.useCallback((h,d)=>{var f,E;h.stopPropagation(),e(d,(E=(f=Os().musicController)==null?void 0:f.getRoomItemPlaylist())==null?void 0:E.length)},[e]),u=()=>{ht("catalog/open/"+Sg.TRAX_SONGS)};return _.useEffect(()=>{var h;if(n!==-1)return(h=Os().musicController)==null||h.playSong(n,ri.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var d;(d=Os().musicController)==null||d.stop(ri.PRIORITY_SONG_PLAY)}},[n]),_.useEffect(()=>()=>o(-1),[]),i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[i.jsx("img",{src:ct("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),i.jsx("h2",{className:"ms-4",children:g("playlist.editor.my.music")})]}),i.jsx("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:i.jsx(Fe,{columnCount:3,columnMinWidth:95,gap:1,children:t&&t.getKeys().map((h,d)=>{var I;const f=t.getKey(d),E=t.getWithIndex(d),m=(I=Os().musicController)==null?void 0:I.getSongInfo(E);return i.jsxs($t,{itemActive:s===d,onClick:()=>r(p=>p===d?-1:d),classNames:["text-black"],children:[i.jsx("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:dU(m==null?void 0:m.songData)}}),i.jsx(O,{truncate:!0,fullWidth:!0,className:"text-center",children:m==null?void 0:m.name}),s===d&&i.jsxs(x,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[i.jsx(W,{onClick:p=>l(p,E),variant:"light",children:i.jsx(V,{className:n===E?"pause-btn":"preview-song"})}),i.jsx(W,{onClick:p=>c(p,f),variant:"light",children:i.jsx(V,{className:"move-disk"})})]})]},d)})})}),i.jsxs("div",{className:"playlist-bottom text-black p-1",children:[i.jsx("h5",{children:g("playlist.editor.text.get.more.music")}),i.jsx("div",{children:g("playlist.editor.text.you.have.no.songdisks.available")}),i.jsx("div",{children:g("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),i.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>u(),children:g("playlist.editor.button.open.catalogue")})]}),i.jsx("img",{src:ct("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},Dtt=a=>{var h,d;const{furniId:t=-1,playlist:e=null,currentPlayingIndex:s=-1,removeFromPlaylist:r=null,togglePlayPause:n=null}=a,[o,l]=_.useState(-1),c=f=>{o===f&&r(f)},u=(f,E)=>{n(f,E!==-1?E:0)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[i.jsx("img",{src:ct("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),i.jsx("h2",{className:"ms-4",children:g("playlist.editor.playlist")})]}),i.jsx("div",{className:"h-100 overflow-y-scroll py-2",children:i.jsx(x,{column:!0,gap:2,children:e&&e.map((f,E)=>i.jsxs(x,{gap:1,className:"text-black cursor-pointer "+(o===E?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>l(m=>m===E?-1:E),children:[i.jsx(V,{onClick:()=>c(E),className:"disk-2 "+(o===E?"selected-song":""),style:{backgroundColor:o===E?"":dU(f.songData)}}),f.name]},E))})}),(!e||e.length===0)&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"playlist-bottom text-black p-1 ms-5",children:[i.jsx("h5",{children:g("playlist.editor.add.songs.to.your.playlist")}),i.jsx("div",{children:g("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),i.jsx("img",{src:ct("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),e&&e.length>0&&i.jsxs(i.Fragment,{children:[s===-1&&i.jsx(W,{variant:"success",size:"lg",onClick:()=>u(t,o),children:g("playlist.editor.button.play.now")}),s!==-1&&i.jsxs(x,{gap:1,children:[i.jsx(W,{variant:"danger",onClick:()=>u(t,o),children:i.jsx(V,{className:"pause-song"})}),i.jsxs(x,{column:!0,children:[i.jsx(O,{bold:!0,display:"block",children:g("playlist.editor.text.now.playing.in.your.room")}),i.jsx(O,{children:((h=e[s])==null?void 0:h.name)+" - "+((d=e[s])==null?void 0:d.creator)})]})]})]})]})},vtt=a=>{const{objectId:t=-1,currentPlayingIndex:e=-1,playlist:s=null,diskInventory:r=null,onClose:n=null,togglePlayPause:o=null,removeFromPlaylist:l=null,addToPlaylist:c=null}=r8();return t===-1?null:i.jsxs(Ct,{className:"nitro-playlist-editor-widget",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("playlist.editor.title"),onCloseClick:n}),i.jsx(It,{children:i.jsxs("div",{className:"d-flex flex-row gap-1 h-100",children:[i.jsx("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:i.jsx(btt,{addToPlaylist:c,diskInventory:r})}),i.jsx("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:i.jsx(Dtt,{furniId:t,removeFromPlaylist:l,playlist:s,togglePlayPause:o,currentPlayingIndex:e})})]})})]})},Ptt=a=>i.jsxs(V,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[i.jsx(rtt,{}),i.jsx(ntt,{}),i.jsx(att,{}),i.jsx(ott,{}),i.jsx(ltt,{}),i.jsx(utt,{}),i.jsx(htt,{}),i.jsx(dtt,{}),i.jsx(_tt,{}),i.jsx(gtt,{}),i.jsx(mtt,{}),i.jsx(vtt,{}),i.jsx(Ett,{}),i.jsx(Ttt,{}),i.jsx(Rtt,{}),i.jsx(xtt,{}),i.jsx(ytt,{}),i.jsx(itt,{}),i.jsx(Mtt,{})]}),Ltt=a=>{const{isVisible:t=!1,errorResult:e=null,petName:s=null,objectType:r=null,onChangePetName:n=null,onConfirm:o=null,onClose:l=null}=V8();return i.jsx(i.Fragment,{children:t&&i.jsxs(Ct,{className:"nitro-pet-package no-resize",theme:"primary-slim",children:[i.jsx(Nt,{center:!0,headerText:g(r==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>l()}),i.jsxs(It,{children:[i.jsxs(x,{className:"pet-package-container-top p-3",children:[i.jsx("div",{className:`package-image-${r} flex-shrink-0`}),i.jsx("div",{className:"m-2",children:i.jsx(O,{variant:"white",className:"package-text-big",children:g(r==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),i.jsx(x,{className:"pet-package-container-bottom p-2",children:i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[i.jsx("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:ct("pet.package.name.max.length"),placeholder:g(r==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:s,onChange:c=>n(c.target.value)}),i.jsx("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),e.length>0&&i.jsx(V,{className:"invalid-feedback d-block m-0",children:e}),i.jsxs(x,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[i.jsx(O,{pointer:!0,className:"text-decoration",onClick:()=>l(),children:g("cancel")}),i.jsx(K0,{variant:s.length<3?"danger":"success",disabled:s.length<3,onClick:()=>o(),children:g(r==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},Utt=a=>{const[t,e]=_.useState("bobba"),[s,r]=_.useState(""),[n,o]=_.useState(!1),{wordsFilter:l=[],isVisible:c=null,setWordsFilter:u,onClose:h=null}=j8(),{navigatorData:d=null}=sn(),f=I=>{(n?!s:!t)||(H(new Tv(d.enteredGuestRoom.roomId,I,n?s:t)),r(""),e("bobba"),o(!1),!(I&&l.includes(n?s:t))&&u(p=>{const T=[...p];return I?T.push(n?s:t):T.splice(T.indexOf(n?s:t),1),T}))},E=I=>{e(I),o(!1)},m=I=>{r(I),o(!0)};return c?i.jsxs(Ct,{className:"nitro-guide-tool no-resize",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("navigator.roomsettings.roomfilter"),onCloseClick:()=>h()}),i.jsxs(It,{className:"text-black",children:[i.jsxs(pt,{className:"d-flex align-items-center justify-content-end gap-2",children:[i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:t,onChange:I=>E(I.target.value)}),i.jsx(W,{onClick:()=>f(!0),children:g("navigator.roomsettings.roomfilter.addword")})]}),i.jsx(N,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:l&&l.length>0&&l.map((I,p)=>i.jsx(x,{alignItems:"center",className:fi("rounded p-1",s===I&&"bg-muted"),pointer:!0,onClick:T=>m(I),children:i.jsx(O,{truncate:!0,children:I})},p))}),i.jsx(pt,{className:"d-flex align-items-center justify-content-end gap-2",children:i.jsx(W,{variant:"danger",onClick:()=>f(!1),disabled:l.length===0||!n,children:g("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},jtt=a=>{const[t,e]=_.useState(!1),{roomSession:s=null}=Le();_s([ta.SHOW_THUMBNAIL,ta.HIDE_THUMBNAIL,ta.TOGGLE_THUMBNAIL],n=>{switch(n.type){case ta.SHOW_THUMBNAIL:e(!0);return;case ta.HIDE_THUMBNAIL:e(!1);return;case ta.TOGGLE_THUMBNAIL:e(o=>!o);return}});const r=async n=>{await rt().saveTextureAsScreenshot(n,!0),e(!1)};return t?i.jsx(r9,{roomId:s.roomId,textureReceiver:r,onClose:()=>e(!1)}):null},wtt=a=>{var k,G,j,F;const[t,e]=_.useState(!1),[s,r]=_.useState(!1),[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(null),[d,f]=_.useState(!1),[E,m]=_.useState(!1),[I,p]=_.useState(!0),[T,R]=_.useState([]),{navigatorData:S=null}=sn(),{roomSession:L=null}=Le();_.useEffect(()=>{n||o(g("landing.view.generic.welcome.first_login"))},[n]);const M=(U,K)=>{switch(U){case"settings":ht("navigator/toggle-room-info");return;case"zoom":r(Q=>{let ut=rt().getRoomInstanceRenderingCanvasScale(L.roomId,1);return Q?ut*=2:ut/=2,rt().setRoomInstanceRenderingCanvasScale(L.roomId,1,ut),!Q});return;case"chat_history":ht("chat-history/toggle");return;case"hiddenbubbles":ht("nitrobubblehidden/toggle");const B=document.getElementById("bubble");B&&B.classList.toggle("icon-chat-disablebubble");const J=document.getElementById("hiddenbubblesText");if(J){const Q=g(t?"room.unmute.button.text":"room.mute.button.text");J.innerText=Q}e(!t);const Z=document.getElementById("bubbleIcon");Z&&Z.classList.toggle("icon-chat-disablebubble");return;case"like_room":H(new Ev(1));return;case"toggle_room_link":ht("navigator/toggle-room-link");return;case"navigator_search_tag":ht(`navigator/search/${K}`),H(new Vl("hotel_view",`tag:${K}`));return;case"room_history":T.length>0&&m(Q=>!Q);return;case"room_history_back":Li(T[T.findIndex(Q=>Q.roomId===S.currentRoomId)-1].roomId);return;case"room_history_next":Li(T[T.findIndex(Q=>Q.roomId===S.currentRoomId)+1].roomId);return}},P=(U,K)=>{let B=JSON.parse(window.localStorage.getItem("nitro.room.history"));if(B&&B.filter(Z=>Z.roomId===U).length>0)return;B&&B.length>=10&&B.shift();const J=B?[...B,{roomId:U,roomName:K}]:[{roomId:U,roomName:K}];return R(J),vS("nitro.room.history",J)};return z($a,U=>{const K=U.getParser();!K.roomEnter||K.data.roomId!==L.roomId||(n!==K.data.roomName&&o(K.data.roomName),l!==K.data.ownerName&&c(K.data.ownerName),u!==K.data.tags&&h(K.data.tags),P(K.data.roomId,K.data.roomName))}),_.useEffect(()=>{const U=()=>{JSON.parse(window.localStorage.getItem("nitro.room.history"))&&window.localStorage.removeItem("nitro.room.history")};return window.addEventListener("beforeunload",U),()=>{window.removeEventListener("beforeunload",U)}},[]),_.useEffect(()=>{f(!0);const U=setTimeout(()=>f(!1),5e3);return()=>clearTimeout(U)},[n,l,u,I]),_.useEffect(()=>{R(JSON.parse(window.localStorage.getItem("nitro.room.history"))??[])},[]),i.jsxs(x,{className:"nitro-room-tools-container",gap:2,children:[i.jsx("div",{className:"btn-toggle toggle-roomtool d-flex align-items-center",onClick:()=>p(!I),children:i.jsx("div",{className:"toggle-icon "+(I?"left":"right")})}),I&&i.jsxs(i.Fragment,{children:[i.jsxs(N,{gap:0,center:!0,className:"nitro-room-tools p-3 px-3",children:[i.jsxs(x,{children:[i.jsxs(N,{center:!0,className:"margin-icons p-2 gap-2",children:[i.jsx(V,{pointer:!0,title:g("room.settings.button.text"),className:"icon icon-cog",onClick:()=>M("settings")}),i.jsx(V,{pointer:!0,title:g("room.zoom.button.text"),onClick:()=>M("zoom"),className:fi("icon",!s&&"icon-zoom-less",s&&"icon-zoom-more")}),i.jsx(V,{pointer:!0,title:g("room.chathistory.button.text"),onClick:()=>M("chat_history"),className:"icon icon-chat-history"}),S.canRate&&i.jsx(V,{pointer:!0,title:g("room.like.button.text"),onClick:()=>M("like_room"),className:"icon icon-like-room"}),i.jsx(V,{pointer:!0,onClick:()=>M("toggle_room_link"),className:"icon icon-room-link"}),i.jsx(V,{pointer:!0,onClick:()=>M("hiddenbubbles"),className:`icon ${t?"icon-chat-disablebubble":"icon-chat-enablebubble"}`})]}),i.jsxs(N,{className:"d-flex flex-column",children:[i.jsx(x,{className:"w-100 room-tool-item",children:i.jsx(O,{variant:"muted",underline:!0,small:!0,onClick:()=>M("settings"),children:g("room.settings.button.text")})}),i.jsx(x,{className:"w-100 room-tool-item",children:i.jsx(O,{variant:"muted",underline:!0,small:!0,onClick:()=>M("zoom"),children:g("room.zoom.button.text")})}),i.jsx(x,{className:"w-100 room-tool-item",children:i.jsx(O,{variant:"muted",underline:!0,small:!0,onClick:()=>M("chat_history"),children:g("room.chathistory.button.text")})}),S.canRate&&i.jsx(x,{className:"w-100 room-tool-item",children:i.jsx(O,{variant:"muted",underline:!0,small:!0,onClick:()=>M("like_room"),children:g("room.like.button.text")})}),i.jsx(x,{className:"w-100 room-tool-item",children:i.jsx(O,{variant:"muted",underline:!0,small:!0,onClick:()=>M("toggle_room_link"),children:g("navigator.embed.caption")})}),i.jsx(x,{className:"w-100 room-tool-item",children:i.jsxs(O,{variant:"muted",underline:!0,small:!0,onClick:()=>M("hiddenbubbles"),children:[" ",g(t?"room.unmute.button.text":"room.mute.button.text")]})})]})]}),i.jsxs(x,{justifyContent:"center",children:[i.jsx(V,{pointer:T.length>1&&((k=T[0])==null?void 0:k.roomId)!==S.currentRoomId,title:g("room.history.button.back.tooltip"),className:`icon ${(T==null?void 0:T.length)===0||((G=T[0])==null?void 0:G.roomId)===S.currentRoomId?"icon-room-history-back-disabled":"icon-room-history-back-enabled"}`,onClick:()=>{var U;return(T==null?void 0:T.length)===0||((U=T[0])==null?void 0:U.roomId)===S.currentRoomId?null:M("room_history_back")}}),i.jsx(V,{pointer:(T==null?void 0:T.length)>0,title:g("room.history.button.tooltip"),className:`icon ${(T==null?void 0:T.length)===0?"icon-room-history-disabled":"icon-room-history-enabled"} margin-button-history`,onClick:()=>(T==null?void 0:T.length)===0?null:M("room_history")}),i.jsx(V,{pointer:T.length>1&&((j=T[T.length-1])==null?void 0:j.roomId)!==S.currentRoomId,title:g("room.history.button.forward.tooltip"),className:`icon ${(T==null?void 0:T.length)===0||((F=T[T.length-1])==null?void 0:F.roomId)===S.currentRoomId?"icon-room-history-next-disabled":"icon-room-history-next-enabled"}`,onClick:()=>{var U;return(T==null?void 0:T.length)===0||((U=T[T.length-1])==null?void 0:U.roomId)===S.currentRoomId?null:M("room_history_next")}})]})]}),i.jsx(x,{className:"nitro-room-tools-history",style:{bottom:S.canRate?"210px":"180px"},children:i.jsx(hu,{children:E&&i.jsx(du.div,{initial:{x:-400},animate:{x:0},exit:{x:-400},children:i.jsx(N,{center:!0,children:i.jsx(N,{className:"px-3 py-2 rounded nitro-room-history",children:i.jsx(N,{gap:1,children:T.length>0&&T.map(U=>i.jsx(O,{bold:U.roomId===S.currentRoomId,variant:U.roomId===S.currentRoomId?"white":"muted",pointer:!0,onClick:()=>Li(U.roomId),children:U.roomName},U.roomId))})})})})})}),i.jsx(N,{justifyContent:"center",children:i.jsx(hu,{children:d&&i.jsx(du.div,{initial:{x:-400},animate:{x:0},exit:{x:-400},children:i.jsx(N,{center:!0,children:i.jsxs(N,{className:"nitro-room-tools-info rounded py-2 px-3",children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{wrap:!0,variant:"white",fontSize:4,children:n}),i.jsx(O,{variant:"muted",fontSize:5,children:l})]}),u&&u.length>0?i.jsx(x,{gap:2,children:u.map((U,K)=>i.jsxs(O,{small:!0,pointer:!0,truncate:!0,variant:"white",className:"rounded bg-primary p-1",onClick:()=>M("navigator_search_tag",U),children:["#",U]},K))}):i.jsx(O,{variant:"muted",children:g("navigator.notagsfound")})]})})})})})]})]})},Ftt=a=>{const{question:t=null,canVote:e=null,vote:s=null,noVotes:r=null,yesVotes:n=null}=a;return i.jsxs(N,{gap:2,className:"wordquiz-question p-2",children:[!e&&i.jsxs(x,{fullWidth:!0,alignItems:"center",gap:2,children:[i.jsx(x,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:i.jsx(O,{variant:"white",children:r})}),i.jsx(O,{variant:"white",center:!0,textBreak:!0,children:t}),i.jsx(x,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:i.jsx(O,{variant:"white",children:n})})]}),e&&i.jsxs(N,{children:[i.jsx(O,{variant:"white",center:!0,textBreak:!0,children:t}),i.jsxs(x,{fullWidth:!0,justifyContent:"center",gap:1,children:[i.jsx(x,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:o=>s(yg),children:i.jsx(V,{className:"word-quiz-dislike"})}),i.jsx(x,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:o=>s(_U),children:i.jsx(V,{className:"word-quiz-like"})})]})]})]})},Gtt=a=>{const{userIndex:t=null,vote:e=null,...s}=a;return i.jsx(qS,{objectId:t,category:Y.UNIT,...s,children:i.jsx(x,{center:!0,pointer:!0,className:`bg-${e===yg?"danger":"success"} rounded p-1`,children:i.jsx(V,{className:`word-quiz-${e===yg?"dislike":"like"}-sm`})})})},ktt=a=>{const{question:t=null,answerSent:e=!1,answerCounts:s=null,userAnswers:r=null,vote:n=null}=q8();return i.jsxs(i.Fragment,{children:[t&&i.jsx(Ftt,{question:t.content,canVote:!e,vote:n,noVotes:s.get(yg)||0,yesVotes:s.get(_U)||0}),r&&Array.from(r.entries()).map(([o,l],c)=>i.jsx(Gtt,{userIndex:o,vote:l.value},c))]})},Btt=a=>{const{roomSession:t=null}=Le(),{simpleAlert:e=null}=Ye();return ft(xl.ROOM_ZOOM,s=>rt().setRoomInstanceRenderingCanvasScale(s.roomId,1,s.level,null,null,!1,s.asDelta)),ft([ot.REQUEST_TEASER,ot.REQUEST_ECOTRONBOX,ot.REQUEST_CLOTHING_CHANGE,ot.REQUEST_PLAYLIST_EDITOR,ot.OPEN_WIDGET,ot.CLOSE_WIDGET,na.FURNI_CLICK,na.FURNI_DOUBLE_CLICK,na.TOOLTIP_SHOW,na.TOOLTIP_HIDE],s=>{if(t)switch(s.objectId,s.category,s.type){}}),ft([ue.RSEME_KICKED,ue.RSEME_PETS_FORBIDDEN_IN_HOTEL,ue.RSEME_PETS_FORBIDDEN_IN_FLAT,ue.RSEME_MAX_PETS,ue.RSEME_MAX_NUMBER_OF_OWN_PETS,ue.RSEME_NO_FREE_TILES_FOR_PET,ue.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,ue.RSEME_BOTS_FORBIDDEN_IN_HOTEL,ue.RSEME_BOTS_FORBIDDEN_IN_FLAT,ue.RSEME_BOT_LIMIT_REACHED,ue.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,ue.RSEME_BOT_NAME_NOT_ACCEPTED],s=>{let r=g("error.title"),n="";switch(s.type){case ue.RSEME_MAX_PETS:n=g("room.error.max_pets");break;case ue.RSEME_MAX_NUMBER_OF_OWN_PETS:n=g("room.error.max_own_pets");break;case ue.RSEME_KICKED:n=g("room.error.kicked"),r=g("generic.alert.title");break;case ue.RSEME_PETS_FORBIDDEN_IN_HOTEL:n=g("room.error.pets.forbidden_in_hotel");break;case ue.RSEME_PETS_FORBIDDEN_IN_FLAT:n=g("room.error.pets.forbidden_in_flat");break;case ue.RSEME_NO_FREE_TILES_FOR_PET:n=g("room.error.pets.no_free_tiles");break;case ue.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:n=g("room.error.pets.selected_tile_not_free");break;case ue.RSEME_BOTS_FORBIDDEN_IN_HOTEL:n=g("room.error.bots.forbidden_in_hotel");break;case ue.RSEME_BOTS_FORBIDDEN_IN_FLAT:n=g("room.error.bots.forbidden_in_flat");break;case ue.RSEME_BOT_LIMIT_REACHED:n=g("room.error.max_bots");break;case ue.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:n=g("room.error.bots.selected_tile_not_free");break;case ue.RSEME_BOT_NAME_NOT_ACCEPTED:n=g("room.error.bots.name.not.accepted");break;default:return}e(n,Yt.DEFAULT,null,null,r)}),i.jsxs(i.Fragment,{children:[i.jsx(U$,{}),i.jsx(H$,{}),i.jsx(G$,{}),i.jsx(z$,{}),i.jsx(Ptt,{}),i.jsx(wtt,{}),i.jsx(Utt,{}),i.jsx(jtt,{}),i.jsx(W$,{}),i.jsx(Ltt,{}),i.jsx(Y$,{}),i.jsx(ktt,{}),i.jsx(X$,{})]})},Vtt=a=>{const{roomSession:t=null}=Le(),e=_.useRef();return _.useEffect(()=>{if(!t)return;const s=Mr().canvas;if(!s)return;s.onclick=n=>Wd(n),s.onmousemove=n=>Wd(n),s.onmousedown=n=>Wd(n),s.onmouseup=n=>Wd(n),s.ontouchstart=n=>Kd(n),s.ontouchmove=n=>Kd(n),s.ontouchend=n=>Kd(n),s.ontouchcancel=n=>Kd(n);const r=e.current;r&&r.appendChild(s)},[t]),i.jsx(hu,{children:!!t&&i.jsx(du.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i.jsx("div",{ref:e,className:"w-100 h-100",children:t instanceof pL&&i.jsxs(i.Fragment,{children:[i.jsx(Btt,{}),t.isSpectator&&i.jsx(h$,{})]})})})})},Htt=a=>{const{useGuideTool:t=!1,unseenAchievementCount:e=0,setMeExpanded:s=null,children:r=null,...n}=a,o=_.useRef();return _.useEffect(()=>{const l=Se();l&&rt().selectRoomObject(l.roomId,l.ownRoomIndex,Y.UNIT)},[]),_.useEffect(()=>{const l=c=>s(!1);return document.addEventListener("click",l),()=>document.removeEventListener(lt.MOUSE_CLICK,l)},[s]),i.jsxs(x,{innerRef:o,alignItems:"center",className:"nitro-toolbar-me p-2",gap:2,children:[jt()&&t&&i.jsx(V,{pointer:!0,className:"navigation-item icon icon-me-helper-tool click-box",onClick:l=>Ps(new or(or.TOGGLE_GUIDE_TOOL))}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-me-achievements click-box",onClick:l=>ht("achievements/toggle"),children:e>0&&i.jsx(ko,{count:e})}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-me-profile click-box",onClick:l=>Ki(tt().userId)}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-me-rooms click-box",onClick:l=>ht("navigator/search/myworld_view")}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-me-clothing click-box",onClick:l=>ht("avatar-editor/toggle")}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-me-settings click-box",onClick:l=>ht("user-settings/toggle")}),r]})},Wtt=a=>{const{isInRoom:t}=a,[e,s]=_.useState(!1),[r,n]=_.useState(!1),{userFigure:o=null}=to(),{getFullCount:l=0}=vr(),{getTotalUnseen:c=0}=Zm(),{requests:u=[]}=gr(),{iconState:h=oa.HIDDEN}=IU(),d=tt().isModerator;return z(zR,f=>{const E=f.getParser();n(E.isAllowed(Y_.USE_GUIDE_TOOL))}),ft(Kh.ANIMATE_ICON,f=>{((m,I,p,T)=>{const R=document.body.getElementsByClassName(m)[0];if(!R)return;I.className="toolbar-icon-animation",I.style.visibility="visible",I.style.left=p+"px",I.style.top=T+"px",document.body.append(I);const S=R.getBoundingClientRect(),L=I.getBoundingClientRect(),M=L.x-S.x,P=L.y-S.y,k=Math.sqrt(M*M+P*P),G=500-Math.abs(1/k*100*500*.5),j=20,F=`ToolbarBouncing[${m}]`;Vu.getMotionByTag(F)||(Vu.runMotion(new wO(new lj(G+8),new ij(R,400,12))).tag=F);const U=new wO(new aj(new oj(I,G,S.x-L.x+j,S.y-L.y,100,1),1),new sj(I));Vu.runMotion(U)})("icon-inventory",f.image,f.x,f.y)}),i.jsxs(i.Fragment,{children:[i.jsx(hu,{children:e&&i.jsx(du.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i.jsx(Htt,{useGuideTool:r,unseenAchievementCount:c,setMeExpanded:s})})}),i.jsxs(x,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[i.jsxs(x,{gap:2,alignItems:"center",className:"widthsizemax",children:[i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsxs(x,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(e?"active ":""),onClick:f=>{s(!e),f.stopPropagation()},children:[i.jsx(os,{figure:o,headOnly:!0,direction:2,position:"absolute"}),c>0&&i.jsx(ko,{count:c})]}),t&&i.jsx(V,{pointer:!0,className:"navigation-item icon icon-habbo click-box",onClick:f=>yS()}),!t&&i.jsx(V,{pointer:!0,className:"navigation-item icon icon-house click-box",onClick:f=>ht("navigator/goto/home")}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-rooms click-box",onClick:f=>ht("navigator/toggle")}),ct("game.center.enabled")&&i.jsx(V,{pointer:!0,className:"navigation-item icon icon-game click-box",onClick:f=>ht("games/toggle")}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-catalog click-box",onClick:f=>ht("catalog/toggle")}),i.jsx(V,{pointer:!0,className:"navigation-item icon icon-inventory click-box",onClick:f=>ht("inventory/toggle"),children:l>0&&i.jsx(ko,{count:l})}),t&&i.jsx(V,{pointer:!0,className:"navigation-item icon icon-camera click-box",onClick:f=>ht("camera/toggle")}),d&&i.jsx(V,{pointer:!0,className:"navigation-item icon icon-modtools click-box",onClick:f=>ht("mod-tools/toggle")})]}),i.jsx(x,{alignItems:"center",id:"toolbar-chat-input-container"})]}),i.jsxs(x,{alignItems:"center",gap:2,children:[i.jsxs(x,{gap:2,children:[i.jsx(V,{pointer:!0,className:"navigation-item icon icon-friendall click-box friendsmovilgen",onClick:f=>ht("friends/toggle"),children:u.length>0&&i.jsx(ko,{count:u.length})}),(h===oa.SHOW||h===oa.UNREAD)&&i.jsx(V,{pointer:!0,className:`navigation-item icon icon-message click-box mensajesmovilgen ${h===oa.UNREAD&&"is-unseen"}`,onClick:f=>Qm()})]}),i.jsx(V,{id:"toolbar-friend-bar-container",className:"d-none d-lg-block"})]})]})]})},Ytt=a=>{const{badges:t=null,gap:e=1,justifyContent:s="between",...r}=a;return i.jsx(i.Fragment,{children:t&&t.length>0&&t.map((n,o)=>i.jsx(N,{center:!0,children:i.jsx(Xe,{badgeCode:n},n)},n))})},ztt=a=>{const{relationships:t=null}=a,e=({type:s})=>{const r=t&&t.relationshipStatusMap.hasKey(s)?t.relationshipStatusMap.getValue(s):null,n=ur.RELATIONSHIP_NAMES[s].toLocaleLowerCase();return i.jsxs(x,{fullWidth:!0,gap:1,children:[i.jsx(x,{center:!0,className:"user-relationship",children:i.jsx("i",{className:`nitro-friends-spritesheet icon-${n}`})}),i.jsxs(N,{grow:!0,gap:0,children:[i.jsxs(x,{alignItems:"center",justifyContent:"between",className:"bg-white rounded px-2 py-1 user-relationship",children:[i.jsxs(O,{small:!0,underline:!0,pointer:!0,onClick:o=>r&&r.randomFriendId>=1&&Ki(r.randomFriendId),children:[(!r||r.friendCount===0)&&g("extendedprofile.add.friends"),r&&r.friendCount>=1&&r.randomFriendName]}),r&&r.friendCount>=1&&i.jsx(x,{center:!0,position:"relative",className:"avatar-image-container",children:i.jsx(os,{figure:r.randomFriendFigure,headOnly:!0,direction:4})})]}),i.jsxs(O,{small:!0,italics:!0,className:"user-relationship-count",children:[(!r||r.friendCount===0)&&g("extendedprofile.no.friends.in.this.category"),r&&r.friendCount>1&&g(`extendedprofile.relstatus.others.${n}`,["count"],[(r.friendCount-1).toString()]),""]})]})]})};return i.jsxs(i.Fragment,{children:[i.jsx(e,{type:ur.HEART}),i.jsx(e,{type:ur.SMILE}),i.jsx(e,{type:ur.BOBBA})]})},Ktt=a=>{const{relationships:t=null,friendsCount:e=null}=a;return i.jsxs(N,{gap:1,children:[i.jsxs(O,{small:!0,children:[i.jsx("b",{children:g("extendedprofile.friends.count")})," ",e]}),i.jsx(O,{bold:!0,small:!0,children:g("extendedprofile.relstatus")}),i.jsx(N,{children:i.jsx(ztt,{relationships:t})})]})},Xtt=a=>{const{itsMe:t=null,groups:e=null,onLeaveGroup:s=null,overflow:r="hidden",gap:n=2,...o}=a,[l,c]=_.useState(null),[u,h]=_.useState(null);return z(Du,d=>{const f=d.getParser();!l||l!==f.id||f.flag||h(f)}),_.useEffect(()=>{l&&H(new Ou(l,!1))},[l]),_.useEffect(()=>{h(null),e.length>0&&c(d=>(d===e[0].groupId&&H(new Ou(e[0].groupId,!1)),e[0].groupId))},[e]),!e||!e.length?i.jsx(N,{center:!0,fullHeight:!0,children:i.jsxs(x,{justifyContent:"center",gap:2,children:[i.jsx(V,{className:"no-group-spritesheet image-1"}),i.jsx(V,{className:"no-group-spritesheet image-2"}),i.jsx(V,{className:"no-group-spritesheet image-3"})]})}):i.jsxs(pt,{overflow:r,gap:2,...o,children:[i.jsx(N,{alignItems:"center",size:2,overflow:"auto",children:i.jsx(Fe,{overflow:null,columnCount:1,columnMinHeight:50,className:"user-groups-container",children:e.map((d,f)=>i.jsxs($t,{overflow:"unset",itemActive:l===d.groupId,onClick:()=>c(d.groupId),className:"p-1",children:[t&&i.jsx("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(d.favourite?"favorite":"not-favorite"),onClick:()=>dq(d)}),i.jsx(Xe,{badgeCode:d.badgeCode,isGroup:!0})]},f))})}),i.jsx(N,{size:10,overflow:"hidden",children:u&&i.jsx(qU,{groupInformation:u,onClose:s})})]})},qtt=a=>{const{userProfile:t=null}=a,[e,s]=_.useState(t.requestSent),r=t.id===tt().userId,n=!e&&!r&&!t.isMyFriend&&!t.requestSent,o=()=>{s(!0),H(new iS(t.username))};return _.useEffect(()=>{s(t.requestSent)},[t]),i.jsxs(x,{gap:2,children:[i.jsx(N,{center:!0,className:"avatar-container",children:i.jsx(os,{figure:t.figure,direction:2})}),i.jsxs(N,{children:[i.jsxs(N,{gap:0,children:[i.jsx(O,{bold:!0,children:t.username}),i.jsxs(O,{italics:!0,textBreak:!0,small:!0,children:[t.motto,""]})]}),i.jsxs(N,{gap:1,children:[i.jsxs(O,{small:!0,children:[i.jsx("b",{children:g("extendedprofile.created")})," ",t.registration]}),i.jsxs(O,{small:!0,children:[i.jsx("b",{children:g("extendedprofile.last.login")})," ",xr.format(t.secondsSinceLastVisit,".ago",2)]}),i.jsxs(O,{small:!0,children:[i.jsx("b",{children:g("extendedprofile.achievementscore")})," ",t.achievementPoints]})]}),i.jsxs(x,{gap:1,children:[t.isOnline&&i.jsx("i",{className:"icon icon-pf-online"}),!t.isOnline&&i.jsx("i",{className:"icon icon-pf-offline"}),i.jsxs(x,{alignItems:"center",gap:1,children:[n&&i.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:o,children:g("extendedprofile.addasafriend")}),!n&&i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"icon icon-pf-tick"}),r&&i.jsx(O,{children:g("extendedprofile.me")}),t.isMyFriend&&i.jsx(O,{children:g("extendedprofile.friend")}),(e||t.requestSent)&&i.jsx(O,{children:g("extendedprofile.friendrequestsent")})]})]})]})]})]})},Qtt=a=>{const[t,e]=_.useState(null),[s,r]=_.useState([]),[n,o]=_.useState(null),l=()=>{e(null),r([]),o(null)},c=()=>{!t||t.id!==tt().userId||Ki(t.id)};return z(JR,u=>{const h=u.getParser();!t||h.userId!==t.id||r(h.badges)}),z(QR,u=>{const h=u.getParser();!t||h.userId!==t.id||o(h)}),z(kM,u=>{const h=u.getParser();let d=!1;e(f=>(f&&f.id&&(d=f.id===h.id),h)),d||(r([]),o(null)),H(new ES(h.id)),H(new IS(h.id))}),z(HM,u=>{const h=u.getParser();h.userId==(t==null?void 0:t.id)&&Ki(h.userId)}),ft(Ot.SELECTED,u=>{if(!t||u.category!==Y.UNIT)return;const h=Se().userDataManager.getUserDataByIndex(u.objectId);h.type===Pe.USER&&Ki(h.webID)}),t?i.jsxs(Ct,{uniqueKey:"nitro-user-profile",theme:"primary-slim",className:"user-profile",children:[i.jsx(Nt,{headerText:g("extendedprofile.caption"),onCloseClick:l}),i.jsxs(It,{overflow:"hidden",children:[i.jsxs(pt,{fullHeight:!1,gap:2,children:[i.jsxs(N,{size:7,gap:1,className:"user-container pe-2",children:[i.jsx(qtt,{userProfile:t}),i.jsx(pt,{columnCount:5,fullHeight:!0,className:"bg-muted rounded px-2 py-1",children:i.jsx(Ytt,{fullWidth:!0,center:!0,badges:s})})]}),i.jsx(N,{size:5,children:n&&i.jsx(Ktt,{relationships:n,friendsCount:t.friendsCount})})]}),i.jsx(x,{alignItems:"center",className:"rooms-button-container px-2 py-1",children:i.jsxs(x,{alignItems:"center",gap:1,onClick:u=>ht(`navigator/search/hotel_view/owner:${t.username}`),children:[i.jsx("i",{className:"icon icon-rooms"}),i.jsx(O,{bold:!0,underline:!0,pointer:!0,children:g("extendedprofile.rooms")})]})}),i.jsx(Xtt,{fullWidth:!0,itsMe:t.id===tt().userId,groups:t.groups,onLeaveGroup:c})]})]}):null},Jtt=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(null),[n,o]=EU(),[l,c]=pU(),u=(d,f)=>{let E=!0;const m=s.clone();switch(d){case"close_view":e(!1),E=!1;return;case"oldchat":m.oldChat=f,H(new dL(m.oldChat));break;case"room_invites":m.roomInvites=f,H(new _L(m.roomInvites));break;case"camera_follow":m.cameraFollow=f,H(new hL(m.cameraFollow));break;case"system_volume":m.volumeSystem=f,m.volumeSystem=Math.max(0,m.volumeSystem),m.volumeSystem=Math.min(100,m.volumeSystem);break;case"furni_volume":m.volumeFurni=f,m.volumeFurni=Math.max(0,m.volumeFurni),m.volumeFurni=Math.min(100,m.volumeFurni);break;case"trax_volume":m.volumeTrax=f,m.volumeTrax=Math.max(0,m.volumeTrax),m.volumeTrax=Math.min(100,m.volumeTrax);break}E&&r(m),KT(m)},h=d=>{switch(d){case"volume":H(new gL(Math.round(s.volumeSystem),Math.round(s.volumeFurni),Math.round(s.volumeTrax)));break}};return z(ZR,d=>{const f=d.getParser(),E=new mu;E.volumeSystem=f.volumeSystem,E.volumeFurni=f.volumeFurni,E.volumeTrax=f.volumeTrax,E.oldChat=f.oldChat,E.roomInvites=f.roomInvites,E.cameraFollow=f.cameraFollow,E.flags=f.flags,E.chatType=f.chatType,r(E),KT(E)}),_.useEffect(()=>{const d={linkReceived:f=>{const E=f.split("/");if(!(E.length<2))switch(E[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(m=>!m);return}},eventUrlPrefix:"user-settings/"};return As(d),()=>Ns(d)},[]),_.useEffect(()=>{s&&Ps(s)},[s]),!t||!s?null:i.jsxs(Ct,{uniqueKey:"user-settings",className:"user-settings-window",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("widget.memenu.settings.title"),onCloseClick:d=>u("close_view")}),i.jsxs(It,{className:"text-black",children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.oldChat,onChange:d=>u("oldchat",d.target.checked)}),i.jsx(O,{children:g("memenu.settings.chat.prefer.old.chat")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.roomInvites,onChange:d=>u("room_invites",d.target.checked)}),i.jsx(O,{children:g("memenu.settings.other.ignore.room.invites")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.cameraFollow,onChange:d=>u("camera_follow",d.target.checked)}),i.jsx(O,{children:g("memenu.settings.other.disable.room.camera.follow")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:n,onChange:d=>o(d.target.checked)}),i.jsx(O,{children:g("memenu.settings.other.place.multiple.objects")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:l,onChange:d=>c(d.target.checked)}),i.jsx(O,{children:g("memenu.settings.other.skip.purchase.confirmation")})]})]}),i.jsxs(N,{children:[i.jsx(O,{bold:!0,children:g("widget.memenu.settings.volume")}),i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("widget.memenu.settings.volume.ui")}),i.jsxs(x,{alignItems:"center",gap:1,children:[s.volumeSystem===0&&i.jsx(uE,{className:fi(s.volumeSystem>=50&&"text-muted","fa-icon")}),s.volumeSystem>0&&i.jsx(hE,{className:fi(s.volumeSystem>=50&&"text-muted","fa-icon")}),i.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeSystem",value:s.volumeSystem,onChange:d=>u("system_volume",d.target.value),onMouseUp:()=>h("volume")}),i.jsx(dE,{className:fi(s.volumeSystem<50&&"text-muted","fa-icon")})]})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("widget.memenu.settings.volume.furni")}),i.jsxs(x,{alignItems:"center",gap:1,children:[s.volumeFurni===0&&i.jsx(uE,{className:fi(s.volumeFurni>=50&&"text-muted","fa-icon")}),s.volumeFurni>0&&i.jsx(hE,{className:fi(s.volumeFurni>=50&&"text-muted","fa-icon")}),i.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeFurni",value:s.volumeFurni,onChange:d=>u("furni_volume",d.target.value),onMouseUp:()=>h("volume")}),i.jsx(dE,{className:fi(s.volumeFurni<50&&"text-muted","fa-icon")})]})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{children:g("widget.memenu.settings.volume.trax")}),i.jsxs(x,{alignItems:"center",gap:1,children:[s.volumeTrax===0&&i.jsx(uE,{className:fi(s.volumeTrax>=50&&"text-muted","fa-icon")}),s.volumeTrax>0&&i.jsx(hE,{className:fi(s.volumeTrax>=50&&"text-muted","fa-icon")}),i.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeTrax",value:s.volumeTrax,onChange:d=>u("trax_volume",d.target.value),onMouseUp:()=>h("volume")}),i.jsx(dE,{className:fi(s.volumeTrax<50&&"text-muted","fa-icon")})]})]})]})]})]})},Ztt=a=>{const{trigger:t=null,furniIds:e=[]}=oe();return i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.pickfurnis.caption",["count","limit"],[e.length.toString(),t.maximumItemSelectionCount.toString()])}),i.jsx(O,{small:!0,children:g("wiredfurni.pickfurnis.desc")})]})},QS=a=>{const{wiredType:t="",requiresFurni:e=bt.STUFF_SELECTION_OPTION_NONE,save:s=null,validate:r=null,children:n=null,hasSpecialInput:o=!1}=a,[l,c]=_.useState(null),[u,h]=_.useState(null),[d,f]=_.useState(!1),{trigger:E=null,setTrigger:m=null,setIntParams:I=null,setStringParam:p=null,setFurniIds:T=null,setAllowsFurni:R=null,saveWired:S=null}=oe(),L=()=>m(null),M=()=>{r&&!r()||(s&&s(),f(!0))};return _.useEffect(()=>{d&&(S(),f(!1))},[d,S]),_.useEffect(()=>{if(!E)return;const P=E.spriteId||-1,k=tt().getFloorItemData(P);k?(c(k.name),h(k.description)):(c("NAME: "+P),h("NAME: "+P)),o&&(I(E.intData),p(E.stringData)),e>bt.STUFF_SELECTION_OPTION_NONE&&T(G=>(G&&G.length&&Fl.clearSelectionShaderFromFurni(G),E.selectedItems&&E.selectedItems.length?(Fl.applySelectionShaderToFurni(E.selectedItems),E.selectedItems):[])),R(e)},[E,o,e,I,p,T,R]),i.jsxs(Ct,{uniqueKey:"nitro-wired",className:"nitro-wired",theme:"primary-slim",children:[i.jsx(Nt,{headerText:g("wiredfurni.title"),onCloseClick:L}),i.jsxs(It,{children:[i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("i",{className:`icon icon-wired-${t}`}),i.jsx(O,{bold:!0,children:l})]}),i.jsx(O,{small:!0,children:u})]}),!!n&&i.jsx("hr",{className:"m-0 bg-dark"}),n,e>bt.STUFF_SELECTION_OPTION_NONE&&i.jsxs(i.Fragment,{children:[i.jsx("hr",{className:"m-0 bg-dark"}),i.jsx(Ztt,{})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx(W,{fullWidth:!0,variant:"success",onClick:M,children:g("wiredfurni.ready")}),i.jsx(W,{fullWidth:!0,variant:"secondary",onClick:L,children:g("cancel")})]})]})]})},Ts=a=>{const{requiresFurni:t=bt.STUFF_SELECTION_OPTION_NONE,save:e=null,hasSpecialInput:s=!1,children:r=null}=a,{trigger:n=null,actionDelay:o=0,setActionDelay:l=null}=oe();return _.useEffect(()=>{l(n.delayInPulses)},[n,l]),i.jsxs(QS,{wiredType:"action",requiresFurni:t,save:e,hasSpecialInput:s,children:[r,!!r&&i.jsx("hr",{className:"m-0 bg-dark"}),i.jsxs(N,{children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.delay",["seconds"],[Ud(o)])}),i.jsx(Xs,{className:"nitro-slider",min:0,max:20,value:o,onChange:c=>l(c)})]})]})},$tt="hd-180-1.ch-210-66.lg-270-82.sh-290-81",tet=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(""),{trigger:n=null,setStringParam:o=null}=oe(),l=()=>o(t+bu+s);return _.useEffect(()=>{const c=n.stringData.split(bu);c.length>0&&e(c[0]),c.length>1&&r(c[1].length>0?c[1]:$tt)},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:c=>e(c.target.value)})]}),i.jsxs(x,{center:!0,children:[i.jsx(os,{figure:s,direction:4}),i.jsx(W,{onClick:c=>r(tt().figure),children:g("wiredfurni.params.capture.figure")})]})]})},eet=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=oe(),c=()=>{o(t),l([s])};return _.useEffect(()=>{e(n.stringData),r(n.intData.length>0?n.intData[0]:0)},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:u=>e(u.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:s===1,onChange:u=>r(1)}),i.jsx(O,{children:g("wiredfurni.params.start.following")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:s===0,onChange:u=>r(0)}),i.jsx(O,{children:g("wiredfurni.params.stop.following")})]})]})]})},set=[2,5,7,8,9,10,27],iet=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=oe(),c=()=>{o(t),l([s])};return _.useEffect(()=>{e(n.stringData),r(n.intData.length>0?n.intData[0]:0)},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:u=>e(u.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.handitem")}),i.jsxs("select",{className:"form-select form-select-sm",value:s,onChange:u=>r(parseInt(u.target.value)),children:[i.jsx("option",{value:"0",children:"------"}),set.map(u=>i.jsx("option",{value:u,children:g(`handitem${u}`)},u))]})]})]})},ret=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:r=null}=oe(),n=()=>r(t);return _.useEffect(()=>{e(s.stringData)},[s]),i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},net=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(""),[n,o]=_.useState(-1),{trigger:l=null,setStringParam:c=null,setIntParams:u=null}=oe(),h=()=>{c(t+bu+s),u([n])};return _.useEffect(()=>{const d=l.stringData.split(bu);d.length>0&&e(d[0]),d.length>1&&r(d[1].length>0?d[1]:""),o(l.intData.length>0?l.intData[0]:0)},[l]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:d=>e(d.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.message")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:ct("wired.action.bot.talk.to.avatar.max.length",64),value:s,onChange:d=>r(d.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:d=>o(0)}),i.jsx(O,{children:g("wiredfurni.params.talk")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:d=>o(1)}),i.jsx(O,{children:g("wiredfurni.params.whisper")})]})]})]})},aet=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(""),[n,o]=_.useState(-1),{trigger:l=null,setStringParam:c=null,setIntParams:u=null}=oe(),h=()=>{c(t+bu+s),u([n])};return _.useEffect(()=>{const d=l.stringData.split(bu);d.length>0&&e(d[0]),d.length>1&&r(d[1].length>0?d[1]:""),o(l.intData.length>0?l.intData[0]:0)},[l]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:d=>e(d.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.message")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:ct("wired.action.bot.talk.max.length",64),value:s,onChange:d=>r(d.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:d=>o(0)}),i.jsx(O,{children:g("wiredfurni.params.talk")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:d=>o(1)}),i.jsx(O,{children:g("wiredfurni.params.shout")})]})]})]})},oet=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:r=null}=oe(),n=()=>r(t);return _.useEffect(()=>{e(s.stringData)},[s]),i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},cet=a=>i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),uet=a=>i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),het=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:r=null}=oe(),n=()=>r(t);return _.useEffect(()=>{e(s.stringData)},[s]),i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.message")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:o=>e(o.target.value),maxLength:ct("wired.action.chat.max.length",100)})]})})},det=a=>i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),_et=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(1),[n,o]=_.useState(!1),[l,c]=_.useState(1),[u,h]=_.useState(1),[d,f]=_.useState([]),{trigger:E=null,setIntParams:m=null,setStringParam:I=null}=oe(),p=()=>f(L=>[...L,{isBadge:!1,itemCode:"",probability:null}]),T=L=>{f(M=>{const P=Array.from(M);return P.splice(L,1),P})},R=(L,M,P,k)=>{const G=Array.from(d),j=G[L];j&&(j.isBadge=M,j.itemCode=P,j.probability=k,f(G))},S=()=>{let L=[];for(const M of d){if(!M.itemCode)continue;const P=[M.isBadge?"0":"1",M.itemCode,M.probability.toString()];L.push(P.join(","))}L.length>0&&(I(L.join(";")),m([s,n?1:0,l,u]))};return _.useEffect(()=>{const L=[];if(E.stringData.length>0&&E.stringData.includes(";")){const M=E.stringData.split(";");for(const P of M){const k=P.split(",");k.length===3&&L.push({isBadge:k[0]==="0",itemCode:k[1],probability:Number(k[2])})}}L.length===0&&L.push({isBadge:!1,itemCode:"",probability:null}),r(E.intData.length>0?E.intData[0]:0),o(E.intData.length>1?E.intData[1]===1:!1),c(E.intData.length>2?E.intData[2]:0),h(E.intData.length>3?E.intData[3]:0),e(E.intData.length>3?E.intData[3]>0:!1),f(L)},[E]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:S,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:L=>e(L.target.checked)}),i.jsx(O,{children:g("wiredfurni.params.prizelimit",["amount"],[t?l.toString():""])})]}),!t&&i.jsx(O,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),t&&i.jsx(Xs,{className:"nitro-slider",min:1,max:1e3,value:l,onChange:L=>c(L)}),i.jsx("hr",{className:"m-0 bg-dark"}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:"How often can a user be rewarded?"}),i.jsxs(x,{gap:1,children:[i.jsxs("select",{className:"form-select form-select-sm w-100",value:s,onChange:L=>r(Number(L.target.value)),children:[i.jsx("option",{value:"0",children:"Once"}),i.jsxs("option",{value:"3",children:["Once every ",u," minutes"]}),i.jsxs("option",{value:"2",children:["Once every ",u," hours"]}),i.jsxs("option",{value:"1",children:["Once every ",u," days"]})]}),s>0&&i.jsx("input",{type:"number",className:"form-control form-control-sm",value:u,onChange:L=>h(Number(L.target.value))})]})]}),i.jsx("hr",{className:"m-0 bg-dark"}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:n,onChange:L=>o(L.target.checked)}),i.jsx(O,{children:"Unique rewards"})]}),i.jsx(O,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),i.jsx("hr",{className:"m-0 bg-dark"}),i.jsxs(x,{justifyContent:"between",alignItems:"center",children:[i.jsx(O,{bold:!0,children:"Rewards"}),i.jsx(W,{variant:"success",onClick:p,children:i.jsx(Cd,{className:"fa-icon"})})]}),i.jsx(N,{gap:1,children:d&&d.map((L,M)=>i.jsxs(x,{gap:1,children:[i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",checked:L.isBadge,onChange:P=>R(M,P.target.checked,L.itemCode,L.probability)}),i.jsx(O,{small:!0,children:"Badge?"})]}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:L.itemCode,onChange:P=>R(M,L.isBadge,P.target.value,L.probability),placeholder:"Item Code"}),i.jsx("input",{type:"number",className:"form-control form-control-sm",value:L.probability,onChange:P=>R(M,L.isBadge,L.itemCode,Number(P.target.value)),placeholder:"Probability"}),M>0&&i.jsx(W,{variant:"danger",onClick:P=>T(M),children:i.jsx(uR,{className:"fa-icon"})})]},M))})]})},get=a=>{const[t,e]=_.useState(1),[s,r]=_.useState(1),[n,o]=_.useState(1),{trigger:l=null,setIntParams:c=null}=oe(),u=()=>c([t,s,n]);return _.useEffect(()=>{l.intData.length>=2?(e(l.intData[0]),r(l.intData[1]),o(l.intData[2])):(e(1),r(1),o(1))},[l]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.setpoints",["points"],[t.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:100,value:t,onChange:h=>e(h)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.settimesingame",["times"],[s.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:10,value:s,onChange:h=>r(h)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.team")}),[1,2,3,4].map(h=>i.jsxs(x,{gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${h}`,checked:n===h,onChange:d=>o(h)}),i.jsx(O,{children:g("wiredfurni.params.team."+h)})]},h))]})]})},fet=a=>{const[t,e]=_.useState(1),[s,r]=_.useState(1),{trigger:n=null,setIntParams:o=null}=oe(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),r(n.intData[1])):(e(1),r(1))},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.setpoints",["points"],[t.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:100,value:t,onChange:c=>e(c)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.settimesingame",["times"],[s.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:10,value:s,onChange:c=>r(c)})]})]})},met=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.team")}),[1,2,3,4].map(o=>i.jsxs(x,{gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${o}`,checked:t===o,onChange:l=>e(o)}),i.jsx(O,{children:g(`wiredfurni.params.team.${o}`)})]},o))]})})},Eet=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:r=null}=oe(),n=()=>r(t);return _.useEffect(()=>{e(s.stringData)},[s]),i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.message")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:o=>e(o.target.value),maxLength:ct("wired.action.kick.from.room.max.length",100)})]})})},pet=a=>i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Iet=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],Tet=[0,1,2,3,4,5,6],Ret=a=>{const[t,e]=_.useState(-1),[s,r]=_.useState(-1),{trigger:n=null,setIntParams:o=null}=oe(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),r(n.intData[1])):(e(-1),r(-1))},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.startdir")}),i.jsx(x,{gap:1,children:Iet.map(c=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:t===c.value,onChange:u=>e(c.value)}),i.jsx(O,{children:i.jsx("i",{className:`icon icon-${c.icon}`})})]},c.value))})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.turn")}),Tet.map(c=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c}`,checked:s===c,onChange:u=>r(c)}),i.jsx(O,{children:g(`wiredfurni.params.turn.${c}`)})]},c))]})]})},Oet=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],Aet=a=>{const[t,e]=_.useState(-1),[s,r]=_.useState(-1),{trigger:n=null,setIntParams:o=null}=oe(),l=()=>o([s,t]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[1]),r(n.intData[0])):(e(-1),r(-1))},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:l,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.emptytiles",["tiles"],[t.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:5,value:t,onChange:c=>e(c)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.startdir")}),i.jsx(x,{gap:1,children:Oet.map(c=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:s===c.value,onChange:u=>r(c.value)}),i.jsx(O,{children:i.jsx("i",{className:`icon icon-${c.icon}`})})]},c.value))})]})]})},Net=[{value:4,icon:"ne"},{value:5,icon:"se"},{value:6,icon:"sw"},{value:7,icon:"nw"},{value:2,icon:"mv-2"},{value:3,icon:"mv-3"},{value:1,icon:"mv-1"}],Cet=[0,1,2,3],xet=a=>{const[t,e]=_.useState(-1),[s,r]=_.useState(-1),{trigger:n=null,setIntParams:o=null}=oe(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),r(n.intData[1])):(e(-1),r(-1))},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.movefurni")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:t===0,onChange:c=>e(0)}),i.jsx(O,{children:g("wiredfurni.params.movefurni.0")})]}),i.jsxs(x,{gap:1,children:[Net.map(c=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:t===c.value,onChange:u=>e(c.value)}),i.jsx("i",{className:`icon icon-${c.icon}`})]},c.value)),i.jsx("div",{className:"col"})]})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.rotatefurni")}),Cet.map(c=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c}`,checked:s===c,onChange:u=>r(c)}),i.jsxs(O,{children:[[1,2].includes(c)&&i.jsx("i",{className:`icon icon-rot-${c}`}),g(`wiredfurni.params.rotatefurni.${c}`)]})]},c))]})]})},yet=a=>{const[t,e]=_.useState(-1),[s,r]=_.useState(""),{trigger:n=null,setIntParams:o=null,setStringParam:l=null}=oe(),c=()=>{o([t]),l(s)};return _.useEffect(()=>{e(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),i.jsxs(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.length.minutes",["minutes"],[t.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:10,value:t,onChange:u=>e(u)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.message")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:s,onChange:u=>r(u.target.value),maxLength:ct("wired.action.mute.user.max.length",100)})]})]})},Met=a=>i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),bet=a=>{const[t,e]=_.useState(0),[s,r]=_.useState(0),[n,o]=_.useState(0),{trigger:l=null,setIntParams:c=null}=oe(),u=()=>c([t,s,n]);return _.useEffect(()=>{e(l.getBoolean(0)?1:0),r(l.getBoolean(1)?1:0),o(l.getBoolean(2)?1:0)},[l]),i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:u,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.conditions")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!t,onChange:h=>e(h.target.checked?1:0)}),i.jsx(O,{children:g("wiredfurni.params.condition.state")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!s,onChange:h=>r(h.target.checked?1:0)}),i.jsx(O,{children:g("wiredfurni.params.condition.direction")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:h=>o(h.target.checked?1:0)}),i.jsx(O,{children:g("wiredfurni.params.condition.position")})]})]})})},Det=a=>i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),vet=a=>i.jsx(Ts,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Pet=a=>{switch(a){case rs.BOT_CHANGE_FIGURE:return i.jsx(tet,{});case rs.BOT_FOLLOW_AVATAR:return i.jsx(eet,{});case rs.BOT_GIVE_HAND_ITEM:return i.jsx(iet,{});case rs.BOT_MOVE:return i.jsx(ret,{});case rs.BOT_TALK:return i.jsx(aet,{});case rs.BOT_TALK_DIRECT_TO_AVTR:return i.jsx(net,{});case rs.BOT_TELEPORT:return i.jsx(oet,{});case rs.CALL_ANOTHER_STACK:return i.jsx(cet,{});case rs.CHASE:return i.jsx(uet,{});case rs.CHAT:return i.jsx(het,{});case rs.FLEE:return i.jsx(det,{});case rs.GIVE_REWARD:return i.jsx(_et,{});case rs.GIVE_SCORE:return i.jsx(fet,{});case rs.GIVE_SCORE_TO_PREDEFINED_TEAM:return i.jsx(get,{});case rs.JOIN_TEAM:return i.jsx(met,{});case rs.KICK_FROM_ROOM:return i.jsx(Eet,{});case rs.LEAVE_TEAM:return i.jsx(pet,{});case rs.MOVE_FURNI:return i.jsx(xet,{});case rs.MOVE_AND_ROTATE_FURNI:return i.jsx(Ret,{});case rs.MOVE_FURNI_TO:return i.jsx(Aet,{});case rs.MUTE_USER:return i.jsx(yet,{});case rs.RESET:return i.jsx(Met,{});case rs.SET_FURNI_STATE:return i.jsx(bet,{});case rs.TELEPORT:return i.jsx(Det,{});case rs.TOGGLE_FURNI_STATE:return i.jsx(vet,{})}return null},Xi=a=>{const{requiresFurni:t=bt.STUFF_SELECTION_OPTION_NONE,save:e=null,hasSpecialInput:s=!1,children:r=null}=a,n=()=>e&&e();return i.jsx(QS,{wiredType:"condition",requiresFurni:t,hasSpecialInput:s,save:n,children:r})},Let=[2,5,7,8,9,10,27],Uet=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.handitem")}),i.jsx("select",{className:"form-select form-select-sm",value:t,onChange:o=>e(parseInt(o.target.value)),children:Let.map(o=>i.jsx("option",{value:o,children:g(`handitem${o}`)},o))})]})})},jet=a=>i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),wet=a=>i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),Fet=[1,2,3,4],Get=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.team")}),Fet.map(o=>i.jsxs(x,{gap:1,alignItems:"center",children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${o}`,checked:t===o,onChange:l=>e(o)}),i.jsx(O,{children:g(`wiredfurni.params.team.${o}`)})]},o))]})})},ket=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:r=null}=oe(),n=()=>r(t);return _.useEffect(()=>{e(s.stringData)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.badgecode")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:o=>e(o.target.value)})]})})},Bet=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e((s==null?void 0:s.intData[0])??0)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.tooltip.effectid")}),i.jsx("input",{type:"number",className:"form-control form-control-sm",value:t,onChange:o=>e(parseInt(o.target.value))})]})})},Vet=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(""),{trigger:n=null,setIntParams:o=null}=oe(),l=()=>{let c=0,u=0;const h=new Date(t),d=new Date(s);h&&d&&(c=h.getTime()/1e3,u=d.getTime()/1e3),o([c,u])};return _.useEffect(()=>{if(n.intData.length>=2){let c=new Date,u=new Date;n.intData[0]>0&&(c=new Date(n.intData[0]*1e3)),n.intData[1]>0&&(u=new Date(n.intData[1]*1e3)),e(pA(c)),r(pA(u))}},[n]),i.jsxs(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.startdate")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:c=>e(c.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.enddate")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:s,onChange:c=>r(c.target.value)})]})]})},Het=a=>i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),Wet=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.requireall")}),[0,1].map(o=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:t===o,onChange:l=>e(o)}),i.jsx(O,{children:g("wiredfurni.params.requireall."+o)})]},o))]})})},Yet=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.not_requireall")}),[0,1].map(o=>i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:t===o,onChange:l=>e(o)}),i.jsx(O,{children:g(`wiredfurni.params.not_requireall.${o}`)})]},o))]})})},zet=a=>i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Ket=a=>{const[t,e]=_.useState(0),[s,r]=_.useState(0),[n,o]=_.useState(0),{trigger:l=null,setIntParams:c=null}=oe(),u=()=>c([t,s,n]);return _.useEffect(()=>{e(l.getBoolean(0)?1:0),r(l.getBoolean(1)?1:0),o(l.getBoolean(2)?1:0)},[l]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:u,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.conditions")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!t,onChange:h=>e(h.target.checked?1:0)}),i.jsx(O,{children:g("wiredfurni.params.condition.state")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!s,onChange:h=>r(h.target.checked?1:0)}),i.jsx(O,{children:g("wiredfurni.params.condition.direction")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:h=>o(h.target.checked?1:0)}),i.jsx(O,{children:g("wiredfurni.params.condition.position")})]})]})})},Xet=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.allowbefore",["seconds"],[Ud(t)])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:1200,value:t,onChange:o=>e(o)})]})})},qet=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.allowafter",["seconds"],[Ud(t)])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:1200,value:t,onChange:o=>e(o)})]})})},Qet=a=>{const[t,e]=_.useState(1),[s,r]=_.useState(0),{trigger:n=null,setIntParams:o=null}=oe(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),r(n.intData[1])):(e(1),r(0))},[n]),i.jsxs(Xi,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.usercountmin",["value"],[t.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:50,value:t,onChange:c=>e(c)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.usercountmax",["value"],[s.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:0,max:125,value:s,onChange:c=>r(c)})]})]})},Jet=a=>{switch(a){case cs.ACTOR_HAS_HANDITEM:return i.jsx(Uet,{});case cs.ACTOR_IS_GROUP_MEMBER:case cs.NOT_ACTOR_IN_GROUP:return i.jsx(jet,{});case cs.ACTOR_IS_ON_FURNI:case cs.NOT_ACTOR_ON_FURNI:return i.jsx(wet,{});case cs.ACTOR_IS_IN_TEAM:case cs.NOT_ACTOR_IN_TEAM:return i.jsx(Get,{});case cs.ACTOR_IS_WEARING_BADGE:case cs.NOT_ACTOR_WEARS_BADGE:return i.jsx(ket,{});case cs.ACTOR_IS_WEARING_EFFECT:case cs.NOT_ACTOR_WEARING_EFFECT:return i.jsx(Bet,{});case cs.DATE_RANGE_ACTIVE:return i.jsx(Vet,{});case cs.FURNIS_HAVE_AVATARS:case cs.FURNI_NOT_HAVE_HABBO:return i.jsx(Het,{});case cs.HAS_STACKED_FURNIS:return i.jsx(Wet,{});case cs.NOT_HAS_STACKED_FURNIS:return i.jsx(Yet,{});case cs.STUFF_TYPE_MATCHES:case cs.NOT_FURNI_IS_OF_TYPE:return i.jsx(zet,{});case cs.STATES_MATCH:case cs.NOT_STATES_MATCH:return i.jsx(Ket,{});case cs.TIME_ELAPSED_LESS:return i.jsx(Xet,{});case cs.TIME_ELAPSED_MORE:return i.jsx(qet,{});case cs.USER_COUNT_IN:case cs.NOT_USER_COUNT_IN:return i.jsx(Qet,{})}return null},fr=a=>{const{requiresFurni:t=bt.STUFF_SELECTION_OPTION_NONE,save:e=null,hasSpecialInput:s=!1,children:r=null}=a,n=()=>e&&e();return i.jsx(QS,{wiredType:"trigger",requiresFurni:t,hasSpecialInput:s,save:n,children:r})},Zet=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(0),{trigger:n=null,setStringParam:o=null}=oe(),l=()=>o(s===1?t:"");return _.useEffect(()=>{e(n.stringData),r(n.stringData?1:0)},[n]),i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.picktriggerer")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:s===0,onChange:c=>r(0)}),i.jsx(O,{children:g("wiredfurni.params.anyavatar")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:s===1,onChange:c=>r(1)}),i.jsx(O,{children:g("wiredfurni.params.certainavatar")})]}),s===1&&i.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:c=>e(c.target.value)})]})})},$et=a=>{const[t,e]=_.useState(""),[s,r]=_.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=oe(),c=()=>{o(t),l([s])};return _.useEffect(()=>{e(n.stringData),r(n.intData.length>0?n.intData[0]:0)},[n]),i.jsxs(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.whatissaid")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:u=>e(u.target.value)})]}),i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.picktriggerer")}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:s===0,onChange:u=>r(0)}),i.jsx(O,{children:g("wiredfurni.params.anyavatar")})]}),i.jsxs(x,{alignItems:"center",gap:1,children:[i.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:s===1,onChange:u=>r(1)}),i.jsx(O,{children:tt().userName})]})]})]})},tst=a=>i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),est=a=>i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),sst=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:r=null}=oe(),n=()=>r(t);return _.useEffect(()=>{e(s.stringData)},[s]),i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},ist=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:r=null}=oe(),n=()=>r(t);return _.useEffect(()=>{e(s.stringData)},[s]),i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.bot.name")}),i.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},rst=a=>i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),nst=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.settime",["seconds"],[Ud(t)])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:1200,value:t,onChange:o=>e(o)})]})})},ast=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.setlongtime",["time"],[xr.format(t*5).toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:120,value:t,onChange:o=>e(o)})]})})},ost=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.settime",["seconds"],[Ud(t)])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:60,value:t,onChange:o=>e(o)})]})})},lst=a=>i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),cst=a=>i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),ust=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:r=null}=oe(),n=()=>r([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:i.jsxs(N,{gap:1,children:[i.jsx(O,{bold:!0,children:g("wiredfurni.params.setscore",["points"],[t.toString()])}),i.jsx(Xs,{className:"nitro-slider",min:1,max:1e3,value:t,onChange:o=>e(o)})]})})},hst=a=>i.jsx(fr,{requiresFurni:bt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),dst=a=>{switch(a){case Ri.AVATAR_ENTERS_ROOM:return i.jsx(Zet,{});case Ri.AVATAR_SAYS_SOMETHING:return i.jsx($et,{});case Ri.AVATAR_WALKS_OFF_FURNI:return i.jsx(tst,{});case Ri.AVATAR_WALKS_ON_FURNI:return i.jsx(est,{});case Ri.BOT_REACHED_AVATAR:return i.jsx(sst,{});case Ri.BOT_REACHED_STUFF:return i.jsx(ist,{});case Ri.COLLISION:return i.jsx(rst,{});case Ri.EXECUTE_ONCE:return i.jsx(nst,{});case Ri.EXECUTE_PERIODICALLY:return i.jsx(ost,{});case Ri.EXECUTE_PERIODICALLY_LONG:return i.jsx(ast,{});case Ri.GAME_ENDS:return i.jsx(lst,{});case Ri.GAME_STARTS:return i.jsx(cst,{});case Ri.SCORE_ACHIEVED:return i.jsx(ust,{});case Ri.TOGGLE_FURNI:return i.jsx(hst,{})}return null},_st=a=>{const{trigger:t=null}=oe();return t?t instanceof MR?Pet(t.code):t instanceof yR?dst(t.code):t instanceof xR?Jet(t.code):null:null},gst=a=>{const[t,e]=_.useState(!1),[s,r]=_.useState(!0);return ft(yt.CREATED,n=>r(!1)),ft(yt.ENDED,n=>r(n.openLandingView)),_.useEffect(()=>{e(!0),it().connection.ready()},[]),_.useEffect(()=>{const n={linkReceived:o=>{const l=o.split("/");if(!(l.length<2))switch(l[1]){case"open":if(l.length>2)switch(l[2]){case"credits":break;default:{const c=l[2];Nn.openHabblet(c)}}return}},eventUrlPrefix:"habblet/"};return As(n),()=>Ns(n)},[]),i.jsxs(V,{fit:!0,children:[i.jsx(hu,{children:s&&i.jsx(du.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i.jsx(qJ,{})})}),i.jsx(Wtt,{isInRoom:!s}),i.jsx(OZ,{}),i.jsx(Vtt,{}),i.jsx(EQ,{}),i.jsx(_st,{}),i.jsx(S9,{}),i.jsx(g9,{}),i.jsx(FZ,{}),i.jsx(GZ,{}),i.jsx(lZ,{}),i.jsx(mQ,{}),i.jsx(BQ,{}),i.jsx(u$,{}),i.jsx(Jtt,{}),i.jsx(Qtt,{}),i.jsx(rJ,{}),i.jsx(M9,{}),i.jsx(LJ,{}),i.jsx(BZ,{}),i.jsx(fJ,{}),i.jsx(mJ,{}),i.jsx(v9,{}),i.jsx(YQ,{}),i.jsx(yQ,{})]})};fu.UI_VERSION=ZL();const fst=a=>{const[t,e]=_.useState(!1);return z(jR,s=>{const r=s.getParser();r&&re.callGame("showGame",r.url)}),_.useEffect(()=>{(async(r,n)=>{try{if(!window.NitroConfig)throw new Error("NitroConfig is not defined!");const o=await Z0({width:r,height:n,autoDensity:!0,backgroundAlpha:0,preference:"webgl",resolution:window.devicePixelRatio});await jt().init(),Ti().maxFPS=jt().getValue("system.fps.max",24),Lt.LOG_DEBUG=jt().getValue("system.log.debug",!0),Lt.LOG_WARN=jt().getValue("system.log.warn",!1),Lt.LOG_ERROR=jt().getValue("system.log.error",!1),Lt.LOG_EVENTS=jt().getValue("system.log.events",!1),Lt.LOG_PACKETS=jt().getValue("system.log.packets",!1);const l=jt().getValue("preload.assets.urls").map(c=>jt().interpolate(c))??[];await Promise.all([ae().downloadAssets(l),Tn().init(),is().init(),Os().init(),tt().init(),Yi().init(),au().init()]),await rt().init(),await it().init(),re.available&&re.call("legacyTrack","authentication","authok",[]),Nn.sendHeartBeat(),setInterval(()=>Nn.sendHeartBeat(),1e4),Ti().add(c=>rt().update(c)),Ti().add(c=>o.render(Yh())),Ti().add(c=>la().run()),e(!0)}catch(o){Lt.error(o)}})(window.innerWidth,window.innerHeight)},[]),i.jsxs(V,{fit:!0,overflow:"hidden",className:!(window.devicePixelRatio%1)&&"image-rendering-pixelated",children:[!t&&i.jsx(o9,{}),t&&i.jsx(gst,{}),i.jsx(V,{id:"draggable-windows-container"})]})};X0(document.getElementById("root")).render(i.jsx(fst,{}));
